<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>rest_framework_nuggests.md</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__left">
    <div class="stackedit__toc">
      
<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#requests">Requests</a>
<ul>
<li><a href="#request-parsing">Request parsing</a></li>
<li><a href="#authentication">Authentication</a></li>
<li><a href="#browser-enhancements">Browser enhancements</a></li>
</ul>
</li>
<li><a href="#responses">Responses</a>
<ul>
<li><a href="#creating-responses">Creating responses</a></li>
</ul>
</li>
<li><a href="#status-codes">Status Codes</a>
<ul>
<li><a href="#information---1xx">Information - 1xx</a></li>
<li><a href="#successful---2xx">Successful - 2xx</a></li>
<li><a href="#redirection---3xx">Redirection - 3xx</a></li>
<li><a href="#client-error---4xx">Client Error - 4xx</a></li>
<li><a href="#server-error---5xx">Server Error - 5xx</a></li>
<li><a href="#helper-functions">Helper functions</a></li>
</ul>
</li>
<li><a href="#views">Views</a>
<ul>
<li><a href="#class-based-views">Class-based Views</a></li>
<li><a href="#function-based-views">Function-based Views</a></li>
</ul>
</li>
<li><a href="#generic-views">Generic Views</a>
<ul>
<li><a href="#genericapiview">GenericAPIView</a>
<ul>
<li></li>
</ul>
</li>
<li><a href="#mixins">Mixins</a></li>
<li><a href="#concrete-view-classes">Concrete View Classes</a></li>
<li><a href="#customizing-the-generic-views">Customizing the generic views</a></li>
</ul>
</li>
<li><a href="#viewsets">Viewsets</a>
<ul>
<li><a href="#viewset-actions">ViewSet actions</a></li>
<li><a href="#making-extra-actions-for-routing">Making extra actions for routing</a></li>
<li><a href="#routing-additional-http-methods-for-extra-actions">Routing additional HTTP methods for extra actions</a></li>
<li><a href="#reversing-actions-urls">Reversing actions URLs</a></li>
<li><a href="#viewset">ViewSet</a></li>
<li><a href="#genericviewset">GenericViewSet</a></li>
<li><a href="#modelviewset">ModelViewSet</a></li>
<li><a href="#readonlymodelviewset">ReadOnlyModelViewSet</a></li>
<li><a href="#custom-viewset-base-classes">Custom ViewSet base classes</a></li>
<li><a href="#comparing-view-and-viewsets">Comparing View and ViewSets</a></li>
</ul>
</li>
<li><a href="#routers">Routers</a>
<ul>
<li><a href="#using--include--with-routers">Using  include  with routers</a></li>
<li><a href="#routing-for-extra-actions">Routing for extra actions</a></li>
</ul>
</li>
<li><a href="#serializers">Serializers</a>
<ul>
<li><a href="#declaring-serializers">Declaring Serializers</a></li>
<li><a href="#saving-instances">Saving instances</a></li>
<li><a href="#validation">Validation</a></li>
<li><a href="#accessing-the-initial-data-and-instance">Accessing the initial data and instance</a></li>
<li><a href="#dealing-with-nested-objects">Dealing with nested objects</a></li>
<li><a href="#dealing-with-multiple-objects">Dealing with multiple objects</a></li>
<li><a href="#including-extra-context">Including extra context</a></li>
<li><a href="#modelserializer">ModelSerializer</a></li>
</ul>
</li>
<li><a href="#serializer-relations">Serializer relations</a></li>
</ul>

    </div>
  </div>
  <div class="stackedit__right">
    <div class="stackedit__html">
      <h1 id="table-of-contents">Table of Contents</h1>
<ul>
<li><a href="#requests">Requests</a>
<ul>
<li><a href="#request-parsing">Request parsing</a></li>
<li><a href="#authentication">Authentication</a></li>
<li><a href="#browser-enhancements">Browser enhancements</a></li>
</ul>
</li>
<li><a href="#responses">Responses</a>
<ul>
<li><a href="#creating-responses">Creating responses</a></li>
</ul>
</li>
<li><a href="#status-codes">Status Codes</a>
<ul>
<li><a href="#information---1xx">Information - 1xx</a></li>
<li><a href="#successful---2xx">Successful - 2xx</a></li>
<li><a href="#redirection---3xx">Redirection - 3xx</a></li>
<li><a href="#client-error---4xx">Client Error - 4xx</a></li>
<li><a href="#server-error---5xx">Server Error - 5xx</a></li>
<li><a href="#helper-functions">Helper functions</a></li>
</ul>
</li>
<li><a href="#views">Views</a>
<ul>
<li><a href="#class-based-views">Class-based Views</a></li>
<li><a href="#function-based-views">Function-based Views</a>
<ul>
<li><a href="#the---api-view----decorator">The <code>@api_view()</code> decorator</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#generic-views">Generic Views</a>
<ul>
<li><a href="#genericapiview">GenericAPIView</a>
<ul>
<li><a href="#-get-queryset-self--"><code>get_queryset(self)</code></a></li>
<li><a href="#-get-object-self--"><code>get_object(self)</code></a></li>
<li><a href="#-filter-queryset-self--queryset--"><code>filter_queryset(self, queryset)</code></a></li>
<li><a href="#-get-serializer-class-self--"><code>get_serializer_class(self)</code></a></li>
</ul>
</li>
<li><a href="#mixins">Mixins</a>
<ul>
<li><a href="#listmodelmixin">ListModelMixin</a></li>
<li><a href="#createmodelmixin">CreateModelMixin</a></li>
<li><a href="#retrievemodelmixin">RetrieveModelMixin</a></li>
<li><a href="#updatemodelmixin">UpdateModelMixin</a></li>
<li><a href="#destroymodelmixin">DestroyModelMixin</a></li>
</ul>
</li>
<li><a href="#concrete-view-classes">Concrete View Classes</a></li>
<li><a href="#customizing-the-generic-views">Customizing the generic views</a></li>
</ul>
</li>
<li><a href="#viewsets">Viewsets</a>
<ul>
<li><a href="#viewset-actions">ViewSet actions</a></li>
<li><a href="#making-extra-actions-for-routing">Making extra actions for routing</a></li>
<li><a href="#routing-additional-http-methods-for-extra-actions">Routing additional HTTP methods for extra actions</a></li>
<li><a href="#reversing-actions-urls">Reversing actions URLs</a></li>
<li><a href="#viewset">ViewSet</a></li>
<li><a href="#genericviewset">GenericViewSet</a></li>
<li><a href="#modelviewset">ModelViewSet</a></li>
<li><a href="#readonlymodelviewset">ReadOnlyModelViewSet</a></li>
<li><a href="#custom-viewset-base-classes">Custom ViewSet base classes</a></li>
<li><a href="#comparing-view-and-viewsets">Comparing View and ViewSets</a></li>
</ul>
</li>
<li><a href="#routers">Routers</a>
<ul>
<li><a href="#using---include---with-routers">Using  <code>include</code>  with routers</a></li>
<li><a href="#routing-for-extra-actions">Routing for extra actions</a></li>
</ul>
</li>
<li><a href="#serializers">Serializers</a>
<ul>
<li><a href="#declaring-serializers">Declaring Serializers</a></li>
<li><a href="#saving-instances">Saving instances</a>
<ul>
<li><a href="#passing-additional-attributes-to--save----">Passing additional attributes to <code>.save()</code>:</a></li>
<li><a href="#overriding---save-----directly">Overriding  <code>.save()</code>  directly</a></li>
</ul>
</li>
<li><a href="#validation">Validation</a>
<ul>
<li><a href="#field-level-validation">Field-level validation</a></li>
<li><a href="#object-level-validation">Object-level validation</a></li>
</ul>
</li>
<li><a href="#accessing-the-initial-data-and-instance">Accessing the initial data and instance</a>
<ul>
<li><a href="#partial-updates">Partial updates</a></li>
</ul>
</li>
<li><a href="#dealing-with-nested-objects">Dealing with nested objects</a>
<ul>
<li><a href="#writing--create----methods-for-nested-representations">Writing <code>.create()</code> methods for nested representations</a></li>
<li><a href="#writing--update----methods-for-nested-representations">Writing <code>.update()</code> methods for nested representations</a></li>
<li><a href="#handling-saving-related-instances-in-model-manager-classes">Handling saving related instances in model manager classes</a></li>
</ul>
</li>
<li><a href="#dealing-with-multiple-objects">Dealing with multiple objects</a></li>
<li><a href="#including-extra-context">Including extra context</a></li>
<li><a href="#modelserializer">ModelSerializer</a>
<ul>
<li><a href="#inspecting-a---modelserializer-">Inspecting a  <code>ModelSerializer</code></a></li>
<li><a href="#specifying-which-fields-to-include">Specifying which fields to include</a></li>
<li><a href="#specifying-nested-serialization">Specifying nested serialization</a></li>
<li><a href="#specifying-fields-explicitly">Specifying fields explicitly</a></li>
<li><a href="#specifying-read-only-fields">Specifying read only fields</a></li>
<li><a href="#additional-keyword-arguments">Additional keyword arguments</a></li>
<li><a href="#relational-fields">Relational fields</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#serializer-relations">Serializer relations</a></li>
</ul>
<h1 id="requests">Requests</h1>
<p>REST framework’s  <code>Request</code>  class extends the standard  <code>HttpRequest</code>, adding support for REST framework’s flexible request parsing and request authentication.</p>
<h2 id="request-parsing">Request parsing</h2>
<ul>
<li><code>request.data</code> returns the parsed content of the request body.</li>
<li><code>request.query_params</code> is for getting the query parameters.</li>
</ul>
<h2 id="authentication">Authentication</h2>
<ul>
<li><code>request.user</code> typically returns an instance of <code>django.contrib.auth.models.User</code>, although the behavior depends on the authentication policy being used.</li>
<li><code>request.auth</code> returns any additional authentication context.</li>
</ul>
<h2 id="browser-enhancements">Browser enhancements</h2>
<ul>
<li><code>request.method</code> returns the <strong>uppercased</strong> string representation of the request’s HTTP method.</li>
<li><code>request.content_type</code>, returns a string object representing the media type of the HTTP request’s body, or an empty string if no media type was provided.</li>
</ul>
<h1 id="responses">Responses</h1>
<ul>
<li><code>Response</code> class which allows you to return content that can be rendered into multiple content types, depending on the client request.</li>
<li>The <code>Response</code> class subclasses Django’s <code>SimpleTemplateResponse</code>.</li>
<li>There’s no requirement for you to use the <code>Response</code> class, you can also return regular <code>HttpResponse</code> or <code>StreamingHttpResponse</code> objects from your views if required.</li>
<li>Using the <code>Response</code> class <em><strong>simply provides a nicer interface</strong></em> for returning content-negotiated Web API responses, that can be rendered to multiple formats.</li>
</ul>
<h2 id="creating-responses">Creating responses</h2>
<p><strong>Signature:</strong>  <code>Response(data, status=None, template_name=None, headers=None, content_type=None)</code></p>
<ul>
<li>
<p><code>data</code>: The serialized data for the response.</p>
</li>
<li>
<p><code>status</code>: A status code for the response. Defaults to 200. See also  <a href="https://www.django-rest-framework.org/api-guide/status-codes/">status codes</a>.</p>
</li>
<li>
<p><code>template_name</code>: A template name to use if  <code>HTMLRenderer</code>  is selected.</p>
</li>
<li>
<p><code>headers</code>: A dictionary of HTTP headers to use in the response.</p>
</li>
<li>
<p><code>content_type</code>: The content type of the response. Typically, this will be set automatically by the renderer as determined by content negotiation, but there may be some cases where you need to specify the content type explicitly.</p>
</li>
<li>
<p>Unlike regular  <code>HttpResponse</code>  objects, you do not instantiate  <code>Response</code>  objects with rendered content. Instead you pass in unrendered data, which may consist of any Python primitives.</p>
</li>
<li>
<p><strong>Note:</strong> The renderers used by the <code>Response</code> class cannot natively handle complex datatypes such as Django model instances, so you need to serialize the data into primitive datatypes before creating the <code>Response</code> object.</p>
</li>
</ul>
<h1 id="status-codes">Status Codes</h1>
<p>Using bare status codes in your responses isn’t recommended. REST framework includes a set of named constants that you can use to make your code more obvious and readable.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> status
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response

<span class="token keyword">def</span> <span class="token function">empty_view</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    content <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'please move along'</span><span class="token punctuation">:</span> <span class="token string">'nothing to see here'</span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> Response<span class="token punctuation">(</span>content<span class="token punctuation">,</span> status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_404_NOT_FOUND<span class="token punctuation">)</span>
</code></pre>
<p>The full set of HTTP status codes included in the  <code>status</code>  module is listed below.</p>
<p>The module also includes a set of helper functions for testing if a status code is in a given range.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> status
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>test <span class="token keyword">import</span> APITestCase

<span class="token keyword">class</span> <span class="token class-name">ExampleTestCase</span><span class="token punctuation">(</span>APITestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">test_url_root</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> reverse<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span>
        response <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertTrue<span class="token punctuation">(</span>status<span class="token punctuation">.</span>is_success<span class="token punctuation">(</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="information---1xx">Information - 1xx</h2>
<p>This class of status code indicates a provisional response. There are no 1xx status codes used in REST framework by default.</p>
<pre><code>HTTP_100_CONTINUE
HTTP_101_SWITCHING_PROTOCOLS
</code></pre>
<h2 id="successful---2xx">Successful - 2xx</h2>
<p>This class of status code indicates that the client’s request was successfully received, understood, and accepted.</p>
<pre><code>HTTP_200_OK
HTTP_201_CREATED
HTTP_202_ACCEPTED
HTTP_203_NON_AUTHORITATIVE_INFORMATION
HTTP_204_NO_CONTENT
HTTP_205_RESET_CONTENT
HTTP_206_PARTIAL_CONTENT
HTTP_207_MULTI_STATUS
HTTP_208_ALREADY_REPORTED
HTTP_226_IM_USED
</code></pre>
<h2 id="redirection---3xx">Redirection - 3xx</h2>
<p>This class of status code indicates that further action needs to be taken by the user agent in order to fulfill the request.</p>
<pre><code>HTTP_300_MULTIPLE_CHOICES
HTTP_301_MOVED_PERMANENTLY
HTTP_302_FOUND
HTTP_303_SEE_OTHER
HTTP_304_NOT_MODIFIED
HTTP_305_USE_PROXY
HTTP_306_RESERVED
HTTP_307_TEMPORARY_REDIRECT
HTTP_308_PERMANENT_REDIRECT
</code></pre>
<h2 id="client-error---4xx">Client Error - 4xx</h2>
<p>The 4xx class of status code is intended for cases in which the client seems to have erred. Except when responding to a HEAD request, the server SHOULD include an entity containing an explanation of the error situation, and whether it is a temporary or permanent condition.</p>
<pre><code>HTTP_400_BAD_REQUEST
HTTP_401_UNAUTHORIZED
HTTP_402_PAYMENT_REQUIRED
HTTP_403_FORBIDDEN
HTTP_404_NOT_FOUND
HTTP_405_METHOD_NOT_ALLOWED
HTTP_406_NOT_ACCEPTABLE
HTTP_407_PROXY_AUTHENTICATION_REQUIRED
HTTP_408_REQUEST_TIMEOUT
HTTP_409_CONFLICT
HTTP_410_GONE
HTTP_411_LENGTH_REQUIRED
HTTP_412_PRECONDITION_FAILED
HTTP_413_REQUEST_ENTITY_TOO_LARGE
HTTP_414_REQUEST_URI_TOO_LONG
HTTP_415_UNSUPPORTED_MEDIA_TYPE
HTTP_416_REQUESTED_RANGE_NOT_SATISFIABLE
HTTP_417_EXPECTATION_FAILED
HTTP_422_UNPROCESSABLE_ENTITY
HTTP_423_LOCKED
HTTP_424_FAILED_DEPENDENCY
HTTP_426_UPGRADE_REQUIRED
HTTP_428_PRECONDITION_REQUIRED
HTTP_429_TOO_MANY_REQUESTS
HTTP_431_REQUEST_HEADER_FIELDS_TOO_LARGE
HTTP_451_UNAVAILABLE_FOR_LEGAL_REASONS
</code></pre>
<h2 id="server-error---5xx">Server Error - 5xx</h2>
<p>Response status codes beginning with the digit “5” indicate cases in which the server is aware that it has erred or is incapable of performing the request. Except when responding to a HEAD request, the server SHOULD include an entity containing an explanation of the error situation, and whether it is a temporary or permanent condition.</p>
<pre><code>HTTP_500_INTERNAL_SERVER_ERROR
HTTP_501_NOT_IMPLEMENTED
HTTP_502_BAD_GATEWAY
HTTP_503_SERVICE_UNAVAILABLE
HTTP_504_GATEWAY_TIMEOUT
HTTP_505_HTTP_VERSION_NOT_SUPPORTED
HTTP_506_VARIANT_ALSO_NEGOTIATES
HTTP_507_INSUFFICIENT_STORAGE
HTTP_508_LOOP_DETECTED
HTTP_509_BANDWIDTH_LIMIT_EXCEEDED
HTTP_510_NOT_EXTENDED
HTTP_511_NETWORK_AUTHENTICATION_REQUIRED
</code></pre>
<h2 id="helper-functions">Helper functions</h2>
<p>The following helper functions are available for identifying the category of the response code.</p>
<pre><code>is_informational()  # 1xx
is_success()        # 2xx
is_redirect()       # 3xx
is_client_error()   # 4xx
is_server_error()   # 5xx
</code></pre>
<h1 id="views">Views</h1>
<p><strong>Note:</strong> <em>Refer to <a href="https://www.cdrf.co/">this website</a> for a nice browsable documentation on views.</em></p>
<h2 id="class-based-views">Class-based Views</h2>
<p>REST framework provides an  <code>APIView</code>  class, which subclasses Django’s  <code>View</code>  class.</p>
<p><code>APIView</code>  classes are different from regular  <code>View</code>  classes in the following ways:</p>
<ul>
<li>Requests passed to the handler methods will be REST framework’s  <code>Request</code>  instances, not Django’s  <code>HttpRequest</code>  instances.</li>
<li>Handler methods may return REST framework’s  <code>Response</code>, instead of Django’s  <code>HttpResponse</code>. The view will manage content negotiation and setting the correct renderer on the response.</li>
<li>Any  <code>APIException</code>  exceptions will be caught and mediated into appropriate responses.</li>
<li>Incoming requests will be authenticated and appropriate permission and/or throttle checks will be run before dispatching the request to the handler method.</li>
</ul>
<p>Using the <code>APIView</code> class is pretty much the same as using a regular <code>View</code> class, as usual, the incoming request is dispatched to an appropriate handler method such as <code>.get()</code> or <code>.post()</code>.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> authentication<span class="token punctuation">,</span> permissions
<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>models <span class="token keyword">import</span> User

<span class="token keyword">class</span> <span class="token class-name">ListUsers</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    View to list all users in the system.

    * Requires token authentication.
    * Only admin users are able to access this view.
    """</span>
    authentication_classes <span class="token operator">=</span> <span class="token punctuation">[</span>authentication<span class="token punctuation">.</span>TokenAuthentication<span class="token punctuation">]</span>
    permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>permissions<span class="token punctuation">.</span>IsAdminUser<span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        Return a list of all users.
        """</span>
        usernames <span class="token operator">=</span> <span class="token punctuation">[</span>user<span class="token punctuation">.</span>username <span class="token keyword">for</span> user <span class="token keyword">in</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>usernames<span class="token punctuation">)</span>
</code></pre>
<h2 id="function-based-views">Function-based Views</h2>
<p>REST framework also allows you to work with regular function based views. It provides a set of simple decorators that wrap your function based views to ensure they receive an instance of  <code>Request</code>  (rather than the usual Django  <code>HttpRequest</code>) and allows them to return a  <code>Response</code>  (instead of a Django  <code>HttpResponse</code>), and allow you to configure how the request is processed.</p>
<h3 id="the-api_view-decorator">The <code>@api_view()</code> decorator</h3>
<p><strong>Signature:</strong>  <code>@api_view(http_method_names=['GET'])</code></p>
<p>The core of this functionality is the  <code>api_view</code>  decorator, which takes a list of HTTP methods that your view should respond to. For example, this is how you would write a very simple view that just manually returns some data:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>decorators <span class="token keyword">import</span> api_view
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response

@api_view<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Hello, world!"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>By default only  <code>GET</code>  methods will be accepted. Other methods will respond with “405 Method Not Allowed”. To alter this behaviour, specify which methods the view allows, like so:</p>
<pre class=" language-python"><code class="prism  language-python">@api_view<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Got some data!"</span><span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">:</span> request<span class="token punctuation">.</span>data<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"Hello, world!"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h1 id="generic-views">Generic Views</h1>
<p>One of the key benefits of class-based views is the way they allow you to compose bits of <em><strong>reusable behavior</strong></em>. REST framework takes advantage of this by providing a number of pre-built views that provide for commonly used patterns.</p>
<p>The generic views provided by REST framework allow you to quickly build API views that map closely to your database models.</p>
<p><strong>Note:</strong> If the generic views don’t suit the needs of your API, you can drop down to using the regular <code>APIView</code> class, or reuse the mixins and base classes used by the generic views to compose your own set of reusable generic views.</p>
<p>Typically when using the generic views, you’ll override the view, and set several class attributes.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>models <span class="token keyword">import</span> User
<span class="token keyword">from</span> myapp<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> UserSerializer
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> generics
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>permissions <span class="token keyword">import</span> IsAdminUser

<span class="token keyword">class</span> <span class="token class-name">UserList</span><span class="token punctuation">(</span>generics<span class="token punctuation">.</span>ListCreateAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> UserSerializer
    permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>IsAdminUser<span class="token punctuation">]</span>
</code></pre>
<p>For more complex cases you might also want to override various methods on the view class. For example.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">UserList</span><span class="token punctuation">(</span>generics<span class="token punctuation">.</span>ListCreateAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> UserSerializer
    permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>IsAdminUser<span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># Note the use of `get_queryset()` instead of `self.queryset`</span>
        queryset <span class="token operator">=</span> self<span class="token punctuation">.</span>get_queryset<span class="token punctuation">(</span><span class="token punctuation">)</span>
        serializer <span class="token operator">=</span> UserSerializer<span class="token punctuation">(</span>queryset<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre>
<p>For very simple cases you might want to pass through any class attributes using the  <code>.as_view()</code>  method. For example, your URLconf might include something like the following entry:</p>
<pre class=" language-python"><code class="prism  language-python">path<span class="token punctuation">(</span><span class="token string">'users/'</span><span class="token punctuation">,</span> ListCreateAPIView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span>queryset<span class="token operator">=</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> serializer_class<span class="token operator">=</span>UserSerializer<span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'user-list'</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="genericapiview">GenericAPIView</h2>
<p>This class extends REST framework’s  <code>APIView</code>  class, adding commonly required behavior for standard list and detail views.</p>
<p><strong>Note:</strong> Each of the concrete generic views provided is built by combining  <code>GenericAPIView</code>, with one or more mixin classes.</p>
<p><strong>Basic settings</strong>:</p>
<p>The following attributes control the basic view behavior.</p>
<ul>
<li><code>queryset</code>  - The queryset that should be used for returning objects from this view. Typically, you must either set this attribute, or override the  <code>get_queryset()</code>  method. If you are overriding a view method, it is important that you call  <code>get_queryset()</code>  instead of accessing this property directly, as  <code>queryset</code>  will get evaluated once, and those results will be cached for all subsequent requests.</li>
<li><code>serializer_class</code>  - The serializer class that should be used for validating and deserializing input, and for serializing output. Typically, you must either set this attribute, or override the  <code>get_serializer_class()</code>  method.</li>
<li><code>lookup_field</code>  - The model field that should be used to for performing object lookup of individual model instances. Defaults to  <code>'pk'</code>. Note that when using hyperlinked APIs you’ll need to ensure that  <em>both</em>  the API views  <em>and</em>  the serializer classes set the lookup fields if you need to use a custom value.</li>
<li><code>lookup_url_kwarg</code>  - The URL keyword argument that should be used for object lookup. The URL conf should include a keyword argument corresponding to this value. If unset this defaults to using the same value as  <code>lookup_field</code>.</li>
</ul>
<blockquote>
<p><strong>Note:</strong> Check out the source code <a href="https://github.com/encode/django-rest-framework/blob/0323d6f8955f987771269506ca5da461e2e7a248/rest_framework/generics.py#L24">here</a></p>
</blockquote>
<p><strong>Base methods:</strong></p>
<h4 id="get_querysetself"><code>get_queryset(self)</code></h4>
<p>Returns the queryset that should be used for list views, and that should be used as the base for lookups in detail views. Defaults to returning the queryset specified by the  <code>queryset</code>  attribute.</p>
<p>This method should always be used rather than accessing  <code>self.queryset</code>  directly, as  <code>self.queryset</code>  gets evaluated only once, and those results are cached for all subsequent requests.</p>
<p>May be overridden to provide dynamic behavior, such as returning a queryset, that is specific to the user making the request.</p>
<p>For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">def</span> <span class="token function">get_queryset</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    user <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>user
    <span class="token keyword">return</span> user<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<blockquote>
<p><strong>Note:</strong>  If the serializer_class used in the generic view spans orm relations, leading to an n+1 problem, you could optimize your queryset in this method using  <code>select_related</code>  and  <code>prefetch_related</code>. To get more information about n+1 problem and use cases of the mentioned methods refer to related section in  <a href="https://docs.djangoproject.com/en/3.1/ref/models/querysets/#django.db.models.query.QuerySet.select_related">django documentation</a>.</p>
</blockquote>
<h4 id="get_objectself"><code>get_object(self)</code></h4>
<p>Returns an object instance that should be used for detail views. Defaults to using the  <code>lookup_field</code>  parameter to filter the base queryset.</p>
<p>May be overridden to provide more complex behavior, such as object lookups based on more than one URL kwarg.</p>
<p>For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">def</span> <span class="token function">get_object</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> self<span class="token punctuation">.</span>get_queryset<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token builtin">filter</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> field <span class="token keyword">in</span> self<span class="token punctuation">.</span>multiple_lookup_fields<span class="token punctuation">:</span>
        <span class="token builtin">filter</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>kwargs<span class="token punctuation">[</span>field<span class="token punctuation">]</span>

    obj <span class="token operator">=</span> get_object_or_404<span class="token punctuation">(</span>queryset<span class="token punctuation">,</span> <span class="token operator">**</span><span class="token builtin">filter</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>check_object_permissions<span class="token punctuation">(</span>self<span class="token punctuation">.</span>request<span class="token punctuation">,</span> obj<span class="token punctuation">)</span>
    <span class="token keyword">return</span> obj
</code></pre>
<p>Note that if your API doesn’t include any object level permissions, you may optionally exclude the  <code>self.check_object_permissions</code>, and simply return the object from the  <code>get_object_or_404</code>  lookup.</p>
<h4 id="filter_querysetself-queryset"><code>filter_queryset(self, queryset)</code></h4>
<p>Given a queryset, filter it with whichever filter backends are in use, returning a new queryset.</p>
<p>For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">def</span> <span class="token function">filter_queryset</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> queryset<span class="token punctuation">)</span><span class="token punctuation">:</span>
    filter_backends <span class="token operator">=</span> <span class="token punctuation">[</span>CategoryFilter<span class="token punctuation">]</span>

    <span class="token keyword">if</span> <span class="token string">'geo_route'</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>query_params<span class="token punctuation">:</span>
        filter_backends <span class="token operator">=</span> <span class="token punctuation">[</span>GeoRouteFilter<span class="token punctuation">,</span> CategoryFilter<span class="token punctuation">]</span>
    <span class="token keyword">elif</span> <span class="token string">'geo_point'</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>query_params<span class="token punctuation">:</span>
        filter_backends <span class="token operator">=</span> <span class="token punctuation">[</span>GeoPointFilter<span class="token punctuation">,</span> CategoryFilter<span class="token punctuation">]</span>

    <span class="token keyword">for</span> backend <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">(</span>filter_backends<span class="token punctuation">)</span><span class="token punctuation">:</span>
        queryset <span class="token operator">=</span> backend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>filter_queryset<span class="token punctuation">(</span>self<span class="token punctuation">.</span>request<span class="token punctuation">,</span> queryset<span class="token punctuation">,</span> view<span class="token operator">=</span>self<span class="token punctuation">)</span>

    <span class="token keyword">return</span> queryset
</code></pre>
<h4 id="get_serializer_classself"><code>get_serializer_class(self)</code></h4>
<p>Returns the class that should be used for the serializer. Defaults to returning the  <code>serializer_class</code>  attribute.</p>
<p>May be overridden to provide dynamic behavior, such as using different serializers for read and write operations, or providing different serializers to different types of users.</p>
<p>For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">def</span> <span class="token function">get_serializer_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>user<span class="token punctuation">.</span>is_staff<span class="token punctuation">:</span>
        <span class="token keyword">return</span> FullAccountSerializer
    <span class="token keyword">return</span> BasicAccountSerializer
</code></pre>
<p><strong>Save and deletion hooks</strong>:</p>
<p>The following methods are provided by the mixin classes, and provide easy overriding of the object save or deletion behavior.</p>
<ul>
<li><code>perform_create(self, serializer)</code>  - Called by  <code>CreateModelMixin</code>  when saving a new object instance.</li>
<li><code>perform_update(self, serializer)</code>  - Called by  <code>UpdateModelMixin</code>  when saving an existing object instance.</li>
<li><code>perform_destroy(self, instance)</code>  - Called by  <code>DestroyModelMixin</code>  when deleting an object instance.</li>
</ul>
<p>These hooks are particularly useful for setting attributes that are implicit in the request, but are not part of the request data. For instance, you might set an attribute on the object based on the request user, or based on a URL keyword argument.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">def</span> <span class="token function">perform_create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span>user<span class="token operator">=</span>self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
</code></pre>
<p>These override points are also particularly useful for adding behavior that occurs before or after saving an object, such as emailing a confirmation, or logging the update.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">def</span> <span class="token function">perform_update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    instance <span class="token operator">=</span> serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
    send_email_confirmation<span class="token punctuation">(</span>user<span class="token operator">=</span>self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>user<span class="token punctuation">,</span> modified<span class="token operator">=</span>instance<span class="token punctuation">)</span>
</code></pre>
<p>You can also use these hooks to provide additional validation, by raising a  <code>ValidationError()</code>. This can be useful if you need some validation logic to apply at the point of database save. For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">def</span> <span class="token function">perform_create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> SignupRequest<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>user<span class="token operator">=</span>self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
    <span class="token keyword">if</span> queryset<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValidationError<span class="token punctuation">(</span><span class="token string">'You have already signed up'</span><span class="token punctuation">)</span>
    serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span>user<span class="token operator">=</span>self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
</code></pre>
<h2 id="mixins">Mixins</h2>
<p>The mixin classes provide the actions that are used to provide the basic view behavior. Note that the mixin classes provide action methods rather than defining the handler methods, such as  <code>.get()</code>  and  <code>.post()</code>, directly. This allows for more flexible composition of behavior.</p>
<p>The mixin classes can be imported from  <code>rest_framework.mixins</code>.</p>
<h3 id="listmodelmixin">ListModelMixin</h3>
<p>Provides a  <code>.list(request, *args, **kwargs)</code>  method, that implements listing a queryset.</p>
<p>If the queryset is populated, this returns a  <code>200 OK</code>  response, with a serialized representation of the queryset as the body of the response. The response data may optionally be paginated.</p>
<h3 id="createmodelmixin">CreateModelMixin</h3>
<p>Provides a  <code>.create(request, *args, **kwargs)</code>  method, that implements creating and saving a new model instance.</p>
<p>If an object is created this returns a  <code>201 Created</code>  response, with a serialized representation of the object as the body of the response. If the representation contains a key named  <code>url</code>, then the  <code>Location</code>  header of the response will be populated with that value.</p>
<p>If the request data provided for creating the object was invalid, a  <code>400 Bad Request</code>  response will be returned, with the error details as the body of the response.</p>
<h3 id="retrievemodelmixin">RetrieveModelMixin</h3>
<p>Provides a  <code>.retrieve(request, *args, **kwargs)</code>  method, that implements returning an existing model instance in a response.</p>
<p>If an object can be retrieved this returns a  <code>200 OK</code>  response, with a serialized representation of the object as the body of the response. Otherwise it will return a  <code>404 Not Found</code>.</p>
<h3 id="updatemodelmixin">UpdateModelMixin</h3>
<p>Provides a  <code>.update(request, *args, **kwargs)</code>  method, that implements updating and saving an existing model instance.</p>
<p>Also provides a  <code>.partial_update(request, *args, **kwargs)</code>  method, which is similar to the  <code>update</code>  method, except that all fields for the update will be optional. This allows support for HTTP  <code>PATCH</code>  requests.</p>
<p>If an object is updated this returns a  <code>200 OK</code>  response, with a serialized representation of the object as the body of the response.</p>
<p>If the request data provided for updating the object was invalid, a  <code>400 Bad Request</code>  response will be returned, with the error details as the body of the response.</p>
<h3 id="destroymodelmixin">DestroyModelMixin</h3>
<p>Provides a  <code>.destroy(request, *args, **kwargs)</code>  method, that implements deletion of an existing model instance.</p>
<p>If an object is deleted this returns a  <code>204 No Content</code>  response, otherwise it will return a  <code>404 Not Found</code>.</p>
<h2 id="concrete-view-classes">Concrete View Classes</h2>
<p>The following classes are the concrete generic views. If you’re using generic views this is normally the level you’ll be working at unless you need heavily customized behavior.</p>
<p>The view classes can be imported from  <code>rest_framework.generics</code>.</p>
<ul>
<li>
<p><strong>CreateAPIView</strong></p>
<ul>
<li>Used for  <strong>create-only</strong>  endpoints.</li>
<li>Provides a  <code>post</code>  method handler.</li>
<li>Extends:  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#genericapiview">GenericAPIView</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#createmodelmixin">CreateModelMixin</a></li>
</ul>
</li>
<li>
<p><strong>ListAPIView</strong></p>
<ul>
<li>Used for  <strong>read-only</strong>  endpoints to represent a  <strong>collection of model instances</strong>.</li>
<li>Provides a  <code>get</code>  method handler.</li>
<li>Extends:  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#genericapiview">GenericAPIView</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#listmodelmixin">ListModelMixin</a></li>
</ul>
</li>
<li>
<p><strong>RetrieveAPIView</strong></p>
<ul>
<li>Used for  <strong>read-only</strong>  endpoints to represent a  <strong>single model instance</strong>.</li>
<li>Provides a  <code>get</code>  method handler.</li>
<li>Extends:  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#genericapiview">GenericAPIView</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#retrievemodelmixin">RetrieveModelMixin</a></li>
</ul>
</li>
<li>
<p><strong>DestroyAPIView</strong></p>
<ul>
<li>Used for  <strong>delete-only</strong>  endpoints for a  <strong>single model instance</strong>.</li>
<li>Provides a  <code>delete</code>  method handler.</li>
<li>Extends:  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#genericapiview">GenericAPIView</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#destroymodelmixin">DestroyModelMixin</a></li>
</ul>
</li>
<li>
<p><strong>UpdateAPIView</strong></p>
<ul>
<li>Used for  <strong>update-only</strong>  endpoints for a  <strong>single model instance</strong>.</li>
<li>Provides  <code>put</code>  and  <code>patch</code>  method handlers.</li>
<li>Extends:  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#genericapiview">GenericAPIView</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#updatemodelmixin">UpdateModelMixin</a></li>
</ul>
</li>
<li>
<p><strong>ListCreateAPIView</strong></p>
<ul>
<li>Used for  <strong>read-write</strong>  endpoints to represent a  <strong>collection of model instances</strong>.</li>
<li>Provides  <code>get</code>  and  <code>post</code>  method handlers.</li>
<li>Extends:  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#genericapiview">GenericAPIView</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#listmodelmixin">ListModelMixin</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#createmodelmixin">CreateModelMixin</a></li>
</ul>
</li>
<li>
<p><strong>RetrieveUpdateAPIView</strong></p>
<ul>
<li>Used for  <strong>read or update</strong>  endpoints to represent a  <strong>single model instance</strong>.</li>
<li>Provides  <code>get</code>,  <code>put</code>  and  <code>patch</code>  method handlers.</li>
<li>Extends:  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#genericapiview">GenericAPIView</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#retrievemodelmixin">RetrieveModelMixin</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#updatemodelmixin">UpdateModelMixin</a></li>
</ul>
</li>
<li>
<p><strong>RetrieveDestroyAPIView</strong></p>
<ul>
<li>Used for  <strong>read or delete</strong>  endpoints to represent a  <strong>single model instance</strong>.</li>
<li>Provides  <code>get</code>  and  <code>delete</code>  method handlers.</li>
<li>Extends:  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#genericapiview">GenericAPIView</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#retrievemodelmixin">RetrieveModelMixin</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#destroymodelmixin">DestroyModelMixin</a></li>
</ul>
</li>
<li>
<p><strong>RetrieveUpdateDestroyAPIView</strong></p>
<ul>
<li>Used for  <strong>read-write-delete</strong>  endpoints to represent a  <strong>single model instance</strong>.</li>
<li>Provides  <code>get</code>,  <code>put</code>,  <code>patch</code>  and  <code>delete</code>  method handlers.</li>
<li>Extends:  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#genericapiview">GenericAPIView</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#retrievemodelmixin">RetrieveModelMixin</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#updatemodelmixin">UpdateModelMixin</a>,  <a href="https://www.django-rest-framework.org/api-guide/generic-views/#destroymodelmixin">DestroyModelMixin</a></li>
</ul>
</li>
</ul>
<h2 id="customizing-the-generic-views">Customizing the generic views</h2>
<p><strong>Creating custom mixins</strong></p>
<p>For example, if you need to lookup objects based on multiple fields in the URL conf, you could create a mixin class like the following:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">MultipleFieldLookupMixin</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Apply this mixin to any view or viewset to get multiple field filtering
    based on a `lookup_fields` attribute, instead of the default single field filtering.
    """</span>
    <span class="token keyword">def</span> <span class="token function">get_object</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        queryset <span class="token operator">=</span> self<span class="token punctuation">.</span>get_queryset<span class="token punctuation">(</span><span class="token punctuation">)</span>             <span class="token comment"># Get the base queryset</span>
        queryset <span class="token operator">=</span> self<span class="token punctuation">.</span>filter_queryset<span class="token punctuation">(</span>queryset<span class="token punctuation">)</span>  <span class="token comment"># Apply any filter backends</span>
        <span class="token builtin">filter</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token keyword">for</span> field <span class="token keyword">in</span> self<span class="token punctuation">.</span>lookup_fields<span class="token punctuation">:</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>kwargs<span class="token punctuation">[</span>field<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token comment"># Ignore empty fields.</span>
                <span class="token builtin">filter</span><span class="token punctuation">[</span>field<span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>kwargs<span class="token punctuation">[</span>field<span class="token punctuation">]</span>
        obj <span class="token operator">=</span> get_object_or_404<span class="token punctuation">(</span>queryset<span class="token punctuation">,</span> <span class="token operator">**</span><span class="token builtin">filter</span><span class="token punctuation">)</span>  <span class="token comment"># Lookup the object</span>
        self<span class="token punctuation">.</span>check_object_permissions<span class="token punctuation">(</span>self<span class="token punctuation">.</span>request<span class="token punctuation">,</span> obj<span class="token punctuation">)</span>
        <span class="token keyword">return</span> obj
</code></pre>
<p>You can then simply apply this mixin to a view or viewset anytime you need to apply the custom behavior.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">RetrieveUserView</span><span class="token punctuation">(</span>MultipleFieldLookupMixin<span class="token punctuation">,</span> generics<span class="token punctuation">.</span>RetrieveAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> UserSerializer
    lookup_fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'account'</span><span class="token punctuation">,</span> <span class="token string">'username'</span><span class="token punctuation">]</span>
</code></pre>
<h1 id="viewsets">Viewsets</h1>
<p>Django REST framework allows you to combine the logic for a set of related views in a single class, called a  <code>ViewSet</code>. In other frameworks you may also find conceptually similar implementations named something like ‘Resources’ or ‘Controllers’.</p>
<p>A  <code>ViewSet</code>  class is simply  <strong>a type of class-based View, that does not provide any method handlers</strong>  such as  <code>.get()</code>  or  <code>.post()</code>, and instead provides actions such as  <code>.list()</code>  and  <code>.create()</code>.</p>
<p>The method handlers for a  <code>ViewSet</code>  are only bound to the corresponding actions at the point of finalizing the view, using the  <code>.as_view()</code>  method.</p>
<p>Typically, rather than explicitly registering the views in a viewset in the urlconf, you’ll register the viewset with a <em><strong>router class</strong></em>, that automatically determines the urlconf for you.</p>
<p>Let’s define a simple viewset that can be used to list or retrieve all the users in the system.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>models <span class="token keyword">import</span> User
<span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> get_object_or_404
<span class="token keyword">from</span> myapps<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> UserSerializer
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> viewsets
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response

<span class="token keyword">class</span> <span class="token class-name">UserViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    A simple ViewSet for listing or retrieving users.
    """</span>
    <span class="token keyword">def</span> <span class="token function">list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        queryset <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        serializer <span class="token operator">=</span> UserSerializer<span class="token punctuation">(</span>queryset<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">retrieve</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        queryset <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        user <span class="token operator">=</span> get_object_or_404<span class="token punctuation">(</span>queryset<span class="token punctuation">,</span> pk<span class="token operator">=</span>pk<span class="token punctuation">)</span>
        serializer <span class="token operator">=</span> UserSerializer<span class="token punctuation">(</span>user<span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre>
<p>If we need to, we can bind this viewset into two separate views, like so:</p>
<pre class=" language-python"><code class="prism  language-python">user_list <span class="token operator">=</span> UserViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'get'</span><span class="token punctuation">:</span> <span class="token string">'list'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
user_detail <span class="token operator">=</span> UserViewSet<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'get'</span><span class="token punctuation">:</span> <span class="token string">'retrieve'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>Typically we wouldn’t do this, but would instead register the viewset with a router, and allow the urlconf to be automatically generated.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> myapp<span class="token punctuation">.</span>views <span class="token keyword">import</span> UserViewSet
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>routers <span class="token keyword">import</span> DefaultRouter

router <span class="token operator">=</span> DefaultRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span>r<span class="token string">'users'</span><span class="token punctuation">,</span> UserViewSet<span class="token punctuation">,</span> basename<span class="token operator">=</span><span class="token string">'user'</span><span class="token punctuation">)</span>
urlpatterns <span class="token operator">=</span> router<span class="token punctuation">.</span>urls
</code></pre>
<p>Rather than writing your own viewsets, you’ll often want to use the existing base classes that provide a default set of behavior. For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">UserViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    A viewset for viewing and editing user instances.
    """</span>
    serializer_class <span class="token operator">=</span> UserSerializer
    queryset <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>There are <em><strong>two main advantages</strong></em> of using a  <code>ViewSet</code>  class over using a  <code>View</code>  class.</p>
<ul>
<li>Repeated logic can be combined into a single class. In the above example, we only need to specify the  <code>queryset</code>  once, and it’ll be used across multiple views.</li>
<li>By using routers, we no longer need to deal with wiring up the URL conf ourselves.</li>
</ul>
<p>Both of these come with a trade-off. Using regular views and URL confs is more explicit and gives you more control. ViewSets are helpful if you want to get up and running quickly, or when you have a large API and you want to enforce a consistent URL configuration throughout.</p>
<h2 id="viewset-actions">ViewSet actions</h2>
<p>The default routers included with REST framework will provide routes for a standard set of create/retrieve/update/destroy style actions, as shown below:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">UserViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Example empty viewset demonstrating the standard
    actions that will be handled by a router class.

    If you're using format suffixes, make sure to also include
    the `format=None` keyword argument for each action.
    """</span>

    <span class="token keyword">def</span> <span class="token function">list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">retrieve</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">partial_update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">destroy</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
</code></pre>
<p>During dispatch, the following attributes are available on the  <code>ViewSet</code>.</p>
<ul>
<li><code>basename</code>  - the base to use for the URL names that are created.</li>
<li><code>action</code>  - the name of the current action (e.g.,  <code>list</code>,  <code>create</code>).</li>
<li><code>detail</code>  - boolean indicating if the current action is configured for a list or detail view.</li>
<li><code>suffix</code>  - the display suffix for the viewset type - mirrors the  <code>detail</code>  attribute.</li>
<li><code>name</code>  - the display name for the viewset. This argument is mutually exclusive to  <code>suffix</code>.</li>
<li><code>description</code>  - the display description for the individual view of a viewset.</li>
</ul>
<p>You may inspect these attributes to adjust behaviour based on the current action. For example, you could restrict permissions to everything except the  <code>list</code>  action similar to this:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">def</span> <span class="token function">get_permissions</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Instantiates and returns the list of permissions that this view requires.
    """</span>
    <span class="token keyword">if</span> self<span class="token punctuation">.</span>action <span class="token operator">==</span> <span class="token string">'list'</span><span class="token punctuation">:</span>
        permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>IsAuthenticated<span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>IsAdminUser<span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>permission<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> permission <span class="token keyword">in</span> permission_classes<span class="token punctuation">]</span>
</code></pre>
<h2 id="making-extra-actions-for-routing">Making extra actions for routing</h2>
<p>If you have ad-hoc methods that should be routable, you can mark them as such with the  <code>@action</code>  decorator. Like regular actions, extra actions may be intended for either a single object, or an entire collection. To indicate this, set the  <code>detail</code>  argument to  <code>True</code>  or  <code>False</code>. The router will configure its URL patterns accordingly. e.g., the  <code>DefaultRouter</code>  will configure detail actions to contain  <code>pk</code>  in their URL patterns.</p>
<p>A more complete example of extra actions:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>models <span class="token keyword">import</span> User
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> status<span class="token punctuation">,</span> viewsets
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>decorators <span class="token keyword">import</span> action
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response
<span class="token keyword">from</span> myapp<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> UserSerializer<span class="token punctuation">,</span> PasswordSerializer

<span class="token keyword">class</span> <span class="token class-name">UserViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    A viewset that provides the standard actions
    """</span>
    queryset <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> UserSerializer

    @action<span class="token punctuation">(</span>detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'post'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">set_password</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        user <span class="token operator">=</span> self<span class="token punctuation">.</span>get_object<span class="token punctuation">(</span><span class="token punctuation">)</span>
        serializer <span class="token operator">=</span> PasswordSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            user<span class="token punctuation">.</span>set_password<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>validated_data<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            user<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'status'</span><span class="token punctuation">:</span> <span class="token string">'password set'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>errors<span class="token punctuation">,</span>
                            status<span class="token operator">=</span>status<span class="token punctuation">.</span>HTTP_400_BAD_REQUEST<span class="token punctuation">)</span>

    @action<span class="token punctuation">(</span>detail<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">recent_users</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        recent_users <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>order_by<span class="token punctuation">(</span><span class="token string">'-last_login'</span><span class="token punctuation">)</span>

        page <span class="token operator">=</span> self<span class="token punctuation">.</span>paginate_queryset<span class="token punctuation">(</span>recent_users<span class="token punctuation">)</span>
        <span class="token keyword">if</span> page <span class="token keyword">is</span> <span class="token operator">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>page<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>get_paginated_response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

        serializer <span class="token operator">=</span> self<span class="token punctuation">.</span>get_serializer<span class="token punctuation">(</span>recent_users<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre>
<p>The  <code>action</code>  decorator will route  <code>GET</code>  requests by default, but may also accept other HTTP methods by setting the  <code>methods</code>  argument. For example:</p>
<pre class=" language-python"><code class="prism  language-python">    @action<span class="token punctuation">(</span>detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'post'</span><span class="token punctuation">,</span> <span class="token string">'delete'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">unset_password</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>The decorator allows you to override any viewset-level configuration such as  <code>permission_classes</code>,  <code>serializer_class</code>,  <code>filter_backends</code>…:</p>
<pre class=" language-python"><code class="prism  language-python">    @action<span class="token punctuation">(</span>detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'post'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> permission_classes<span class="token operator">=</span><span class="token punctuation">[</span>IsAdminOrIsSelf<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">set_password</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>The two new actions will then be available at the urls  <code>^users/{pk}/set_password/$</code>  and  <code>^users/{pk}/unset_password/$</code>. Use the  <code>url_path</code>  and  <code>url_name</code>  parameters to change the URL segment and the reverse URL name of the action.</p>
<p>To view all extra actions, call the  <code>.get_extra_actions()</code>  method.</p>
<h2 id="routing-additional-http-methods-for-extra-actions">Routing additional HTTP methods for extra actions</h2>
<p>Extra actions can map additional HTTP methods to separate  <code>ViewSet</code>  methods. For example, the above password set/unset methods could be consolidated into a single route. Note that additional mappings do not accept arguments.</p>
<pre class=" language-python"><code class="prism  language-python">    @action<span class="token punctuation">(</span>detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'put'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'Change Password'</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">password</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Update the user's password."""</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    @password<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span>delete
    <span class="token keyword">def</span> <span class="token function">delete_password</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Delete the user's password."""</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<h2 id="reversing-actions-urls">Reversing actions URLs</h2>
<p>If you need to get the URL of an action, use the  <code>.reverse_action()</code>  method. This is a convenience wrapper for  <code>reverse()</code>, automatically passing the view’s  <code>request</code>  object and prepending the  <code>url_name</code>  with the  <code>.basename</code>  attribute.</p>
<p>Note that the  <code>basename</code>  is provided by the router during  <code>ViewSet</code>  registration. If you are not using a router, then you must provide the  <code>basename</code>  argument to the  <code>.as_view()</code>  method.</p>
<p>Using the example from the previous section:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> view<span class="token punctuation">.</span>reverse_action<span class="token punctuation">(</span><span class="token string">'set-password'</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token string">'http://localhost:8000/api/users/1/set_password'</span>
</code></pre>
<p>Alternatively, you can use the  <code>url_name</code>  attribute set by the  <code>@action</code>  decorator.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> view<span class="token punctuation">.</span>reverse_action<span class="token punctuation">(</span>view<span class="token punctuation">.</span>set_password<span class="token punctuation">.</span>url_name<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token string">'http://localhost:8000/api/users/1/set_password'</span>
</code></pre>
<p>The  <code>url_name</code>  argument for  <code>.reverse_action()</code>  should match the same argument to the  <code>@action</code>  decorator. Additionally, this method can be used to reverse the default actions, such as  <code>list</code>  and  <code>create</code>.</p>
<h2 id="viewset">ViewSet</h2>
<p>The  <code>ViewSet</code>  class inherits from  <code>APIView</code>. You can use any of the standard attributes such as  <code>permission_classes</code>,  <code>authentication_classes</code>  in order to control the API policy on the viewset.</p>
<p>The  <code>ViewSet</code>  class does not provide any implementations of actions. In order to use a  <code>ViewSet</code>  class you’ll override the class and define the action implementations explicitly.</p>
<h2 id="genericviewset">GenericViewSet</h2>
<p>The  <code>GenericViewSet</code>  class inherits from  <code>GenericAPIView</code>, and provides the default set of  <code>get_object</code>,  <code>get_queryset</code>  methods and other generic view base behavior, but does not include any actions by default.</p>
<p>In order to use a  <code>GenericViewSet</code>  class you’ll override the class and either mixin the required mixin classes, or define the action implementations explicitly.</p>
<h2 id="modelviewset">ModelViewSet</h2>
<p>The  <code>ModelViewSet</code>  class inherits from  <code>GenericAPIView</code>  and includes implementations for various actions, by mixing in the behavior of the various mixin classes.</p>
<p>The actions provided by the  <code>ModelViewSet</code>  class are  <code>.list()</code>,  <code>.retrieve()</code>,  <code>.create()</code>,  <code>.update()</code>,  <code>.partial_update()</code>, and  <code>.destroy()</code>.</p>
<p><strong>Example</strong></p>
<p>Because  <code>ModelViewSet</code>  extends  <code>GenericAPIView</code>, you’ll normally need to provide at least the  <code>queryset</code>  and  <code>serializer_class</code>  attributes. For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">AccountViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    A simple ViewSet for viewing and editing accounts.
    """</span>
    queryset <span class="token operator">=</span> Account<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> AccountSerializer
    permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>IsAccountAdminOrReadOnly<span class="token punctuation">]</span>
</code></pre>
<p>Note that you can use any of the standard attributes or method overrides provided by  <code>GenericAPIView</code>. For example, to use a  <code>ViewSet</code>  that dynamically determines the queryset it should operate on, you might do something like this:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">AccountViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    A simple ViewSet for viewing and editing the accounts
    associated with the user.
    """</span>
    serializer_class <span class="token operator">=</span> AccountSerializer
    permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>IsAccountAdminOrReadOnly<span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">get_queryset</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>user<span class="token punctuation">.</span>accounts<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>Note however that upon removal of the  <code>queryset</code>  property from your  <code>ViewSet</code>, any associated  <a href="https://www.django-rest-framework.org/api-guide/routers/">router</a>  will be unable to derive the basename of your Model automatically, and so you will have to specify the  <code>basename</code>  kwarg as part of your  <a href="https://www.django-rest-framework.org/api-guide/routers/">router registration</a>.</p>
<p>Also note that although this class provides the complete set of create/list/retrieve/update/destroy actions by default, you can restrict the available operations by using the standard permission classes.</p>
<h2 id="readonlymodelviewset">ReadOnlyModelViewSet</h2>
<p>The  <code>ReadOnlyModelViewSet</code>  class also inherits from  <code>GenericAPIView</code>. As with  <code>ModelViewSet</code>  it also includes implementations for various actions, but unlike  <code>ModelViewSet</code>  only provides the ‘read-only’ actions,  <code>.list()</code>  and  <code>.retrieve()</code>.</p>
<p><strong>Example</strong></p>
<p>As with  <code>ModelViewSet</code>, you’ll normally need to provide at least the  <code>queryset</code>  and  <code>serializer_class</code>  attributes. For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">AccountViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ReadOnlyModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    A simple ViewSet for viewing accounts.
    """</span>
    queryset <span class="token operator">=</span> Account<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> AccountSerializer
</code></pre>
<p>Again, as with  <code>ModelViewSet</code>, you can use any of the standard attributes and method overrides available to  <code>GenericAPIView</code>.</p>
<h2 id="custom-viewset-base-classes">Custom ViewSet base classes</h2>
<p>You may need to provide custom  <code>ViewSet</code>  classes that do not have the full set of  <code>ModelViewSet</code>  actions, or that customize the behavior in some other way.</p>
<p><strong>Example</strong></p>
<p>To create a base viewset class that provides  <code>create</code>,  <code>list</code>  and  <code>retrieve</code>  operations, inherit from  <code>GenericViewSet</code>, and mixin the required actions:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> mixins

<span class="token keyword">class</span> <span class="token class-name">CreateListRetrieveViewSet</span><span class="token punctuation">(</span>mixins<span class="token punctuation">.</span>CreateModelMixin<span class="token punctuation">,</span>
                                mixins<span class="token punctuation">.</span>ListModelMixin<span class="token punctuation">,</span>
                                mixins<span class="token punctuation">.</span>RetrieveModelMixin<span class="token punctuation">,</span>
                                viewsets<span class="token punctuation">.</span>GenericViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    A viewset that provides `retrieve`, `create`, and `list` actions.

    To use it, override the class and set the `.queryset` and
    `.serializer_class` attributes.
    """</span>
    <span class="token keyword">pass</span>
</code></pre>
<p>By creating your own base  <code>ViewSet</code>  classes, you can provide common behavior that can be reused in multiple viewsets across your API.</p>
<h2 id="comparing-view-and-viewsets">Comparing View and ViewSets</h2>
<p><code>ViewSets</code>  and  <code>Routers</code>  are simple tools to speed up the implementation of your API if you’re aiming for standard behaviour and standard URLs.</p>
<p>Using  <code>ViewSet</code>  you don’t have to create separate views for getting a list of objects and detail of one object.  <code>ViewSet</code>  will handle for you in a consistent way both list and detail.</p>
<p>Using  <code>Router</code>  will connect your  <code>ViewSet</code>  into “standarized” (it’s not standard in any global way, just some structure that was implemented by creators of Django REST framework) structure of URLs. That way you don’t have to create your  <code>urlpatterns</code>  by hand and you’re guaranteed that all of your URLs are consistent (at least on the layer that  <code>Router</code>  is responsible for).</p>
<p>It looks like not much, but when implementing some huge API where you will have many and many  <code>urlpatterns</code>  and views, using  <code>ViewSets</code>  and  <code>Routers</code>  will make big difference.</p>
<p>For better explanation: this is code using  <code>ViewSets</code>  and  <code>Routers</code>:</p>
<p><code>views.py</code>:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> snippets<span class="token punctuation">.</span>models <span class="token keyword">import</span> Article
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> viewsets
<span class="token keyword">from</span> yourapp<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> ArticleSerializer

<span class="token keyword">class</span> <span class="token class-name">ArticleViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Article<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> ArticleSerializer

</code></pre>
<p><code>urls.py</code>:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url<span class="token punctuation">,</span> include
<span class="token keyword">from</span> yourapp <span class="token keyword">import</span> views
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>routers <span class="token keyword">import</span> DefaultRouter

router <span class="token operator">=</span> DefaultRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span>r<span class="token string">'articles'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>ArticleViewSet<span class="token punctuation">)</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    url<span class="token punctuation">(</span>r<span class="token string">'^'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>router<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

</code></pre>
<p>And equivalent result using normal  <code>Views</code>  and no  <code>routers</code>:</p>
<p><code>views.py</code>:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> snippets<span class="token punctuation">.</span>models <span class="token keyword">import</span> Article
<span class="token keyword">from</span> snippets<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> ArticleSerializer
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> generics


<span class="token keyword">class</span> <span class="token class-name">ArticleList</span><span class="token punctuation">(</span>generics<span class="token punctuation">.</span>ListCreateAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Article<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> ArticleSerializer


<span class="token keyword">class</span> <span class="token class-name">ArticleDetail</span><span class="token punctuation">(</span>generics<span class="token punctuation">.</span>RetrieveUpdateDestroyAPIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    queryset <span class="token operator">=</span> Article<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    serializer_class <span class="token operator">=</span> ArticleSerializer

</code></pre>
<p><code>urls.py</code></p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url<span class="token punctuation">,</span> include
<span class="token keyword">from</span> yourapp <span class="token keyword">import</span> views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    url<span class="token punctuation">(</span>r<span class="token string">'articles/^'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>ArticleList<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"article-list"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    url<span class="token punctuation">(</span>r<span class="token string">'articles/(?P&lt;pk&gt;[0-9]+)/^'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>ArticleDetail<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"article-detail"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre>
<h1 id="routers">Routers</h1>
<p>Some Web frameworks such as Rails provide functionality for automatically determining how the URLs for an application should be mapped to the logic that deals with handling incoming requests.</p>
<p>REST framework adds support for automatic URL routing to Django, and provides you with a simple, quick and consistent way of wiring your view logic to a set of URLs.</p>
<p>Here’s an example of a simple URL conf, that uses  <code>SimpleRouter</code>.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> routers

router <span class="token operator">=</span> routers<span class="token punctuation">.</span>SimpleRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span>r<span class="token string">'users'</span><span class="token punctuation">,</span> UserViewSet<span class="token punctuation">)</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span>r<span class="token string">'accounts'</span><span class="token punctuation">,</span> AccountViewSet<span class="token punctuation">)</span>
urlpatterns <span class="token operator">=</span> router<span class="token punctuation">.</span>urls
</code></pre>
<p>There are two mandatory arguments to the  <code>register()</code>  method:</p>
<ul>
<li><code>prefix</code>  - The URL prefix to use for this set of routes.</li>
<li><code>viewset</code>  - The viewset class.</li>
</ul>
<p>Optionally, you may also specify an additional argument:</p>
<ul>
<li><code>basename</code>  - The base to use for the URL names that are created. If unset the basename will be automatically generated based on the  <code>queryset</code>  attribute of the viewset, if it has one. Note that if the viewset does not include a  <code>queryset</code>attribute then you must set  <code>basename</code>  when registering the viewset.</li>
</ul>
<p>The example above would generate the following URL patterns:</p>
<ul>
<li>URL pattern:  <code>^users/$</code>  Name:  <code>'user-list'</code></li>
<li>URL pattern:  <code>^users/{pk}/$</code>  Name:  <code>'user-detail'</code></li>
<li>URL pattern:  <code>^accounts/$</code>  Name:  <code>'account-list'</code></li>
<li>URL pattern:  <code>^accounts/{pk}/$</code>  Name:  <code>'account-detail'</code></li>
</ul>
<hr>
<p><strong>Note:</strong>  The  <code>basename</code>  argument is used to specify the initial part of the view name pattern. In the example above, that’s the  <code>user</code>  or  <code>account</code>  part.</p>
<p>Typically you won’t  <em>need</em>  to specify the  <code>basename</code>  argument, but if you have a viewset where you’ve defined a custom  <code>get_queryset</code>  method, then the viewset may not have a  <code>.queryset</code>  attribute set. If you try to register that viewset you’ll see an error like this:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token string">'basename'</span> argument <span class="token operator">not</span> specified<span class="token punctuation">,</span> <span class="token operator">and</span> could <span class="token operator">not</span> automatically determine the name <span class="token keyword">from</span> the viewset<span class="token punctuation">,</span> <span class="token keyword">as</span> it does <span class="token operator">not</span> have a <span class="token string">'.queryset'</span> attribute<span class="token punctuation">.</span>
</code></pre>
<h2 id="using--include--with-routers">Using  <code>include</code>  with routers</h2>
<p>The  <code>.urls</code>  attribute on a router instance is simply a standard list of URL patterns. There are a number of different styles for how you can include these URLs.</p>
<p>For example, you can append  <code>router.urls</code>  to a list of existing views…</p>
<pre class=" language-python"><code class="prism  language-python">router <span class="token operator">=</span> routers<span class="token punctuation">.</span>SimpleRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span>r<span class="token string">'users'</span><span class="token punctuation">,</span> UserViewSet<span class="token punctuation">)</span>
router<span class="token punctuation">.</span>register<span class="token punctuation">(</span>r<span class="token string">'accounts'</span><span class="token punctuation">,</span> AccountViewSet<span class="token punctuation">)</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'forgot-password/'</span><span class="token punctuation">,</span> ForgotPasswordFormView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

urlpatterns <span class="token operator">+=</span> router<span class="token punctuation">.</span>urls
</code></pre>
<p>Alternatively you can use Django’s  <code>include</code>  function, like so…</p>
<pre class=" language-python"><code class="prism  language-python">urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'forgot-password'</span><span class="token punctuation">,</span> ForgotPasswordFormView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>router<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre>
<p>You may use  <code>include</code>  with an application namespace:</p>
<pre class=" language-python"><code class="prism  language-python">urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'forgot-password/'</span><span class="token punctuation">,</span> ForgotPasswordFormView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'api/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span>urls<span class="token punctuation">,</span> <span class="token string">'app_name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre>
<p>Or both an application and instance namespace:</p>
<pre class=" language-python"><code class="prism  language-python">urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'forgot-password/'</span><span class="token punctuation">,</span> ForgotPasswordFormView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'api/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span>urls<span class="token punctuation">,</span> <span class="token string">'app_name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> namespace<span class="token operator">=</span><span class="token string">'instance_name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre>
<p>See Django’s  <a href="https://docs.djangoproject.com/en/1.11/topics/http/urls/#url-namespaces">URL namespaces docs</a>  and the  <a href="https://docs.djangoproject.com/en/2.0/ref/urls/#include"><code>include</code>  API reference</a>  for more details.</p>
<hr>
<p><strong>Note</strong>: If using namespacing with hyperlinked serializers you’ll also need to ensure that any  <code>view_name</code>  parameters on the serializers correctly reflect the namespace. In the examples above you’d need to include a parameter such as<code>view_name='app_name:user-detail'</code>  for serializer fields hyperlinked to the user detail view.</p>
<p>The automatic  <code>view_name</code>  generation uses a pattern like  <code>%(model_name)-detail</code>. Unless your models names actually clash you may be better off  <strong>not</strong>  namespacing your Django REST Framework views when using hyperlinked serializers.</p>
<h2 id="routing-for-extra-actions">Routing for extra actions</h2>
<p>A viewset may  <a href="https://www.django-rest-framework.org/api-guide/viewsets/#marking-extra-actions-for-routing">mark extra actions for routing</a>  by decorating a method with the  <code>@action</code>  decorator. These extra actions will be included in the generated routes. For example, given the  <code>set_password</code>  method on the  <code>UserViewSet</code>  class:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> myapp<span class="token punctuation">.</span>permissions <span class="token keyword">import</span> IsAdminOrIsSelf
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>decorators <span class="token keyword">import</span> action

<span class="token keyword">class</span> <span class="token class-name">UserViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    @action<span class="token punctuation">(</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'post'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> permission_classes<span class="token operator">=</span><span class="token punctuation">[</span>IsAdminOrIsSelf<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">set_password</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>The following route would be generated:</p>
<ul>
<li>URL pattern:  <code>^users/{pk}/set_password/$</code></li>
<li>URL name:  <code>'user-set-password'</code></li>
</ul>
<p>By default, the URL pattern is based on the method name, and the URL name is the combination of the  <code>ViewSet.basename</code>and the hyphenated method name. If you don’t want to use the defaults for either of these values, you can instead provide the  <code>url_path</code>  and  <code>url_name</code>  arguments to the  <code>@action</code>  decorator.</p>
<p>For example, if you want to change the URL for our custom action to  <code>^users/{pk}/change-password/$</code>, you could write:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> myapp<span class="token punctuation">.</span>permissions <span class="token keyword">import</span> IsAdminOrIsSelf
<span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>decorators <span class="token keyword">import</span> action

<span class="token keyword">class</span> <span class="token class-name">UserViewSet</span><span class="token punctuation">(</span>ModelViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    @action<span class="token punctuation">(</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'post'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> permission_classes<span class="token operator">=</span><span class="token punctuation">[</span>IsAdminOrIsSelf<span class="token punctuation">]</span><span class="token punctuation">,</span>
            url_path<span class="token operator">=</span><span class="token string">'change-password'</span><span class="token punctuation">,</span> url_name<span class="token operator">=</span><span class="token string">'change_password'</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">set_password</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>The above example would now generate the following URL pattern:</p>
<ul>
<li>URL path:  <code>^users/{pk}/change-password/$</code></li>
<li>URL name:  <code>'user-change_password'</code></li>
</ul>
<h1 id="serializers">Serializers</h1>
<p>d model instances to be converted to native Python datatypes that can then be easily rendered into  <code>JSON</code>,  <code>XML</code>  or other content types. Serializers also provide deserialization, allowing parsed data to be converted back into complex types, after first validating the incoming data.</p>
<p>The serializers in REST framework work very similarly to Django’s  <code>Form</code>  and  <code>ModelForm</code>  classes. We provide a  <code>Serializer</code>class which gives you a powerful, generic way to control the output of your responses, as well as a  <code>ModelSerializer</code>  class which provides a useful shortcut for creating serializers that deal with model instances and querysets.</p>
<h2 id="declaring-serializers">Declaring Serializers</h2>
<p>Let’s start by creating a simple object we can use for example purposes:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime

<span class="token keyword">class</span> <span class="token class-name">Comment</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> email<span class="token punctuation">,</span> content<span class="token punctuation">,</span> created<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>email <span class="token operator">=</span> email
        self<span class="token punctuation">.</span>content <span class="token operator">=</span> content
        self<span class="token punctuation">.</span>created <span class="token operator">=</span> created <span class="token operator">or</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>

comment <span class="token operator">=</span> Comment<span class="token punctuation">(</span>email<span class="token operator">=</span><span class="token string">'leila@example.com'</span><span class="token punctuation">,</span> content<span class="token operator">=</span><span class="token string">'foo bar'</span><span class="token punctuation">)</span>
</code></pre>
<p>We’ll declare a serializer that we can use to serialize and deserialize data that corresponds to  <code>Comment</code>  objects.</p>
<p>Declaring a serializer looks very similar to declaring a form:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers

<span class="token keyword">class</span> <span class="token class-name">CommentSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    email <span class="token operator">=</span> serializers<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    content <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    created <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span><span class="token punctuation">)</span>

serializer <span class="token operator">=</span> CommentSerializer<span class="token punctuation">(</span>comment<span class="token punctuation">)</span>
serializer<span class="token punctuation">.</span>data
<span class="token comment"># {'email': 'leila@example.com', 'content': 'foo bar', 'created': '2016-01-27T15:17:10.375877'}</span>
</code></pre>
<p>To finalise the serialization process we render the data into <code>json</code>.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>renderers <span class="token keyword">import</span> JSONRenderer

json <span class="token operator">=</span> JSONRenderer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>render<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
json
<span class="token comment"># b'{"email":"leila@example.com","content":"foo bar","created":"2016-01-27T15:17:10.375877"}'</span>
</code></pre>
<h2 id="saving-instances">Saving instances</h2>
<p>If we want to be able to return complete object instances based on the validated data we need to implement one or both of the  <code>.create()</code>  and  <code>.update()</code>  methods. For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">CommentSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    email <span class="token operator">=</span> serializers<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    content <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    created <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Comment<span class="token punctuation">(</span><span class="token operator">**</span>validated_data<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        instance<span class="token punctuation">.</span>email <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span>email<span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>content <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'content'</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span>content<span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>created <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'created'</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span>created<span class="token punctuation">)</span>
        <span class="token keyword">return</span> instance
</code></pre>
<p><em><strong>If your object instances correspond to Django models you’ll also want to ensure that these methods save the object to the database.</strong></em> For example, if  <code>Comment</code>  was a Django model, the methods might look like this:</p>
<pre class=" language-python"><code class="prism  language-python">    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Comment<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token operator">**</span>validated_data<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        instance<span class="token punctuation">.</span>email <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span>email<span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>content <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'content'</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span>content<span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>created <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'created'</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span>created<span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> instance
</code></pre>
<p>Now when deserializing data, we can call  <code>.save()</code>  to return an object instance, based on the validated data.</p>
<pre class=" language-python"><code class="prism  language-python">comment <span class="token operator">=</span> serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>Calling  <code>.save()</code>  will either create a new instance, or update an existing instance, depending on if an existing instance was passed when instantiating the serializer class:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token comment"># .save() will create a new instance.</span>
serializer <span class="token operator">=</span> CommentSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>

<span class="token comment"># .save() will update the existing `comment` instance.</span>
serializer <span class="token operator">=</span> CommentSerializer<span class="token punctuation">(</span>comment<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
</code></pre>
<p><strong>Note:</strong> Both the  <code>.create()</code>  and  <code>.update()</code>  methods are optional. You can implement either none, one, or both of them, depending on the use-case for your serializer class.</p>
<h3 id="passing-additional-attributes-to-.save">Passing additional attributes to <code>.save()</code>:</h3>
<p>Sometimes you’ll want your view code to be able to inject additional data at the point of saving the instance. This additional data might include information like the current user, the current time, or anything else that is not part of the request data.</p>
<p>You can do so by including additional keyword arguments when calling  <code>.save()</code>. For example:</p>
<pre class=" language-python"><code class="prism  language-python">serializer<span class="token punctuation">.</span>save<span class="token punctuation">(</span>owner<span class="token operator">=</span>request<span class="token punctuation">.</span>user<span class="token punctuation">)</span>
</code></pre>
<p>Any additional keyword arguments will be included in the  <code>validated_data</code>  argument when  <code>.create()</code>  or  <code>.update()</code>  are called.</p>
<h3 id="overriding--.save--directly">Overriding  <code>.save()</code>  directly</h3>
<p>In some cases the  <code>.create()</code>  and  <code>.update()</code>  method names may not be meaningful. For example, in a contact form we may not be creating new instances, but instead sending an email or other message.</p>
<p>In these cases you might instead choose to override  <code>.save()</code>  directly, as being more readable and meaningful.</p>
<p>For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">ContactForm</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    email <span class="token operator">=</span> serializers<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    message <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">save</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        email <span class="token operator">=</span> self<span class="token punctuation">.</span>validated_data<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span>
        message <span class="token operator">=</span> self<span class="token punctuation">.</span>validated_data<span class="token punctuation">[</span><span class="token string">'message'</span><span class="token punctuation">]</span>
        send_email<span class="token punctuation">(</span><span class="token keyword">from</span><span class="token operator">=</span>email<span class="token punctuation">,</span> message<span class="token operator">=</span>message<span class="token punctuation">)</span>
</code></pre>
<p>Note that in the case above we’re now having to access the serializer  <code>.validated_data</code>  property directly.</p>
<h2 id="validation">Validation</h2>
<p>When deserializing data, you always need to call  <code>is_valid()</code>  before attempting to access the validated data, or save an object instance. If any validation errors occur, the  <code>.errors</code>  property will contain a dictionary representing the resulting error messages. For example:</p>
<pre class=" language-python"><code class="prism  language-python">serializer <span class="token operator">=</span> CommentSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'email'</span><span class="token punctuation">:</span> <span class="token string">'foobar'</span><span class="token punctuation">,</span> <span class="token string">'content'</span><span class="token punctuation">:</span> <span class="token string">'baz'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
serializer<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># False</span>
serializer<span class="token punctuation">.</span>errors
<span class="token comment"># {'email': ['Enter a valid e-mail address.'], 'created': ['This field is required.']}</span>
</code></pre>
<h3 id="field-level-validation">Field-level validation</h3>
<p>You can specify custom field-level validation by adding <code>.validate_&lt;field_name&gt;</code> methods to your <code>Serializer</code> subclass.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers

<span class="token keyword">class</span> <span class="token class-name">BlogPostSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    content <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">validate_title</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        Check that the blog post is about Django.
        """</span>
        <span class="token keyword">if</span> <span class="token string">'django'</span> <span class="token operator">not</span> <span class="token keyword">in</span> value<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError<span class="token punctuation">(</span><span class="token string">"Blog post is not about Django"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> value
</code></pre>
<p><strong>Note:</strong> If your <code>&lt;field_name&gt;</code> is declared on your serializer with the parameter <code>required=False</code> then this validation step will not take place if the field is not included.</p>
<h3 id="object-level-validation">Object-level validation</h3>
<p>To do any other validation that requires access to multiple fields, add a method called <code>.validate()</code> to your <code>Serializer</code>subclass. This method takes a single argument, which is a dictionary of field values.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers

<span class="token keyword">class</span> <span class="token class-name">EventSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    description <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    start <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    finish <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">validate</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        Check that start is before finish.
        """</span>
        <span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">'start'</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> data<span class="token punctuation">[</span><span class="token string">'finish'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError<span class="token punctuation">(</span><span class="token string">"finish must occur after start"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> data
</code></pre>
<h2 id="accessing-the-initial-data-and-instance">Accessing the initial data and instance</h2>
<p>When passing an initial object or queryset to a serializer instance, the object will be made available as  <code>.instance</code>. If no initial object is passed then the  <code>.instance</code>  attribute will be  <code>None</code>.</p>
<p>When passing data to a serializer instance, the unmodified data will be made available as  <code>.initial_data</code>. If the  <code>data</code>keyword argument is not passed then the  <code>.initial_data</code>  attribute will not exist.</p>
<h3 id="partial-updates">Partial updates</h3>
<p>By default, serializers must be passed values for all required fields or they will raise validation errors. You can use the  <code>partial</code>argument in order to allow partial updates.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token comment"># Update `comment` with partial data</span>
serializer <span class="token operator">=</span> CommentSerializer<span class="token punctuation">(</span>comment<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'content'</span><span class="token punctuation">:</span> <span class="token string">'foo bar'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> partial<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="dealing-with-nested-objects">Dealing with nested objects</h2>
<p>The previous examples are fine for dealing with objects that only have simple datatypes, but sometimes we also need to be able to represent more complex objects, where some of the attributes of an object might not be simple datatypes such as strings, dates or integers.</p>
<p><strong>Note:</strong> The  <code>Serializer</code>  class is itself a type of  <code>Field</code>, and can be used to represent relationships where one object type is nested inside another.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">UserSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    email <span class="token operator">=</span> serializers<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    username <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">CommentSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    user <span class="token operator">=</span> UserSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    content <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    created <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>If a nested representation may optionally accept the  <code>None</code>  value you should pass the  <code>required=False</code>  flag to the nested serializer.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">CommentSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    user <span class="token operator">=</span> UserSerializer<span class="token punctuation">(</span>required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment"># May be an anonymous user.</span>
    content <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    created <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>Similarly if a nested representation should be a list of items, you should pass the  <code>many=True</code>  flag to the nested serializer.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">CommentSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    user <span class="token operator">=</span> UserSerializer<span class="token punctuation">(</span>required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    edits <span class="token operator">=</span> EditItemSerializer<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># A nested list of 'edit' items.</span>
    content <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    created <span class="token operator">=</span> serializers<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="writing-.create-methods-for-nested-representations">Writing <code>.create()</code> methods for nested representations</h3>
<p>If you’re supporting writable nested representations you’ll need to write  <code>.create()</code>  or  <code>.update()</code>  methods that handle saving multiple objects.</p>
<p>The following example demonstrates how you might handle creating a user with a nested profile object.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">UserSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    profile <span class="token operator">=</span> ProfileSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> User
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'email'</span><span class="token punctuation">,</span> <span class="token string">'profile'</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        profile_data <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'profile'</span><span class="token punctuation">)</span>
        user <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token operator">**</span>validated_data<span class="token punctuation">)</span>
        Profile<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>user<span class="token operator">=</span>user<span class="token punctuation">,</span> <span class="token operator">**</span>profile_data<span class="token punctuation">)</span>
        <span class="token keyword">return</span> user
</code></pre>
<h3 id="writing-.update-methods-for-nested-representations">Writing <code>.update()</code> methods for nested representations</h3>
<p>For updates you’ll want to think carefully about how to handle updates to relationships. For example if the data for the relationship is  <code>None</code>, or not provided, which of the following should occur?</p>
<ul>
<li>Set the relationship to  <code>NULL</code>  in the database.</li>
<li>Delete the associated instance.</li>
<li>Ignore the data and leave the instance as it is.</li>
<li>Raise a validation error.</li>
</ul>
<p>Here’s an example for an  <code>.update()</code>  method on our previous  <code>UserSerializer</code>  class.</p>
<pre class=" language-python"><code class="prism  language-python">    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        profile_data <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'profile'</span><span class="token punctuation">)</span>
        <span class="token comment"># Unless the application properly enforces that this field is</span>
        <span class="token comment"># always set, the following could raise a `DoesNotExist`, which</span>
        <span class="token comment"># would need to be handled.</span>
        profile <span class="token operator">=</span> instance<span class="token punctuation">.</span>profile

        instance<span class="token punctuation">.</span>username <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span>username<span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>email <span class="token operator">=</span> validated_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span>email<span class="token punctuation">)</span>
        instance<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

        profile<span class="token punctuation">.</span>is_premium_member <span class="token operator">=</span> profile_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span>
            <span class="token string">'is_premium_member'</span><span class="token punctuation">,</span>
            profile<span class="token punctuation">.</span>is_premium_member
        <span class="token punctuation">)</span>
        profile<span class="token punctuation">.</span>has_support_contract <span class="token operator">=</span> profile_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span>
            <span class="token string">'has_support_contract'</span><span class="token punctuation">,</span>
            profile<span class="token punctuation">.</span>has_support_contract
         <span class="token punctuation">)</span>
        profile<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> instance
</code></pre>
<p>Because the behavior of nested creates and updates can be ambiguous, and may require complex dependencies between related models, REST framework 3 requires you to always write these methods explicitly. The default  <code>ModelSerializer``.create()</code>  and  <code>.update()</code>  methods do not include support for writable nested representations.</p>
<p>There are however, third-party packages available such as  <a href="https://www.django-rest-framework.org/api-guide/serializers/#drf-writable-nested">DRF Writable Nested</a>  that support automatic writable nested representations.</p>
<h3 id="handling-saving-related-instances-in-model-manager-classes">Handling saving related instances in model manager classes</h3>
<p>An alternative to saving multiple related instances in the serializer is to write custom model manager classes that handle creating the correct instances.</p>
<p>For example, suppose we wanted to ensure that  <code>User</code>  instances and  <code>Profile</code>  instances are always created together as a pair. We might write a custom manager class that looks something like this:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">UserManager</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Manager<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">,</span> email<span class="token punctuation">,</span> is_premium_member<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> has_support_contract<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        user <span class="token operator">=</span> User<span class="token punctuation">(</span>username<span class="token operator">=</span>username<span class="token punctuation">,</span> email<span class="token operator">=</span>email<span class="token punctuation">)</span>
        user<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        profile <span class="token operator">=</span> Profile<span class="token punctuation">(</span>
            user<span class="token operator">=</span>user<span class="token punctuation">,</span>
            is_premium_member<span class="token operator">=</span>is_premium_member<span class="token punctuation">,</span>
            has_support_contract<span class="token operator">=</span>has_support_contract
        <span class="token punctuation">)</span>
        profile<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> user
</code></pre>
<p>This manager class now more nicely encapsulates that user instances and profile instances are always created at the same time. Our  <code>.create()</code>  method on the serializer class can now be re-written to use the new manager method.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
        username<span class="token operator">=</span>validated_data<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        email<span class="token operator">=</span>validated_data<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        is_premium_member<span class="token operator">=</span>validated_data<span class="token punctuation">[</span><span class="token string">'profile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'is_premium_member'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        has_support_contract<span class="token operator">=</span>validated_data<span class="token punctuation">[</span><span class="token string">'profile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'has_support_contract'</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span>
</code></pre>
<p>For more details on this approach see the Django documentation on  <a href="https://docs.djangoproject.com/en/stable/topics/db/managers/">model managers</a>, and  <a href="https://www.dabapps.com/blog/django-models-and-encapsulation/">this blogpost on using model and manager classes</a>.</p>
<h2 id="dealing-with-multiple-objects">Dealing with multiple objects</h2>
<p>To serialize a queryset or list of objects instead of a single object instance, you should pass the  <code>many=True</code>  flag when instantiating the serializer. You can then pass a queryset or list of objects to be serialized.</p>
<pre class=" language-python"><code class="prism  language-python">queryset <span class="token operator">=</span> Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
serializer <span class="token operator">=</span> BookSerializer<span class="token punctuation">(</span>queryset<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
serializer<span class="token punctuation">.</span>data
<span class="token comment"># [</span>
<span class="token comment">#     {'id': 0, 'title': 'The electric kool-aid acid test', 'author': 'Tom Wolfe'},</span>
<span class="token comment">#     {'id': 1, 'title': 'If this is a man', 'author': 'Primo Levi'},</span>
<span class="token comment">#     {'id': 2, 'title': 'The wind-up bird chronicle', 'author': 'Haruki Murakami'}</span>
<span class="token comment"># ]</span>
</code></pre>
<h2 id="including-extra-context">Including extra context</h2>
<p>There are some cases where you need to provide extra context to the serializer in addition to the object being serialized. One common case is if you’re using a serializer that includes hyperlinked relations, which requires the serializer to have access to the current request so that it can properly generate fully qualified URLs.</p>
<p>You can provide arbitrary additional context by passing a  <code>context</code>  argument when instantiating the serializer. For example:</p>
<pre class=" language-python"><code class="prism  language-python">serializer <span class="token operator">=</span> AccountSerializer<span class="token punctuation">(</span>account<span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'request'</span><span class="token punctuation">:</span> request<span class="token punctuation">}</span><span class="token punctuation">)</span>
serializer<span class="token punctuation">.</span>data
<span class="token comment"># {'id': 6, 'owner': 'denvercoder9', 'created': datetime.datetime(2013, 2, 12, 09, 44, 56, 678870), 'details': 'http://example.com/accounts/6/details'}</span>
</code></pre>
<p>The context dictionary can be used within any serializer field logic, such as a custom  <code>.to_representation()</code>  method, by accessing the  <code>self.context</code>  attribute.</p>
<h2 id="modelserializer">ModelSerializer</h2>
<p><strong>The  <code>ModelSerializer</code>  class is the same as a regular  <code>Serializer</code>  class, except that</strong>:</p>
<ul>
<li>It will automatically generate a set of fields for you, based on the model.</li>
<li>It will automatically generate validators for the serializer, such as unique_together validators.</li>
<li>It includes simple default implementations of  <code>.create()</code>  and  <code>.update()</code>.</li>
</ul>
<p>Declaring a  <code>ModelSerializer</code>  looks like this:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">AccountSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Account
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'account_name'</span><span class="token punctuation">,</span> <span class="token string">'users'</span><span class="token punctuation">,</span> <span class="token string">'created'</span><span class="token punctuation">]</span>
</code></pre>
<p>By default, all the model fields on the class will be mapped to a corresponding serializer fields.</p>
<p>Any relationships such as foreign keys on the model will be mapped to  <code>PrimaryKeyRelatedField</code>. Reverse relationships are not included by default unless explicitly included as specified in the  <a href="https://www.django-rest-framework.org/api-guide/relations/">serializer relations</a>  documentation.</p>
<h3 id="inspecting-a--modelserializer">Inspecting a  <code>ModelSerializer</code></h3>
<p>Serializer classes generate helpful verbose representation strings, that allow you to fully inspect the state of their fields. This is particularly useful when working with  <code>ModelSerializers</code>  where you want to determine what set of fields and validators are being automatically created for you.</p>
<p>To do so, open the Django shell, using  <code>python manage.py shell</code>, then import the serializer class, instantiate it, and print the object representation…</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> myapp<span class="token punctuation">.</span>serializers <span class="token keyword">import</span> AccountSerializer
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> serializer <span class="token operator">=</span> AccountSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">(</span>serializer<span class="token punctuation">)</span><span class="token punctuation">)</span>
AccountSerializer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">'ID'</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> CharField<span class="token punctuation">(</span>allow_blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> max_length<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    owner <span class="token operator">=</span> PrimaryKeyRelatedField<span class="token punctuation">(</span>queryset<span class="token operator">=</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="specifying-which-fields-to-include">Specifying which fields to include</h3>
<p>If you only want a subset of the default fields to be used in a model serializer, you can do so using  <code>fields</code>  or  <code>exclude</code>  options, just as you would with a  <code>ModelForm</code>. It is strongly recommended that you explicitly set all fields that should be serialized using the  <code>fields</code>  attribute. This will make it less likely to result in unintentionally exposing data when your models change.</p>
<p>For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">AccountSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Account
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'account_name'</span><span class="token punctuation">,</span> <span class="token string">'users'</span><span class="token punctuation">,</span> <span class="token string">'created'</span><span class="token punctuation">]</span>
</code></pre>
<p>You can also set the  <code>fields</code>  attribute to the special value  <code>'__all__'</code>  to indicate that all fields in the model should be used.</p>
<p>For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">AccountSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Account
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
</code></pre>
<p>You can set the  <code>exclude</code>  attribute to a list of fields to be excluded from the serializer.</p>
<p>For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">AccountSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Account
        exclude <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'users'</span><span class="token punctuation">]</span>
</code></pre>
<p>In the example above, if the  <code>Account</code>  model had 3 fields  <code>account_name</code>,  <code>users</code>, and  <code>created</code>, this will result in the fields  <code>account_name</code>  and  <code>created</code>  to be serialized.</p>
<p>The names in the  <code>fields</code>  and  <code>exclude</code>  attributes will normally map to model fields on the model class.</p>
<p>Alternatively names in the  <code>fields</code>  options can map to properties or methods which take no arguments that exist on the model class.</p>
<p>Since version 3.3.0, it is  <strong>mandatory</strong>  to provide one of the attributes  <code>fields</code>  or  <code>exclude</code>.</p>
<h3 id="specifying-nested-serialization">Specifying nested serialization</h3>
<p>The default  <code>ModelSerializer</code>  uses primary keys for relationships, but you can also easily generate nested representations using the  <code>depth</code>  option:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">AccountSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Account
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'account_name'</span><span class="token punctuation">,</span> <span class="token string">'users'</span><span class="token punctuation">,</span> <span class="token string">'created'</span><span class="token punctuation">]</span>
        depth <span class="token operator">=</span> <span class="token number">1</span>
</code></pre>
<p>The  <code>depth</code>  option should be set to an integer value that indicates the depth of relationships that should be traversed before reverting to a flat representation.</p>
<p>If you want to customize the way the serialization is done you’ll need to define the field yourself.</p>
<h3 id="specifying-fields-explicitly">Specifying fields explicitly</h3>
<p>You can add extra fields to a  <code>ModelSerializer</code>  or override the default fields by declaring fields on the class, just as you would for a  <code>Serializer</code>  class.</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">AccountSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'get_absolute_url'</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    groups <span class="token operator">=</span> serializers<span class="token punctuation">.</span>PrimaryKeyRelatedField<span class="token punctuation">(</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Account
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">,</span> <span class="token string">'groups'</span><span class="token punctuation">]</span>
</code></pre>
<p>Extra fields can correspond to any property or callable on the model.</p>
<h3 id="specifying-read-only-fields">Specifying read only fields</h3>
<p>You may wish to specify multiple fields as read-only. Instead of adding each field explicitly with the  <code>read_only=True</code>  attribute, you may use the shortcut Meta option,  <code>read_only_fields</code>.</p>
<p>This option should be a list or tuple of field names, and is declared as follows:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">AccountSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Account
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'account_name'</span><span class="token punctuation">,</span> <span class="token string">'users'</span><span class="token punctuation">,</span> <span class="token string">'created'</span><span class="token punctuation">]</span>
        read_only_fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'account_name'</span><span class="token punctuation">]</span>
</code></pre>
<p>Model fields which have  <code>editable=False</code>  set, and  <code>AutoField</code>  fields will be set to read-only by default, and do not need to be added to the  <code>read_only_fields</code>  option.</p>
<hr>
<p><strong>Note</strong>: There is a special-case where a read-only field is part of a  <code>unique_together</code>  constraint at the model level. In this case the field is required by the serializer class in order to validate the constraint, but should also not be editable by the user.</p>
<p>The right way to deal with this is to specify the field explicitly on the serializer, providing both the  <code>read_only=True</code>  and  <code>default=…</code>  keyword arguments.</p>
<p>One example of this is a read-only relation to the currently authenticated  <code>User</code>  which is  <code>unique_together</code>  with another identifier. In this case you would declare the user field like so:</p>
<pre class=" language-python"><code class="prism  language-python">user <span class="token operator">=</span> serializers<span class="token punctuation">.</span>PrimaryKeyRelatedField<span class="token punctuation">(</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span>serializers<span class="token punctuation">.</span>CurrentUserDefault<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>Please review the  <a href="https://www.django-rest-framework.org/api-guide/validators/">Validators Documentation</a>  for details on the  <a href="https://www.django-rest-framework.org/api-guide/validators/#uniquetogethervalidator">UniqueTogetherValidator</a>  and  <a href="https://www.django-rest-framework.org/api-guide/validators/#currentuserdefault">CurrentUserDefault</a>  classes.</p>
<hr>
<h3 id="additional-keyword-arguments">Additional keyword arguments</h3>
<p>There is also a shortcut allowing you to specify arbitrary additional keyword arguments on fields, using the  <code>extra_kwargs</code>option. As in the case of  <code>read_only_fields</code>, this means you do not need to explicitly declare the field on the serializer.</p>
<p>This option is a dictionary, mapping field names to a dictionary of keyword arguments. For example:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">CreateUserSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> User
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">,</span> <span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'password'</span><span class="token punctuation">]</span>
        extra_kwargs <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'write_only'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">}</span><span class="token punctuation">}</span>

    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> validated_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        user <span class="token operator">=</span> User<span class="token punctuation">(</span>
            email<span class="token operator">=</span>validated_data<span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            username<span class="token operator">=</span>validated_data<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span>
        user<span class="token punctuation">.</span>set_password<span class="token punctuation">(</span>validated_data<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        user<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> user
</code></pre>
<p><strong>Note:</strong> Please keep in mind that, if the field has already been explicitly declared on the serializer class, then the  <code>extra_kwargs</code>  option will be ignored.</p>
<h3 id="relational-fields">Relational fields</h3>
<p>When serializing model instances, there are a number of different ways you might choose to represent relationships. The default representation for  <code>ModelSerializer</code>  is to use the primary keys of the related instances.</p>
<p>Alternative representations include serializing using hyperlinks, serializing complete nested representations, or serializing with a custom representation.</p>
<p>For full details see the  <a href="https://www.django-rest-framework.org/api-guide/relations/">serializer relations</a>  documentation.</p>
<h1 id="serializer-relations">Serializer relations</h1>
<p>Relational fields are used to represent model relationships. They can be applied to  <code>ForeignKey</code>,  <code>ManyToManyField</code>  and  <code>OneToOneField</code>  relationships, as well as to reverse relationships, and custom relationships such as  <code>GenericForeignKey</code>.</p>
<p><strong>Note:</strong>  The relational fields are declared in  <code>relations.py</code>, but by convention you should import them from the  <code>serializers</code>module, using  <code>from rest_framework import serializers</code>  and refer to fields as  <code>serializers.&lt;FieldName&gt;</code>.</p>
<p><strong>Note:</strong>  REST Framework does not attempt to automatically optimize querysets passed to serializers in terms of  <code>select_related</code>and  <code>prefetch_related</code>  since it would be too much magic. A serializer with a field spanning an orm relation through its source attribute could require an additional database hit to fetch related object from the database. It is the programmer’s responsibility to optimize queries to avoid additional database hits which could occur while using such a serializer.</p>
<p>For example, the following serializer would lead to a database hit each time evaluating the tracks field if it is not prefetched:</p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">class</span> <span class="token class-name">AlbumSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    tracks <span class="token operator">=</span> serializers<span class="token punctuation">.</span>SlugRelatedField<span class="token punctuation">(</span>
        many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
        slug_field<span class="token operator">=</span><span class="token string">'title'</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Album
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'album_name'</span><span class="token punctuation">,</span> <span class="token string">'artist'</span><span class="token punctuation">,</span> <span class="token string">'tracks'</span><span class="token punctuation">]</span>

<span class="token comment"># For each album object, tracks should be fetched from database</span>
qs <span class="token operator">=</span> Album<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>AlbumSerializer<span class="token punctuation">(</span>qs<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre>
<p>If  <code>AlbumSerializer</code>  is used to serialize a fairly large queryset with  <code>many=True</code>  then it could be a serious performance problem. Optimizing the queryset passed to  <code>AlbumSerializer</code>  with:</p>
<pre class=" language-python"><code class="prism  language-python">qs <span class="token operator">=</span> Album<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>prefetch_related<span class="token punctuation">(</span><span class="token string">'tracks'</span><span class="token punctuation">)</span>
<span class="token comment"># No additional database hits required</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>AlbumSerializer<span class="token punctuation">(</span>qs<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span>
</code></pre>
<p>would solve the issue.</p>

    </div>
  </div>
</body>

</html>

<!doctype html><html style="overflow:auto;height:auto;width:auto;"><head><title>functions_tools_agents_langchain</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><style>@font-face {
	font-family: Asana;
	src: url("fonts/Asana-Math.otf") format("opentype");
}

@font-face {
	font-family: Asana-Math;
	src: url("fonts/Asana-math-mode.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathbb;
	src: url("fonts/types-generated/Asana-mathbb.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathit;
	src: url("fonts/types-generated/Asana-mathit.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathcal;
	src: url("fonts/types-generated/Asana-mathcal.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathscr;
	src: url("fonts/types-generated/Asana-mathscr.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathfrak;
	src: url("fonts/types-generated/Asana-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathsf;
	src: url("fonts/types-generated/Asana-mathsf.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathtt;
	src: url("fonts/types-generated/Asana-mathtt.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathrm;
	src: url("fonts/types-generated/Asana-mathrm.otf") format("opentype");
}

@font-face {
	font-family: 'FontAwesome';
	src: url('fonts/icomoon.eot');
	src: url('fonts/icomoon.eot') format('embedded-opentype'), url('fonts/icomoon.woff') format('woff'), url('fonts/icomoon.ttf') format('truetype'), url('fonts/icomoon.svg') format('svg');
	font-weight: normal;
	font-style: normal;
}

/**
Latin Modern
**/

@font-face {
	font-family: LatinModern;
	src: url("fonts/latinmodern-math.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Math;
	src: url("fonts/latinmodern-math-mode.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathbb;
	src: url("fonts/types-generated/latinmodern-mathbb.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathit;
	src: url("fonts/types-generated/latinmodern-mathit.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathcal;
	src: url("fonts/types-generated/latinmodern-mathcal.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathscr;
	src: url("fonts/types-generated/latinmodern-mathscr.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathfrak;
	src: url("fonts/types-generated/latinmodern-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathsf;
	src: url("fonts/types-generated/latinmodern-mathsf.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathtt;
	src: url("fonts/types-generated/latinmodern-mathtt.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathrm;
	src: url("fonts/types-generated/latinmodern-mathrm.otf") format("opentype");
}

/***********************************************************/

/**
Thicker Latin Modern
**/

@font-face {
	font-family: ThickerLm;
	src: url("fonts/thickerlm-math.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Math;
	src: url("fonts/thickerlm-math-mode.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathbb;
	src: url("fonts/types-generated/thickerlm-mathbb.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathit;
	src: url("fonts/types-generated/thickerlm-mathit.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathcal;
	src: url("fonts/types-generated/thickerlm-mathcal.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathscr;
	src: url("fonts/types-generated/thickerlm-mathscr.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathfrak;
	src: url("fonts/types-generated/thickerlm-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathsf;
	src: url("fonts/types-generated/thickerlm-mathsf.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathtt;
	src: url("fonts/types-generated/thickerlm-mathtt.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathrm;
	src: url("fonts/types-generated/thickerlm-mathrm.otf") format("opentype");
}

/***********************************************************/

/* Computer Modern */

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunss.otf') format("opentype");
	font-weight: normal;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunsx.otf') format("opentype");
	font-weight: bold;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunsi.otf') format("opentype");
	font-weight: normal;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunso.otf') format("opentype");
	font-weight: bold;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunrm.otf') format("opentype");
	font-weight: normal;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunbx.otf') format("opentype");
	font-weight: bold;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunti.otf') format("opentype");
	font-weight: normal;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunbi.otf') format("opentype");
	font-weight: bold;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmuntt.otf') format("opentype");
	font-weight: normal;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmuntb.otf') format("opentype");
	font-weight: bold;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmunit.otf') format("opentype");
	font-weight: normal;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmuntx.otf') format("opentype");
	font-weight: bold;
	font-style: italic;
}

/**/

/**
Sans Math + Liberation Font
**/

@font-face {
	font-family: Sans;
	src: url("fonts/Sans-Math.otf") format("opentype");
}

@font-face {
	font-family: Sans-Math;
	src: url("fonts/Sans-Math-mode.otf") format("opentype");
}

@font-face {
	font-family: Sans-Bold;
	src: url("fonts/types-generated/Sans-bold.otf") format("opentype");
	font-weight: bold;
}

@font-face {
	font-family: Sans-Mathbb;
	src: url("fonts/types-generated/Asana-mathbb.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathit;
	src: url("fonts/types-generated/Sans-mathit.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathcal;
	src: url("fonts/types-generated/Asana-mathcal.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathscr;
	src: url("fonts/types-generated/Asana-mathscr.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathfrak;
	src: url("fonts/types-generated/Asana-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathsf;
	src: url("fonts/types-generated/Asana-mathsf.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathtt;
	src: url("fonts/types-generated/Asana-mathtt.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathrm;
	src: url("fonts/types-generated/Asana-mathrm.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathbf;
	src: url("fonts/types-generated/Sans-mathbf.otf") format("opentype");
	font-weight: bold;
}

/***********************************************************/</style><style>/* @font-face {
  font-family: 'FontAwesome';
  src: format('woff'), url('fonts/icomoon.svg?erlpdm#icomoon') format('svg');
  font-weight: normal;
  font-style: normal;
} */

[class^="fa-"], [class*=" fa-"] {
  /* use !important to prevent issues with browser extensions that change fonts */
  /* font-family: 'FontAwesome' !important;
  speak: none;
  font-style: normal;
  font-weight: normal;
  font-variant: normal;
  text-transform: none; */
  /* line-height: 1; */
  /* Better Font Rendering =========== */
  /* -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale; */
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.fa-plus:before {
  content: "\f067";
}
.fa-user:before {
  content: "\f007";
}
.fa-check:before {
  content: "\f00c";
}
.fa-close:before {
  content: "\f00d";
}
.fa-remove:before {
  content: "\f00d";
}
.fa-times:before {
  content: "\f00d";
}
.fa-search-plus:before {
  content: "\f00e";
}
.fa-search-minus:before {
  content: "\f010";
}
.fa-cog:before {
  content: "\f013";
}
.fa-gear:before {
  content: "\f013";
}
.fa-trash-o:before {
  content: "\f014";
}
.fa-file-o:before {
  content: "\f016";
}
.fa-refresh:before {
  content: "\f021";
}
.fa-font:before {
  content: "\f031";
}
.fa-bold:before {
  content: "\f032";
}
.fa-italic:before {
  content: "\f033";
}
.fa-align-left:before {
  content: "\f036";
}
.fa-align-center:before {
  content: "\f037";
}
.fa-align-right:before {
  content: "\f038";
}
.fa-dedent:before {
  content: "\f03b";
}
.fa-outdent:before {
  content: "\f03b";
}
.fa-indent:before {
  content: "\f03c";
}
.fa-image:before {
  content: "\f03e";
}
.fa-photo:before {
  content: "\f03e";
}
.fa-picture-o:before {
  content: "\f03e";
}
.fa-pencil:before {
  content: "\f040";
}
.fa-edit:before {
  content: "\f044";
}
.fa-pencil-square-o:before {
  content: "\f044";
}
.fa-share-square-o:before {
  content: "\f045";
}
.fa-arrows:before {
  content: "\f047";
}
.fa-chevron-left:before {
  content: "\f053";
}
.fa-chevron-right:before {
  content: "\f054";
}
.fa-times-circle:before {
  content: "\f057";
}
.fa-info-circle:before {
  content: "\f05a";
}
.fa-arrow-left:before {
  content: "\f060";
}
.fa-arrow-right:before {
  content: "\f061";
}
.fa-arrow-up:before {
  content: "\f062";
}
.fa-arrow-down:before {
  content: "\f063";
}
.fa-mail-forward:before {
  content: "\f064";
}
.fa-share:before {
  content: "\f064";
}
.fa-exclamation-circle:before {
  content: "\f06a";
}
.fa-exclamation-triangle:before {
  content: "\f071";
}
.fa-warning:before {
  content: "\f071";
}
.fa-chevron-up:before {
  content: "\f077";
}
.fa-chevron-down:before {
  content: "\f078";
}
.fa-folder:before {
  content: "\f07b";
}
.fa-folder-open:before {
  content: "\f07c";
}
.fa-twitter:before {
  content: "\f099";
}
.fa-twr:before {
  content: "\f099";
}
.fa-facebook:before {
  content: "\f09a";
}
.fa-fce:before {
  content: "\f09a";
}
.fa-facebook-f:before {
  content: "\f09a";
}
.fa-github:before {
  content: "\f09b";
}
.fa-gh:before {
  content: "\f09b";
}
.fa-cut:before {
  content: "\f0c4";
}
.fa-scissors:before {
  content: "\f0c4";
}
.fa-copy:before {
  content: "\f0c5";
}
.fa-files-o:before {
  content: "\f0c5";
}
.fa-bars:before {
  content: "\f0c9";
}
.fa-navicon:before {
  content: "\f0c9";
}
.fa-reorder:before {
  content: "\f0c9";
}
.fa-list-ul:before {
  content: "\f0ca";
}
.fa-list-ol:before {
  content: "\f0cb";
}
.fa-strikethrough:before {
  content: "\f0cc";
}
.fa-underline:before {
  content: "\f0cd";
}
.fa-table:before {
  content: "\f0ce";
}
.fa-magic:before {
  content: "\f0d0";
}
.fa-caret-down:before {
  content: "\f0d7";
}
.fa-caret-right:before {
  content: "\f0da";
}
.fa-sort-desc:before {
  content: "\f0dd";
}
.fa-sort-down:before {
  content: "\f0dd";
}
.fa-clipboard:before {
  content: "\f0ea";
}
.fa-paste:before {
  content: "\f0ea";
}
.fa-angle-double-left:before {
  content: "\f100";
}
.fa-angle-double-right:before {
  content: "\f101";
}
.fa-angle-double-up:before {
  content: "\f102";
}
.fa-angle-double-down:before {
  content: "\f103";
}
.fa-circle:before {
  content: "\f111";
}
.fa-mail-reply:before {
  content: "\f112";
}
.fa-reply:before {
  content: "\f112";
}
.fa-exclamation:before {
  content: "\f12a";
}
.fa-eraser:before {
  content: "\f12d";
}
.fa-ellipsis-h:before {
  content: "\f141";
}
.fa-ellipsis-v:before {
  content: "\f142";
}
.fa-file:before {
  content: "\f15b";
}
.fa-file-text:before {
  content: "\f15c";
}
.fa-google:before {
  content: "\f1a0";
}
.fa-gg:before {
  content: "\f1a0";
}
.fa-trash:before {
  content: "\f1f8";
}
.fa-i-cursor:before {
  content: "\f246";
}
.fa-hand-paper-o:before {
  content: "\f256";
}
.fa-hand-stop-o:before {
  content: "\f256";
}
</style><style>

compositeblock {
  display: inline-block;
  position: relative;
  text-align: left;
  unicode-bidi: isolate;
}
compositeblock.middle {
  vertical-align: middle;
}
latex-symbol-icon {
  display: inline-block;
  padding: 2px;
  border: 1px solid transparent;
  cursor: pointer;
}
latex-symbol-icon:hover,
latex-symbol-icon.selected {
  background: white;
  border: 1px solid lightgray;
}
inline {
  display: inline-block;
}
base-line-indicator {
  display: inline-block;
  overflow: hidden;
  width: 0px;
  height: inherit;
}

math-type .constant-text > constant-text {
  margin-left: 0.2em;
  margin-right: 0.2em;
}
math-type .constant-text > constant-text.close-left {
  margin-left: 0;
}
math-type .constant-text > constant-text.close-right {
  margin-right: 0;
}



/**different context*/
/**different context*/
math-type ref-tag {
  position: absolute;
  right: 5px;
  top: 50%;
  transform: translate(0, -50%);
  z-index: 8;
  cursor: pointer;
}
math-type ref-tag > label {
  cursor: pointer;
}
math-type ref-tag:hover {
  text-decoration: underline;
}
math-type ref-tag.line-tag {
  transition: background 0.4s;
}
math-type ref-tag.empty-line-tag {
  opacity: 0.5;
  animation: fadein 0.5s;
}
math-type tr.math-row ref-tag {
  left: calc(100% + 20px);
  right: unset;
}
@keyframes fadein {
  0% {
    opacity: 0;
  }
  70% {
    opacity: 0;
  }
  100% {
    opacity: 0.5;
  }
}







.color-picker no-color-select {
  display: block;
  text-align: center;
  /* width: 100%; */
  /* height: 20px; */
  background: white;
  border: 1px solid lightgray;
  margin-bottom: 2px;
  color: gray;
  padding: 2px;
  cursor: default;
  border-radius: 0;
  padding-bottom: 2px;
  margin-bottom: 3px;
  margin-left: -1px;
  margin-right: -1px;
  font-size: 13px;
}
.color-picker no-color-select:hover {
  color: black;
}
.color-picker color-select {
  position: absolute;
  top: 30px;
  left: 0px;
  background: white;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type editarea.no-area-container,
math-type editarea.text-mode,
math-type area-container,
math-type .print-as-area-container {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
math-type editarea.no-area-container > line,
math-type editarea.text-mode > line,
math-type area-container > line,
math-type .print-as-area-container > line {
  min-width: 0.3em;
  position: relative;
  display: block;
  width: 100%;
  align-items: baseline;
  flex-wrap: wrap;
  box-sizing: border-box;
  flex-wrap: nowrap;
  line-height: 1.2;
  white-space: nowrap;
}
math-type editarea.no-area-container > line block,
math-type editarea.text-mode > line block,
math-type area-container > line block,
math-type .print-as-area-container > line block {
  white-space: pre;
}
math-type editarea.no-area-container > line.single-block > blocks > baselineblock,
math-type editarea.text-mode > line.single-block > blocks > baselineblock,
math-type area-container > line.single-block > blocks > baselineblock,
math-type .print-as-area-container > line.single-block > blocks > baselineblock {
  display: none;
}
math-type editarea.no-area-container > line > blocks,
math-type editarea.text-mode > line > blocks,
math-type area-container > line > blocks,
math-type .print-as-area-container > line > blocks {
  /**
            Different between inline and inline-block is about whether Section Text will be wrap in next wrapped line 
            */
  display: inline-block;
  text-align: left;
}
math-type editarea.no-area-container > line.root,
math-type editarea.text-mode > line.root,
math-type area-container > line.root,
math-type .print-as-area-container > line.root,
math-type editarea.no-area-container > line.text-mode,
math-type editarea.text-mode > line.text-mode,
math-type area-container > line.text-mode,
math-type .print-as-area-container > line.text-mode {
  display: block;
  font-style: normal;
}
math-type editarea.no-area-container > line.root > prefix,
math-type editarea.text-mode > line.root > prefix,
math-type area-container > line.root > prefix,
math-type .print-as-area-container > line.root > prefix,
math-type editarea.no-area-container > line.text-mode > prefix,
math-type editarea.text-mode > line.text-mode > prefix,
math-type area-container > line.text-mode > prefix,
math-type .print-as-area-container > line.text-mode > prefix {
  white-space: pre;
  display: inline-block;
  cursor: default;
  text-align: left;
}
math-type editarea.no-area-container > line.root > blocks,
math-type editarea.text-mode > line.root > blocks,
math-type area-container > line.root > blocks,
math-type .print-as-area-container > line.root > blocks,
math-type editarea.no-area-container > line.text-mode > blocks,
math-type editarea.text-mode > line.text-mode > blocks,
math-type area-container > line.text-mode > blocks,
math-type .print-as-area-container > line.text-mode > blocks {
  /** should not wrap here*/
  align-items: baseline;
  box-sizing: border-box;
}
math-type editarea.no-area-container > line.root > blocks > block,
math-type editarea.text-mode > line.root > blocks > block,
math-type area-container > line.root > blocks > block,
math-type .print-as-area-container > line.root > blocks > block,
math-type editarea.no-area-container > line.text-mode > blocks > block,
math-type editarea.text-mode > line.text-mode > blocks > block,
math-type area-container > line.text-mode > blocks > block,
math-type .print-as-area-container > line.text-mode > blocks > block {
  white-space: pre-wrap;
  white-space: break-spaces;
}
math-type editarea.no-area-container > line.root.full-line-block-inside > prefix,
math-type editarea.text-mode > line.root.full-line-block-inside > prefix,
math-type area-container > line.root.full-line-block-inside > prefix,
math-type .print-as-area-container > line.root.full-line-block-inside > prefix,
math-type editarea.no-area-container > line.text-mode.full-line-block-inside > prefix,
math-type editarea.text-mode > line.text-mode.full-line-block-inside > prefix,
math-type area-container > line.text-mode.full-line-block-inside > prefix,
math-type .print-as-area-container > line.text-mode.full-line-block-inside > prefix {
  float: left;
  vertical-align: top;
}
math-type editarea.no-area-container > line.root.full-line-block-inside > blocks,
math-type editarea.text-mode > line.root.full-line-block-inside > blocks,
math-type area-container > line.root.full-line-block-inside > blocks,
math-type .print-as-area-container > line.root.full-line-block-inside > blocks,
math-type editarea.no-area-container > line.text-mode.full-line-block-inside > blocks,
math-type editarea.text-mode > line.text-mode.full-line-block-inside > blocks,
math-type area-container > line.text-mode.full-line-block-inside > blocks,
math-type .print-as-area-container > line.text-mode.full-line-block-inside > blocks {
  display: block;
  width: 100%;
}
math-type editarea.no-area-container > line.root.full-line-block-inside > blocks > baselineblock,
math-type editarea.text-mode > line.root.full-line-block-inside > blocks > baselineblock,
math-type area-container > line.root.full-line-block-inside > blocks > baselineblock,
math-type .print-as-area-container > line.root.full-line-block-inside > blocks > baselineblock,
math-type editarea.no-area-container > line.text-mode.full-line-block-inside > blocks > baselineblock,
math-type editarea.text-mode > line.text-mode.full-line-block-inside > blocks > baselineblock,
math-type area-container > line.text-mode.full-line-block-inside > blocks > baselineblock,
math-type .print-as-area-container > line.text-mode.full-line-block-inside > blocks > baselineblock {
  display: inline-block;
  float: left;
}
math-type editarea.no-area-container > line.root.has-rtl.align-justify,
math-type editarea.text-mode > line.root.has-rtl.align-justify,
math-type area-container > line.root.has-rtl.align-justify,
math-type .print-as-area-container > line.root.has-rtl.align-justify,
math-type editarea.no-area-container > line.text-mode.has-rtl.align-justify,
math-type editarea.text-mode > line.text-mode.has-rtl.align-justify,
math-type area-container > line.text-mode.has-rtl.align-justify,
math-type .print-as-area-container > line.text-mode.has-rtl.align-justify {
  direction: rtl;
}
math-type editarea.no-area-container > line.root.section,
math-type editarea.text-mode > line.root.section,
math-type area-container > line.root.section,
math-type .print-as-area-container > line.root.section,
math-type editarea.no-area-container > line.text-mode.section,
math-type editarea.text-mode > line.text-mode.section,
math-type area-container > line.text-mode.section,
math-type .print-as-area-container > line.text-mode.section {
  text-align: left;
}
math-type editarea.no-area-container > line.root.section > blocks,
math-type editarea.text-mode > line.root.section > blocks,
math-type area-container > line.root.section > blocks,
math-type .print-as-area-container > line.root.section > blocks,
math-type editarea.no-area-container > line.text-mode.section > blocks,
math-type editarea.text-mode > line.text-mode.section > blocks,
math-type area-container > line.text-mode.section > blocks,
math-type .print-as-area-container > line.text-mode.section > blocks {
  /**
                    Different between inline and inline-block is about whether Section Text will be wrap in next wrapped line 
                    */
  display: inline;
}
math-type editarea.no-area-container > line.root.section.has-rtl,
math-type editarea.text-mode > line.root.section.has-rtl,
math-type area-container > line.root.section.has-rtl,
math-type .print-as-area-container > line.root.section.has-rtl,
math-type editarea.no-area-container > line.text-mode.section.has-rtl,
math-type editarea.text-mode > line.text-mode.section.has-rtl,
math-type area-container > line.text-mode.section.has-rtl,
math-type .print-as-area-container > line.text-mode.section.has-rtl {
  direction: rtl;
}
math-type editarea.no-area-container > line.root.section.has-rtl > prefix,
math-type editarea.text-mode > line.root.section.has-rtl > prefix,
math-type area-container > line.root.section.has-rtl > prefix,
math-type .print-as-area-container > line.root.section.has-rtl > prefix,
math-type editarea.no-area-container > line.text-mode.section.has-rtl > prefix,
math-type editarea.text-mode > line.text-mode.section.has-rtl > prefix,
math-type area-container > line.text-mode.section.has-rtl > prefix,
math-type .print-as-area-container > line.text-mode.section.has-rtl > prefix {
  direction: rtl;
  order: 1;
}
math-type editarea.no-area-container > line.root.theorem,
math-type editarea.text-mode > line.root.theorem,
math-type area-container > line.root.theorem,
math-type .print-as-area-container > line.root.theorem,
math-type editarea.no-area-container > line.text-mode.theorem,
math-type editarea.text-mode > line.text-mode.theorem,
math-type area-container > line.text-mode.theorem,
math-type .print-as-area-container > line.text-mode.theorem {
  padding-top: 0.3em;
  padding-bottom: 0.3em;
}
math-type editarea.no-area-container > line > prefix,
math-type editarea.text-mode > line > prefix,
math-type area-container > line > prefix,
math-type .print-as-area-container > line > prefix {
  text-align: right;
}
math-type editarea.no-area-container > line.has-indent,
math-type editarea.text-mode > line.has-indent,
math-type area-container > line.has-indent,
math-type .print-as-area-container > line.has-indent {
  display: flex;
  justify-content: flex-start;
}
math-type editarea.no-area-container > line.has-rtl.has-indent > prefix,
math-type editarea.text-mode > line.has-rtl.has-indent > prefix,
math-type area-container > line.has-rtl.has-indent > prefix,
math-type .print-as-area-container > line.has-rtl.has-indent > prefix {
  direction: rtl;
  order: 1;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-0,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-0,
math-type area-container > line.has-rtl.has-indent.indent-0,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-0 {
  padding-left: 0;
  padding-right: 30px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-1,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-1,
math-type area-container > line.has-rtl.has-indent.indent-1,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-1 {
  padding-left: 0;
  padding-right: 65px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-2,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-2,
math-type area-container > line.has-rtl.has-indent.indent-2,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-2 {
  padding-left: 0;
  padding-right: 105px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-3,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-3,
math-type area-container > line.has-rtl.has-indent.indent-3,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-3 {
  padding-left: 0;
  padding-right: 145px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-4,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-4,
math-type area-container > line.has-rtl.has-indent.indent-4,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-4 {
  padding-left: 0;
  padding-right: 185px;
}
math-type editarea.no-area-container > line.indent-0,
math-type editarea.text-mode > line.indent-0,
math-type area-container > line.indent-0,
math-type .print-as-area-container > line.indent-0 {
  padding-left: 30px;
}
math-type editarea.no-area-container > line.indent-1,
math-type editarea.text-mode > line.indent-1,
math-type area-container > line.indent-1,
math-type .print-as-area-container > line.indent-1 {
  padding-left: 65px;
}
math-type editarea.no-area-container > line.indent-2,
math-type editarea.text-mode > line.indent-2,
math-type area-container > line.indent-2,
math-type .print-as-area-container > line.indent-2 {
  padding-left: 105px;
}
math-type editarea.no-area-container > line.indent-3,
math-type editarea.text-mode > line.indent-3,
math-type area-container > line.indent-3,
math-type .print-as-area-container > line.indent-3 {
  padding-left: 145px;
}
math-type editarea.no-area-container > line.indent-4,
math-type editarea.text-mode > line.indent-4,
math-type area-container > line.indent-4,
math-type .print-as-area-container > line.indent-4 {
  padding-left: 185px;
}
math-type editarea.no-area-container > line.math-container-selected,
math-type editarea.text-mode > line.math-container-selected,
math-type area-container > line.math-container-selected,
math-type .print-as-area-container > line.math-container-selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type editarea.no-area-container > line.math-container,
math-type editarea.text-mode > line.math-container,
math-type area-container > line.math-container,
math-type .print-as-area-container > line.math-container {
  font-family: 'Asana';
  justify-content: center;
  text-align: center;
  text-align-last: auto;
  display: flex;
}
math-type editarea.no-area-container > line.math-container block,
math-type editarea.text-mode > line.math-container block,
math-type area-container > line.math-container block,
math-type .print-as-area-container > line.math-container block {
  white-space: pre;
}
math-type editarea.no-area-container > line.align-center,
math-type editarea.text-mode > line.align-center,
math-type area-container > line.align-center,
math-type .print-as-area-container > line.align-center {
  text-align: center;
  text-align-last: auto;
}
math-type editarea.no-area-container > line.align-center.has-indent,
math-type editarea.text-mode > line.align-center.has-indent,
math-type area-container > line.align-center.has-indent,
math-type .print-as-area-container > line.align-center.has-indent {
  justify-content: center;
}
math-type editarea.no-area-container > line.align-center.section,
math-type editarea.text-mode > line.align-center.section,
math-type area-container > line.align-center.section,
math-type .print-as-area-container > line.align-center.section {
  text-align: center;
  text-align-last: auto;
}
math-type editarea.no-area-container > line.align-center > blocks,
math-type editarea.text-mode > line.align-center > blocks,
math-type area-container > line.align-center > blocks,
math-type .print-as-area-container > line.align-center > blocks {
  text-align: center;
  text-align-last: auto;
}
math-type editarea.no-area-container > line.align-justify,
math-type editarea.text-mode > line.align-justify,
math-type area-container > line.align-justify,
math-type .print-as-area-container > line.align-justify {
  text-align: justify;
}
math-type editarea.no-area-container > line.align-justify.section,
math-type editarea.text-mode > line.align-justify.section,
math-type area-container > line.align-justify.section,
math-type .print-as-area-container > line.align-justify.section {
  text-align: justify;
}
math-type editarea.no-area-container > line.align-justify > blocks,
math-type editarea.text-mode > line.align-justify > blocks,
math-type area-container > line.align-justify > blocks,
math-type .print-as-area-container > line.align-justify > blocks {
  text-align: justify;
}
math-type editarea.no-area-container > line.align-left,
math-type editarea.text-mode > line.align-left,
math-type area-container > line.align-left,
math-type .print-as-area-container > line.align-left {
  text-align: left;
}
math-type editarea.no-area-container > line.align-left > blocks,
math-type editarea.text-mode > line.align-left > blocks,
math-type area-container > line.align-left > blocks,
math-type .print-as-area-container > line.align-left > blocks {
  text-align: left;
}
math-type editarea.no-area-container > line.align-right,
math-type editarea.text-mode > line.align-right,
math-type area-container > line.align-right,
math-type .print-as-area-container > line.align-right {
  text-align: right;
}
math-type editarea.no-area-container > line.align-right.has-indent,
math-type editarea.text-mode > line.align-right.has-indent,
math-type area-container > line.align-right.has-indent,
math-type .print-as-area-container > line.align-right.has-indent {
  justify-content: flex-end;
}
math-type editarea.no-area-container > line.align-right.section,
math-type editarea.text-mode > line.align-right.section,
math-type area-container > line.align-right.section,
math-type .print-as-area-container > line.align-right.section {
  text-align: right;
}
math-type editarea.no-area-container > line.align-right > blocks,
math-type editarea.text-mode > line.align-right > blocks,
math-type area-container > line.align-right > blocks,
math-type .print-as-area-container > line.align-right > blocks {
  text-align: right;
}
math-type editarea.no-area-container > line > blocks > block,
math-type editarea.text-mode > line > blocks > block,
math-type area-container > line > blocks > block,
math-type .print-as-area-container > line > blocks > block {
  display: inline;
}
math-type editarea.no-area-container,
math-type area-container {
  align-items: initial;
}
math-type editarea.root-editor {
  align-items: initial;
  display: block;
  color: black;
  fill: black;
  stroke: black;
  border-color: black;
}
math-type editarea.root-editor.read-only {
  cursor: default;
}
math-type editarea.root-editor.read-only block {
  cursor: default;
}
math-type editarea.root-editor > area-container {
  display: block;
}
math-type area-container {
  width: 100%;
}
math-type block {
  cursor: text;
}
math-type editarea {
  box-sizing: border-box;
  display: flex;
  overflow-x: visible;
  align-items: center;
  justify-content: center;
  flex-direction: row;
  flex-wrap: nowrap;
}
math-type editarea block {
  cursor: text;
}
math-type editarea.high-order {
  position: relative;
  z-index: 10;
}
math-type editarea.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type editarea.bordered {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type editarea.center > area-container > line,
math-type editarea.center > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type editarea.left > area-container > line,
math-type editarea.left > line {
  justify-content: flex-start;
  text-align: left;
}
math-type editarea.right > area-container > line,
math-type editarea.right > line {
  justify-content: flex-end;
  text-align: right;
}
math-type editarea > area-baseline {
  width: 0;
  overflow: hidden;
  display: inline-block;
  float: left;
}
math-type setting.mt-common-dialog.line-tag-setting {
  transform: translate(0, -100%);
  position: absolute;
  font-family: serif;
  font-size: 11px;
  top: -4px;
  left: -10px;
  outline: none;
}
math-type setting.mt-common-dialog.line-tag-setting i {
  font-style: normal;
  padding: 1px 3px;
}
baselineblock {
  height: 0px;
  display: inline-block;
  width: 0;
  overflow: hidden;
}
baselineblock.inline {
  display: inline;
}
emptyblock {
  white-space: pre;
}
composite {
  display: inline-block;
}
block.Binary {
  padding: 0 0.2em;
}
block.Relation {
  padding: 0 0.3em;
}
block.Punctuation {
  padding-right: 0.2em;
}




check-box-wrapper {
  display: block;
  font-size: 11px;
  color: gray;
  cursor: pointer;
}
check-box-wrapper.disabled {
  color: lightgray;
}
check-box-wrapper.disabled check-box-rect {
  border: 1px solid #e2e1e1;
  color: lightgray;
}
check-box-wrapper.disabled check-box-rect:hover {
  border: 1px solid #e2e1e1;
}
check-box-wrapper.mobile-tablet check-box-rect {
  margin-top: -3px;
  width: 16px;
  height: 15px;
  font-size: 13px;
}
check-box-wrapper.mobile-tablet check-box-rect > i {
  left: 2px;
  top: 1px;
}
check-box-wrapper check-box-rect {
  width: 1.4em;
  height: 1.35em;
  border: 1px solid #c3c2c2;
  position: relative;
  display: inline-flex;
  font-size: 11px;
  color: green;
  background: white;
  justify-content: center;
  align-items: center;
}
check-box-wrapper check-box-rect:hover {
  border: 1px solid gray;
}
check-box-wrapper.unchecked check-box-rect > i {
  visibility: hidden;
}

vcomposed-symbol {
  display: flex;
  width: 100%;
  height: 100%;
  overflow: hidden;
  flex-direction: column;
}
vcomposed-symbol > start {
  display: block;
  float: left;
  overflow: hidden;
  margin-bottom: -0.02em;
}
vcomposed-symbol > middle-center {
  overflow: hidden;
  margin-top: -0.02em;
  margin-bottom: -0.02em;
}
vcomposed-symbol > middle {
  display: block;
  flex-grow: 1;
  position: relative;
  overflow: hidden;
  margin-top: -0.02em;
  margin-bottom: -0.02em;
}
vcomposed-symbol > middle > fixed {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
}
vcomposed-symbol > middle > fixed > inside {
  display: block;
  overflow: hidden;
}
vcomposed-symbol > end {
  margin-top: -0.02em;
  display: block;
  overflow: hidden;
}


.open-brace,
.close-brace {
  padding: 0 0.1em;
  width: 0.5em;
  min-width: 0.5em;
}
.open-brace > start,
.close-brace > start {
  min-height: 0.75em;
  height: 0.75em;
}
.open-brace > middle-center,
.close-brace > middle-center {
  min-height: 0.6em;
  height: 0.6em;
}
.open-brace > end,
.close-brace > end {
  min-height: 0.75em;
  height: 0.75em;
}
.open-bracket,
.close-bracket {
  width: 0.43em;
  min-width: 0.43em;
}
.open-bracket > start,
.close-bracket > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-bracket > end,
.close-bracket > end {
  height: 0.7em;
  min-height: 0.7em;
}
.open-parenthesis,
.close-parenthesis {
  width: 0.45em;
  min-width: 0.45em;
}
.open-parenthesis > start,
.close-parenthesis > start {
  min-height: 0.85em;
  height: 0.85em;
}
.open-parenthesis > end,
.close-parenthesis > end {
  min-height: 0.8em;
  height: 0.8em;
}
.open-floor,
.close-floor {
  width: 0.45em;
  min-width: 0.45em;
}
.open-floor > end,
.close-floor > end {
  height: 0.35em;
  min-height: 0.35em;
}
.open-ceil,
.close-ceil {
  width: 0.45em;
  min-width: 0.45em;
}
.open-ceil > start,
.close-ceil > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-vert,
.close-vert {
  width: 0.3em;
  min-width: 0.3em;
}
.open-Vert,
.close-Vert {
  width: 0.5em;
  min-width: 0.5em;
}
.open-uparrow,
.close-uparrow {
  width: 0.45em;
  min-width: 0.45em;
}
.open-uparrow > start,
.close-uparrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-downarrow,
.close-downarrow {
  width: 0.45em;
  min-width: 0.45em;
}
.open-downarrow > end,
.close-downarrow > end {
  height: 0.4em;
  min-height: 0.4em;
}
.open-updownarrow,
.close-updownarrow {
  width: 0.45em;
  min-width: 0.45em;
}
.open-updownarrow > start,
.close-updownarrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-updownarrow > end,
.close-updownarrow > end {
  height: 0.4em;
  min-height: 0.4em;
}
.open-Uparrow,
.close-Uparrow {
  width: 0.7em;
  min-width: 0.7em;
}
.open-Uparrow > start,
.close-Uparrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-Downarrow,
.close-Downarrow {
  width: 0.7em;
  min-width: 0.7em;
}
.open-Downarrow > end,
.close-Downarrow > end {
  height: 0.5em;
  min-height: 0.5em;
}
.open-Updownarrow,
.close-Updownarrow {
  width: 0.6em;
  min-width: 0.6em;
}
.open-Updownarrow > start,
.close-Updownarrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-Updownarrow > end,
.close-Updownarrow > end {
  height: 0.5em;
  min-height: 0.5em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
opensymbolblock,
closesymbolblock,
.middle-vert-symbol {
  display: inline-flex;
  align-items: center;
  position: relative;
  text-align: left;
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}
opensymbolblock.normal,
closesymbolblock.normal,
.middle-vert-symbol.normal {
  margin-top: 0;
  margin-bottom: 0;
}
opensymbolblock > hidden-span,
closesymbolblock > hidden-span,
.middle-vert-symbol > hidden-span {
  visibility: hidden;
  width: 0px;
}
opensymbolblock[type='brace'],
closesymbolblock[type='brace'],
.middle-vert-symbol[type='brace'] {
  margin-left: 0.05em;
  margin-right: 0.05em;
  overflow: visible;
}
opensymbolblock[type='brace'] > svg,
closesymbolblock[type='brace'] > svg,
.middle-vert-symbol[type='brace'] > svg {
  overflow: visible;
  width: 0.5em;
  height: 100%;
}
opensymbolblock[type='parenthesis'] > svg,
closesymbolblock[type='parenthesis'] > svg,
.middle-vert-symbol[type='parenthesis'] > svg {
  width: 0.5em;
  height: 100%;
}
opensymbolblock[type='bracket'] > svg,
closesymbolblock[type='bracket'] > svg,
.middle-vert-symbol[type='bracket'] > svg {
  width: 0.5em;
  height: 100%;
}
opensymbolblock[type='angle'].sm-1 > svg,
closesymbolblock[type='angle'].sm-1 > svg,
.middle-vert-symbol[type='angle'].sm-1 > svg {
  width: 0.3em;
}
opensymbolblock[type='angle'].sm-2 > svg,
closesymbolblock[type='angle'].sm-2 > svg,
.middle-vert-symbol[type='angle'].sm-2 > svg {
  width: 0.45em;
}
opensymbolblock[type='angle'] > svg,
closesymbolblock[type='angle'] > svg,
.middle-vert-symbol[type='angle'] > svg {
  width: 0.6em;
  height: 100%;
}
opensymbolblock[type='slash'] > svg,
closesymbolblock[type='slash'] > svg,
.middle-vert-symbol[type='slash'] > svg {
  width: 0.7em;
  height: 100%;
}
opensymbolblock > bracket-span,
closesymbolblock > bracket-span,
.middle-vert-symbol > bracket-span {
  display: block;
}
opensymbolblock > vcomposed-symbol,
closesymbolblock > vcomposed-symbol,
.middle-vert-symbol > vcomposed-symbol,
opensymbolblock > bracket-span,
closesymbolblock > bracket-span,
.middle-vert-symbol > bracket-span {
  height: 100%;
  width: 100%;
  font-style: normal;
}
opensymbolblock > brace-span,
closesymbolblock > brace-span,
.middle-vert-symbol > brace-span {
  visibility: hidden;
  display: inline-block;
  padding: 0 0.1em;
}
opensymbolblock,
.middle-vert-symbol {
  margin-left: 0.07em;
}
opensymbolblock.normal,
.middle-vert-symbol.normal {
  margin-left: 0;
}
opensymbolblock[type='vert'],
.middle-vert-symbol[type='vert'],
opensymbolblock.middle-vert-symbol,
.middle-vert-symbol.middle-vert-symbol {
  margin-left: 0.05em;
  margin-right: 0.05em;
}
opensymbolblock[type='vert'] > svg,
.middle-vert-symbol[type='vert'] > svg,
opensymbolblock.middle-vert-symbol > svg,
.middle-vert-symbol.middle-vert-symbol > svg {
  width: 0.4em;
  height: 100%;
}
opensymbolblock[type='parenthesis'] > svg,
.middle-vert-symbol[type='parenthesis'] > svg {
  margin-right: -0.1em;
}
closesymbolblock {
  margin-right: 0.07em;
}
closesymbolblock.normal {
  margin-right: 0;
}
closesymbolblock[type='vert'] {
  margin-left: 0.05em;
  margin-right: 0.05em;
}
closesymbolblock[type='vert'] > svg {
  width: 0.4em;
  height: 100%;
}
closesymbolblock[type='parenthesis'] > svg {
  margin-left: -0.1em;
}

opensymbolblock[type=empty] > empty,
closesymbolblock[type=empty] > empty {
  width: 2px;
  height: 100%;
  display: block;
}
opensymbolblock[type=empty] > empty.normal-size,
closesymbolblock[type=empty] > empty.normal-size {
  height: 1em;
}
opensymbolblock[type=empty] > empty.line-selected,
closesymbolblock[type=empty] > empty.line-selected {
  background-color: lightgray;
}

.dirac-bracket-symbol > div > .oangle,
.dirac-bracket-symbol > div > .cangle {
  align-self: stretch;
  width: 0.55em;
  position: relative;
  margin-top: 0.1em;
  margin-bottom: -0.1em;
}
.dirac-bracket-symbol > div > .oangle > svg,
.dirac-bracket-symbol > div > .cangle > svg {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}
.dirac-bracket-symbol > div > .vert {
  align-self: stretch;
  width: 0.25em;
  position: relative;
  margin-top: 0.1em;
  margin-bottom: -0.1em;
}
.dirac-bracket-symbol > div > .vert > svg {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}
.dirac-bracket-symbol > div > editarea.first {
  min-width: 0.3em;
  padding-right: 0.1em;
}
.dirac-bracket-symbol > div > editarea.last {
  min-width: 0.3em;
  padding-left: 0.1em;
}
.dirac-bracket-symbol > div > editarea.middle {
  min-width: 0.3em;
  padding-left: 0.1em;
  padding-right: 0.1em;
}

cancel-symbol > editarea {
  display: inline-flex;
}
cancel-symbol > svg {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: visible;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.frac-slashed-symbol.frac-inline {
  font-size: 0.75em;
}
math-type compositeblock.fraction-symbol {
  margin-left: 0.1em;
  margin-right: 0.1em;
  vertical-align: baseline;
}
math-type compositeblock.fraction-symbol.frac-inline {
  font-size: 0.75em;
}
math-type compositeblock.fraction-symbol > .enumerator {
  float: left;
  width: 100%;
  clear: both;
}
math-type compositeblock.fraction-symbol > .denominator {
  margin-top: -5px;
  float: left;
  width: 100%;
}
math-type compositeblock.fraction-symbol > .frac-line {
  clear: both;
  pointer-events: none;
}
math-type compositeblock.fraction-symbol > .frac-line > inline {
  display: inline-block;
  width: 100%;
  vertical-align: 0.25em;
  border-bottom: solid 1px;
}
math-type compositeblock.fraction-symbol > editarea {
  border: 0px;
  min-width: 0.6em;
  text-align: center;
  text-align-last: auto;
}
math-type compositeblock.fraction-symbol > editarea > area-container > line,
math-type compositeblock.fraction-symbol > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type compositeblock.fraction-symbol > editarea-line {
  text-align: center;
  text-align-last: auto;
}

.stackrel-icon {
  margin: auto;
  display: flex;
  align-items: center;
  flex-direction: column;
}
.stackrel-icon .square {
  width: 6px;
  height: 6px;
  border-style: solid;
  border-width: 1px;
  border-color: gray;
}
.stackrel-icon .distance {
  margin-top: 3px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .stackrel-symbol.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type .stackrel-symbol > .cur-value {
  clear: both;
  display: inline-flex;
  width: 100%;
}
math-type .stackrel-symbol > .top {
  float: left;
  clear: both;
  width: 100%;
  font-size: 0.7em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .underset-symbol > .center {
  display: inline-flex;
  width: 100%;
}
math-type .underset-symbol > .bottom {
  float: left;
  display: block;
  width: 100%;
  font-size: 0.7em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-under-set-symbol.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type .over-under-set-symbol > .top {
  display: flex;
  float: left;
  clear: both;
  width: 100%;
}
math-type .over-under-set-symbol > .top > line {
  font-size: 0.7em;
}
math-type .over-under-set-symbol > .middle {
  display: inline-flex;
  width: 100%;
  clear: both;
}
math-type .over-under-set-symbol > .middle.select {
  border-bottom: none;
}
math-type .over-under-set-symbol > .bottom {
  display: flex;
  float: left;
  width: 100%;
}
math-type .over-under-set-symbol > .bottom > line {
  font-size: 0.7em;
}

expandable-component.thickness item-option.thickness-option {
  width: 40px;
  height: 12px;
}
expandable-component.thickness svg {
  stroke: gray;
  stroke-width: 1px;
  fill: none;
}
expandable-component.thickness thickness {
  position: relative;
  display: flex;
  height: 100%;
}
expandable-component.thickness thickness > svg.thickness {
  width: 25px;
  height: 100%;
  position: static;
}
expandable-component.thickness thickness > svg.thickness line {
  stroke: gray;
  stroke-width: 1px;
}
expandable-component.thickness thickness > svg.thickness path {
  fill: #d2cfcf;
  stroke: none;
}



/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .textcircled > div > editarea {
  text-align: center;
  text-align-last: auto;
}
math-type .textcircled > div > editarea > area-container > line,
math-type .textcircled > div > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.math-container-symbol {
  margin-top: 0.3em;
  margin-bottom: 0.3em;
  display: inline-flex;
}
.math-container-symbol.inline {
  margin-top: 0px;
  margin-bottom: 0px;
}
.math-container-symbol.selected {
  background-color: rgba(76, 175, 80, 0.05);
  outline: 1px solid #c1d4c1;
}
.math-container-symbol.display {
  display: block;
}
.math-container-symbol.display.selected {
  background-color: rgba(76, 175, 80, 0.05);
  outline: none;
}
.math-container-symbol.display > editarea {
  width: 100%;
  flex-grow: 1;
  display: block;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol.display > editarea > area-container > line,
.math-container-symbol.display > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol.display > editarea > area-container > line {
  padding-top: 8px;
  padding-bottom: 8px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.math-container-symbol > editarea.multiline {
  display: block;
  flex-grow: 1;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol > editarea.multiline > area-container > line,
.math-container-symbol > editarea.multiline > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol > editarea.multiline > line:last-child {
  justify-content: flex-end;
  text-align: right;
}
.math-container-symbol > editarea.multiline > line:first-child {
  justify-content: flex-start;
  text-align: left;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .icon-sqrt,
.auto-complete-external-area .icon-sqrt {
  display: flex;
  margin: auto;
  font-size: 12px;
}
math-type .icon-sqrt .square,
.auto-complete-external-area .icon-sqrt .square {
  margin-top: 3px;
  margin-right: -6px;
}
math-type .icon-sqrt .square-expand,
.auto-complete-external-area .icon-sqrt .square-expand {
  background-color: #f7f7f7;
}
math-type .icon-sqrt .align-end,
.auto-complete-external-area .icon-sqrt .align-end {
  margin-top: 8px;
}
math-type .icon-sqrt .line,
.auto-complete-external-area .icon-sqrt .line {
  width: 10px;
  border-top: solid 1px black;
  margin-top: 6px;
}
math-type .icon-sqrt .big-square,
.auto-complete-external-area .icon-sqrt .big-square {
  margin-top: 11px;
  margin-left: -8px;
}
math-type .sqrt-symbol {
  white-space: nowrap;
  align-items: stretch;
  position: relative;
}
math-type .sqrt-symbol > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  left: 50%;
  top: -0.5em;
  left: 0.5em;
}
math-type .sqrt-symbol > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .sqrt-symbol > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .sqrt-symbol text {
  fill: black;
}
math-type .sqrt-symbol > sqrt-edit {
  position: relative;
  order: 3;
  display: inline-block;
  align-self: flex-end;
}
math-type .sqrt-symbol > sqrt-edit > sqrt-symbol-line {
  overflow: visible;
  z-index: 1;
  width: 100%;
  height: 100%;
  display: block;
  position: absolute;
  left: 0;
  top: 0;
  pointer-events: none;
}
math-type .sqrt-symbol > sqrt-edit > sqrt-symbol-line > svg {
  overflow: visible;
  width: 100%;
  height: 1em;
}
math-type .sqrt-symbol > sqrt-edit > area-container > line {
  width: 1em;
  position: relative;
}
math-type .sqrt-symbol > sqrt-edit > editarea,
math-type .sqrt-symbol > sqrt-edit > editarea-line {
  z-index: 2;
  display: inline-block;
  min-width: 0.5em;
  margin-left: 1em;
}
math-type .sqrt-symbol > sqrt-top {
  position: relative;
  z-index: 2;
  vertical-align: bottom;
  padding-bottom: 0.95em;
  align-self: flex-end;
  display: inline-block;
}
math-type .sqrt-symbol > sqrt-top.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type .sqrt-symbol > sqrt-top > editarea {
  font-size: 0.7em;
  border: none 0px;
  min-width: 0.5em;
  display: flex;
  float: right;
  text-align: center;
  text-align-last: auto;
}
math-type .sqrt-symbol > sqrt-top > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}





/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
image-viewer {
  width: 100%;
}
image-viewer.inline {
  width: auto;
}
image-viewer .image-content {
  cursor: pointer;
  text-align: left;
}
image-viewer detail list-items-options div {
  border: 1px solid transparent;
  cursor: pointer;
  margin-left: 3px;
  padding: 0 2px 0 2px;
}
image-viewer detail list-items-options div:hover {
  background-color: white;
  border: 1px solid lightgray;
}
image-viewer detail list-items-options div.selected {
  background-color: white;
  border: 1px solid lightgray;
}
image-viewer image-container {
  display: flex;
  flex-direction: column;
}
image-viewer image-container img {
  position: absolute;
}
image-viewer image-container.center {
  align-items: center;
}
image-viewer image-container.left {
  align-items: flex-start;
}
image-viewer image-container.right {
  align-items: flex-end;
}
.resize-box {
  position: absolute;
  width: 8px;
  height: 8px;
  border-width: 1px;
  border-color: gray;
  border-style: solid;
  background-color: white;
  z-index: 999;
}
.resize-box.mobile-tablet {
  width: 16px;
  height: 16px;
}
.resize-box.hide {
  display: none;
}
topleft {
  top: 0;
  left: 0;
  margin-left: -5px;
  margin-top: -5px;
  cursor: nwse-resize;
}
topleft.mobile-tablet {
  margin-left: -8px;
  margin-top: -8px;
}
topright {
  top: 0;
  right: 0;
  margin-right: -5px;
  margin-top: -5px;
  cursor: nesw-resize;
}
topright.mobile-tablet {
  margin-right: -8px;
  margin-top: -8px;
}
topmiddle {
  top: 0;
  left: 50%;
  margin-left: -5px;
  margin-top: -5px;
  cursor: ns-resize;
}
topmiddle.mobile-tablet {
  margin-left: -8px;
  margin-top: -8px;
}
leftmiddle {
  top: 50%;
  left: 0;
  margin-left: -5px;
  margin-top: -5px;
  cursor: ew-resize;
}
leftmiddle.mobile-tablet {
  margin-left: -8px;
  margin-top: -8px;
}
rightmiddle {
  top: 50%;
  right: 0;
  margin-right: -5px;
  margin-top: -5px;
  cursor: ew-resize;
}
rightmiddle.mobile-tablet {
  margin-right: -8px;
  margin-top: -8px;
}
bottomleft {
  bottom: 0;
  left: 0;
  margin-left: -5px;
  margin-bottom: -5px;
  cursor: nesw-resize;
}
bottomleft.mobile-tablet {
  margin-left: -8px;
  margin-bottom: -8px;
}
bottomright {
  bottom: 0;
  right: 0;
  margin-right: -5px;
  margin-bottom: -5px;
  cursor: nwse-resize;
}
bottomright.mobile-tablet {
  margin-right: -8px;
  margin-bottom: -8px;
}
bottommiddle {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  margin-bottom: -5px;
  cursor: ns-resize;
}
bottommiddle.mobile-tablet {
  margin-left: -8px;
  margin-bottom: -8px;
}
.ghost-viewer {
  outline: 1px dotted gray;
  width: 100%;
  height: 100%;
  display: block;
}

compositeblock.image-container {
  position: relative;
  width: 100%;
  margin-top: 10px;
  margin-bottom: 10px;
}
compositeblock.image-container > image-viewer {
  display: block;
}
compositeblock.image-container.inline {
  width: auto;
  margin-top: 0;
  margin-bottom: 0;
  display: inline-block;
}
.image-caption > line.text-mode:first-child {
  display: inline;
}
.image-caption > line.text-mode:first-child > blocks {
  display: inline;
}
.add-caption {
  opacity: 0.85;
  text-align: "center";
  color: #1155cc;
  cursor: pointer;
  position: absolute;
  bottom: -35px;
  left: 50%;
  transform: translate(-50%, 0);
  z-index: 10;
  font-size: 13px;
  background: white;
  border: 1px solid lightgray;
  padding: 5px;
}
.add-caption:hover {
  opacity: 1;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .power-index-symbol-container {
  margin-right: 0.06em;
  margin-left: 0.03em;
}
math-type .power-index-symbol-container.has-power > .power-value {
  margin-left: 0.04em;
}
math-type .power-index-symbol-container > .power-value,
math-type .pre-script-symbol-container > .power-value {
  /*margin-bottom: -2px;*/
  float: left;
  clear: both;
  text-align: left;
}
math-type .power-index-symbol-container > .power-value.small > line,
math-type .pre-script-symbol-container > .power-value.small > line {
  margin-bottom: -0.35em;
}
math-type .power-index-symbol-container > .power-value > line,
math-type .pre-script-symbol-container > .power-value > line {
  font-size: 0.7em;
}
math-type .power-index-symbol-container > .power-value > area-container > line,
math-type .pre-script-symbol-container > .power-value > area-container > line,
math-type .power-index-symbol-container > .power-value > line,
math-type .pre-script-symbol-container > .power-value > line {
  justify-content: flex-start;
  text-align: left;
}
math-type .power-index-symbol-container > middle-base,
math-type .pre-script-symbol-container > middle-base {
  display: block;
  clear: both;
  height: 1em;
}
math-type .power-index-symbol-container > middle-base > inline,
math-type .pre-script-symbol-container > middle-base > inline {
  display: inline-block;
}
math-type .power-index-symbol-container > .index-value,
math-type .pre-script-symbol-container > .index-value {
  float: left;
  text-align: left;
}
math-type .power-index-symbol-container > .index-value > line,
math-type .pre-script-symbol-container > .index-value > line {
  font-size: 0.7em;
}
math-type .power-index-symbol-container > .index-value > area-container > line,
math-type .pre-script-symbol-container > .index-value > area-container > line,
math-type .power-index-symbol-container > .index-value > line,
math-type .pre-script-symbol-container > .index-value > line {
  justify-content: flex-start;
  text-align: left;
}
math-type .power-index-symbol-container > editarea-block.index-value,
math-type .pre-script-symbol-container > editarea-block.index-value,
math-type .power-index-symbol-container > editarea-line.index-value,
math-type .pre-script-symbol-container > editarea-line.index-value {
  font-size: 0.7em;
}
math-type .power-index-symbol-container > editarea-block.power-value,
math-type .pre-script-symbol-container > editarea-block.power-value,
math-type .power-index-symbol-container > editarea-line.power-value,
math-type .pre-script-symbol-container > editarea-line.power-value {
  font-size: 0.7em;
}
math-type .pre-script-symbol-container > .power-value {
  float: right;
}
math-type .pre-script-symbol-container > .index-value {
  float: right;
}
.icon-power-index-symbol {
  display: flex;
  margin: auto;
  width: 20px;
  padding-bottom: 6px;
}
.icon-power-index-symbol .square-up {
  margin-top: 4px;
}
.icon-power-index-symbol .square-down {
  margin-top: 14px;
  margin-left: -6px;
}
.icon-power-index-symbol .align-end {
  margin-top: 4px;
}
.icon-power-symbol {
  display: flex;
  margin: auto;
  width: 20px;
  padding-bottom: 6px;
}
.icon-power-symbol .square {
  margin-top: 4px;
}
.icon-power-symbol .align-end {
  margin-top: 4px;
}
.icon-index-symbol {
  display: flex;
  margin: auto;
  width: 20px;
  padding-bottom: 6px;
}
.icon-index-symbol .square {
  margin-top: 14px;
  margin-left: 0px;
}
.icon-index-symbol .align-end {
  margin-top: 4px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.matrix-like > matrix > table > tbody > tr > td {
  padding-bottom: 0.1em;
  padding-top: 0.1em;
}
.matrix-symbol.matrix-like > matrix > table > tbody > tr.hline {
  border-top: 1px solid;
}
.matrix-symbol.matrix-like > matrix > table > tbody > tr:last-child.last-hline {
  border-bottom: 1px solid;
}
.matrix-symbol {
  /* must be flex to have vertical center align , unless figure out another way */
  display: inline-flex;
  align-items: center;
}
.matrix-symbol > matrix > table > tbody > tr > td > .sbd {
  position: absolute;
  left: -1px;
  top: -1px;
  right: -1px;
  bottom: -1px;
  pointer-events: none;
  background: none;
}
.matrix-symbol.selected > matrix > table > tbody > tr > td > .sbd {
  border-top: 1px solid rgba(93, 92, 92, 0.15);
  border-left: 1px solid rgba(93, 92, 92, 0.15);
}
.matrix-symbol.selected > matrix > table > tbody > tr > td > .sbd.sbd-lr {
  border-bottom: 1px solid rgba(93, 92, 92, 0.15);
}
.matrix-symbol.selected > matrix > table > tbody > tr > td > .sbd.sbd-lc {
  border-right: 1px solid rgba(93, 92, 92, 0.15);
}
.matrix-symbol > base-line-indicator {
  height: inherit;
  margin-top: -0.18em;
}
.matrix-symbol matrixclosesymbol,
.matrix-symbol matrixopensymbol {
  font-style: normal;
  color: black;
  position: relative;
}
.matrix-symbol matrixclosesymbol > span,
.matrix-symbol matrixopensymbol > span {
  visibility: hidden;
  display: inline-block;
}
.matrix-symbol matrixclosesymbol > svg,
.matrix-symbol matrixopensymbol > svg {
  overflow: visible;
  font-size: 15px;
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
}
.matrix-symbol matrixclosesymbol > svg text,
.matrix-symbol matrixopensymbol > svg text {
  fill: black;
}
.matrix-symbol > matrix.matrix > table > tbody > tr > td {
  padding: 0 0.3em;
}
.matrix-symbol > matrix {
  display: flex;
  position: relative;
  float: left;
  align-items: flex-start;
  break-inside: avoid;
}
.matrix-symbol > matrix > svg {
  width: 0.6em;
  /*init height, willl be changed by inline style*/
  height: 3px;
  overflow: visible;
  align-self: flex-start;
}
.matrix-symbol > matrix > vcomposed-symbol {
  height: inherit;
  align-self: stretch;
}
.matrix-symbol > matrix > table {
  border: 1px solid transparent;
  border-collapse: collapse;
}
.matrix-symbol > matrix > table > tbody > tr {
  box-sizing: border-box;
}
.matrix-symbol > matrix > table > tbody > tr.smaller {
  font-size: 0.75em;
}
.matrix-symbol > matrix > table > tbody > tr > td {
  position: relative;
  border: 1px dotted transparent;
  box-sizing: border-box;
  padding: 0 0.3em;
  vertical-align: baseline;
}
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell {
  display: inline-block;
  width: 100%;
}
.matrix-symbol > matrix > table > tbody > tr > td.vline {
  border-left: 1px solid;
}
.matrix-symbol > matrix > table > tbody > tr > td:last-child.last-vline {
  border-right: 1px solid;
}
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell {
  min-width: 0.5em;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.matrix > table {
  margin-left: -0.2em;
  margin-right: -0.2em;
}
.matrix-symbol > matrix.matrix > table > tbody > tr > td > .editor-cell {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol > matrix.matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.left {
  text-align: left;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.left > area-container > line,
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.left > line {
  justify-content: flex-start;
  text-align: left;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.center {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.center > area-container > line,
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.center > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.right {
  text-align: right;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.right > area-container > line,
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.right > line {
  justify-content: flex-end;
  text-align: right;
}
.matrix-symbol > matrix.gathered > table > tbody > tr > td:nth-child(2n+3) {
  padding-left: 1em;
}
.matrix-symbol > matrix.gathered line {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td {
  padding: 0;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+3) {
  padding-left: 1em;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+1) > .editor-cell {
  text-align: right;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+1) > .editor-cell > area-container > line,
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+1) > .editor-cell > line {
  justify-content: flex-end;
  text-align: right;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n) > .editor-cell {
  text-align: left;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n) > .editor-cell > area-container > line,
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n) > .editor-cell > line {
  justify-content: flex-start;
  text-align: left;
}
.matrix-symbol > matrix > border-design {
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  display: block;
  background-color: rgba(255, 255, 255, 0.7);
  z-index: 10;
}
.matrix-symbol > matrix > border-design > border-line {
  cursor: pointer;
  position: absolute;
  /*border:1px solid gray;*/
}
.matrix-symbol > matrix > border-design > border-line > horizontal-line {
  border-top: 1px solid #eceaea;
  display: block;
  position: absolute;
  top: 50%;
  width: 100%;
  height: 1px;
  margin-top: 0;
  left: 0;
}
.matrix-symbol > matrix > border-design > border-line > vertical-line {
  border-left: 1px solid #eceaea;
  display: block;
  position: absolute;
  left: 50%;
  width: 1px;
  height: 100%;
  top: 0;
}
.matrix-symbol > matrix > border-design > border-line > vertical-line.enabled {
  border-top: 1px solid;
}
.matrix-symbol > matrix > border-design > border-line:hover > horizontal-line {
  border-top: 1px solid gray;
}
.matrix-symbol > matrix > border-design > border-line:hover > vertical-line {
  border-left: 1px solid gray;
}
.matrix-symbol > matrix > border-design > border-line.enabled > horizontal-line {
  border-top: 1px solid;
}
.matrix-symbol > matrix > border-design > border-line.enabled > vertical-line {
  border-left: 1px solid;
}
.matrix-symbol > matrix > setting {
  padding: 7px;
  position: absolute;
  top: -6px;
  font-family: "Segoe UI", Arial, Verdana, sans-serif;
  transform: translate(0, -100%);
  left: 0;
}
.matrix-symbol > matrix > setting > main-setting {
  display: flex;
  flex-direction: row;
}
.matrix-symbol > matrix > setting > main-setting styled-select {
  display: block;
  background-color: white;
}
.fa-table.array-settings {
  border: 1px solid lightgray;
  padding: 3px 5px;
  font-size: 14px;
  color: gray;
  cursor: pointer;
  /*margin-left: 5px;*/
}
.fa-table.array-settings:hover {
  color: black;
  background: white;
}
.matrix-icon {
  display: flex;
}
.matrix-icon .square {
  margin-top: 2px;
}
.matrix-icon .display-flex {
  display: flex;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td {
  padding: 0 0.2em;
}
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td.non-select,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td.non-select {
  user-select: none;
  width: 0.2em;
  padding: 0;
}
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td > .editor-cell,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td > .editor-cell {
  text-align: left;
}
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td > .editor-cell > line,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: flex-start;
  text-align: left;
}
.case-icon {
  display: flex;
  font-size: 18px;
  line-height: 18px;
}
.case-icon .square {
  margin-top: 2px;
}
.case-icon .display-flex {
  display: flex;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td {
  padding: 0 0.2em;
}
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #e0e0e0;
}
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td > .editor-cell {
  text-align: left;
}
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: flex-start;
  text-align: left;
}
.case-icon {
  display: flex;
  font-size: 18px;
  line-height: 18px;
}
.case-icon .square {
  margin-top: 2px;
}
.case-icon .display-flex {
  display: flex;
}

.array-icon .square {
  margin-top: 2px;
}
.array-icon .display-flex {
  display: flex;
}

.matrix-like.binom > .binom > table > tbody > tr > td {
  padding: 0;
}
.matrix-like.binom > .binom > table > tbody > tr > td line {
  text-align: center;
  text-align-last: auto;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.align-symbol {
  /*display flex because to make sure it's spend whole line*/
  display: flex;
  justify-content: center;
  margin-top: 10px;
  margin-bottom: 10px;
  width: 100%;
}
.matrix-symbol.align-symbol.selected {
  background-color: rgba(76, 175, 80, 0.05);
}
.matrix-symbol.align-symbol > matrix > setting > main-setting {
  margin-bottom: 0px;
}
.matrix-symbol.align-symbol > matrix > bulb {
  left: 50%;
}
.matrix-symbol.align-symbol > matrix > setting {
  margin-left: 20px;
}
.matrix-symbol.align-symbol > matrix.align {
  width: 100%;
  display: block;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td {
  padding: 0;
  vertical-align: baseline;
  border: 1px solid transparent;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell {
  /* should align start and area-container level (instead of line level)
                as for lazy rendering, we need to have exact line width */
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container {
  align-items: flex-start;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line {
  width: auto;
  text-align: left;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.align-right > .editor-cell {
  /* should align start and area-container level (instead of line level)
                as for lazy rendering, we need to have exact line width */
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.align-right > .editor-cell > area-container {
  align-items: flex-end;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.align-right > .editor-cell > area-container > line {
  width: auto;
  text-align: right;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.non-select {
  border: none;
  user-select: none;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.expand {
  width: 100%;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #e0e0e0;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell {
  min-width: 1.5em;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > tupple {
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: baseline;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.gather-symbol {
  /*display flex because to make sure it's spend whole line*/
  display: flex;
  justify-content: center;
  margin-top: 10px;
  margin-bottom: 10px;
  width: 100%;
}
.matrix-symbol.gather-symbol.selected {
  background-color: rgba(76, 175, 80, 0.05);
}
.matrix-symbol.gather-symbol > matrix.gather {
  width: 100%;
  display: block;
}
.matrix-symbol.gather-symbol > matrix > setting > main-setting {
  margin-bottom: 0px;
}
.matrix-symbol.gather-symbol > matrix > bulb {
  left: -1em;
}
.matrix-symbol.gather-symbol > matrix > setting {
  margin-left: 20px;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td {
  padding: 0;
  vertical-align: baseline;
  border: 1px solid transparent;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.non-select {
  user-select: none;
  width: 1.5em;
  border: none;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.expand {
  width: 100%;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #e0e0e0;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td line {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > .editor-cell {
  min-width: 1.5em;
  /* should align start and area-container level (instead of line level)
                as for lazy rendering, we need to have exact line width */
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container {
  align-items: center;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line {
  width: auto;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > tupple {
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: baseline;
}

math-type compositeblock.table-symbol {
  width: 100%;
  display: flex;
}
math-type compositeblock.table-symbol.cap-above {
  flex-direction: column;
}
math-type .matrix-symbol > matrix.table {
  width: 100%;
  flex-direction: column;
  align-items: stretch;
}
math-type .matrix-symbol > matrix.table > table {
  table-layout: fixed;
  border: unset;
  width: 100%;
}
math-type .matrix-symbol > matrix.table > table > tbody > tr > td {
  vertical-align: top;
  padding: 0;
  position: relative;
}
math-type .cell-border-box {
  position: absolute;
  left: -1px;
  top: -1px;
  width: 100%;
  height: 100%;
}
.table-caption > line.text-mode:first-child {
  display: inline;
}
.table-caption > line.text-mode:first-child > blocks {
  display: inline;
}

editarea.lttb.text-mode > line.text-mode > blocks {
  text-align: inherit;
}



math-type compositeblock.table-of-content {
  display: block;
  width: 100%;
}
math-type compositeblock.table-of-content > toc-wrapper {
  position: relative;
  width: 100%;
  display: block;
  cursor: default;
}
math-type compositeblock.table-of-content > toc-wrapper .toc-setting-icons {
  display: none;
  position: absolute;
  left: -65px;
  width: 70px;
  top: -20px;
  bottom: 0;
  font-size: 1em;
  z-index: 999;
  padding-top: 20px;
}
math-type compositeblock.table-of-content > toc-wrapper .toc-setting-icons > .icon-refresh,
math-type compositeblock.table-of-content > toc-wrapper .toc-setting-icons > .icon-settings {
  border: 1px solid #c3c2c2;
  padding: 0.3em;
  padding-top: 0.1em;
  line-height: 1.2;
  padding-bottom: 0;
  cursor: pointer;
  background-color: #f7f7f7;
  color: gray;
  width: 12px;
  display: inline-block;
  margin-left: 5px;
}
math-type compositeblock.table-of-content > toc-wrapper:hover .toc-setting-icons {
  display: block;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode {
  width: 100%;
  cursor: default;
  display: block;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode {
  display: block;
  width: auto;
  cursor: default;
  padding-left: 1em;
  padding-right: 15px;
  font-style: unset;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > blocks,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > blocks {
  display: block;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > prefix,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > prefix {
  display: none;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl {
  padding-left: 15px;
  padding-right: 1em;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl > a > blocks,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl > blocks {
  text-align: right;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl a > blocks > compositeblock.toc-page-number-symbol,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl > blocks > compositeblock.toc-page-number-symbol {
  float: left;
  padding-left: 0;
  margin-right: 0;
  margin-left: 0;
  padding-right: 0.5em;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > block,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > block,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > blocks > block,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode a > blocks > block {
  white-space: pre-wrap;
  white-space: break-spaces;
  cursor: pointer;
  font-style: unset;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > blocks > compositeblock.toc-page-number-symbol,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > blocks > compositeblock.toc-page-number-symbol {
  float: right;
  padding-left: 0.5em;
  margin-right: 0;
}

.icon-integral-symbol {
  margin: auto 4px auto auto;
  display: flex;
  flex-direction: row-reverse;
  font-size: 12px;
}
.icon-integral-symbol .square-up {
  border-width: 1px;
  margin-top: 0px;
}
.icon-integral-symbol .square-down {
  border-width: 1px;
  margin-top: 21px;
  margin-left: -10px;
}
.icon-integral-symbol .align-end {
  margin-top: 6px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .limit-type {
  position: relative;
}
math-type .limit-type > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  top: -1.4em;
  left: 0.6em;
  align-items: flex-start;
}
math-type .limit-type > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .limit-type > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .limit-type > .to,
math-type .limit-type > .from {
  float: left;
  clear: both;
}
math-type .limit-type > .to > line,
math-type .limit-type > .from > line,
math-type .limit-type > .to > editarea > line,
math-type .limit-type > .from > editarea > line {
  font-size: 0.7em;
}
math-type .limit-type > editarea-line,
math-type .limit-type > editarea-block {
  font-size: 0.7em;
}
math-type .limit-type > symbol {
  display: block;
  clear: both;
  pointer-events: none;
}
math-type .limit-type > symbol > span {
  white-space: nowrap;
  pointer-events: none;
}
math-type .limit-type > setting {
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  opacity: 0.5;
  opacity: 1;
  position: absolute;
  left: 50%;
  top: -2em;
  font-size: 0.6em;
  margin-left: -0.6em;
  padding: 0 0.2em;
  cursor: pointer;
}
math-type .limit-type > setting:hover {
  border-color: gray;
  opacity: 1;
}
math-type .limit-type > setting:hover {
  border: 1px solid gray;
}
math-type .limit-type > setting > i {
  transform: rotate(-60deg);
}
math-type .limit-type.limit-kind > setting > i {
  transform: rotate(45deg);
}
math-type .limit-type.limit-kind > symbol {
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > .from,
math-type .limit-type.limit-kind > .to {
  width: 100%;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > .from > line,
math-type .limit-type.limit-kind > .to > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > empty.from {
  height: 0;
  margin-top: -0.75em;
}
math-type .limit-type.limit-kind > empty.from > editarea.selected > line,
math-type .limit-type.limit-kind > empty.from > editarea-block.selected,
math-type .limit-type.limit-kind > empty.from > editarea-line.selected {
  background-color: white;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > empty.to {
  height: 0;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > empty.to > editarea.selected > line,
math-type .limit-type.limit-kind > empty.to > editarea-block.selected,
math-type .limit-type.limit-kind > empty.to > editarea-line.selected {
  background-color: white;
  text-align: center;
  text-align-last: auto;
}
math-type .integral-like-symbol.inline > symbol {
  font-size: 1em;
}
math-type .integral-like-symbol.int-ml {
  margin-left: -0.5em;
}
math-type .integral-like-symbol.oint-ml {
  margin-left: -0.3em;
}
math-type .integral-like-symbol > symbol {
  font-size: 1.5em;
}
math-type .integral-like-symbol > symbol > span {
  line-height: 1.4em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .limit-type.lim-like-symbol {
  margin-left: 0.2em;
  margin-right: 0.2em;
}
math-type .limit-type.lim-like-symbol.close-left {
  margin-left: 0;
}
math-type .limit-type.lim-like-symbol.close-right {
  margin-right: 0;
}
math-type .limit-type.lim-like-symbol.limit-kind > empty.from > editarea {
  margin-top: -0.4em;
}
math-type .lim-like-symbol > add {
  left: 50%;
  top: -1em;
}
math-type .lim-like-symbol > symbol.inf {
  text-decoration: underline;
}
math-type .lim-like-symbol > symbol.sup {
  text-decoration: overline;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from,
math-type .lim-like-symbol.non-limit-kind > editarea.to {
  margin-left: 1.47em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-lim,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-lim {
  margin-left: 1.5435em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-liminf,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-liminf {
  margin-left: 3.15em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-limsup,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-limsup {
  margin-left: 3.528em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-sup,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-sup {
  margin-left: 1.6905em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-varlimsup,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-varlimsup {
  margin-left: 1.5435em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to {
  margin-left: 2.072em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-lim,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-lim {
  margin-left: 2.1756em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-liminf,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-liminf {
  margin-left: 4.44em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-limsup,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-limsup {
  margin-left: 4.9728em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-sup,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-sup {
  margin-left: 2.3828em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-varlimsup,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-varlimsup {
  margin-left: 2.1756em;
}



/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .limit-type.summation-like-symbol.limit-kind > empty.from {
  margin-top: -0.3em;
}
math-type .limit-type.summation-like-symbol.limit-kind > empty.from > editarea,
math-type .limit-type.summation-like-symbol.limit-kind > empty.from > editarea-block {
  margin-top: -0.2em;
}
math-type .summation-like-symbol.inline > add {
  top: -1.1em;
}
math-type .summation-like-symbol.inline > symbol {
  font-size: 1em;
}
math-type .summation-like-symbol.inline > symbol > span {
  vertical-align: 0.15em;
}
math-type .summation-like-symbol {
  padding-right: 0.15em;
}
math-type .summation-like-symbol > symbol {
  font-size: 1.5em;
}
math-type .summation-like-symbol > symbol > span {
  vertical-align: 0.1em;
  line-height: 1.4em;
}
math-type .summation-like-symbol > add {
  top: -1.5em;
}
math-type .summation-like-symbol > .custom-symbol {
  font-weight: bold;
}

hcomposed-symbol {
  display: flex;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
hcomposed-symbol > start {
  display: block;
  float: left;
  overflow: hidden;
}
hcomposed-symbol > middle {
  display: block;
  flex-grow: 1;
  white-space: nowrap;
  position: relative;
  overflow: hidden;
}
hcomposed-symbol > middle > fixed {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
}
hcomposed-symbol > middle > fixed > inside {
  display: inline-block;
  overflow: hidden;
}
hcomposed-symbol > end {
  display: block;
  overflow: hidden;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .arrow-like-symbol {
  padding: 0 0.2em;
}
math-type .arrow-like-symbol > arrow-like-simple > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  left: 0.8em;
  top: -0.7em;
}
math-type .arrow-like-symbol > arrow-like-simple > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .arrow-like-symbol > arrow-like-simple > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .arrow-like-symbol > middle {
  display: block;
  text-align: center;
  text-align-last: auto;
  clear: both;
  width: 100%;
  position: relative;
}
math-type .arrow-like-symbol > middle > inside {
  display: inline-block;
  height: 0.55em;
  width: 100%;
}
math-type .arrow-like-symbol > middle > inside > hcomposed-symbol {
  position: absolute;
  top: 0.4em;
  left: 0;
}
math-type .arrow-like-symbol > editarea.sright-1 {
  padding-left: 0.55em;
  padding-right: 0.25em;
}
math-type .arrow-like-symbol > editarea.sleft-1 {
  padding-left: 0.25em;
  padding-right: 0.55em;
}
math-type .arrow-like-symbol > editarea.small-margin {
  padding-left: 0.4em;
  padding-right: 0.4em;
}
math-type .arrow-like-symbol > editarea.large-padding {
  margin: 0 1.3em;
}
math-type .arrow-like-symbol > editarea > line {
  font-size: 0.7em;
}
math-type .arrow-like-symbol > .top {
  float: left;
  width: 100%;
  clear: both;
  margin-bottom: -0.5em;
  z-index: 1;
  position: relative;
}
math-type .arrow-like-symbol > .top.space-1,
math-type .arrow-like-symbol > .top.up-space-1-lower-space-2 {
  margin-bottom: -0.4em;
}
math-type .arrow-like-symbol > .bottom {
  margin-top: -0.45em;
  float: left;
  width: 100%;
}
math-type .arrow-like-symbol > .bottom.space-1,
math-type .arrow-like-symbol > .bottom.lower-space-1 {
  margin-top: -0.35em;
}
math-type .arrow-like-symbol > .bottom.space-2,
math-type .arrow-like-symbol > .bottom.up-space-1-lower-space-2 {
  margin-top: -0.25em;
}

.over-icon {
  margin: auto;
  width: 12px;
  font-size: 13px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-arrow-symbol > arrow-symbol {
  display: block;
  margin-right: -0.05em;
  position: relative;
}
math-type .over-arrow-symbol > arrow-symbol > hcomposed-symbol {
  position: absolute;
}
math-type .over-arrow-symbol > arrow-symbol > arrow-wrapper {
  margin-right: -0.2em;
}
math-type .over-arrow-symbol > editarea {
  display: inline-flex;
  text-align: center;
  text-align-last: auto;
}
math-type .over-arrow-symbol > editarea > area-container > line,
math-type .over-arrow-symbol > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type .over-arrow-symbol > editarea-block {
  min-width: 0.5em;
  text-align: center;
  text-align-last: auto;
  display: inline-block;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-line-symbol {
  margin-left: 0.05em;
  margin-right: 0.05em;
}
math-type .over-line-symbol > editarea {
  display: inline-flex;
  min-width: 0.5em;
}
math-type .over-line-symbol > editarea-line {
  min-width: 0.5em;
  display: inline-block;
  text-align: center;
  text-align-last: auto;
}
math-type .over-line-symbol > line-border {
  display: block;
  position: relative;
}
math-type .over-line-symbol > line-border > hcomposed-symbol {
  position: absolute;
}
math-type .over-line-symbol > line-border > svg {
  position: absolute;
  width: 100%;
  height: 100%;
}

brace-top-wrapper {
  display: flex;
  flex-direction: row;
  height: 100%;
  font-family: Asana-Math, Asana;
}
brace-top-wrapper > middle-wrapper {
  flex-grow: 1;
  position: relative;
  overflow: hidden;
}
brace-top-wrapper > middle-wrapper > fixed {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
}
brace-top-wrapper > middle-wrapper > fixed > middle-inside {
  overflow: hidden;
}
brace-top-wrapper first,
brace-top-wrapper middle,
brace-top-wrapper last {
  overflow: hidden;
  position: relative;
}
brace-top-wrapper first {
  min-width: 0.7em;
  width: 0.7em;
}
brace-top-wrapper > middle {
  min-width: 0.6em;
  width: 0.6em;
}
brace-top-wrapper > last {
  min-width: 0.7em;
  width: 0.7em;
}
bracket-top-wrapper {
  display: flex;
  flex-direction: column;
  width: 100%;
  font-family: Asana-Math, Asana;
}
bracket-top-wrapper > first,
bracket-top-wrapper middle,
bracket-top-wrapper last {
  overflow: hidden;
  position: relative;
}
bracket-top-wrapper > first {
  height: 0.5em;
  min-height: 0.5em;
}
bracket-top-wrapper middle-wrapper {
  flex-grow: 1;
  position: relative;
  overflow: hidden;
}
bracket-top-wrapper middle-wrapper > fixed {
  overflow: hidden;
  position: absolute;
  left: 0;
  top: 0;
}
bracket-top-wrapper middle-wrapper > fixed > middle {
  display: block;
  overflow: hidden;
}
bracket-top-wrapper > last {
  height: 0.65em;
  min-height: 0.65em;
}
parenthesis-top-wrapper {
  display: flex;
  flex-direction: column;
  width: 100%;
  font-family: Asana-Math, Asana;
}
parenthesis-top-wrapper > first,
parenthesis-top-wrapper middle,
parenthesis-top-wrapper last {
  overflow: hidden;
  position: relative;
  height: 1em;
  min-height: 1em;
}
parenthesis-top-wrapper > first {
  min-height: 0.9em;
  height: 0.9em;
}
parenthesis-top-wrapper middle-wrapper {
  flex-grow: 1;
  position: relative;
  overflow: hidden;
}
parenthesis-top-wrapper middle-wrapper > fixed {
  position: absolute;
  top: 0;
  left: 0;
}
parenthesis-top-wrapper middle-wrapper > fixed > middle {
  display: block;
  overflow: hidden;
}
parenthesis-top-wrapper > last {
  min-height: 1em;
  height: 1em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-brace-symbol {
  position: relative;
}
math-type .over-brace-symbol > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  top: -1.5em;
  margin-left: -0.6em;
}
math-type .over-brace-symbol > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .over-brace-symbol > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .over-brace-symbol > top-brace {
  pointer-events: none;
  display: block;
  min-width: 1.1em;
  position: relative;
  clear: both;
  margin-bottom: -0.1em;
  font-style: normal;
  font-weight: normal;
}
math-type .over-brace-symbol > top-brace > brace-top-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  left: 50%;
  transform: translate(-50%, 0);
}
math-type .over-brace-symbol > editarea {
  display: inline-flex;
  width: 100%;
  align-self: center;
  clear: both;
}
math-type .over-brace-symbol > editarea.overValue {
  font-size: 0.7em;
  float: left;
  width: 100%;
  margin-bottom: 0.1em;
}

.icon-hat {
  margin: auto;
  width: 12px;
  font-size: 12px;
}
.icon-hat .square {
  margin-top: -3px;
}

.under-arc-symbol {
  display: inline-block;
}
.under-arc-symbol > editarea {
  display: inline-flex;
}
.under-arc-symbol > symbol {
  display: block;
  width: 100%;
  position: relative;
}
.under-arc-symbol > symbol > svg {
  position: absolute;
  left: 0;
  top: 0;
  display: block;
  width: 100%;
  height: 100%;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .under-line-symbol > editarea {
  display: inline-flex;
}
math-type .under-line-symbol > line-border {
  display: block;
  position: relative;
  float: left;
  width: 100%;
}
math-type .under-line-symbol > line-border > svg {
  position: absolute;
  width: 100%;
  height: 100%;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.under-brace-symbol {
  display: inline-flex;
  flex-flow: column;
  position: relative;
}
math-type compositeblock.under-brace-symbol > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  top: 3em;
}
math-type compositeblock.under-brace-symbol > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type compositeblock.under-brace-symbol > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type compositeblock.under-brace-symbol > bottom-brace {
  pointer-events: none;
  display: block;
  position: relative;
  min-width: 1.3em;
  font-style: normal;
  font-weight: normal;
}
math-type compositeblock.under-brace-symbol > bottom-brace > brace-top-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  left: 50%;
  transform: translate(-50%, 0);
}
math-type compositeblock.under-brace-symbol > editarea {
  margin-left: 0.15em;
  margin-right: 0.15em;
  align-self: center;
}
math-type compositeblock.under-brace-symbol > editarea.underValue {
  font-size: 0.7em;
}
.under-brace-icon {
  width: 12px;
  margin: auto;
  font-size: 12px;
}
.under-brace-icon .brace-wrapper {
  margin-top: -14px;
}


math-type .operator-name > editarea {
  margin-left: 0.2em;
  margin-right: 0.2em;
  display: inline-flex;
}
math-type .operator-name > editarea.close-left {
  margin-left: 0;
}
math-type .operator-name > editarea.close-right {
  margin-right: 0;
}

.math-group > editarea {
  float: left;
}
.group-icon .rectangle {
  width: 23px;
  height: 12px;
  border-style: solid;
  border-width: 1px;
  text-align: center;
  border-color: gray;
  font-family: fantasy;
  color: black;
  padding-top: 1px;
  font-size: 9px;
  line-height: 14px;
  vertical-align: middle;
  margin: auto;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.over-symbol {
  position: relative;
}
math-type compositeblock.over-symbol > symbol {
  font-family: Asana-Math, Asana, Arial;
  height: 8em;
  display: block;
  text-align: center;
  text-align-last: auto;
  position: relative;
}
math-type compositeblock.over-symbol > symbol > inner {
  display: block;
  position: absolute;
  text-align: center;
  text-align-last: auto;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}
math-type compositeblock.over-symbol > symbol.dot > inner.left-sign,
math-type compositeblock.over-symbol > symbol.ring > inner.left-sign {
  transform: translate(-0.07em, 0);
}
math-type compositeblock.over-symbol > symbol.dot > inner.right-sign,
math-type compositeblock.over-symbol > symbol.ring > inner.right-sign {
  transform: translate(0.2em, 0);
}
math-type compositeblock.over-symbol > symbol.dot > inner,
math-type compositeblock.over-symbol > symbol.ring > inner {
  transform: translate(0.05em, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner.left-sign,
math-type compositeblock.over-symbol > symbol.small-tilde > inner.left-sign {
  transform: translate(-0.04em, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner.right-sign,
math-type compositeblock.over-symbol > symbol.small-tilde > inner.right-sign {
  transform: translate(0.15em, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner.ignore-shift,
math-type compositeblock.over-symbol > symbol.small-tilde > inner.ignore-shift {
  transform: translate(0, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner,
math-type compositeblock.over-symbol > symbol.small-tilde > inner {
  transform: translate(0.05em, 0);
}
math-type compositeblock.over-symbol > symbol.acute > inner.left-sign {
  transform: translate(-0.04em, 0);
}
math-type compositeblock.over-symbol > symbol.acute > inner.right-sign {
  transform: translate(0.25em, 0);
}
math-type compositeblock.over-symbol > symbol.acute > inner {
  transform: translate(0.1em, 0);
}
math-type compositeblock.over-symbol > symbol.grave,
math-type compositeblock.over-symbol > symbol.breve,
math-type compositeblock.over-symbol > symbol.acute {
  font-family: 'Times New Roman', Times, serif;
}
math-type compositeblock.over-symbol > symbol.grave > inner.left-sign,
math-type compositeblock.over-symbol > symbol.breve > inner.left-sign,
math-type compositeblock.over-symbol > symbol.check > inner.left-sign {
  transform: translate(-0.07em, 0);
}
math-type compositeblock.over-symbol > symbol.grave > inner.right-sign,
math-type compositeblock.over-symbol > symbol.breve > inner.right-sign,
math-type compositeblock.over-symbol > symbol.check > inner.right-sign {
  transform: translate(0.17em, 0);
}
math-type compositeblock.over-symbol > symbol.ddddot {
  min-width: 0.9em;
}
math-type compositeblock.over-symbol > symbol.dddot {
  min-width: 0.7em;
}

.math-xx > editarea {
  float: left;
}

math-type .big-delimiter-symbol {
  display: inline-flex;
  align-items: center;
  position: relative;
  margin: 0.1em 0;
}
math-type .big-delimiter-symbol big-delimiter.big-open {
  margin-left: 0.09em;
}
math-type .big-delimiter-symbol big-delimiter.big-close {
  margin-right: 0.07em;
}
math-type .big-delimiter-symbol > base-line-indicator {
  height: inherit;
}
math-type .big-delimiter-symbol > big-delimiter > svg {
  height: 100%;
  width: 100%;
}
math-type .big-delimiter-symbol > big-delimiter > bulb {
  left: -10px;
}
math-type .big-delimiter-symbol > big-delimiter > setting {
  width: 158px;
  display: flex;
  position: absolute;
  left: 0;
  top: -40px;
}
math-type .big-delimiter-symbol > big-delimiter > setting > .select-box-container {
  margin-right: 4px;
}
math-type .big-delimiter-symbol > big-delimiter > setting > .select-box-container:last-child {
  margin-right: 0px;
}

select-buttons {
  font-size: 13px;
  color: gray;
  display: block;
}
select-buttons > sb-item {
  display: inline-block;
  padding: 2px 2px;
  cursor: pointer;
  border: 1px solid transparent;
  /*box-sizing: border-box;*/
}
select-buttons > sb-item.selected {
  background-color: white;
  border: 1px solid lightgray;
}
select-buttons > sb-item:hover {
  border: 1px solid lightgray;
}
select-buttons > sb-item.disabled {
  opacity: 0.3;
  cursor: default;
  border: 1px solid transparent;
}
select-buttons > sb-item.disabled:hover {
  background-color: inherit;
  border: 1px solid transparent;
}

tabs-container tab-item {
  color: gray;
}
tabs-container tab-item:hover {
  color: black;
}

expandable-component.button-action {
  cursor: pointer;
  color: gray;
  fill: gray;
}
expandable-component.button-action:hover,
expandable-component.button-action.selected {
  color: black;
  fill: black;
}
expandable-component.button-action:hover label-display,
expandable-component.button-action.selected label-display {
  border: 1px solid #e2e0e0;
}
expandable-component.button-action label-display {
  font-size: 12px;
  padding-top: 5px;
  display: flex;
  border: 1px solid transparent;
  padding-left: 2px;
  padding-right: 2px;
  margin-top: 0px;
  padding-bottom: 4px;
  cursor: pointer;
}
expandable-component.button-action label-display > i {
  padding-left: 5px;
  padding-top: 1px;
}
expandable-component.button-action label-item-container > label-item:hover {
  background-color: #bfe4bd;
}
expandable-component.button-action label-item-container > label-item.ignore-select {
  background-color: inherit;
  cursor: default;
}
expandable-component.button-action.button-style label-display {
  background: white;
  border: 1px solid lightgray;
}
expandable-component.button-action.button-style:hover,
expandable-component.button-action.button-style.selected {
  color: gray;
}
expandable-component.button-action.button-style:hover label-display,
expandable-component.button-action.button-style.selected label-display {
  background: #f7f6f6;
}

g.group-box-move {
  opacity: 0.2;
}
g.group-box-move:hover {
  opacity: 0.8;
}




.math-diagram .intersections-group {
  stroke-width: 2px;
  stroke: black;
  fill: transparent;
  cursor: move;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.math-diagram > math-diagram {
  background: white;
}
math-type compositeblock.math-diagram {
  cursor: default;
  width: 100%;
  /** display block as if inline block, it will be disapear in some cases*/
  display: block;
}
math-type compositeblock.math-diagram .connection-point {
  cursor: crosshair;
}
math-type compositeblock.math-diagram .connection-point g {
  fill-opacity: 0.6;
}
math-type compositeblock.math-diagram .connection-point:hover g {
  fill-opacity: 1;
}
math-type compositeblock.math-diagram .text-diagram-editor editarea.text-mode.non-wrap > line.text-mode {
  font-size: unset;
}
math-type compositeblock.math-diagram .text-diagram-editor editarea.text-mode.non-wrap > line.text-mode > block {
  white-space: pre;
}
math-type compositeblock.math-diagram .text-diagram-editor editarea.text-mode.non-wrap > line.text-mode > blocks > block {
  white-space: pre;
}
math-type compositeblock.math-diagram > math-diagram {
  border: 1px solid transparent;
}
math-type compositeblock.math-diagram > math-diagram > clip-region > zoom-region {
  display: block;
  width: 100%;
  height: 100%;
}
math-type compositeblock.math-diagram > math-diagram > clip-region > zoom-region > svg {
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}
math-type compositeblock.math-diagram .add-label {
  fill: gray;
}
math-type compositeblock.math-diagram .add-label:hover {
  fill: black;
}
math-type compositeblock.math-diagram .diagram-editor {
  margin: 0 2px;
}
math-type compositeblock.math-diagram .control-point-guide {
  stroke: lightgray;
  stroke-width: 0.5px;
  pointer-events: none;
}
math-type compositeblock.math-diagram .connection-group {
  stroke: black;
  fill: none;
}
math-type compositeblock.math-diagram .arrow-line {
  cursor: move;
}
math-type compositeblock.math-diagram .mobile-tablet .shape .transparent,
math-type compositeblock.math-diagram .mobile-tablet .composite-shape .transparent {
  stroke-width: 10px;
}
math-type compositeblock.math-diagram .shape,
math-type compositeblock.math-diagram .composite-shape {
  stroke-width: 1px;
  fill: none;
  cursor: move;
}
math-type compositeblock.math-diagram .shape .transparent,
math-type compositeblock.math-diagram .composite-shape .transparent {
  pointer-events: visiblePainted;
  stroke-width: 6px;
  stroke: transparent;
  stroke-dasharray: none;
  fill: none;
}
math-type compositeblock.math-diagram .mobile-tablet .connection.transparent,
math-type compositeblock.math-diagram .mobile-tablet .connection.transparent > line,
math-type compositeblock.math-diagram .mobile-tablet .connection.transparent > path {
  stroke-width: 10px;
}
math-type compositeblock.math-diagram .connection {
  stroke-width: 1px;
  fill: none;
  cursor: move;
}
math-type compositeblock.math-diagram .connection.transparent,
math-type compositeblock.math-diagram .connection.transparent > line,
math-type compositeblock.math-diagram .connection.transparent > path {
  pointer-events: visiblePainted;
  stroke-width: 6px;
  stroke: transparent;
  stroke-dasharray: none;
  fill: none;
}
math-type compositeblock.math-diagram .frame {
  stroke-width: 1px;
  fill: transparent;
}
math-type math-diagram {
  display: block;
  position: relative;
  width: 100%;
  height: 300px;
}
math-type math-diagram position-container {
  position: absolute;
  width: 1px;
  height: 1px;
  display: block;
}
math-type math-diagram dg-editor-container {
  position: absolute;
  min-width: 0.85em;
  border-collapse: border-box;
}
math-type math-diagram coverlayer {
  position: absolute;
  background: transparent;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  z-index: 2;
  cursor: move;
}
math-type math-diagram connection-point {
  position: absolute;
  display: block;
  height: 6px;
  width: 6px;
  background: lightgray;
  border: 1px solid gray;
  bottom: -10px;
  left: 50%;
  margin-left: -3px;
  cursor: e-resize;
}
math-type .diagram-caption > line.text-mode:first-child {
  display: inline;
}
math-type .diagram-caption > line.text-mode:first-child > blocks {
  display: inline;
}


.plot-input-style-settings {
  opacity: 0.5;
}
.plot-input-style-settings:hover {
  opacity: 1;
}

.psa-cn .ps-hint {
  opacity: 0;
  transition: opacity 0.3s linear;
}
.psa-cn:hover .ps-hint {
  opacity: 0.6;
}

.role-toolbar-wrapper.dg-full-view tool-bar too-bar-container {
  justify-content: start;
  width: auto;
  min-width: 0;
}
.role-toolbar-wrapper.dg-full-view diagram-settings {
  width: auto;
}

.dg-items-bar-container item {
  display: inline-block;
  padding: 3px;
  fill: gray;
  stroke: gray;
}
.dg-items-bar-container item,
.dg-items-bar-container item-option {
  border: 1px transparent solid;
}
.dg-items-bar-container item:hover,
.dg-items-bar-container item-option:hover {
  border: 1px #c4c1c1 solid;
  background: white;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.theorem {
  display: block;
}
math-type compositeblock.theorem.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type theorem-name {
  min-width: 20px;
  display: inline;
}
math-type theorem-name > line.text-mode:first-child {
  display: inline;
}
math-type editarea.text-mode.edit-theorem-content {
  min-width: 100px;
  display: inline;
  font-style: italic;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode:first-child {
  display: inline;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode:first-child > blocks {
  display: inline;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode > block {
  font-style: italic;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode > blocks > block {
  font-style: italic;
}
math-type editarea.text-mode.edit-theorem-content.normal > line.text-mode > block {
  font-style: normal;
}
math-type editarea.text-mode.edit-theorem-content.normal > line.text-mode > blocks > block {
  font-style: normal;
}
math-type editarea.text-mode.edit-theorem-content .qed-symbol {
  line-height: 1em;
}
.deletable {
  cursor: pointer;
}
.deletable:hover {
  color: red;
}

.regular-checkbox:hover {
  background-color: #f3f2f2;
}

@media print {
  code[class*="language-"],
  pre[class*="language-"] {
    text-shadow: none !important;
  }
}
math-type .code-section prefix.code-line-number {
  color: #a9a7a7;
  width: 2.5em;
  display: inline-block;
  flex-shrink: 0;
}
math-type .code-section prefix.code-line-number.prefix-l10 {
  width: 1.5em;
}
math-type .code-section prefix.code-line-number.prefix-l100 {
  width: 2em;
}
math-type .code-section .code-line-blocks-container {
  white-space: pre-wrap;
  white-space: break-spaces;
}
math-type .code-section .code-line-blocks-container block.token {
  white-space: pre-wrap;
  white-space: break-spaces;
}
math-type .code-section line.text-mode.code-section-line {
  display: flex;
  flex-direction: row;
  line-height: 1.5;
}

/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */
.code-section.theme-default editarea {
  color: black;
}
.code-section.theme-default .token.comment,
.code-section.theme-default .token.prolog,
.code-section.theme-default .token.doctype,
.code-section.theme-default .token.cdata {
  color: slategray;
}
.code-section.theme-default .token.punctuation {
  color: #999;
}
.code-section.theme-default .namespace {
  opacity: 0.7;
}
.code-section.theme-default .token.property,
.code-section.theme-default .token.tag,
.code-section.theme-default .token.boolean,
.code-section.theme-default .token.number,
.code-section.theme-default .token.constant,
.code-section.theme-default .token.symbol,
.code-section.theme-default .token.deleted {
  color: #905;
}
.code-section.theme-default .token.selector,
.code-section.theme-default .token.attr-name,
.code-section.theme-default .token.string,
.code-section.theme-default .token.char,
.code-section.theme-default .token.builtin,
.code-section.theme-default .token.inserted {
  color: #690;
}
.code-section.theme-default .token.operator,
.code-section.theme-default .token.entity,
.code-section.theme-default .token.url,
.code-section.theme-default .language-css .token.string,
.code-section.theme-default .style .token.string {
  color: #9a6e3a;
}
.code-section.theme-default .token.atrule,
.code-section.theme-default .token.attr-value,
.code-section.theme-default .token.keyword {
  color: #07a;
}
.code-section.theme-default .token.function,
.code-section.theme-default .token.class-name {
  color: #DD4A68;
}
.code-section.theme-default .token.regex,
.code-section.theme-default .token.important,
.code-section.theme-default .token.important1,
.code-section.theme-default .token.variable {
  color: #e90;
}
.code-section.theme-default .token.important,
.code-section.theme-default .token.bold,
.code-section.theme-default .token.bold1 {
  font-weight: bold;
}
.code-section.theme-default .token.italic,
.code-section.theme-default .token.italic1 {
  font-style: italic;
}
.code-section.theme-default .token.entity {
  cursor: help;
}

/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */
.code-section.theme-tomorrow-night {
  /**
 * prism.js tomorrow night eighties for JavaScript, CoffeeScript, CSS and HTML
 * Based on https://github.com/chriskempson/tomorrow-theme
 * @author Rose Pritchard
 */
}
.code-section.theme-tomorrow-night editarea {
  caret-color: #ccc;
}
.code-section.theme-tomorrow-night editarea {
  color: #ccc;
}
.code-section.theme-tomorrow-night .token.comment,
.code-section.theme-tomorrow-night .token.block-comment,
.code-section.theme-tomorrow-night .token.prolog,
.code-section.theme-tomorrow-night .token.doctype,
.code-section.theme-tomorrow-night .token.cdata {
  color: #999;
}
.code-section.theme-tomorrow-night .token.punctuation {
  color: #ccc;
}
.code-section.theme-tomorrow-night .token.tag,
.code-section.theme-tomorrow-night .token.attr-name,
.code-section.theme-tomorrow-night .token.namespace,
.code-section.theme-tomorrow-night .token.deleted {
  color: #e2777a;
}
.code-section.theme-tomorrow-night .token.function-name {
  color: #6196cc;
}
.code-section.theme-tomorrow-night .token.boolean,
.code-section.theme-tomorrow-night .token.number,
.code-section.theme-tomorrow-night .token.function {
  color: #f08d49;
}
.code-section.theme-tomorrow-night .token.property,
.code-section.theme-tomorrow-night .token.class-name,
.code-section.theme-tomorrow-night .token.constant,
.code-section.theme-tomorrow-night .token.symbol {
  color: #f8c555;
}
.code-section.theme-tomorrow-night .token.selector,
.code-section.theme-tomorrow-night .token.important,
.code-section.theme-tomorrow-night .token.important1,
.code-section.theme-tomorrow-night .token.atrule,
.code-section.theme-tomorrow-night .token.keyword,
.code-section.theme-tomorrow-night .token.builtin {
  color: #cc99cd;
}
.code-section.theme-tomorrow-night .token.string,
.code-section.theme-tomorrow-night .token.char,
.code-section.theme-tomorrow-night .token.attr-value,
.code-section.theme-tomorrow-night .token.regex,
.code-section.theme-tomorrow-night .token.variable {
  color: #7ec699;
}
.code-section.theme-tomorrow-night .token.operator,
.code-section.theme-tomorrow-night .token.entity,
.code-section.theme-tomorrow-night .token.url {
  color: #67cdcc;
}
.code-section.theme-tomorrow-night .token.important,
.code-section.theme-tomorrow-night .token.bold,
.code-section.theme-tomorrow-night .token.bold1 {
  font-weight: bold;
}
.code-section.theme-tomorrow-night .token.italic,
.code-section.theme-tomorrow-night .token.italic1 {
  font-style: italic;
}
.code-section.theme-tomorrow-night .token.entity {
  cursor: help;
}
.code-section.theme-tomorrow-night .token.inserted {
  color: green;
}

editor-container > math-type.dark-mode {
  background: #1e1e1e;
}
math-type.dark-mode {
  background: #1e1e1e;
}
math-type.dark-mode.math-type-for-print {
  -webkit-print-color-adjust: exact;
}
math-type.dark-mode editarea.root-editor {
  color: #e0e0e0;
  fill: #e0e0e0;
  stroke: #e0e0e0;
  border-color: #e0e0e0;
}
math-type.dark-mode editarea.root-editor {
  background: #1e1e1e;
}
math-type.dark-mode .math-container-symbol.selected,
math-type.dark-mode .math-container-symbol.display.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.gather-symbol.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.align-symbol.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.align-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.matrix-like.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.matrix-like > matrix > table > tbody > tr.selected:not(.hline) {
  border-top: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.matrix-like > matrix > table > tbody > tr:last-child.selected {
  border-bottom: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol > matrix > table > tbody > tr > td.selected:not(.vline) {
  border-left: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol > matrix > table > tbody > tr > td:last-child.selected {
  border-right: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.case-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #525252;
}
math-type.dark-mode selection-wrapper > selection {
  background-color: rgba(33, 150, 243, 0.25);
}
math-type.dark-mode selection-wrapper.inactive > selection {
  background-color: rgba(255, 255, 255, 0.27);
}
math-type.dark-mode editarea.selected {
  outline: 1px solid rgba(177, 174, 174, 0.3);
}
math-type.dark-mode compositeblock.math-diagram > math-diagram {
  background: #1e1e1e;
}
container-layer.dark-mode editor-container {
  background: #1e1e1e;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
editor-container > math-type {
  background: white;
  outline: 1px solid lightgray;
}
math-type {
  display: block;
  position: relative;
  padding: 20px;
  color: black;
  padding-top: 15px;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  outline: none;
  cursor: text;
  text-align: initial;
}
math-type .rcnt {
  color: white;
  font-size: 12px;
  position: -webkit-sticky;
  position: sticky;
  top: 0;
  bottom: 0;
  display: flex;
  flex-direction: row;
}
math-type > .mt-sa {
  position: absolute;
  top: 0;
  left: -100px;
  right: -100px;
  bottom: -400px;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  pointer-events: none;
}
math-type.math-only compositeblock.math-container-symbol {
  width: 100%;
}
math-type.math-only compositeblock.math-container-symbol.selected {
  outline: none;
  background: none;
}
math-type.math-only compositeblock.math-container-symbol > editarea {
  width: 100%;
}
math-type.math-only compositeblock.math-container-symbol > editarea > line {
  justify-content: flex-start;
}
math-type > input:not([type]),
math-type input[type="text"] {
  width: 50px;
}
math-type composition-indicator {
  display: block;
  position: absolute;
  height: 2px;
  min-width: 2px;
  border-bottom: 2px solid gray;
  left: 0;
  top: 0;
}
math-type .focus-element {
  outline: none;
  overflow: hidden;
  width: 0px;
  height: 0px;
  top: 0px;
  left: 0px;
  display: block;
  position: absolute;
  font-size: 40px;
}
.scroll-without-scrollbar {
  scrollbar-width: none;
  /* Firefox */
  -ms-overflow-style: none;
  /* IE 10+ */
}
.scroll-without-scrollbar::-webkit-scrollbar {
  width: 0;
  height: 0;
  display: none;
}
#root,
.main-container {
  width: 100%;
  color: #212121;
}
.sub-text-cursor,
.text-cursor {
  position: absolute;
  color: green;
  /*font-size: 1.2em;*/
  pointer-events: none;
  border-left: 2px solid green;
  display: block;
  top: 0px;
  left: 0px;
  z-index: 10;
}
.sub-text-cursor {
  opacity: 0.4;
}
math-edit-container {
  display: block;
  outline: none;
  position: relative;
  font-family: 'Asana';
}
.root-editor {
  min-height: 500px;
  box-sizing: border-box;
}
.root-editor.restricted-view {
  min-height: unset;
}
.root-editor.test-view {
  min-height: 100px;
}
.menu {
  color: #ffffff;
  text-transform: uppercase;
  text-decoration: none;
  font-family: "HelveticaNeue-Medium", sans-serif;
  font-size: 14px;
  display: inline-block;
  transform: scale(1, 1.5);
  -webkit-transform: scale(1, 1.5);
  /* Safari and Chrome */
  -moz-transform: scale(1, 1.5);
  /* Firefox */
  -ms-transform: scale(1, 1.5);
  /* IE 9+ */
  -o-transform: scale(1, 1.5);
  /* Opera */
}
.setting-group-options {
  font-size: 13px;
  color: gray;
  fill: gray;
}
.setting-group-options > i,
.setting-group-options > svg.icon {
  padding: 3px;
  cursor: pointer;
  border: 1px solid transparent;
  /*box-sizing: border-box;*/
}
.setting-group-options > i.selected,
.setting-group-options > svg.icon.selected {
  background-color: white;
  border: 1px solid lightgray;
}
.setting-group-options > i:hover,
.setting-group-options > svg.icon:hover {
  border: 1px solid lightgray;
}
.setting-group-options > i.disabled,
.setting-group-options > svg.icon.disabled {
  opacity: 0.3;
}
.setting-group-options > i.disabled:hover,
.setting-group-options > svg.icon.disabled:hover {
  background-color: inherit;
  border: 1px solid transparent;
}
math-type .math-text,
math-type .normal-text,
math-type .raw-latex {
  font-family: arial, verdana, geneva, lucida, 'lucida grande', arial, helvetica, sans-serif;
}
math-type .math-text editarea.text-mode > line.text-mode > blocks > block,
math-type .normal-text editarea.text-mode > line.text-mode > blocks > block,
math-type .raw-latex editarea.text-mode > line.text-mode > blocks > block {
  white-space: nowrap;
}
.mt-common-dialog {
  box-shadow: 1px 1px 1px 0px #e0dddd;
  background-color: #f7f7f7;
  border: 1px lightgray solid;
  z-index: 14;
  padding: 6px;
  cursor: default;
  font-family: "Segoe UI", Arial, Verdana, sans-serif;
}
disabled-layer {
  display: block;
  position: absolute;
  left: 0;
  top: 1px;
  right: 0;
  bottom: 2px;
  background: rgba(247, 247, 247, 0.66);
  /** consider export button z-index when change this one*/
  z-index: 500;
}
math-type tag-container tag-select-wrapper {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}
math-type tag-container tag-box-select {
  position: absolute;
  display: block;
  background-color: green;
  opacity: 0;
  cursor: pointer;
  z-index: 15;
}
math-type tag-container tag-box-select:hover {
  opacity: 0.2;
}
math-type tag-container tag-box-gap {
  position: absolute;
  display: block;
  background-color: white;
  opacity: 0.9;
  z-index: 15;
}
.setting-popup-zindex {
  z-index: 11;
}
svg.selectable {
  cursor: pointer;
  border: 1px solid transparent;
}
svg.selectable.selected {
  background: white;
  border: solid 1px lightgray;
}
svg.selectable:hover {
  border: solid 1px lightgray;
}


@media print {
  @page {
    margin: 0;
  }
  /**
    Convert Preview into main print area
    */
  .math-type-doc,
  .docs-container,
  .modal-dialog-root-container,
  instructions-container {
    display: none !important;
  }
  .print-preview-container {
    position: static !important;
    display: block !important;
    visibility: visible !important;
    width: auto !important;
    height: auto !important;
    z-index: 99999 !important;
  }
  .print-container {
    position: static !important;
    overflow: hidden;
  }
  .print-preview-controls-container {
    display: none !important;
  }
  .math-type-no-print {
    display: none !important;
  }
  area-container.print-page-level {
    margin-left: 0 !important;
    margin-top: 0 !important;
    margin-right: 0 !important;
    margin-bottom: 0 !important;
    border: none !important;
    border-left: none !important;
    border-top: none !important;
    border-right: none !important;
    border-bottom: none !important;
    break-inside: avoid !important;
  }
  .area-container-border {
    border: none !important;
    border-left: none !important;
    border-top: none !important;
    border-right: none !important;
    border-bottom: none !important;
    display: none !important;
  }
  #print-container {
    background-color: transparent !important;
  }
  #print-container > math-type {
    background-color: transparent !important;
  }
  #print-container > math-type > math-edit-container > editarea {
    background-color: transparent !important;
  }
  /*-----------------------------*/
  header,
  .export-bar-container {
    display: none !important;
  }
  math-type {
    padding: 0 !important;
  }
  .print-remove-background {
    background-color: transparent !important;
  }
  document-info-bar {
    display: none !important;
  }
  document-sidebar-container {
    display: none !important;
  }
  body {
    position: relative !important;
  }
  page,
  #root,
  body,
  html {
    height: 100% !important;
    width: 100% !important;
    position: relative !important;
    background: white !important;
    overflow: visible !important;
  }
}
.print-background.math-type-for-print {
  -webkit-print-color-adjust: exact;
}
@media print {
  outline: none !important;
  .npm__react-simple-code-editor__textarea {
    display: none !important;
  }
  math-diagram {
    border: none !important;
  }
  .no-border-on-print {
    border: none !important;
  }
  .setting-select {
    display: none !important;
  }
  .no-print,
  ref-tag.empty-line-tag,
  .text-cursor,
  .sub-text-cursor,
  selection-wrapper,
  message-box-container,
  connection-controls,
  .control-point-guide,
  tool-bar,
  items-bar,
  document-sidebar,
  resize-bar,
  diagram-expander,
  warning-error-region,
  loading-layer,
  resizing-info,
  toc-refresh {
    display: none !important;
  }
  .no-print-outline {
    outline: none !important;
  }
  .selected {
    background: unset !important;
  }
  .math-container-symbol.selected {
    background: unset !important;
  }
  .matrix-symbol.align-symbol {
    background: unset !important;
  }
  .matrix-symbol.gather-symbol {
    background: unset !important;
  }
  tr.selected,
  td.selected {
    border: unset !important;
  }
  tr.selected.hline {
    border-top: 1px solid black !important;
  }
  tr.selected.last-hline {
    border-bottom: 1px solid black !important;
  }
  td.selected.vline {
    border-left: 1px solid black !important;
  }
  td.selected.last-vline {
    border-right: 1px solid black !important;
  }
  .selected {
    outline: unset !important;
  }
  container-layer {
    margin: 0 !important;
    padding: 0 !important;
    background: transparent !important;
    height: initial !important;
    overflow: visible !important;
  }
  editor-container {
    border: none !important;
    margin: 0 !important;
    padding: 0 !important;
    background: transparent !important;
    width: 100% !important;
  }
  content-area {
    padding: 0px !important;
    margin: 0;
    background: transparent !important;
  }
  vcomposed-symbol.non-safari > start {
    margin-bottom: -0.05em !important;
  }
  vcomposed-symbol.non-safari > middle-center {
    margin-top: -0.05em;
    margin-bottom: -0.05em !important;
  }
  vcomposed-symbol.non-safari > middle {
    margin-top: -0.05em;
    margin-bottom: -0.05em !important;
  }
  vcomposed-symbol.non-safari > end {
    margin-top: -0.05em !important;
  }
}
.math-type-for-print {
  outline: none !important;
}
.math-type-for-print .npm__react-simple-code-editor__textarea {
  display: none !important;
}
.math-type-for-print math-diagram {
  border: none !important;
}
.math-type-for-print .no-border-on-print {
  border: none !important;
}
.math-type-for-print .setting-select {
  display: none !important;
}
.math-type-for-print .no-print,
.math-type-for-print ref-tag.empty-line-tag,
.math-type-for-print .text-cursor,
.math-type-for-print .sub-text-cursor,
.math-type-for-print selection-wrapper,
.math-type-for-print message-box-container,
.math-type-for-print connection-controls,
.math-type-for-print .control-point-guide,
.math-type-for-print tool-bar,
.math-type-for-print items-bar,
.math-type-for-print document-sidebar,
.math-type-for-print resize-bar,
.math-type-for-print diagram-expander,
.math-type-for-print warning-error-region,
.math-type-for-print loading-layer,
.math-type-for-print resizing-info,
.math-type-for-print toc-refresh {
  display: none !important;
}
.math-type-for-print .no-print-outline {
  outline: none !important;
}
.math-type-for-print .selected {
  background: unset !important;
}
.math-type-for-print .math-container-symbol.selected {
  background: unset !important;
}
.math-type-for-print .matrix-symbol.align-symbol {
  background: unset !important;
}
.math-type-for-print .matrix-symbol.gather-symbol {
  background: unset !important;
}
.math-type-for-print tr.selected,
.math-type-for-print td.selected {
  border: unset !important;
}
.math-type-for-print tr.selected.hline {
  border-top: 1px solid black !important;
}
.math-type-for-print tr.selected.last-hline {
  border-bottom: 1px solid black !important;
}
.math-type-for-print td.selected.vline {
  border-left: 1px solid black !important;
}
.math-type-for-print td.selected.last-vline {
  border-right: 1px solid black !important;
}
.math-type-for-print .selected {
  outline: unset !important;
}
.math-type-for-print container-layer {
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  height: initial !important;
  overflow: visible !important;
}
.math-type-for-print editor-container {
  border: none !important;
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  width: 100% !important;
}
.math-type-for-print content-area {
  padding: 0px !important;
  margin: 0;
  background: transparent !important;
}
.math-type-for-print vcomposed-symbol.non-safari > start {
  margin-bottom: -0.05em !important;
}
.math-type-for-print vcomposed-symbol.non-safari > middle-center {
  margin-top: -0.05em;
  margin-bottom: -0.05em !important;
}
.math-type-for-print vcomposed-symbol.non-safari > middle {
  margin-top: -0.05em;
  margin-bottom: -0.05em !important;
}
.math-type-for-print vcomposed-symbol.non-safari > end {
  margin-top: -0.05em !important;
}
.justify-single-line {
  display: inline-block;
  text-align-last: justify;
  width: 100%;
}
.rtl-on-line-level {
  direction: rtl;
}

math-type modal-dialog.import-latex math-type editarea.root-editor {
  min-height: 100px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .mobile-keys-support-region {
  position: fixed;
  top: 84px;
  left: 45px;
  color: gray;
  z-index: 11609;
  opacity: 0.9;
  display: flex;
  width: auto;
  z-index: 600;
  cursor: pointer;
}
math-type .mobile-keys-support-region.is-android {
  top: unset;
  bottom: 4px;
  left: 17px;
}
math-type .mobile-keys-support-region.select-only {
  top: 40px;
  left: 25px;
}
math-type .mobile-keys-support-region.select-only .btn-suggestion-box-mobile {
  display: none;
}



.special-symbol-dialog__special-char {
  display: inline-block;
  width: 24px;
  height: 24px;
  line-height: 24px;
  border-bottom: 1px solid #ddd;
  border-right: 1px solid #ddd;
  text-align: center;
  cursor: pointer;
  outline: none;
}
.special-symbol-dialog__special-char:hover {
  background: #bfe4bd;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
context-menu-container {
  position: fixed;
  left: 100px;
  top: 300px;
  z-index: 13;
  box-shadow: 2px 2px 3px 0px #c3c3c3;
  border: 1px solid lightgray;
  width: 200px;
  background: white;
  cursor: default;
  outline: none;
  font-family: "Segoe UI", Arial, Verdana, sans-serif;
}
context-menu-container ct-item {
  display: block;
  padding: 6px 9px;
  font-size: 13px;
  color: gray;
}
context-menu-container ct-item.disabled {
  color: lightgray;
}
context-menu-container ct-item:hover {
  background: #eae9e9;
}
context-menu-container ct-item.hidden {
  display: none;
}
context-menu-container ct-icon {
  width: 20px;
  display: inline-block;
}
context-menu-container ct-separator {
  width: 100%;
  display: block;
  height: 1px;
  margin-top: 2px;
  margin-bottom: 2px;
  border-top: 1px solid lightgray;
}

/* Collection default theme */
/* Grid default theme */
/* Table default theme */









/* List default theme */



math-type .symbol-container,
.auto-complete-external-area .symbol-container {
  display: flex;
  flex-direction: row;
  min-height: 25px;
  padding-left: 4px;
  padding-right: 12px;
  align-items: center;
  cursor: pointer;
}
math-type .symbol-container.selected,
.auto-complete-external-area .symbol-container.selected {
  background-color: #bfe4bd;
}
math-type .symbol-friendly-name,
.auto-complete-external-area .symbol-friendly-name {
  flex-grow: 1;
  font-family: Asana;
  /*padding-top: 6px;*/
}
math-type .symbol-icon,
.auto-complete-external-area .symbol-icon {
  /*padding-top: 6px;*/
  margin-right: 15px;
  min-width: 20px;
  text-align: center;
}
math-type .short-cut,
.auto-complete-external-area .short-cut {
  text-align: center;
  color: gray;
  /*vertical-align: middle;*/
  /*line-height: 20px;*/
  margin: 0 2px 0 2px;
  font-size: 12px;
  display: flex;
  align-items: center;
}
math-type .short-cut span,
.auto-complete-external-area .short-cut span {
  font-size: 10px;
}
math-type .hidden,
.auto-complete-external-area .hidden {
  display: none;
}







/**different context*/
/**different context*/
selection-wrapper {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
  user-select: none;
  pointer-events: none;
  z-index: 9;
}
selection-wrapper > selection {
  display: block;
  position: absolute;
  background-color: rgba(0, 126, 255, 0.15);
  user-select: none;
  width: 100px;
  height: 100px;
  transform-origin: 0 0;
}
selection-wrapper.inactive > selection {
  background-color: rgba(58, 57, 57, 0.13);
}

region-highlight-container {
  user-select: none;
  pointer-events: none;
  display: block;
  position: absolute;
  width: 0px;
  height: 0px;
  top: 0;
  left: 0;
  border: 1px solid lightgoldenrodyellow;
  opacity: 0.2;
}
region-highlight-container > rhc-all > rh-rect {
  display: block;
  position: absolute;
  background: orange;
}
region-highlight-container > rh-selected-rect {
  display: block;
  position: absolute;
  background: red;
}

.math-template-btb.btn-normal {
  background: transparent;
  margin-left: 0;
  font-size: 12px;
  border: none;
}
.math-template-btb.btn-normal:hover {
  background: white;
}
.math-template-name-item:hover {
  background: #f7f7f7;
}

.math-template-tree .tree-node-name {
  white-space: nowrap;
}
.math-template-tree .tree-node-name:hover {
  background: #f7f7f7;
}

math-type compositeblock.bib-bibliography {
  width: 100%;
  display: block;
}
math-type compositeblock.bib-cite {
  display: inline;
  white-space: break-spaces;
}
math-type compositeblock.bib-cite > editarea.text-mode {
  display: inline;
}
math-type compositeblock.bib-cite > editarea.text-mode > line.text-mode {
  display: inline;
}
math-type compositeblock.bib-cite > editarea.text-mode > line.text-mode > blocks {
  display: inline;
}
.csl-context {
  white-space: pre-wrap;
}
.csl-context.csl-cite div {
  display: inline;
}
.csl-context div.csl-left-margin {
  float: left;
}
.csl-context div.csl-block {
  font-weight: bold;
}
.csl-context div.csl-right-inline {
  margin-left: 2.5em;
}
.csl-context div.csl-indent {
  margin-top: 0.5em;
  margin-left: 2em;
  padding-bottom: 0.2em;
  padding-left: 0.5em;
  border-left: 5px solid #ccc;
}

.caption-ref-select .role-item:hover {
  background: #edf9ec;
}

.footnote-mt-container {
  position: relative;
}
.footnote-mt-container .more-option-box {
  position: absolute;
  left: -25px;
  top: 0;
  width: 30px;
  bottom: 0;
  display: none;
}
.footnote-mt-container .more-option-box > div {
  background: #f7f7f7;
  border: 1px solid #d6d3d3;
  padding: 0 0.2em;
  cursor: pointer;
  color: gray;
  display: inline-block;
}
.footnote-mt-container.hover-select:hover .more-option-box {
  display: block;
}
.mt-doc-fn > math-edit-container > editarea > area-container > line > first-line-prefix {
  padding-right: 0.3em;
}
.mt-doc-fn > math-edit-container > editarea > area-container > line.has-rtl {
  direction: rtl;
}
.mt-doc-fn > math-edit-container > editarea > area-container > line.has-rtl > first-line-prefix {
  padding-left: 0.3em;
}
.blocks-inline > math-edit-container > editarea > area-container > line > blocks {
  display: inline;
}

.lang-name:hover {
  background: #f7f7f7;
}
.lang-name.selected {
  background: #e1e8f5;
}
.custom-lange-area input::placeholder,
.custom-lange-area textarea::placeholder {
  color: lightgray;
}

.page-print-item {
  position: relative;
}
.page-print-item:hover .page-print-item-hover {
  display: block;
}
.page-print-item-hover {
  display: none;
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  margin-top: 10px;
  background: #f7f6f6;
  z-index: 10;
  padding: 5px;
  font-size: 0.8em;
  white-space: nowrap;
  color: gray;
  border: 1px solid lightgray;
}

.settings-show-hide {
  background: rgba(255, 255, 255, 0.61);
}
.settings-show-hide:hover {
  background: white;
}
.group-symbol-collapsed {
  display: block;
  border: 1px dotted lightgray;
  padding-top: 0.1em;
  padding-bottom: 0.1em;
}
.role-math-mode-group.math-mode-group-expanded .settings-show-hide,
.role-text-mode-group-inline.text-mode-group-inline-expanded .settings-show-hide {
  display: none;
}
.role-math-mode-group.math-mode-group-expanded:hover,
.role-text-mode-group-inline.text-mode-group-inline-expanded:hover {
  outline: 1px solid lightgray;
}
.role-math-mode-group.math-mode-group-expanded:hover .settings-show-hide,
.role-text-mode-group-inline.text-mode-group-inline-expanded:hover .settings-show-hide {
  display: flex;
}

math-type compositeblock.text-super-script-symbol,
math-type compositeblock.text-sub-script-symbol {
  display: inline;
}
math-type compositeblock.text-super-script-symbol > editarea.text-mode,
math-type compositeblock.text-sub-script-symbol > editarea.text-mode {
  display: inline;
}
math-type compositeblock.text-super-script-symbol > editarea.text-mode > line.text-mode,
math-type compositeblock.text-sub-script-symbol > editarea.text-mode > line.text-mode {
  display: inline;
}
math-type compositeblock.text-super-script-symbol > editarea.text-mode > line.text-mode > blocks,
math-type compositeblock.text-sub-script-symbol > editarea.text-mode > line.text-mode > blocks {
  display: inline;
}
math-type .text-super-script-symbol {
  vertical-align: super;
}
math-type .text-sub-script-symbol {
  vertical-align: sub;
}

compositeblock.section-ref {
  display: inline;
}
compositeblock.section-ref > .section-ref-border {
  display: inline;
  white-space: pre-wrap;
}
compositeblock.section-ref > div {
  display: inline;
}



icon-dropdown-items icon-dropdown-item:hover {
  background: #eae9e9;
}
icon-dropdown ii-icon {
  fill: gray;
}
icon-dropdown:hover {
  color: #4e4d4d;
}
icon-dropdown:hover ii-icon {
  fill: #4e4d4d;
}

resizable-container {
  display: block;
  position: relative;
  min-height: 0;
  flex-shrink: 0;
}





a.fce {
  cursor: pointer;
}
a.fce:hover svg {
  fill: #2d4373;
}
a.fce svg {
  fill: #3b5998;
}
a.fce i {
  text-align: center;
  color: white;
}
a.gg {
  cursor: pointer;
}
a.gg:hover svg {
  fill: #c23321;
}
a.gg svg {
  fill: #dd4b39;
}
a.gg i {
  text-align: center;
  color: white;
}
a.twr {
  cursor: pointer;
}
a.twr:hover svg {
  fill: #2795e9;
}
a.twr svg {
  fill: #55acee;
}
a.twr i {
  text-align: center;
  color: white;
}
a.gh {
  cursor: pointer;
}
a.gh:hover svg {
  fill: #2b2b2b;
}
a.gh svg {
  fill: #444;
}
a.gh i {
  text-align: center;
  color: white;
}





modal-dialog.swift.document-name modal-container.mt-common-dialog {
  width: 500px;
  max-width: 95vw;
}
modal-dialog.swift.document-name document-name {
  width: 100%;
  display: flex;
  flex-direction: column;
}
modal-dialog.swift.document-name document-name label {
  display: block;
  font-size: 13px;
}
modal-dialog.swift.document-name document-name textarea {
  width: auto;
  display: block;
  margin: 5px 0px;
  height: 39px;
  outline: none;
  border: 1px solid lightgray;
  resize: vertical;
}

.dock-tab-content {
  flex: 1;
  min-height: 0;
  min-width: 0;
  display: none;
}
.dock-tab-content.active {
  display: flex;
}

quick-start editarea.root-editor {
  min-height: 100px;
}
quick-start > qs-math-type-container > math-type:hover {
  border: 1px solid gray;
}
quick-start > qs-math-type-container > math-type tool-bar {
  display: none;
}
quick-start > qs-math-type-container > math-type items-bar {
  display: none;
  left: -60px;
  top: 0px;
  box-shadow: 0px 1px 2px 0px #4c4949;
}





/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**Context Level 1*/
/**both Level 1 and 2 Context */
/**Context Level 2 inside docsContainerZIndex*/
document-info-container document-info-bar {
  display: block;
  position: absolute;
  right: 15px;
  bottom: 5px;
  background: #f7f7f7;
  box-shadow: 1px 1px 1px 0px #e0dddd;
  border: 1px lightgray solid;
  font-size: 12px;
  padding: 0px;
  color: gray;
  opacity: 0.8;
  z-index: 4;
}
document-info-container document-info-bar:hover {
  opacity: 1;
}
document-info-container modal-container button.ok.btn-primary {
  display: none;
}
.Popover-body {
  font-size: 12px;
  padding: 10px;
  background: #4CAF50;
  box-shadow: #888686 1px 1px 1px 1px;
  color: white;
  max-width: 250px;
}
.Popover-tip {
  fill: #4CAF50;
}

/**Context Level 1*/
/**both Level 1 and 2 Context */
/**Context Level 2 inside docsContainerZIndex*/
.doc-toolbar-container {
  position: relative;
  background: #f7f7f7;
  top: 0;
  left: 0;
  width: 100%;
  border: 1px lightgray solid;
  margin-left: -2px;
  z-index: 6;
}
.doc-toolbar-container > tool-bar {
  position: relative;
  top: 0;
  left: 0;
  display: block;
  padding-left: 0px;
  min-width: 770px;
  width: 770px;
  margin: auto;
  background: transparent;
  box-shadow: none;
  border: none;
  height: 35px;
}











/**Context Level 1*/
/**both Level 1 and 2 Context */
/**Context Level 2 inside docsContainerZIndex*/


</style><style>.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style>#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style>.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style>.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style>#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style>.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style>.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head><body style="overflow:auto;background:rgb(255, 255, 255);width:auto;height:auto;"><editor-container style="display:block;margin:auto;width:816px;"><math-type style="user-select:text;" class=" math-type-for-print "><math-edit-container><editarea class="root-editor" style="font-family: &quot;Computer Modern Sans&quot;, serif; font-size: 17px;"><area-baseline aria-hidden="true">a</area-baseline><area-container><line class="root text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 1.73em; font-weight: bold;">Functions, Tools and Agents with LangChain</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="anchor-tag inline" style="font-family: &quot;Computer Modern Serif&quot;, serif; font-weight: bold;"><div data-id="n0.9059799531616755" class="anchor-tag-border no-border-on-print" id="n0.9059799531616755"><span>Table of Content</span></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="table-of-content inline"><toc-wrapper style="opacity: 1;"><editarea class="edit-area toc-ea no-area-container text-mode"><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.5745575096311577" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.5745575096311577" style="display: inline-block; white-space: pre;">1. </span></compositeblock><block>Introduction</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 619.547px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L619.546875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.6242513820833859" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.6242513820833859" style="display: inline-block; white-space: pre;">2. </span></compositeblock><block>OpenAI Function Calling</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 530.789px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L530.7890625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.7118261617056219" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.7118261617056219" style="display: inline-block; white-space: pre;">3. </span></compositeblock><block>LangChain Expression Language (LCEL)</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 419.938px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L419.9375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.6261543553496496" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.6261543553496496" style="display: inline-block; white-space: pre;">3.1. </span></compositeblock><block>Runnable Maps</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 549.477px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L549.4765625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.8072378385435093" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.8072378385435093" style="display: inline-block; white-space: pre;">3.2. </span></compositeblock><block>Bind</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 626.398px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L626.3984375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.6933467522487005" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.6933467522487005" style="display: inline-block; white-space: pre;">3.3. </span></compositeblock><block>Fallbacks</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 594.578px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L594.578125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.16032720397385947" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.16032720397385947" style="display: inline-block; white-space: pre;">3.4. </span></compositeblock><block>Interface</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 597.922px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L597.921875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.7322523048583449" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.7322523048583449" style="display: inline-block; white-space: pre;">4. </span></compositeblock><block>OpenAI Function Calling in LangChain</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 431.289px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L431.2890625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.28841613547260136" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.28841613547260136" style="display: inline-block; white-space: pre;">4.1. </span></compositeblock><block>Pydantic</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 597.195px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L597.1953125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.3757256337998929" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.3757256337998929" style="display: inline-block; white-space: pre;">4.2. </span></compositeblock><block>Using Pydantic to define OpenAI functions</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 354.43px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L354.4296875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.2892590396107084" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.2892590396107084" style="display: inline-block; white-space: pre;">4.3. </span></compositeblock><block>Using Multiple Functions</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 481.867px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L481.8671875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.4339343904058026" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.4339343904058026" style="display: inline-block; white-space: pre;">5. </span></compositeblock><block>Tagging and Extraction</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 539.75px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L539.75,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.1549656109217361" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.1549656109217361" style="display: inline-block; white-space: pre;">5.1. </span></compositeblock><block>Tagging</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 602.719px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L602.71875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.33805652978889555" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.33805652978889555" style="display: inline-block; white-space: pre;">5.2. </span></compositeblock><block>Extraction</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 586.242px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L586.2421875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.018505856230518924" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.018505856230518924" style="display: inline-block; white-space: pre;">5.3. </span></compositeblock><block>Real-world Example</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 519.438px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L519.4375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.7301665705190514" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.7301665705190514" style="display: inline-block; white-space: pre;">6. </span></compositeblock><block>Tools and Routing</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 575.586px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L575.5859375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.12496366649896395" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.12496366649896395" style="display: inline-block; white-space: pre;">6.1. </span></compositeblock><block>Tools</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 621.18px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L621.1796875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.9931548687371452" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.9931548687371452" style="display: inline-block; white-space: pre;">6.2. </span></compositeblock><block>Routing</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 603.617px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L603.6171875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.7189534581762422" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.7189534581762422" style="display: inline-block; white-space: pre;">7. </span></compositeblock><block>Conversational Agent</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 554.898px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L554.8984375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.2834242762306962" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.2834242762306962" style="display: inline-block; white-space: pre;">7.1. </span></compositeblock><block>Agents</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 610.555px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L610.5546875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.7351896297714062" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.7351896297714062" style="display: inline-block; white-space: pre;">7.2. </span></compositeblock><block>Create a Chatbot</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 535.977px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L535.9765625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line></editarea></toc-wrapper></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.5745575096311577" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.5745575096311577" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Introduction</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>How can LLMs interact with our existing software infrastructure? For example, by letting it decide when to make a function call to a different program to get more information, or, to take an action.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>LLMs were originally designed to generate text for humans, but some LLMs have now been trained to output formatted data such as values stored as JSON to make it easy let LLM decide when to call other code as a subroutine.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Here's the outline of this course:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">OpenAI function calling</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">LangChain Expression Language (LCEL)</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">OpenAI function calling in LangChain</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Tagging and extraction using OpenAI function calling</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Tools and Routing</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Conversational Agent</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.6242513820833859" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.6242513820833859" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>OpenAI Function Calling</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>OpenAI has fine-tuned the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">gpt-3.5-turbo-0613</block><block> and </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">gpt-4-0613</block><block> models to:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Accept additional arguments through which users can pass in descriptions of functions.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>If it is relevant, return the name of the function to use, along with a JSON object with the appropriate input parameters.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>For example, we can define this custom function to get the weather info:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> json</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Example dummy function hard coded to return the same weather</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># In production, this could be your backend API or an external API</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">get_current_weather</block><block class="punctuation token">(</block><block class=" token">location</block><block class="punctuation token">,</block><block class=" token"> unit</block><block class="operator token">=</block><block class="string token">"fahrenheit"</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Get the current weather in a given location"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    weather_info </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"location"</block><block class="punctuation token">:</block><block class=" token"> location</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"temperature"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"72"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"unit"</block><block class="punctuation token">:</block><block class=" token"> unit</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"forecast"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">[</block><block class="string token">"sunny"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"windy"</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> json</block><block class="punctuation token">.</block><block class=" token">dumps</block><block class="punctuation token">(</block><block class=" token">weather_info</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">How do we pass this information to the language model?</block><block> OpenAI has exposed a new parameter called </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">functions</block><block> through which you can pass a list of function definitions.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">NOTE:</block><block> The </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">"description"</block><block> fields are very important because they're passed directly to the language model.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># define a function</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">functions </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"name"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"get_current_weather"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"description"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"Get the current weather in a given location"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"parameters"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"type"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"object"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"properties"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                </block><block class="string token">"location"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                    </block><block class="string token">"type"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"string"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                    </block><block class="string token">"description"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"The city and state, e.g. San Francisco, CA"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                </block><block class="punctuation token">}</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                </block><block class="string token">"unit"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">{</block><block class="string token">"type"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"string"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"enum"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">[</block><block class="string token">"celsius"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"fahrenheit"</block><block class="punctuation token">]</block><block class="punctuation token">}</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="punctuation token">}</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"required"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">[</block><block class="string token">"location"</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">}</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">messages </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"role"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"user"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"content"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"What's the weather like in Boston?"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> openai</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">response </block><block class="operator token">=</block><block class=" token"> openai</block><block class="punctuation token">.</block><block class=" token">ChatCompletion</block><block class="punctuation token">.</block><block class=" token">create</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model</block><block class="operator token">=</block><block class="string token">"gpt-3.5-turbo-0613"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    messages</block><block class="operator token">=</block><block class=" token">messages</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    functions</block><block class="operator token">=</block><block class=" token">functions</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">response</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "id": "chatcmpl-8IfHyztPhNmSXTVEgw5twr6SsUZtC",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "object": "chat.completion",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "created": 1699459310,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "model": "gpt-3.5-turbo-0613",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "choices": [</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#       "index": 0,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#       "message": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#         "role": "assistant",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#         "content": null,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#         "function_call": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#           "name": "get_current_weather",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#           "arguments": "{\n  \"location\": \"Boston, MA\"\n}"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#         }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#       },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#       "finish_reason": "function_call"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   ],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "usage": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     "prompt_tokens": 82,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     "completion_tokens": 18,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     "total_tokens": 100</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">response_message </block><block class="operator token">=</block><block class=" token"> response</block><block class="punctuation token">[</block><block class="string token">"choices"</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="string token">"message"</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">response_message</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># &lt;OpenAIObject at 0x7fca00261ea0&gt; JSON: {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "role": "assistant",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "content": null,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "function_call": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     "name": "get_current_weather",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     "arguments": "{\n  \"location\": \"Boston, MA\"\n}"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">response_message</block><block class="punctuation token">[</block><block class="string token">"content"</block><block class="punctuation token">]</block><block class="punctuation token">)</block><block class=" token">  </block><block class="comment token"># --&gt; should return empty</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">response_message</block><block class="punctuation token">[</block><block class="string token">"function_call"</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># &lt;OpenAIObject at 0x7fca00261ef0&gt; JSON: {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "name": "get_current_weather",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "arguments": "{\n  \"location\": \"Boston, MA\"\n}"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">json</block><block class="punctuation token">.</block><block class=" token">loads</block><block class="punctuation token">(</block><block class=" token">response_message</block><block class="punctuation token">[</block><block class="string token">"function_call"</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="string token">"arguments"</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'location': 'Boston, MA'}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">args </block><block class="operator token">=</block><block class=" token"> json</block><block class="punctuation token">.</block><block class=" token">loads</block><block class="punctuation token">(</block><block class=" token">response_message</block><block class="punctuation token">[</block><block class="string token">"function_call"</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="string token">"arguments"</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">get_current_weather</block><block class="punctuation token">(</block><block class=" token">args</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># '{"location": {"location": "Boston, MA"}, "temperature": "72", "unit": "fahrenheit", "forecast": ["sunny", "windy"]}'</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block> </block><block style="font-weight: bold; color: rgb(255, 64, 0);">NOTE:</block><block> </block><block style="font-weight: bold; background-color: rgb(252, 239, 178);">Function calling with OpenAI doesn't directly call the function. We still have to do that ourselves</block><block>. Rather, it just tells us what function to call and what the arguments to that function should be.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: underline;">It's also worth noting that although it's trained to return a JSON, it's acutally not strictly enforced</block><block>. So, if you're decoding it with </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">json.loads()</block><block> and you run into some error, that's actually an issue on the model side. So, you might want to put some safeguards around that. </block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">NOTE:</block><block> If we send a message not related to the function, it will not use the function. The model decides whether to call the function.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">What if we want to force the model whether to use or not to use the function?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We use the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">function_call</block><block> parameter. It has three modes:</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(251, 111, 117);">"auto"</block><block>  Let the model decide whether to use the function.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(251, 111, 117);">"none"</block><block>  Force not to use the function.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(251, 111, 117);">{"name": "get_current_weather"}</block><block>  Force to use the function.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">NOTE:</block><block> Function calls counts against the token usage.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">How to do a function call and actually run the function and pass the output back to the language model?</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">messages</block><block class="punctuation token">.</block><block class=" token">append</block><block class="punctuation token">(</block><block class=" token">response</block><block class="punctuation token">[</block><block class="string token">"choices"</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="string token">"message"</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">args </block><block class="operator token">=</block><block class=" token"> json</block><block class="punctuation token">.</block><block class=" token">loads</block><block class="punctuation token">(</block><block class=" token">response</block><block class="punctuation token">[</block><block class="string token">"choices"</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="string token">"message"</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="string token">'function_call'</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="string token">'arguments'</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">observation </block><block class="operator token">=</block><block class=" token"> get_current_weather</block><block class="punctuation token">(</block><block class=" token">args</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">messages</block><block class="punctuation token">.</block><block class=" token">append</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"role"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"function"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"name"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"get_current_weather"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"content"</block><block class="punctuation token">:</block><block class=" token"> observation</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">response </block><block class="operator token">=</block><block class=" token"> openai</block><block class="punctuation token">.</block><block class=" token">ChatCompletion</block><block class="punctuation token">.</block><block class=" token">create</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model</block><block class="operator token">=</block><block class="string token">"gpt-3.5-turbo-0613"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    messages</block><block class="operator token">=</block><block class=" token">messages</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">response</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "id": "chatcmpl-8IfarBiAvimhIt1szLCppH26JNXVS",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "object": "chat.completion",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "created": 1699460481,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "model": "gpt-3.5-turbo-0613",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "choices": [</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#       "index": 0,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#       "message": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#         "role": "assistant",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#         "content": "The weather in Boston is currently sunny and windy with a temperature of 72 degrees Fahrenheit."</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#       },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#       "finish_reason": "stop"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   ],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   "usage": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     "prompt_tokens": 77,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     "completion_tokens": 18,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     "total_tokens": 95</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># }</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.7118261617056219" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.7118261617056219" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>LangChain Expression Language (LCEL)</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This is a new syntax that makes it much easier and more transparent to construct and work with different chains and agents. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>A lot of the power of LangChain comes from composing chains of different components together. </block><block style="font-weight: bold;">LCEL</block><block> offers a new way of doing this.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">LCEL</block><block> is a runnable protocol. It defines:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>An allowed set of input types. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>An allowed set of output types.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Required method  e.g. invoke, stream, batch, etc.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>You can also modify parameters at the run time and add options like </block><block style="font-weight: bold;">fallbacks</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>You can do all these new compositions </block><block style="text-decoration: underline;">using the Linux pipe syntax</block><block>. It will look something like this  </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176); background-color: rgb(252, 239, 178);">Chain = prompt | llm | OutputParser</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The are a few </block><block style="font-weight: bold;">common methods</block><block> in </block><block style="font-weight: bold;">LCEL</block><block>:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(255, 64, 0);">invoke [ainvoke]</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(255, 64, 0);">stream [astream]</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(255, 64, 0);">batch [abatch]</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">NOTE:</block><block> For every method, there's also an </block><block style="font-weight: bold;">asynchronous</block><block> version, e.g. </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(255, 64, 0);">invoke </block><block style="font-family: &quot;Computer Modern Sans&quot;, serif; font-weight: bold; color: rgb(0, 0, 0);"></block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(255, 64, 0);"> ainvoke</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Common properties</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(255, 64, 0);">input_schema</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(255, 64, 0);">output_schema</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Common I/O</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 575px; height: 264.75px; position: relative;"><img src="image-resources/1fd32741-2c0e-42ea-8a91-f53453b6ad99.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Why use LCEL?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Runnables support:</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Async, batch, and streaming support</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Fallbacks</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Parallelism</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>LLM calls can be time consuming.</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Any components that can be run in parallel are.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Logging is built-in.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Here is a simple chain:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prompt </block><block class="operator token">=</block><block class=" token"> ChatPromptTemplate</block><block class="punctuation token">.</block><block class=" token">from_template</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"tell me a short joke about {topic}"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model </block><block class="operator token">=</block><block class=" token"> ChatOpenAI</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">output_parser </block><block class="operator token">=</block><block class=" token"> StrOutputParser</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> model </block><block class="operator token">|</block><block class=" token"> output_parser</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"topic"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"bears"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># "Why don't bears wear shoes?\n\nBecause they have bear feet!"</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.6261543553496496" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.6261543553496496" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">3.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Runnable Maps</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>A more complex example  And </block><block style="font-weight: bold; color: rgb(255, 64, 0);">Runnable Map</block><block> to supply user-provided inputs to the prompt.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">embeddings </block><block class="keyword token">import</block><block class=" token"> OpenAIEmbeddings</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">vectorstores </block><block class="keyword token">import</block><block class=" token"> DocArrayInMemorySearch</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">vectorstore </block><block class="operator token">=</block><block class=" token"> DocArrayInMemorySearch</block><block class="punctuation token">.</block><block class=" token">from_texts</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">[</block><block class="string token">"harrison worked at kensho"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"bears like to eat honey"</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    embedding</block><block class="operator token">=</block><block class=" token">OpenAIEmbeddings</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">retriever </block><block class="operator token">=</block><block class=" token"> vectorstore</block><block class="punctuation token">.</block><block class=" token">as_retriever</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">retriever</block><block class="punctuation token">.</block><block class=" token">get_relevant_documents</block><block class="punctuation token">(</block><block class="string token">"where did harrison work?"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># [Document(page_content='harrison worked at kensho'),</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Document(page_content='bears like to eat honey')]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">retriever</block><block class="punctuation token">.</block><block class=" token">get_relevant_documents</block><block class="punctuation token">(</block><block class="string token">"what do bears like to eat"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># [Document(page_content='bears like to eat honey'),</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Document(page_content='harrison worked at kensho')]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">template </block><block class="operator token">=</block><block class=" token"> </block><block class="triple-quoted-string string token">"""Answer the question based only on the following context:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">{context}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">Question: {question}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prompt </block><block class="operator token">=</block><block class=" token"> ChatPromptTemplate</block><block class="punctuation token">.</block><block class=" token">from_template</block><block class="punctuation token">(</block><block class=" token">template</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">schema</block><block class="punctuation token">.</block><block class=" token">runnable </block><block class="keyword token">import</block><block class=" token"> RunnableMap</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain </block><block class="operator token">=</block><block class=" token"> RunnableMap</block><block class="punctuation token">(</block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"context"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="keyword token">lambda</block><block class=" token"> x</block><block class="punctuation token">:</block><block class=" token"> retriever</block><block class="punctuation token">.</block><block class=" token">get_relevant_documents</block><block class="punctuation token">(</block><block class=" token">x</block><block class="punctuation token">[</block><block class="string token">"question"</block><block class="punctuation token">]</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"question"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="keyword token">lambda</block><block class=" token"> x</block><block class="punctuation token">:</block><block class=" token"> x</block><block class="punctuation token">[</block><block class="string token">"question"</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">}</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">|</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> model </block><block class="operator token">|</block><block class=" token"> output_parser</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"question"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"where did harrison work?"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># 'Harrison worked at Kensho.'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">inputs </block><block class="operator token">=</block><block class=" token"> RunnableMap</block><block class="punctuation token">(</block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"context"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="keyword token">lambda</block><block class=" token"> x</block><block class="punctuation token">:</block><block class=" token"> retriever</block><block class="punctuation token">.</block><block class=" token">get_relevant_documents</block><block class="punctuation token">(</block><block class=" token">x</block><block class="punctuation token">[</block><block class="string token">"question"</block><block class="punctuation token">]</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"question"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="keyword token">lambda</block><block class=" token"> x</block><block class="punctuation token">:</block><block class=" token"> x</block><block class="punctuation token">[</block><block class="string token">"question"</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">inputs</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"question"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"where did harrison work?"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'context': [Document(page_content='harrison worked at kensho'),</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  Document(page_content='bears like to eat honey')],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># 'question': 'where did harrison work?'}</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.8072378385435093" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.8072378385435093" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">3.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Bind</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We can also </block><block style="font-weight: bold; color: rgb(255, 64, 0);">bind</block><block> parameters. Let's see an example for OpenAI functions:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">functions </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">      </block><block class="string token">"name"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"weather_search"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">      </block><block class="string token">"description"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"Search for weather given an airport code"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">      </block><block class="string token">"parameters"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"type"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"object"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"properties"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">          </block><block class="string token">"airport_code"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"type"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"string"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"description"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"The airport code to get the weather for"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">          </block><block class="punctuation token">}</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">}</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"required"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">[</block><block class="string token">"airport_code"</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">      </block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prompt </block><block class="operator token">=</block><block class=" token"> ChatPromptTemplate</block><block class="punctuation token">.</block><block class=" token">from_messages</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">(</block><block class="string token">"human"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"{input}"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model </block><block class="operator token">=</block><block class=" token"> ChatOpenAI</block><block class="punctuation token">(</block><block class=" token">temperature</block><block class="operator token">=</block><block class="number token">0</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">bind</block><block class="punctuation token">(</block><block class=" token">functions</block><block class="operator token">=</block><block class=" token">functions</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">runnable </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">runnable</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"what is the weather in sf"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AIMessage(content='', additional_kwargs={'function_call': {'name': 'weather_search', 'arguments': '{\n  "airport_code": "SFO"\n}'}})</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.6933467522487005" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.6933467522487005" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">3.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Fallbacks</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>With LCEL, it's very easy to attach </block><block style="font-weight: bold; color: rgb(255, 64, 0);">fallbacks</block><block> not only to individual components but to entire sequences.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In this example, we intentionally use an older LM from OpenAI that is supposed to fail, then we will use fallbacks to handle that.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">llms </block><block class="keyword token">import</block><block class=" token"> OpenAI</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> json</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">simple_model </block><block class="operator token">=</block><block class=" token"> OpenAI</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    temperature</block><block class="operator token">=</block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    max_tokens</block><block class="operator token">=</block><block class="number token">1000</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model</block><block class="operator token">=</block><block class="string token">"text-davinci-001"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">simple_chain </block><block class="operator token">=</block><block class=" token"> simple_model </block><block class="operator token">|</block><block class=" token"> json</block><block class="punctuation token">.</block><block class=" token">loads</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">challenge </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">"write three poems in a json blob, where each poem is a json blob of a title, author, and first line"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">simple_model</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class=" token">challenge</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># '\n\n["The Waste Land","T.S. Eliot","April is the cruelest month, breeding # lilacs out of the dead land"]\n\n["The Raven","Edgar Allan Poe","Once upon # a midnight dreary, while I pondered, weak and weary"]\n\n["Ode to a # # #Nightingale","John Keats","Thou still unravish\'d bride of quietness, Thou # foster-child of silence and slow time"]'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">simple_chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class=" token">challenge</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># JSONDecodeError </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model </block><block class="operator token">=</block><block class=" token"> ChatOpenAI</block><block class="punctuation token">(</block><block class=" token">temperature</block><block class="operator token">=</block><block class="number token">0</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain </block><block class="operator token">=</block><block class=" token"> model </block><block class="operator token">|</block><block class=" token"> StrOutputParser</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">|</block><block class=" token"> json</block><block class="punctuation token">.</block><block class=" token">loads</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class=" token">challenge</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'poem1': {'title': 'Whispers of the Wind',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'author': 'Emily Rivers',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'first_line': 'Softly it comes, the whisper of the wind'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'poem2': {'title': 'Silent Serenade',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'author': 'Jacob Moore',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'first_line': 'In the stillness of night, a silent serenade'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'poem3': {'title': 'Dancing Shadows',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'author': 'Sophia Anderson',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'first_line': 'Shadows dance upon the moonlit floor'}}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">final_chain </block><block class="operator token">=</block><block class=" token"> simple_chain</block><block class="punctuation token">.</block><block class=" token">with_fallbacks</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class=" token">chain</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">final_chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class=" token">challenge</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'poem1': {'title': 'Whispers of the Wind',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'author': 'Emily Rivers',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'first_line': 'Softly it comes, the whisper of the wind'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'poem2': {'title': 'Silent Serenade',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'author': 'Jacob Moore',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'first_line': 'In the stillness of night, a silent serenade'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'poem3': {'title': 'Dancing Shadows',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'author': 'Sophia Anderson',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'first_line': 'Shadows dance upon the moonlit floor'}}</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.16032720397385947" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.16032720397385947" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">3.4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Interface</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(255, 64, 0);">invoke</block><block>  synchronous</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(255, 64, 0);">batch</block><block>  invoking on multiple inputs (</block><block style="font-weight: bold;">NOTE:</block><block> in the background, it runs them in parallel).</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(255, 64, 0);">stream</block><block>  returns an iterable  useful for applications to gradually show responses as they become available by the LM.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(255, 64, 0);">ainvoke</block><block>  asynchronous  e.g.: </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-size: 0.8em; font-weight: bold; color: rgb(79, 167, 176);">response = await chain.ainvoke({"topic": "bears"})</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.7322523048583449" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.7322523048583449" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>OpenAI Function Calling in LangChain</block></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.28841613547260136" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.28841613547260136" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">4.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Pydantic</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Pydantic</block><block> is a data validation library for Python.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Works with Python type annotations. But, rather than static type checking, they are actively used at runtime for data validation and conversion.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Provides built-in methods to serialize/de-serialize models to/from JSON, dictionaries, etc.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>LangChain leverages Pydantic to create JSON scheme describing function.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Pydantic data classes are a blend of Python's data classes with the validation power of Pydantic.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>They offer a concise way to define data structures while ensuring that the data adheres to specified types and constraints.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In LangChain, Pydantic is used to create OpenAI function description (i.e. to create the schema).</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 400px; height: 293.33px; position: relative;"><img src="image-resources/e7e90326-33c8-4d1a-baa2-fc99ce6c2a4b.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>With Pydantic, we can create </block><block style="font-weight: bold;">nested objects</block><block>:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">pUser</block><block class="punctuation token">(</block><block class=" token">BaseModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    age</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">int</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    email</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">foo_p </block><block class="operator token">=</block><block class=" token"> pUser</block><block class="punctuation token">(</block><block class=" token">name</block><block class="operator token">=</block><block class="string token">"Jane"</block><block class="punctuation token">,</block><block class=" token"> age</block><block class="operator token">=</block><block class="number token">32</block><block class="punctuation token">,</block><block class=" token"> email</block><block class="operator token">=</block><block class="string token">"jane@gmail.com"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">Class</block><block class="punctuation token">(</block><block class=" token">BaseModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    students</block><block class="punctuation token">:</block><block class=" token"> List</block><block class="punctuation token">[</block><block class=" token">pUser</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">obj </block><block class="operator token">=</block><block class=" token"> Class</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    students</block><block class="operator token">=</block><block class="punctuation token">[</block><block class=" token">pUser</block><block class="punctuation token">(</block><block class=" token">name</block><block class="operator token">=</block><block class="string token">"Jane"</block><block class="punctuation token">,</block><block class=" token"> age</block><block class="operator token">=</block><block class="number token">32</block><block class="punctuation token">,</block><block class=" token"> email</block><block class="operator token">=</block><block class="string token">"jane@gmail.com"</block><block class="punctuation token">)</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.3757256337998929" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.3757256337998929" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">4.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Using Pydantic to define OpenAI functions</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We can use Pydantic to define a function. See below:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Note that the docstring of the class act as the description. That's why it's required  </block><block style="background-color: rgb(252, 239, 178);">To be more clear, description for the class (the docstring) is required but the description for the argument (i.e. Field(description="...") is not required</block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">WeatherSearch</block><block class="punctuation token">(</block><block class=" token">BaseModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Call this with an airport code to get the weather at that airport"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    airport_code</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class=" token">description</block><block class="operator token">=</block><block class="string token">"airport code to get weather for"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">utils</block><block class="punctuation token">.</block><block class=" token">openai_functions </block><block class="keyword token">import</block><block class=" token"> convert_pydantic_to_openai_function</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">weather_function </block><block class="operator token">=</block><block class=" token"> convert_pydantic_to_openai_function</block><block class="punctuation token">(</block><block class=" token">WeatherSearch</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">weather_function</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'name': 'WeatherSearch',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'description': 'Call this with an airport code to get the weather at that airport',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'parameters': {'title': 'WeatherSearch',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'description': 'Call this with an airport code to get the weather at that airport',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'type': 'object',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'properties': {'airport_code': {'title': 'Airport Code',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     'description': 'airport code to get weather for',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     'type': 'string'}},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'required': ['airport_code']}}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">chat_models </block><block class="keyword token">import</block><block class=" token"> ChatOpenAI</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model </block><block class="operator token">=</block><block class=" token"> ChatOpenAI</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="string token">"what is the weather in SF today?"</block><block class="punctuation token">,</block><block class=" token"> functions</block><block class="operator token">=</block><block class="punctuation token">[</block><block class=" token">weather_function</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#AIMessage(content='', additional_kwargs={'function_call': {'name': 'WeatherSearch', 'arguments': '{\n  "airport_code": "SFO"\n}'}})</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># We can also bind the function</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_with_function </block><block class="operator token">=</block><block class=" token"> model</block><block class="punctuation token">.</block><block class=" token">bind</block><block class="punctuation token">(</block><block class=" token">functions</block><block class="operator token">=</block><block class="punctuation token">[</block><block class=" token">weather_function</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Using it with chains</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">prompts </block><block class="keyword token">import</block><block class=" token"> ChatPromptTemplate</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prompt </block><block class="operator token">=</block><block class=" token"> ChatPromptTemplate</block><block class="punctuation token">.</block><block class=" token">from_messages</block><block class="punctuation token">(</block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"system"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"You are a helpful assistant"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"user"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"{input}"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> model_with_function</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"what is the weather in sf?"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AIMessage(content='', additional_kwargs={'function_call': {'name': 'WeatherSearch', 'arguments': '{\n  "airport_code": "SFO"\n}'}})</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.2892590396107084" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.2892590396107084" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">4.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Using Multiple Functions</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We can pass a set of function and let the LLM decide which to use based on the question context.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">ArtistSearch</block><block class="punctuation token">(</block><block class=" token">BaseModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Call this to get the names of songs by a particular artist"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    artist_name</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class=" token">description</block><block class="operator token">=</block><block class="string token">"name of artist to look up"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    n</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">int</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class=" token">description</block><block class="operator token">=</block><block class="string token">"number of results"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">functions </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    convert_pydantic_to_openai_function</block><block class="punctuation token">(</block><block class=" token">WeatherSearch</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    convert_pydantic_to_openai_function</block><block class="punctuation token">(</block><block class=" token">ArtistSearch</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_with_functions </block><block class="operator token">=</block><block class=" token"> model</block><block class="punctuation token">.</block><block class=" token">bind</block><block class="punctuation token">(</block><block class=" token">functions</block><block class="operator token">=</block><block class=" token">functions</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_with_functions</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="string token">"what is the weather in sf?"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AIMessage(content='', additional_kwargs={'function_call': {'name': 'WeatherSearch', 'arguments': '{\n  "airport_code": "SFO"\n}'}})</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_with_functions</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="string token">"what are three songs by taylor swift?"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AIMessage(content='', additional_kwargs={'function_call': {'name': 'ArtistSearch', 'arguments': '{\n  "artist_name": "taylor swift",\n  "n": 3\n}'}})</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.4339343904058026" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.4339343904058026" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">5. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Tagging and Extraction</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This is one of the main use cases for OpenAI functions.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This allows us to extract structured data from unstructured text.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.1549656109217361" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.1549656109217361" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">5.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Tagging</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We have seen the LLM, given a function description, select arguments from the input text, generate a structured output forming a function call. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>More generally, the LLM can </block><block style="font-weight: bold; font-style: italic;">evaluate</block><block> the input text and generate structured output.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In </block><block style="font-weight: bold; color: rgb(255, 64, 0);">tagging</block><block>, we pass in an unstructured piece of text along with some structured description, and then we use the LLM to generate some structured output to reason over that input text and create some response in the format of the structured output that we passed in.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Here's an example of tagging for performing sentiment analysis.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> typing </block><block class="keyword token">import</block><block class=" token"> List</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> pydantic </block><block class="keyword token">import</block><block class=" token"> BaseModel</block><block class="punctuation token">,</block><block class=" token"> Field</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">utils</block><block class="punctuation token">.</block><block class=" token">openai_functions </block><block class="keyword token">import</block><block class=" token"> convert_pydantic_to_openai_function</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">Tagging</block><block class="punctuation token">(</block><block class=" token">BaseModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Tag the piece of text with particular info."""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    sentiment</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class=" token">description</block><block class="operator token">=</block><block class="string token">"sentiment of text, should be `pos`, `neg`, or `neutral`"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    language</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class=" token">description</block><block class="operator token">=</block><block class="string token">"language of text (should be ISO 639-1 code)"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">convert_pydantic_to_openai_function</block><block class="punctuation token">(</block><block class=" token">Tagging</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'name': 'Tagging',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'description': 'Tag the piece of text with particular info.',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'parameters': {'title': 'Tagging',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'description': 'Tag the piece of text with particular info.',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'type': 'object',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'properties': {'sentiment': {'title': 'Sentiment',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     'description': 'sentiment of text, should be `pos`, `neg`, or `neutral`',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     'type': 'string'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#    'language': {'title': 'Language',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     'description': 'language of text (should be ISO 639-1 code)',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     'type': 'string'}},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'required': ['sentiment', 'language']}}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">prompts </block><block class="keyword token">import</block><block class=" token"> ChatPromptTemplate</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">chat_models </block><block class="keyword token">import</block><block class=" token"> ChatOpenAI</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model </block><block class="operator token">=</block><block class=" token"> ChatOpenAI</block><block class="punctuation token">(</block><block class=" token">temperature</block><block class="operator token">=</block><block class="number token">0</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">tagging_functions </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class=" token">convert_pydantic_to_openai_function</block><block class="punctuation token">(</block><block class=" token">Tagging</block><block class="punctuation token">)</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prompt </block><block class="operator token">=</block><block class=" token"> ChatPromptTemplate</block><block class="punctuation token">.</block><block class=" token">from_messages</block><block class="punctuation token">(</block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"system"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"Think carefully, and then tag the text as instructed"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"user"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"{input}"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_with_functions </block><block class="operator token">=</block><block class=" token"> model</block><block class="punctuation token">.</block><block class=" token">bind</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    functions</block><block class="operator token">=</block><block class=" token">tagging_functions</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    function_call</block><block class="operator token">=</block><block class="punctuation token">{</block><block class="string token">"name"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"Tagging"</block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">tagging_chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> model_with_functions</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">tagging_chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"I love langchain"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AIMessage(content='', additional_kwargs={'function_call': {'name': 'Tagging', 'arguments': '{\n  "sentiment": "pos",\n  "language": "en"\n}'}})</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">tagging_chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"non mi piace questo cibo"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AIMessage(content='', additional_kwargs={'function_call': {'name': 'Tagging', 'arguments': '{\n  "sentiment": "neg",\n  "language": "it"\n}'}})</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">output_parsers</block><block class="punctuation token">.</block><block class=" token">openai_functions </block><block class="keyword token">import</block><block class=" token"> JsonOutputFunctionsParser</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">tagging_chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> model_with_functions </block><block class="operator token">|</block><block class=" token"> JsonOutputFunctionsParser</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">tagging_chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"non mi piace questo cibo"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'sentiment': 'neg', 'language': 'it'}</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.33805652978889555" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.33805652978889555" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">5.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Extraction</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>When given an input JSON schema, the LLM has been fine-tuned to find and fill in the parameters of that schema.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The capability is not limited to function schema.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This can be used for general purpose extraction.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In extraction, we're going to be extracting specific entities from the text. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>These entities are also represented by a structured description.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Rather than using the LLM to reason over the text and respond with a single output in the structured description, we're using the LLM to look over the text, and extract a list of these elements.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Extraction is similar to tagging, but used for extracting multiple pieces of information.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> typing </block><block class="keyword token">import</block><block class=" token"> Optional</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">Person</block><block class="punctuation token">(</block><block class=" token">BaseModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Information about a person."""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class=" token">description</block><block class="operator token">=</block><block class="string token">"person's name"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    age</block><block class="punctuation token">:</block><block class=" token"> Optional</block><block class="punctuation token">[</block><block class="builtin token">int</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class=" token">description</block><block class="operator token">=</block><block class="string token">"person's age"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">Information</block><block class="punctuation token">(</block><block class=" token">BaseModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Information to extract."""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    people</block><block class="punctuation token">:</block><block class=" token"> List</block><block class="punctuation token">[</block><block class=" token">Person</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class=" token">description</block><block class="operator token">=</block><block class="string token">"List of info about people"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">convert_pydantic_to_openai_function</block><block class="punctuation token">(</block><block class=" token">Information</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'name': 'Information',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'description': 'Information to extract.',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'parameters': {'title': 'Information',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'description': 'Information to extract.',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'type': 'object',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'properties': {'people': {'title': 'People',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     'description': 'List of info about people',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     'type': 'array',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     'items': {'title': 'Person',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#      'description': 'Information about a person.',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#      'type': 'object',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#      'properties': {'name': {'title': 'Name',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#        'description': "person's name",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#        'type': 'string'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#       'age': {'title': 'Age',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#        'description': "person's age",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#        'type': 'integer'}},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#      'required': ['name']}}},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'required': ['people']}}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_functions </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class=" token">convert_pydantic_to_openai_function</block><block class="punctuation token">(</block><block class=" token">Information</block><block class="punctuation token">)</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_model </block><block class="operator token">=</block><block class=" token"> model</block><block class="punctuation token">.</block><block class=" token">bind</block><block class="punctuation token">(</block><block class=" token">functions</block><block class="operator token">=</block><block class=" token">extraction_functions</block><block class="punctuation token">,</block><block class=" token"> function_call</block><block class="operator token">=</block><block class="punctuation token">{</block><block class="string token">"name"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"Information"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_model</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="string token">"Joe is 30, his mom is Martha"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AIMessage(content='', additional_kwargs={'function_call': {'name': 'Information', 'arguments': '{\n  "people": [\n    {\n      "name": "Joe",\n      "age": 30\n    },\n    {\n      "name": "Martha",\n      "age": 0\n    }\n  ]\n}'}})</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prompt </block><block class="operator token">=</block><block class=" token"> ChatPromptTemplate</block><block class="punctuation token">.</block><block class=" token">from_messages</block><block class="punctuation token">(</block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"system"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"Extract the relevant information, if not explicitly provided do not guess. Extract partial info"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"human"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"{input}"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> extraction_model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"Joe is 30, his mom is Martha"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AIMessage(content='', additional_kwargs={'function_call': {'name': 'Information', 'arguments': '{\n  "people": [\n    {\n      "name": "Joe",\n      "age": 30\n    },\n    {\n      "name": "Martha"\n    }\n  ]\n}'}})</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> extraction_model </block><block class="operator token">|</block><block class=" token"> JsonOutputFunctionsParser</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"Joe is 30, his mom is Martha"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'people': [{'name': 'Joe', 'age': 30}, {'name': 'Martha'}]}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">output_parsers</block><block class="punctuation token">.</block><block class=" token">openai_functions </block><block class="keyword token">import</block><block class=" token"> JsonKeyOutputFunctionsParser</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> extraction_model </block><block class="operator token">|</block><block class=" token"> JsonKeyOutputFunctionsParser</block><block class="punctuation token">(</block><block class=" token">key_name</block><block class="operator token">=</block><block class="string token">"people"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"Joe is 30, his mom is Martha"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># [{'name': 'Joe', 'age': 30}, {'name': 'Martha'}]</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" style="line-height: 1.4; font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.018505856230518924" id="n0.018505856230518924" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">5.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Real-world Example</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Here, we're going to get a blog post and extract tag information from a sub-set of the text.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">document_loaders </block><block class="keyword token">import</block><block class=" token"> WebBaseLoader</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">loader </block><block class="operator token">=</block><block class=" token"> WebBaseLoader</block><block class="punctuation token">(</block><block class="string token">"https://lilianweng.github.io/posts/2023-06-23-agent/"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">documents </block><block class="operator token">=</block><block class=" token"> loader</block><block class="punctuation token">.</block><block class=" token">load</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">doc </block><block class="operator token">=</block><block class=" token"> documents</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">page_content </block><block class="operator token">=</block><block class=" token"> doc</block><block class="punctuation token">.</block><block class=" token">page_content</block><block class="punctuation token">[</block><block class="punctuation token">:</block><block class="number token">10000</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Tagging</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">Overview</block><block class="punctuation token">(</block><block class=" token">BaseModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Overview of a section of text."""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    summary</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class=" token">description</block><block class="operator token">=</block><block class="string token">"Provide a concise summary of the content."</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    language</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class=" token">description</block><block class="operator token">=</block><block class="string token">"Provide the language that the content is written in."</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    keywords</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class=" token">description</block><block class="operator token">=</block><block class="string token">"Provide keywords related to the content."</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">overview_tagging_function </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    convert_pydantic_to_openai_function</block><block class="punctuation token">(</block><block class=" token">Overview</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">tagging_model </block><block class="operator token">=</block><block class=" token"> model</block><block class="punctuation token">.</block><block class=" token">bind</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    functions</block><block class="operator token">=</block><block class=" token">overview_tagging_function</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    function_call</block><block class="operator token">=</block><block class="punctuation token">{</block><block class="string token">"name"</block><block class="punctuation token">:</block><block class="string token">"Overview"</block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">tagging_chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> tagging_model </block><block class="operator token">|</block><block class=" token"> JsonOutputFunctionsParser</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">tagging_chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> page_content</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'summary': 'This article discusses the concept of building autonomous agents powered by LLM (large language model) as their core controller. It explores the key components of such agent systems, including planning, memory, and tool use. It also covers various techniques for task decomposition and self-reflection in autonomous agents. The article provides examples of case studies and challenges in implementing LLM-powered autonomous agents.',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'language': 'English',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'keywords': 'LLM, autonomous agents, planning, memory, tool use, task decomposition, self-reflection, case studies, challenges'}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Now, let's get a list of all papers mentioned in the blog post</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">Paper</block><block class="punctuation token">(</block><block class=" token">BaseModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Information about papers mentioned."""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    title</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    author</block><block class="punctuation token">:</block><block class=" token"> Optional</block><block class="punctuation token">[</block><block class="builtin token">str</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">Info</block><block class="punctuation token">(</block><block class=" token">BaseModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Information to extract"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    papers</block><block class="punctuation token">:</block><block class=" token"> List</block><block class="punctuation token">[</block><block class=" token">Paper</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">paper_extraction_function </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    convert_pydantic_to_openai_function</block><block class="punctuation token">(</block><block class=" token">Info</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_model </block><block class="operator token">=</block><block class=" token"> model</block><block class="punctuation token">.</block><block class=" token">bind</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    functions</block><block class="operator token">=</block><block class=" token">paper_extraction_function</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    function_call</block><block class="operator token">=</block><block class="punctuation token">{</block><block class="string token">"name"</block><block class="punctuation token">:</block><block class="string token">"Info"</block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> extraction_model </block><block class="operator token">|</block><block class=" token"> JsonKeyOutputFunctionsParser</block><block class="punctuation token">(</block><block class=" token">key_name</block><block class="operator token">=</block><block class="string token">"papers"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> page_content</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># [{'title': 'LLM Powered Autonomous Agents', 'author': 'Lilian Weng'}]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># In the above, the LM gets confused because it's finding the article itself as the paper! We're going to fix it with giving it a better system message.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">template </block><block class="operator token">=</block><block class=" token"> </block><block class="triple-quoted-string string token">"""A article will be passed to you. Extract from it all papers that are mentioned by this article. </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">Do not extract the name of the article itself. If no papers are mentioned that's fine - you don't need to extract any! Just return an empty list.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">Do not make up or guess ANY extra information. Only extract what exactly is in the text."""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prompt </block><block class="operator token">=</block><block class=" token"> ChatPromptTemplate</block><block class="punctuation token">.</block><block class=" token">from_messages</block><block class="punctuation token">(</block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"system"</block><block class="punctuation token">,</block><block class=" token"> template</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"human"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"{input}"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> extraction_model </block><block class="operator token">|</block><block class=" token"> JsonKeyOutputFunctionsParser</block><block class="punctuation token">(</block><block class=" token">key_name</block><block class="operator token">=</block><block class="string token">"papers"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> page_content</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># [{'title': 'Chain of thought (CoT; Wei et al. 2022)', 'author': 'Wei et al.'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  {'title': 'Tree of Thoughts (Yao et al. 2023)', 'author': 'Yao et al.'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  {'title': 'LLM+P (Liu et al. 2023)', 'author': 'Liu et al.'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  {'title': 'ReAct (Yao et al. 2023)', 'author': 'Yao et al.'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  {'title': 'Reflexion (Shinn &amp; Labash 2023)', 'author': 'Shinn &amp; Labash'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  {'title': 'Chain of Hindsight (CoH; Liu et al. 2023)',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'author': 'Liu et al.'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  {'title': 'Algorithm Distillation (AD; Laskin et al. 2023)',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'author': 'Laskin et al.'}]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">extraction_chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"hi"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># []</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Do the same on the entire content</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">text_splitter </block><block class="keyword token">import</block><block class=" token"> RecursiveCharacterTextSplitter</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">text_splitter </block><block class="operator token">=</block><block class=" token"> RecursiveCharacterTextSplitter</block><block class="punctuation token">(</block><block class=" token">chunk_overlap</block><block class="operator token">=</block><block class="number token">0</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">splits </block><block class="operator token">=</block><block class=" token"> text_splitter</block><block class="punctuation token">.</block><block class=" token">split_text</block><block class="punctuation token">(</block><block class=" token">doc</block><block class="punctuation token">.</block><block class=" token">page_content</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">flatten</block><block class="punctuation token">(</block><block class=" token">matrix</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    flat_list </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">for</block><block class=" token"> row </block><block class="keyword token">in</block><block class=" token"> matrix</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        flat_list </block><block class="operator token">+=</block><block class=" token"> row</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> flat_list</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">flatten</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class="punctuation token">[</block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">2</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> </block><block class="punctuation token">[</block><block class="number token">3</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">4</block><block class="punctuation token">]</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># flatten([[1, 2], [3, 4]])</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">schema</block><block class="punctuation token">.</block><block class=" token">runnable </block><block class="keyword token">import</block><block class=" token"> RunnableLambda</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prep </block><block class="operator token">=</block><block class=" token"> RunnableLambda</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">lambda</block><block class=" token"> x</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> doc</block><block class="punctuation token">}</block><block class=" token"> </block><block class="keyword token">for</block><block class=" token"> doc </block><block class="keyword token">in</block><block class=" token"> text_splitter</block><block class="punctuation token">.</block><block class=" token">split_text</block><block class="punctuation token">(</block><block class=" token">x</block><block class="punctuation token">)</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prep</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="string token">"hi"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># [{'input': 'hi'}]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># .map() is used because "prep" returns a list of objects.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#        To implement extract on all elements of the list, we use .map()</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain </block><block class="operator token">=</block><block class=" token"> prep </block><block class="operator token">|</block><block class=" token"> extraction_chain</block><block class="punctuation token">.</block><block class="builtin token">map</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">|</block><block class=" token"> flatten</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class=" token">doc</block><block class="punctuation token">.</block><block class=" token">page_content</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># [{'title': 'AutoGPT', 'author': ''},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  {'title': 'GPT-Engineer', 'author': ''},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  {'title': 'BabyAGI', 'author': ''},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  {'title': 'Chain of thought (CoT; Wei et al. 2022)', 'author': ''},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  {'title': 'Tree of Thoughts (Yao et al. 2023)', 'author': ''},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  {'title': 'LLM+P (Liu et al. 2023)', 'author': ''},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  ...]</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" style="line-height: 1.4; font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.7301665705190514" id="n0.7301665705190514" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">6. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Tools and Routing</block></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.12496366649896395" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.12496366649896395" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">6.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Tools</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>When we think about how the LM use functions, there's two components to it:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Having a LM decide which function to use and what the inputs to that function should be.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Calling that function with those inputs.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>LangChain combines these two components into something called a </block><block style="font-weight: bold; color: rgb(255, 64, 0);">Tool</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Tool</block><block> is basically a schema definition for the function and a callable.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There's many tools built-in to LangChain but one can create his own tool as well.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Selecting from multiple possible tools is called </block><block style="font-weight: bold; color: rgb(255, 64, 0);">routing</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Functions and services an LLM can utilize to extend its capabilities are named </block><block style="font-weight: bold;">"tools"</block><block> in LangChain.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>LangChain has many tools available:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Search tools, math tools, SQL tools, etc.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In this section, we are creating our own tool based on an OpenAI spec.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Predating LLMs, the OpenAI specification is routinely used by service providers to describe their APIs.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># importing the tool decorator from langchain</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">agents </block><block class="keyword token">import</block><block class=" token"> tool</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">@tool</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">search</block><block class="punctuation token">(</block><block class=" token">query</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">-</block><block class="operator token">&gt;</block><block class=" token"> </block><block class="builtin token">str</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Search for weather online"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> </block><block class="string token">"42f"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Creating a definition for the input</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># This is important because that's what's used by the LM</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> pydantic </block><block class="keyword token">import</block><block class=" token"> BaseModel</block><block class="punctuation token">,</block><block class=" token"> Field</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">SearchInput</block><block class="punctuation token">(</block><block class=" token">BaseModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    query</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class=" token">description</block><block class="operator token">=</block><block class="string token">"Thing to search for"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">@tool</block><block class="punctuation token">(</block><block class=" token">args_schema</block><block class="operator token">=</block><block class=" token">SearchInput</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">search</block><block class="punctuation token">(</block><block class=" token">query</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">-</block><block class="operator token">&gt;</block><block class=" token"> </block><block class="builtin token">str</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Search for the weather online."""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> </block><block class="string token">"42f"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">search</block><block class="punctuation token">.</block><block class=" token">args</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'query': {'title': 'Query',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'description': 'Thing to search for',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'type': 'string'}}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">search</block><block class="punctuation token">.</block><block class=" token">run</block><block class="punctuation token">(</block><block class="string token">"sf"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># '42f'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">##### Getting the temperature tool</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> requests</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> pydantic </block><block class="keyword token">import</block><block class=" token"> BaseModel</block><block class="punctuation token">,</block><block class=" token"> Field</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> datetime</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Define the input schema</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">OpenMeteoInput</block><block class="punctuation token">(</block><block class=" token">BaseModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    latitude</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">float</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class="punctuation token">.</block><block class="punctuation token">.</block><block class="punctuation token">.</block><block class="punctuation token">,</block><block class=" token"> description</block><block class="operator token">=</block><block class="string token">"Latitude of the location to fetch weather data for"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    longitude</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">float</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class="punctuation token">.</block><block class="punctuation token">.</block><block class="punctuation token">.</block><block class="punctuation token">,</block><block class=" token"> description</block><block class="operator token">=</block><block class="string token">"Longitude of the location to fetch weather data for"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">@tool</block><block class="punctuation token">(</block><block class=" token">args_schema</block><block class="operator token">=</block><block class=" token">OpenMeteoInput</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">get_current_temperature</block><block class="punctuation token">(</block><block class=" token">latitude</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">float</block><block class="punctuation token">,</block><block class=" token"> longitude</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">float</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">-</block><block class="operator token">&gt;</block><block class=" token"> </block><block class="builtin token">dict</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Fetch current temperature for given coordinates."""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    BASE_URL </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">"https://api.open-meteo.com/v1/forecast"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Parameters for the request</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    params </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">'latitude'</block><block class="punctuation token">:</block><block class=" token"> latitude</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">'longitude'</block><block class="punctuation token">:</block><block class=" token"> longitude</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">'hourly'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">'temperature_2m'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">'forecast_days'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Make the request</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    response </block><block class="operator token">=</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class=" token">BASE_URL</block><block class="punctuation token">,</block><block class=" token"> params</block><block class="operator token">=</block><block class=" token">params</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> response</block><block class="punctuation token">.</block><block class=" token">status_code </block><block class="operator token">==</block><block class=" token"> </block><block class="number token">200</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        results </block><block class="operator token">=</block><block class=" token"> response</block><block class="punctuation token">.</block><block class=" token">json</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">else</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">raise</block><block class=" token"> Exception</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"API Request failed with status code: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">response</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">status_code</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    current_utc_time </block><block class="operator token">=</block><block class=" token"> datetime</block><block class="punctuation token">.</block><block class=" token">datetime</block><block class="punctuation token">.</block><block class=" token">utcnow</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    time_list </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class=" token">datetime</block><block class="punctuation token">.</block><block class=" token">datetime</block><block class="punctuation token">.</block><block class=" token">fromisoformat</block><block class="punctuation token">(</block><block class=" token">time_str</block><block class="punctuation token">.</block><block class=" token">replace</block><block class="punctuation token">(</block><block class="string token">'Z'</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'+00:00'</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">for</block><block class=" token"> time_str </block><block class="keyword token">in</block><block class=" token"> results</block><block class="punctuation token">[</block><block class="string token">'hourly'</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="string token">'time'</block><block class="punctuation token">]</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    temperature_list </block><block class="operator token">=</block><block class=" token"> results</block><block class="punctuation token">[</block><block class="string token">'hourly'</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="string token">'temperature_2m'</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    closest_time_index </block><block class="operator token">=</block><block class=" token"> </block><block class="builtin token">min</block><block class="punctuation token">(</block><block class="builtin token">range</block><block class="punctuation token">(</block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">time_list</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> key</block><block class="operator token">=</block><block class="keyword token">lambda</block><block class=" token"> i</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">abs</block><block class="punctuation token">(</block><block class=" token">time_list</block><block class="punctuation token">[</block><block class=" token">i</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">-</block><block class=" token"> current_utc_time</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    current_temperature </block><block class="operator token">=</block><block class=" token"> temperature_list</block><block class="punctuation token">[</block><block class=" token">closest_time_index</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> </block><block class="string-interpolation string token">f'The current temperature is </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">current_temperature</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">C'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">get_current_temperature</block><block class="punctuation token">.</block><block class=" token">name</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># 'get_current_temperature'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">get_current_temperature</block><block class="punctuation token">.</block><block class=" token">description</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># 'get_current_temperature(latitude: float, longitude: float) -&gt; dict - Fetch current temperature for given coordinates.'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">get_current_temperature</block><block class="punctuation token">.</block><block class=" token">args</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># # {'latitude': {'title': 'Latitude',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'description': 'Latitude of the location to fetch weather data for',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'type': 'number'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'longitude': {'title': 'Longitude',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'description': 'Longitude of the location to fetch weather data for',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'type': 'number'}}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">tools</block><block class="punctuation token">.</block><block class=" token">render </block><block class="keyword token">import</block><block class=" token"> format_tool_to_openai_function</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">format_tool_to_openai_function</block><block class="punctuation token">(</block><block class=" token">get_current_temperature</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'name': 'get_current_temperature',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'description': 'get_current_temperature(latitude: float, longitude: float) -&gt; dict - Fetch current temperature for given coordinates.',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'parameters': {'title': 'OpenMeteoInput',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'type': 'object',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'properties': {'latitude': {'title': 'Latitude',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     'description': 'Latitude of the location to fetch weather data for',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     'type': 'number'},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#    'longitude': {'title': 'Longitude',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     'description': 'Longitude of the location to fetch weather data for',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#     'type': 'number'}},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'required': ['latitude', 'longitude']}}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">get_current_temperature</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"latitude"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">13</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"longitude"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">14</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># 'The current temperature is 30.2C'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">##### Searching Wiki tool</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> wikipedia</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">@tool</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">search_wikipedia</block><block class="punctuation token">(</block><block class=" token">query</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">-</block><block class="operator token">&gt;</block><block class=" token"> </block><block class="builtin token">str</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Run Wikipedia search and get page summaries."""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    page_titles </block><block class="operator token">=</block><block class=" token"> wikipedia</block><block class="punctuation token">.</block><block class=" token">search</block><block class="punctuation token">(</block><block class=" token">query</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    summaries </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">for</block><block class=" token"> page_title </block><block class="keyword token">in</block><block class=" token"> page_titles</block><block class="punctuation token">[</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">3</block><block class="punctuation token">]</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">try</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            wiki_page </block><block class="operator token">=</block><block class=" token">  wikipedia</block><block class="punctuation token">.</block><block class=" token">page</block><block class="punctuation token">(</block><block class=" token">title</block><block class="operator token">=</block><block class=" token">page_title</block><block class="punctuation token">,</block><block class=" token"> auto_suggest</block><block class="operator token">=</block><block class="boolean token">False</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            summaries</block><block class="punctuation token">.</block><block class=" token">append</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Page: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">page_title</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">\nSummary: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">wiki_page</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">summary</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">except</block><block class=" token"> </block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            self</block><block class="punctuation token">.</block><block class=" token">wiki_client</block><block class="punctuation token">.</block><block class=" token">exceptions</block><block class="punctuation token">.</block><block class=" token">PageError</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            self</block><block class="punctuation token">.</block><block class=" token">wiki_client</block><block class="punctuation token">.</block><block class=" token">exceptions</block><block class="punctuation token">.</block><block class=" token">DisambiguationError</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">pass</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> </block><block class="keyword token">not</block><block class=" token"> summaries</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">return</block><block class=" token"> </block><block class="string token">"No good Wikipedia Search Result was found"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> </block><block class="string token">"\n\n"</block><block class="punctuation token">.</block><block class=" token">join</block><block class="punctuation token">(</block><block class=" token">summaries</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">format_tool_to_openai_function</block><block class="punctuation token">(</block><block class=" token">search_wikipedia</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'name': 'search_wikipedia',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'description': 'search_wikipedia(query: str) -&gt; str - Run Wikipedia search and get page summaries.',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'parameters': {'title': 'search_wikipediaSchemaSchema',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'type': 'object',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'properties': {'query': {'title': 'Query', 'type': 'string'}},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'required': ['query']}}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">search_wikipedia</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"query"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"langchain"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># 'Page: LangChain\nSummary: LangChain is a framework designed to simplify the creation of applications using large language models (LLMs). As a language model ...'</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Often times, functions that we want to interact with are exposed behind APIs. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Often times, APIs have specific specifications for their inputs and outputs  </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(251, 111, 117);">OpenAPISpec</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In the example below, we see how we can convert this OpenAPI to an OpenAI function.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">chains</block><block class="punctuation token">.</block><block class=" token">openai_functions</block><block class="punctuation token">.</block><block class=" token">openapi </block><block class="keyword token">import</block><block class=" token"> openapi_spec_to_openai_fn</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">utilities</block><block class="punctuation token">.</block><block class=" token">openapi </block><block class="keyword token">import</block><block class=" token"> OpenAPISpec</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">text </block><block class="operator token">=</block><block class=" token"> </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">  "openapi": "3.0.0",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">  "info": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    "version": "1.0.0",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    "title": "Swagger Petstore",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    "license": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      "name": "MIT"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">  },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">  "servers": [</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      "url": "http://petstore.swagger.io/v1"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">  ],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">  "paths": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    "/pets": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      "get": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "summary": "List all pets",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "operationId": "listPets",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "tags": [</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "pets"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        ],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "parameters": [</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "name": "limit",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "in": "query",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "description": "How many items to return at one time (max 100)",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "required": false,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "schema": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              "type": "integer",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              "maximum": 100,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              "format": "int32"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        ],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "responses": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "200": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "description": "A paged array of pets",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "headers": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              "x-next": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                "description": "A link to the next page of responses",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                "schema": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                  "type": "string"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "content": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              "application/json": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                "schema": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                  "$ref": "#/components/schemas/Pets"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "default": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "description": "unexpected error",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "content": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              "application/json": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                "schema": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                  "$ref": "#/components/schemas/Error"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      "post": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "summary": "Create a pet",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "operationId": "createPets",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "tags": [</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "pets"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        ],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "responses": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "201": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "description": "Null response"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "default": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "description": "unexpected error",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "content": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              "application/json": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                "schema": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                  "$ref": "#/components/schemas/Error"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    "/pets/{petId}": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      "get": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "summary": "Info for a specific pet",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "operationId": "showPetById",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "tags": [</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "pets"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        ],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "parameters": [</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "name": "petId",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "in": "path",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "required": true,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "description": "The id of the pet to retrieve",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "schema": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              "type": "string"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        ],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "responses": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "200": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "description": "Expected response to a valid request",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "content": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              "application/json": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                "schema": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                  "$ref": "#/components/schemas/Pet"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "default": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "description": "unexpected error",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "content": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              "application/json": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                "schema": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                  "$ref": "#/components/schemas/Error"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">                }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">              }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">  },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">  "components": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    "schemas": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      "Pet": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "type": "object",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "required": [</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "id",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "name"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        ],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "properties": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "id": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "type": "integer",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "format": "int64"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "name": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "type": "string"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "tag": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "type": "string"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      "Pets": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "type": "array",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "maxItems": 100,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "items": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "$ref": "#/components/schemas/Pet"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      "Error": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "type": "object",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "required": [</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "code",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "message"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        ],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        "properties": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "code": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "type": "integer",</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "format": "int32"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          },</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          "message": {</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            "type": "string"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">      }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">  }</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">spec </block><block class="operator token">=</block><block class=" token"> OpenAPISpec</block><block class="punctuation token">.</block><block class=" token">from_text</block><block class="punctuation token">(</block><block class=" token">text</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">pet_openai_functions</block><block class="punctuation token">,</block><block class=" token"> pet_callables </block><block class="operator token">=</block><block class=" token"> openapi_spec_to_openai_fn</block><block class="punctuation token">(</block><block class=" token">spec</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">pet_openai_functions</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># [{'name': 'listPets',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'description': 'List all pets',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'parameters': {'type': 'object',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#    'properties': {'params': {'type': 'object',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#      'properties': {'limit': {'type': 'integer',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#        'maximum': 100.0,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#        'schema_format': 'int32',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#        'description': 'How many items to return at one time (max 100)'}},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#      'required': []}}}},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  {'name': 'createPets',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'description': 'Create a pet',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'parameters': {'type': 'object', 'properties': {}}},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  {'name': 'showPetById',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'description': 'Info for a specific pet',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   'parameters': {'type': 'object',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#    'properties': {'path_params': {'type': 'object',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#      'properties': {'petId': {'type': 'string',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#        'description': 'The id of the pet to retrieve'}},</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#      'required': ['petId']}}}}]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">chat_models </block><block class="keyword token">import</block><block class=" token"> ChatOpenAI</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model </block><block class="operator token">=</block><block class=" token"> ChatOpenAI</block><block class="punctuation token">(</block><block class=" token">temperature</block><block class="operator token">=</block><block class="number token">0</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">bind</block><block class="punctuation token">(</block><block class=" token">functions</block><block class="operator token">=</block><block class=" token">pet_openai_functions</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="string token">"what are three pets names"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AIMessage(content='', additional_kwargs={'function_call': {'name': 'listPets', 'arguments': '{\n  "params": {\n    "limit": 3\n  }\n}'}})</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="string token">"tell me about pet with id 42"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AIMessage(content='', additional_kwargs={'function_call': {'name': 'showPetById', 'arguments': '{\n  "path_params": {\n    "petId": "42"\n  }\n}'}})</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" style="line-height: 1.4; font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.9931548687371452" id="n0.9931548687371452" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">6.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Routing</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Given our tools above, let's format these as OpenAI functions and show this same behavior.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Routing</block><block>  using LLM to determine which function to use + what are the inputs to the function</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">functions </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    format_tool_to_openai_function</block><block class="punctuation token">(</block><block class=" token">f</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">for</block><block class=" token"> f </block><block class="keyword token">in</block><block class=" token"> </block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        search_wikipedia</block><block class="punctuation token">,</block><block class=" token"> get_current_temperature</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model </block><block class="operator token">=</block><block class=" token"> ChatOpenAI</block><block class="punctuation token">(</block><block class=" token">temperature</block><block class="operator token">=</block><block class="number token">0</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">bind</block><block class="punctuation token">(</block><block class=" token">functions</block><block class="operator token">=</block><block class=" token">functions</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="string token">"what is the weather in sf right now"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AIMessage(content='', additional_kwargs={'function_call': {'name': 'get_current_temperature', 'arguments': '{\n  "latitude": 37.7749,\n  "longitude": -122.4194\n}'}})</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="string token">"what is langchain"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AIMessage(content='', additional_kwargs={'function_call': {'name': 'search_wikipedia', 'arguments': '{\n  "query": "langchain"\n}'}})</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">prompts </block><block class="keyword token">import</block><block class=" token"> ChatPromptTemplate</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prompt </block><block class="operator token">=</block><block class=" token"> ChatPromptTemplate</block><block class="punctuation token">.</block><block class=" token">from_messages</block><block class="punctuation token">(</block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"system"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"You are helpful but sassy assistant"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"user"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"{input}"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"what is the weather in sf right now"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AIMessage(content='', additional_kwargs={'function_call': {'name': 'get_current_temperature', 'arguments': '{\n  "latitude": 37.7749,\n  "longitude": -122.4194\n}'}})</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">agents</block><block class="punctuation token">.</block><block class=" token">output_parsers </block><block class="keyword token">import</block><block class=" token"> OpenAIFunctionsAgentOutputParser</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> model </block><block class="operator token">|</block><block class=" token"> OpenAIFunctionsAgentOutputParser</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">result </block><block class="operator token">=</block><block class=" token"> chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"what is the weather in sf right now"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="builtin token">type</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># langchain.schema.agent.AgentActionMessageLog</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">.</block><block class=" token">tool</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># 'get_current_temperature'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">.</block><block class=" token">tool_input</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'latitude': 37.7749, 'longitude': -122.4194}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">get_current_temperature</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">.</block><block class=" token">tool_input</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># 'The current temperature is 13.1C'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">result </block><block class="operator token">=</block><block class=" token"> chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"hi!"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="builtin token">type</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># langchain.schema.agent.AgentFinish</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">result</block><block class="punctuation token">.</block><block class=" token">return_values</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'output': 'Hello! How can I assist you today?'}</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>When a function is called  </block><block style="font-weight: bold; font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(251, 111, 117);">AgentAction</block><block>, and if not  </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(251, 111, 117);">AgentFinish</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We use these to write a routing function.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">schema</block><block class="punctuation token">.</block><block class=" token">agent </block><block class="keyword token">import</block><block class=" token"> AgentFinish</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">route</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> </block><block class="builtin token">isinstance</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">,</block><block class=" token"> AgentFinish</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">return</block><block class=" token"> result</block><block class="punctuation token">.</block><block class=" token">return_values</block><block class="punctuation token">[</block><block class="string token">'output'</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">else</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        tools </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"search_wikipedia"</block><block class="punctuation token">:</block><block class=" token"> search_wikipedia</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"get_current_temperature"</block><block class="punctuation token">:</block><block class=" token"> get_current_temperature</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">return</block><block class=" token"> tools</block><block class="punctuation token">[</block><block class=" token">result</block><block class="punctuation token">.</block><block class=" token">tool</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class=" token">run</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">.</block><block class=" token">tool_input</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> model </block><block class="operator token">|</block><block class=" token"> OpenAIFunctionsAgentOutputParser</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">|</block><block class=" token"> route</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">result </block><block class="operator token">=</block><block class=" token"> chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"What is the weather in san francisco right now?"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># 'The current temperature is 13.1C'</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" style="line-height: 1.4; font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.7189534581762422" id="n0.7189534581762422" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">7. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Conversational Agent</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In this section, we combine tool usage with chat memory to create a conversational agent similar to ChatGPT.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" style="line-height: 1.4; font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.2834242762306962" id="n0.2834242762306962" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">7.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Agents</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; color: rgb(0, 0, 0);"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Agents</block><block> are a combination of LLMs and code</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; color: rgb(0, 0, 0);"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>LLMs reason about what steps to take and call for actions.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; font-weight: bold; color: rgb(0, 0, 0);"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Agent Loop</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; color: rgb(0, 0, 0);"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Choose a tool to use</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; color: rgb(0, 0, 0);"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Observe the output of the tool</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; color: rgb(0, 0, 0);"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Repeat until a stopping condition is met. </block><block style="font-weight: bold;">What are those stopping criteria?</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>LLM-determined</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Hard-coded rules (e.g., max number of iterations, etc.)</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">tools </block><block class="keyword token">import</block><block class=" token"> tool</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> requests</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> pydantic </block><block class="keyword token">import</block><block class=" token"> BaseModel</block><block class="punctuation token">,</block><block class=" token"> Field</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> datetime</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Define the input schema</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">OpenMeteoInput</block><block class="punctuation token">(</block><block class=" token">BaseModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    latitude</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">float</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class="punctuation token">.</block><block class="punctuation token">.</block><block class="punctuation token">.</block><block class="punctuation token">,</block><block class=" token"> description</block><block class="operator token">=</block><block class="string token">"Latitude of the location to fetch weather data for"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    longitude</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">float</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> Field</block><block class="punctuation token">(</block><block class="punctuation token">.</block><block class="punctuation token">.</block><block class="punctuation token">.</block><block class="punctuation token">,</block><block class=" token"> description</block><block class="operator token">=</block><block class="string token">"Longitude of the location to fetch weather data for"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">@tool</block><block class="punctuation token">(</block><block class=" token">args_schema</block><block class="operator token">=</block><block class=" token">OpenMeteoInput</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">get_current_temperature</block><block class="punctuation token">(</block><block class=" token">latitude</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">float</block><block class="punctuation token">,</block><block class=" token"> longitude</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">float</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">-</block><block class="operator token">&gt;</block><block class=" token"> </block><block class="builtin token">dict</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Fetch current temperature for given coordinates."""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    BASE_URL </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">"https://api.open-meteo.com/v1/forecast"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Parameters for the request</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    params </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">'latitude'</block><block class="punctuation token">:</block><block class=" token"> latitude</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">'longitude'</block><block class="punctuation token">:</block><block class=" token"> longitude</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">'hourly'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">'temperature_2m'</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">'forecast_days'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">1</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Make the request</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    response </block><block class="operator token">=</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class=" token">BASE_URL</block><block class="punctuation token">,</block><block class=" token"> params</block><block class="operator token">=</block><block class=" token">params</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> response</block><block class="punctuation token">.</block><block class=" token">status_code </block><block class="operator token">==</block><block class=" token"> </block><block class="number token">200</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        results </block><block class="operator token">=</block><block class=" token"> response</block><block class="punctuation token">.</block><block class=" token">json</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">else</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">raise</block><block class=" token"> Exception</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"API Request failed with status code: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">response</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">status_code</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    current_utc_time </block><block class="operator token">=</block><block class=" token"> datetime</block><block class="punctuation token">.</block><block class=" token">datetime</block><block class="punctuation token">.</block><block class=" token">utcnow</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    time_list </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class=" token">datetime</block><block class="punctuation token">.</block><block class=" token">datetime</block><block class="punctuation token">.</block><block class=" token">fromisoformat</block><block class="punctuation token">(</block><block class=" token">time_str</block><block class="punctuation token">.</block><block class=" token">replace</block><block class="punctuation token">(</block><block class="string token">'Z'</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">'+00:00'</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">for</block><block class=" token"> time_str </block><block class="keyword token">in</block><block class=" token"> results</block><block class="punctuation token">[</block><block class="string token">'hourly'</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="string token">'time'</block><block class="punctuation token">]</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    temperature_list </block><block class="operator token">=</block><block class=" token"> results</block><block class="punctuation token">[</block><block class="string token">'hourly'</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="string token">'temperature_2m'</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    closest_time_index </block><block class="operator token">=</block><block class=" token"> </block><block class="builtin token">min</block><block class="punctuation token">(</block><block class="builtin token">range</block><block class="punctuation token">(</block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">time_list</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> key</block><block class="operator token">=</block><block class="keyword token">lambda</block><block class=" token"> i</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">abs</block><block class="punctuation token">(</block><block class=" token">time_list</block><block class="punctuation token">[</block><block class=" token">i</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">-</block><block class=" token"> current_utc_time</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    current_temperature </block><block class="operator token">=</block><block class=" token"> temperature_list</block><block class="punctuation token">[</block><block class=" token">closest_time_index</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> </block><block class="string-interpolation string token">f'The current temperature is </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">current_temperature</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">C'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> wikipedia</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">@tool</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">search_wikipedia</block><block class="punctuation token">(</block><block class=" token">query</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">-</block><block class="operator token">&gt;</block><block class=" token"> </block><block class="builtin token">str</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""Run Wikipedia search and get page summaries."""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    page_titles </block><block class="operator token">=</block><block class=" token"> wikipedia</block><block class="punctuation token">.</block><block class=" token">search</block><block class="punctuation token">(</block><block class=" token">query</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    summaries </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">for</block><block class=" token"> page_title </block><block class="keyword token">in</block><block class=" token"> page_titles</block><block class="punctuation token">[</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">3</block><block class="punctuation token">]</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">try</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            wiki_page </block><block class="operator token">=</block><block class=" token">  wikipedia</block><block class="punctuation token">.</block><block class=" token">page</block><block class="punctuation token">(</block><block class=" token">title</block><block class="operator token">=</block><block class=" token">page_title</block><block class="punctuation token">,</block><block class=" token"> auto_suggest</block><block class="operator token">=</block><block class="boolean token">False</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            summaries</block><block class="punctuation token">.</block><block class=" token">append</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Page: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">page_title</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">\nSummary: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">wiki_page</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">summary</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">except</block><block class=" token"> </block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            self</block><block class="punctuation token">.</block><block class=" token">wiki_client</block><block class="punctuation token">.</block><block class=" token">exceptions</block><block class="punctuation token">.</block><block class=" token">PageError</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            self</block><block class="punctuation token">.</block><block class=" token">wiki_client</block><block class="punctuation token">.</block><block class=" token">exceptions</block><block class="punctuation token">.</block><block class=" token">DisambiguationError</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">pass</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> </block><block class="keyword token">not</block><block class=" token"> summaries</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">return</block><block class=" token"> </block><block class="string token">"No good Wikipedia Search Result was found"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> </block><block class="string token">"\n\n"</block><block class="punctuation token">.</block><block class=" token">join</block><block class="punctuation token">(</block><block class=" token">summaries</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">tools </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class=" token">get_current_temperature</block><block class="punctuation token">,</block><block class=" token"> search_wikipedia</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">chat_models </block><block class="keyword token">import</block><block class=" token"> ChatOpenAI</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">prompts </block><block class="keyword token">import</block><block class=" token"> ChatPromptTemplate</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">tools</block><block class="punctuation token">.</block><block class=" token">render </block><block class="keyword token">import</block><block class=" token"> format_tool_to_openai_function</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">agents</block><block class="punctuation token">.</block><block class=" token">output_parsers </block><block class="keyword token">import</block><block class=" token"> OpenAIFunctionsAgentOutputParser</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">functions </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class=" token">format_tool_to_openai_function</block><block class="punctuation token">(</block><block class=" token">f</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">for</block><block class=" token"> f </block><block class="keyword token">in</block><block class=" token"> tools</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model </block><block class="operator token">=</block><block class=" token"> ChatOpenAI</block><block class="punctuation token">(</block><block class=" token">temperature</block><block class="operator token">=</block><block class="number token">0</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">bind</block><block class="punctuation token">(</block><block class=" token">functions</block><block class="operator token">=</block><block class=" token">functions</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prompt </block><block class="operator token">=</block><block class=" token"> ChatPromptTemplate</block><block class="punctuation token">.</block><block class=" token">from_messages</block><block class="punctuation token">(</block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"system"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"You are helpful but sassy assistant"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"user"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"{input}"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> model </block><block class="operator token">|</block><block class=" token"> OpenAIFunctionsAgentOutputParser</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">result </block><block class="operator token">=</block><block class=" token"> chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"what is the weather is sf?"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">result</block><block class="punctuation token">.</block><block class=" token">tool_input</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'latitude': 37.7749, 'longitude': -122.4194}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">##### Adding MessagesPlaceholder to keep the memory of our messages</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">prompts </block><block class="keyword token">import</block><block class=" token"> MessagesPlaceholder</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prompt </block><block class="operator token">=</block><block class=" token"> ChatPromptTemplate</block><block class="punctuation token">.</block><block class=" token">from_messages</block><block class="punctuation token">(</block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"system"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"You are helpful but sassy assistant"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"user"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"{input}"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    MessagesPlaceholder</block><block class="punctuation token">(</block><block class=" token">variable_name</block><block class="operator token">=</block><block class="string token">"agent_scratchpad"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">chain </block><block class="operator token">=</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> model </block><block class="operator token">|</block><block class=" token"> OpenAIFunctionsAgentOutputParser</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">result1 </block><block class="operator token">=</block><block class=" token"> chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"what is the weather is sf?"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"agent_scratchpad"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">result1</block><block class="punctuation token">.</block><block class=" token">tool</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># 'get_current_temperature'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">observation </block><block class="operator token">=</block><block class=" token"> get_current_temperature</block><block class="punctuation token">(</block><block class=" token">result1</block><block class="punctuation token">.</block><block class=" token">tool_input</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">observation</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># 'The current temperature is 16.6C'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="builtin token">type</block><block class="punctuation token">(</block><block class=" token">result1</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># langchain.schema.agent.AgentActionMessageLog</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#### This next steps takes the results of the functions and pass it as a list of messages to the LLM</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">agents</block><block class="punctuation token">.</block><block class=" token">format_scratchpad </block><block class="keyword token">import</block><block class=" token"> format_to_openai_functions</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">result1</block><block class="punctuation token">.</block><block class=" token">message_log</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># [AIMessage(content='', additional_kwargs={'function_call': {'name': 'get_current_temperature', 'arguments': '{\n  "latitude": 37.7749,\n  "longitude": -122.4194\n}'}})]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">format_to_openai_functions</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class="punctuation token">(</block><block class=" token">result1</block><block class="punctuation token">,</block><block class=" token"> observation</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># [AIMessage(content='', additional_kwargs={'function_call': {'name': 'get_current_temperature', 'arguments': '{\n  "latitude": 37.7749,\n  "longitude": -122.4194\n}'}}),</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  FunctionMessage(content='The current temperature is 16.6C', name='get_current_temperature')]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">result2 </block><block class="operator token">=</block><block class=" token"> chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"what is the weather is sf?"</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"agent_scratchpad"</block><block class="punctuation token">:</block><block class=" token"> format_to_openai_functions</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class="punctuation token">(</block><block class=" token">result1</block><block class="punctuation token">,</block><block class=" token"> observation</block><block class="punctuation token">)</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">result2</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AgentFinish(return_values={'output': 'The current temperature in San Francisco is 16.6C.'}, log='The current temperature in San Francisco is 16.6C.')</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">schema</block><block class="punctuation token">.</block><block class=" token">agent </block><block class="keyword token">import</block><block class=" token"> AgentFinish</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#### We're going to put all the above steps into a function</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">run_agent</block><block class="punctuation token">(</block><block class=" token">user_input</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    intermediate_steps </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">while</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        result </block><block class="operator token">=</block><block class=" token"> chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> user_input</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"agent_scratchpad"</block><block class="punctuation token">:</block><block class=" token"> format_to_openai_functions</block><block class="punctuation token">(</block><block class=" token">intermediate_steps</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">if</block><block class=" token"> </block><block class="builtin token">isinstance</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">,</block><block class=" token"> AgentFinish</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">return</block><block class=" token"> result</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        tool </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"search_wikipedia"</block><block class="punctuation token">:</block><block class=" token"> search_wikipedia</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"get_current_temperature"</block><block class="punctuation token">:</block><block class=" token"> get_current_temperature</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">}</block><block class="punctuation token">[</block><block class=" token">result</block><block class="punctuation token">.</block><block class=" token">tool</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        observation </block><block class="operator token">=</block><block class=" token"> tool</block><block class="punctuation token">.</block><block class=" token">run</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">.</block><block class=" token">tool_input</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        intermediate_steps</block><block class="punctuation token">.</block><block class=" token">append</block><block class="punctuation token">(</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">,</block><block class=" token"> observation</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">schema</block><block class="punctuation token">.</block><block class=" token">runnable </block><block class="keyword token">import</block><block class=" token"> RunnablePassthrough</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">### `RunnablePassthrough` takes the initial input and passes it through</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">agent_chain </block><block class="operator token">=</block><block class=" token"> RunnablePassthrough</block><block class="punctuation token">.</block><block class=" token">assign</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    agent_scratchpad</block><block class="operator token">=</block><block class=" token"> </block><block class="keyword token">lambda</block><block class=" token"> x</block><block class="punctuation token">:</block><block class=" token"> format_to_openai_functions</block><block class="punctuation token">(</block><block class=" token">x</block><block class="punctuation token">[</block><block class="string token">"intermediate_steps"</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">|</block><block class=" token"> chain</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">run_agent</block><block class="punctuation token">(</block><block class=" token">user_input</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    intermediate_steps </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">while</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        result </block><block class="operator token">=</block><block class=" token"> agent_chain</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> user_input</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"intermediate_steps"</block><block class="punctuation token">:</block><block class=" token"> intermediate_steps</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">if</block><block class=" token"> </block><block class="builtin token">isinstance</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">,</block><block class=" token"> AgentFinish</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">return</block><block class=" token"> result</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        tool </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"search_wikipedia"</block><block class="punctuation token">:</block><block class=" token"> search_wikipedia</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"get_current_temperature"</block><block class="punctuation token">:</block><block class=" token"> get_current_temperature</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">}</block><block class="punctuation token">[</block><block class=" token">result</block><block class="punctuation token">.</block><block class=" token">tool</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        observation </block><block class="operator token">=</block><block class=" token"> tool</block><block class="punctuation token">.</block><block class=" token">run</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">.</block><block class=" token">tool_input</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        intermediate_steps</block><block class="punctuation token">.</block><block class=" token">append</block><block class="punctuation token">(</block><block class="punctuation token">(</block><block class=" token">result</block><block class="punctuation token">,</block><block class=" token"> observation</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">run_agent</block><block class="punctuation token">(</block><block class="string token">"what is the weather is sf?"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AgentFinish(return_values={'output': 'The current temperature in San Francisco is 16.6C.'}, log='The current temperature in San Francisco is 16.6C.')</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">run_agent</block><block class="punctuation token">(</block><block class="string token">"what is langchain?"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AgentFinish(return_values={'output': 'LangChain is a framework designed to simplify the creation of applications using large language models (LLMs). It is a language model integration framework that can be used for various tasks such as document analysis and summarization, chatbots, and code analysis. LangChain helps developers leverage the power of language models in their applications.'}, log='LangChain is a framework designed to simplify the creation of applications using large language models (LLMs). It is a language model integration framework that can be used for various tasks such as document analysis and summarization, chatbots, and code analysis. LangChain helps developers leverage the power of language models in their applications.')</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">run_agent</block><block class="punctuation token">(</block><block class="string token">"hi!"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># AgentFinish(return_values={'output': 'Hello! How can I assist you today?'}, log='Hello! How can I assist you today?')</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The </block><block style="font-weight: bold; font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(251, 111, 117);">AgentExecutor</block><block> class is just a souped up version of the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(251, 111, 117); font-weight: bold;">run_agent()</block><block> function above. It has logging, error handling (e.g. it handles when the LM doesn't return a properly formatted JSON output), error handling for the tools.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">agents </block><block class="keyword token">import</block><block class=" token"> AgentExecutor</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">agent_executor </block><block class="operator token">=</block><block class=" token"> AgentExecutor</block><block class="punctuation token">(</block><block class=" token">agent</block><block class="operator token">=</block><block class=" token">agent_chain</block><block class="punctuation token">,</block><block class=" token"> tools</block><block class="operator token">=</block><block class=" token">tools</block><block class="punctuation token">,</block><block class=" token"> verbose</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">agent_executor</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"what is langchain?"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># &gt; Entering new AgentExecutor chain...</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Invoking: `search_wikipedia` with `{'query': 'langchain'}`</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Page: LangChain</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Summary: LangChain is a framework designed to simplify the creation of applications using large language models (LLMs). As a language model integration framework, LangChain's use-cases largely overlap with those of language models in general, including document analysis and summarization, chatbots, and code analysis.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">agent_executor</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"my name is bob"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># &gt; Entering new AgentExecutor chain...</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Hello Bob! How can I assist you today?</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># &gt; Finished chain.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'input': 'my name is bob', 'output': 'Hello Bob! How can I assist you today?'}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">agent_executor</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"what is my name"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># &gt; Entering new AgentExecutor chain...</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># I'm sorry, but I don't have access to personal information.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># &gt; Finished chain.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'input': 'what is my name',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'output': "I'm sorry, but I don't have access to personal information."}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prompt </block><block class="operator token">=</block><block class=" token"> ChatPromptTemplate</block><block class="punctuation token">.</block><block class=" token">from_messages</block><block class="punctuation token">(</block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"system"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"You are helpful but sassy assistant"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    MessagesPlaceholder</block><block class="punctuation token">(</block><block class=" token">variable_name</block><block class="operator token">=</block><block class="string token">"chat_history"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">(</block><block class="string token">"user"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"{input}"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    MessagesPlaceholder</block><block class="punctuation token">(</block><block class=" token">variable_name</block><block class="operator token">=</block><block class="string token">"agent_scratchpad"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">agent_chain </block><block class="operator token">=</block><block class=" token"> RunnablePassthrough</block><block class="punctuation token">.</block><block class=" token">assign</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    agent_scratchpad</block><block class="operator token">=</block><block class=" token"> </block><block class="keyword token">lambda</block><block class=" token"> x</block><block class="punctuation token">:</block><block class=" token"> format_to_openai_functions</block><block class="punctuation token">(</block><block class=" token">x</block><block class="punctuation token">[</block><block class="string token">"intermediate_steps"</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">|</block><block class=" token"> prompt </block><block class="operator token">|</block><block class=" token"> model </block><block class="operator token">|</block><block class=" token"> OpenAIFunctionsAgentOutputParser</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#### Adding memory (chat history)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> langchain</block><block class="punctuation token">.</block><block class=" token">memory </block><block class="keyword token">import</block><block class=" token"> ConversationBufferMemory</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">memory </block><block class="operator token">=</block><block class=" token"> ConversationBufferMemory</block><block class="punctuation token">(</block><block class=" token">return_messages</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">,</block><block class=" token">memory_key</block><block class="operator token">=</block><block class="string token">"chat_history"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">agent_executor </block><block class="operator token">=</block><block class=" token"> AgentExecutor</block><block class="punctuation token">(</block><block class=" token">agent</block><block class="operator token">=</block><block class=" token">agent_chain</block><block class="punctuation token">,</block><block class=" token"> tools</block><block class="operator token">=</block><block class=" token">tools</block><block class="punctuation token">,</block><block class=" token"> verbose</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">,</block><block class=" token"> memory</block><block class="operator token">=</block><block class=" token">memory</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">agent_executor</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"my name is bob"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># &gt; Entering new AgentExecutor chain...</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Hello Bob! How can I assist you today?</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># &gt; Finished chain.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'input': 'my name is bob',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'chat_history': [HumanMessage(content='my name is bob'),</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   AIMessage(content='Hello Bob! How can I assist you today?')],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'output': 'Hello Bob! How can I assist you today?'}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">agent_executor</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"whats my name"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># &gt; Entering new AgentExecutor chain...</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Your name is Bob.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># &gt; Finished chain.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'input': 'whats my name',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'chat_history': [HumanMessage(content='my name is bob'),</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   AIMessage(content='Hello Bob! How can I assist you today?'),</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   HumanMessage(content='whats my name'),</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   AIMessage(content='Your name is Bob.')],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'output': 'Your name is Bob.'}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">agent_executor</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"whats the weather in sf?"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># &gt; Entering new AgentExecutor chain...</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Invoking: `get_current_temperature` with `{'latitude': 37.7749, 'longitude': -122.4194}`</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># The current temperature is 15.4CThe current temperature in San Francisco is 15.4C.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># &gt; Finished chain.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'input': 'whats the weather in sf?',</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'chat_history': [HumanMessage(content='my name is bob'),</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   AIMessage(content='Hello Bob! How can I assist you today?'),</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   HumanMessage(content='whats my name'),</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   AIMessage(content='Your name is Bob.'),</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   HumanMessage(content='whats the weather in sf?'),</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#   AIMessage(content='The current temperature in San Francisco is 15.4C.')],</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#  'output': 'The current temperature in San Francisco is 15.4C.'}</block></blocks></line></editarea></div></compositeblock><block> </block></blocks></line><line class="root text-mode section sindent-1" style="line-height: 1.4; font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold;" data-line-id="n0.7351896297714062" id="n0.7351896297714062" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">7.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Create a Chatbot</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="decorator annotation punctuation token">@tool</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">create_your_own</block><block class="punctuation token">(</block><block class=" token">query</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">-</block><block class="operator token">&gt;</block><block class=" token"> </block><block class="builtin token">str</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""This function can do whatever you would like once you fill it in """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="builtin token">type</block><block class="punctuation token">(</block><block class=" token">query</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> query</block><block class="punctuation token">[</block><block class="punctuation token">:</block><block class="punctuation token">:</block><block class="operator token">-</block><block class="number token">1</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">tools </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class=" token">get_current_temperature</block><block class="punctuation token">,</block><block class=" token"> search_wikipedia</block><block class="punctuation token">,</block><block class=" token"> create_your_own</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># GUI</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> panel </block><block class="keyword token">as</block><block class=" token"> pn</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">pn</block><block class="punctuation token">.</block><block class=" token">extension</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> panel </block><block class="keyword token">as</block><block class=" token"> pn</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> param</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">cbfs</block><block class="punctuation token">(</block><block class=" token">param</block><block class="punctuation token">.</block><block class=" token">Parameterized</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">__init__</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">,</block><block class=" token"> tools</block><block class="punctuation token">,</block><block class=" token"> </block><block class="operator token">**</block><block class=" token">params</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="builtin token">super</block><block class="punctuation token">(</block><block class=" token">cbfs</block><block class="punctuation token">,</block><block class=" token"> self</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">__init__</block><block class="punctuation token">(</block><block class=" token"> </block><block class="operator token">**</block><block class=" token">params</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">panels </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">functions </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class=" token">format_tool_to_openai_function</block><block class="punctuation token">(</block><block class=" token">f</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">for</block><block class=" token"> f </block><block class="keyword token">in</block><block class=" token"> tools</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">model </block><block class="operator token">=</block><block class=" token"> ChatOpenAI</block><block class="punctuation token">(</block><block class=" token">temperature</block><block class="operator token">=</block><block class="number token">0</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">bind</block><block class="punctuation token">(</block><block class=" token">functions</block><block class="operator token">=</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">functions</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">memory </block><block class="operator token">=</block><block class=" token"> ConversationBufferMemory</block><block class="punctuation token">(</block><block class=" token">return_messages</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">,</block><block class=" token">memory_key</block><block class="operator token">=</block><block class="string token">"chat_history"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">prompt </block><block class="operator token">=</block><block class=" token"> ChatPromptTemplate</block><block class="punctuation token">.</block><block class=" token">from_messages</block><block class="punctuation token">(</block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="punctuation token">(</block><block class="string token">"system"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"You are helpful but sassy assistant"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            MessagesPlaceholder</block><block class="punctuation token">(</block><block class=" token">variable_name</block><block class="operator token">=</block><block class="string token">"chat_history"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="punctuation token">(</block><block class="string token">"user"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"{input}"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            MessagesPlaceholder</block><block class="punctuation token">(</block><block class=" token">variable_name</block><block class="operator token">=</block><block class="string token">"agent_scratchpad"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">chain </block><block class="operator token">=</block><block class=" token"> RunnablePassthrough</block><block class="punctuation token">.</block><block class=" token">assign</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            agent_scratchpad </block><block class="operator token">=</block><block class=" token"> </block><block class="keyword token">lambda</block><block class=" token"> x</block><block class="punctuation token">:</block><block class=" token"> format_to_openai_functions</block><block class="punctuation token">(</block><block class=" token">x</block><block class="punctuation token">[</block><block class="string token">"intermediate_steps"</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">|</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">prompt </block><block class="operator token">|</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">model </block><block class="operator token">|</block><block class=" token"> OpenAIFunctionsAgentOutputParser</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">qa </block><block class="operator token">=</block><block class=" token"> AgentExecutor</block><block class="punctuation token">(</block><block class=" token">agent</block><block class="operator token">=</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">chain</block><block class="punctuation token">,</block><block class=" token"> tools</block><block class="operator token">=</block><block class=" token">tools</block><block class="punctuation token">,</block><block class=" token"> verbose</block><block class="operator token">=</block><block class="boolean token">False</block><block class="punctuation token">,</block><block class=" token"> memory</block><block class="operator token">=</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">memory</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">convchain</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">,</block><block class=" token"> query</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">if</block><block class=" token"> </block><block class="keyword token">not</block><block class=" token"> query</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">return</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        inp</block><block class="punctuation token">.</block><block class=" token">value </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">''</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        result </block><block class="operator token">=</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">qa</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class="punctuation token">{</block><block class="string token">"input"</block><block class="punctuation token">:</block><block class=" token"> query</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">answer </block><block class="operator token">=</block><block class=" token"> result</block><block class="punctuation token">[</block><block class="string token">'output'</block><block class="punctuation token">]</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">panels</block><block class="punctuation token">.</block><block class=" token">extend</block><block class="punctuation token">(</block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            pn</block><block class="punctuation token">.</block><block class=" token">Row</block><block class="punctuation token">(</block><block class="string token">'User:'</block><block class="punctuation token">,</block><block class=" token"> pn</block><block class="punctuation token">.</block><block class=" token">pane</block><block class="punctuation token">.</block><block class=" token">Markdown</block><block class="punctuation token">(</block><block class=" token">query</block><block class="punctuation token">,</block><block class=" token"> width</block><block class="operator token">=</block><block class="number token">450</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            pn</block><block class="punctuation token">.</block><block class=" token">Row</block><block class="punctuation token">(</block><block class="string token">'ChatBot:'</block><block class="punctuation token">,</block><block class=" token"> pn</block><block class="punctuation token">.</block><block class=" token">pane</block><block class="punctuation token">.</block><block class=" token">Markdown</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">answer</block><block class="punctuation token">,</block><block class=" token"> width</block><block class="operator token">=</block><block class="number token">450</block><block class="punctuation token">,</block><block class=" token"> styles</block><block class="operator token">=</block><block class="punctuation token">{</block><block class="string token">'background-color'</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">'#F6F6F6'</block><block class="punctuation token">}</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">return</block><block class=" token"> pn</block><block class="punctuation token">.</block><block class=" token">WidgetBox</block><block class="punctuation token">(</block><block class="operator token">*</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">panels</block><block class="punctuation token">,</block><block class=" token"> scroll</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">clr_history</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">,</block><block class=" token">count</block><block class="operator token">=</block><block class="number token">0</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">chat_history </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">return</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">cb </block><block class="operator token">=</block><block class=" token"> cbfs</block><block class="punctuation token">(</block><block class=" token">tools</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">inp </block><block class="operator token">=</block><block class=" token"> pn</block><block class="punctuation token">.</block><block class=" token">widgets</block><block class="punctuation token">.</block><block class=" token">TextInput</block><block class="punctuation token">(</block><block class=" token"> placeholder</block><block class="operator token">=</block><block class="string token">'Enter text here'</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">conversation </block><block class="operator token">=</block><block class=" token"> pn</block><block class="punctuation token">.</block><block class=" token">bind</block><block class="punctuation token">(</block><block class=" token">cb</block><block class="punctuation token">.</block><block class=" token">convchain</block><block class="punctuation token">,</block><block class=" token"> inp</block><block class="punctuation token">)</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">tab1 </block><block class="operator token">=</block><block class=" token"> pn</block><block class="punctuation token">.</block><block class=" token">Column</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    pn</block><block class="punctuation token">.</block><block class=" token">Row</block><block class="punctuation token">(</block><block class=" token">inp</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    pn</block><block class="punctuation token">.</block><block class=" token">layout</block><block class="punctuation token">.</block><block class=" token">Divider</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    pn</block><block class="punctuation token">.</block><block class=" token">panel</block><block class="punctuation token">(</block><block class=" token">conversation</block><block class="punctuation token">,</block><block class=" token">  loading_indicator</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">,</block><block class=" token"> height</block><block class="operator token">=</block><block class="number token">400</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    pn</block><block class="punctuation token">.</block><block class=" token">layout</block><block class="punctuation token">.</block><block class=" token">Divider</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">dashboard </block><block class="operator token">=</block><block class=" token"> pn</block><block class="punctuation token">.</block><block class=" token">Column</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    pn</block><block class="punctuation token">.</block><block class=" token">Row</block><block class="punctuation token">(</block><block class=" token">pn</block><block class="punctuation token">.</block><block class=" token">pane</block><block class="punctuation token">.</block><block class=" token">Markdown</block><block class="punctuation token">(</block><block class="string token">'# QnA_Bot'</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    pn</block><block class="punctuation token">.</block><block class=" token">Tabs</block><block class="punctuation token">(</block><block class="punctuation token">(</block><block class="string token">'Conversation'</block><block class="punctuation token">,</block><block class=" token"> tab1</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">dashboard</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode selected" style="line-height: 1.4;"><prefix style=""></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 675.75px; height: 587.81px; position: relative;"><img src="image-resources/a94844ff-1cd8-4f87-8195-567172fe84b8.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line></area-container></editarea><div></div></math-edit-container></math-type></editor-container></body></html>
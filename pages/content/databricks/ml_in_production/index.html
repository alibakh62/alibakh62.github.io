<!doctype html><html style="overflow:auto;height:auto;width:auto;"><head><title>ml_in_production_ILT_training</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><style>@font-face {
	font-family: Asana;
	src: url("fonts/Asana-Math.otf") format("opentype");
}

@font-face {
	font-family: Asana-Math;
	src: url("fonts/Asana-math-mode.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathbb;
	src: url("fonts/types-generated/Asana-mathbb.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathit;
	src: url("fonts/types-generated/Asana-mathit.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathcal;
	src: url("fonts/types-generated/Asana-mathcal.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathscr;
	src: url("fonts/types-generated/Asana-mathscr.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathfrak;
	src: url("fonts/types-generated/Asana-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathsf;
	src: url("fonts/types-generated/Asana-mathsf.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathtt;
	src: url("fonts/types-generated/Asana-mathtt.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathrm;
	src: url("fonts/types-generated/Asana-mathrm.otf") format("opentype");
}

@font-face {
	font-family: 'FontAwesome';
	src: url('fonts/icomoon.eot');
	src: url('fonts/icomoon.eot') format('embedded-opentype'), url('fonts/icomoon.woff') format('woff'), url('fonts/icomoon.ttf') format('truetype'), url('fonts/icomoon.svg') format('svg');
	font-weight: normal;
	font-style: normal;
}

/**
Latin Modern
**/

@font-face {
	font-family: LatinModern;
	src: url("fonts/latinmodern-math.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Math;
	src: url("fonts/latinmodern-math-mode.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathbb;
	src: url("fonts/types-generated/latinmodern-mathbb.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathit;
	src: url("fonts/types-generated/latinmodern-mathit.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathcal;
	src: url("fonts/types-generated/latinmodern-mathcal.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathscr;
	src: url("fonts/types-generated/latinmodern-mathscr.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathfrak;
	src: url("fonts/types-generated/latinmodern-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathsf;
	src: url("fonts/types-generated/latinmodern-mathsf.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathtt;
	src: url("fonts/types-generated/latinmodern-mathtt.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathrm;
	src: url("fonts/types-generated/latinmodern-mathrm.otf") format("opentype");
}

/***********************************************************/

/**
Thicker Latin Modern
**/

@font-face {
	font-family: ThickerLm;
	src: url("fonts/thickerlm-math.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Math;
	src: url("fonts/thickerlm-math-mode.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathbb;
	src: url("fonts/types-generated/thickerlm-mathbb.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathit;
	src: url("fonts/types-generated/thickerlm-mathit.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathcal;
	src: url("fonts/types-generated/thickerlm-mathcal.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathscr;
	src: url("fonts/types-generated/thickerlm-mathscr.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathfrak;
	src: url("fonts/types-generated/thickerlm-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathsf;
	src: url("fonts/types-generated/thickerlm-mathsf.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathtt;
	src: url("fonts/types-generated/thickerlm-mathtt.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathrm;
	src: url("fonts/types-generated/thickerlm-mathrm.otf") format("opentype");
}

/***********************************************************/

/* Computer Modern */

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunss.otf') format("opentype");
	font-weight: normal;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunsx.otf') format("opentype");
	font-weight: bold;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunsi.otf') format("opentype");
	font-weight: normal;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunso.otf') format("opentype");
	font-weight: bold;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunrm.otf') format("opentype");
	font-weight: normal;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunbx.otf') format("opentype");
	font-weight: bold;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunti.otf') format("opentype");
	font-weight: normal;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunbi.otf') format("opentype");
	font-weight: bold;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmuntt.otf') format("opentype");
	font-weight: normal;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmuntb.otf') format("opentype");
	font-weight: bold;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmunit.otf') format("opentype");
	font-weight: normal;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmuntx.otf') format("opentype");
	font-weight: bold;
	font-style: italic;
}

/**/

/**
Sans Math + Liberation Font
**/

@font-face {
	font-family: Sans;
	src: url("fonts/Sans-Math.otf") format("opentype");
}

@font-face {
	font-family: Sans-Math;
	src: url("fonts/Sans-Math-mode.otf") format("opentype");
}

@font-face {
	font-family: Sans-Bold;
	src: url("fonts/types-generated/Sans-bold.otf") format("opentype");
	font-weight: bold;
}

@font-face {
	font-family: Sans-Mathbb;
	src: url("fonts/types-generated/Asana-mathbb.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathit;
	src: url("fonts/types-generated/Sans-mathit.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathcal;
	src: url("fonts/types-generated/Asana-mathcal.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathscr;
	src: url("fonts/types-generated/Asana-mathscr.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathfrak;
	src: url("fonts/types-generated/Asana-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathsf;
	src: url("fonts/types-generated/Asana-mathsf.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathtt;
	src: url("fonts/types-generated/Asana-mathtt.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathrm;
	src: url("fonts/types-generated/Asana-mathrm.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathbf;
	src: url("fonts/types-generated/Sans-mathbf.otf") format("opentype");
	font-weight: bold;
}

/***********************************************************/</style><style>

compositeblock {
  display: inline-block;
  position: relative;
  text-align: left;
  unicode-bidi: isolate;
}
compositeblock.middle {
  vertical-align: middle;
}
latex-symbol-icon {
  display: inline-block;
  padding: 2px;
  border: 1px solid transparent;
  cursor: pointer;
}
latex-symbol-icon:hover,
latex-symbol-icon.selected {
  background: white;
  border: 1px solid lightgray;
}
inline {
  display: inline-block;
}
base-line-indicator {
  display: inline-block;
  overflow: hidden;
  width: 0px;
  height: inherit;
}

math-type .constant-text > constant-text {
  margin-left: 0.2em;
  margin-right: 0.2em;
}
math-type .constant-text > constant-text.close-left {
  margin-left: 0;
}
math-type .constant-text > constant-text.close-right {
  margin-right: 0;
}



/**different context*/
/**different context*/
math-type ref-tag {
  position: absolute;
  right: 5px;
  top: 50%;
  transform: translate(0, -50%);
  z-index: 8;
  cursor: pointer;
}
math-type ref-tag > label {
  cursor: pointer;
}
math-type ref-tag:hover {
  text-decoration: underline;
}
math-type ref-tag.line-tag {
  transition: background 0.4s;
}
math-type ref-tag.empty-line-tag {
  opacity: 0.5;
  animation: fadein 0.5s;
}
math-type tr.math-row ref-tag {
  left: calc(100% + 20px);
  right: unset;
}
@keyframes fadein {
  0% {
    opacity: 0;
  }
  70% {
    opacity: 0;
  }
  100% {
    opacity: 0.5;
  }
}







.color-picker no-color-select {
  display: block;
  text-align: center;
  /* width: 100%; */
  /* height: 20px; */
  background: white;
  border: 1px solid lightgray;
  margin-bottom: 2px;
  color: gray;
  padding: 2px;
  cursor: default;
  border-radius: 0;
  padding-bottom: 2px;
  margin-bottom: 3px;
  margin-left: -1px;
  margin-right: -1px;
  font-size: 13px;
}
.color-picker no-color-select:hover {
  color: black;
}
.color-picker color-select {
  position: absolute;
  top: 30px;
  left: 0px;
  background: white;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type editarea.no-area-container,
math-type editarea.text-mode,
math-type area-container,
math-type .print-as-area-container {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
math-type editarea.no-area-container > line,
math-type editarea.text-mode > line,
math-type area-container > line,
math-type .print-as-area-container > line {
  min-width: 0.3em;
  position: relative;
  display: block;
  width: 100%;
  align-items: baseline;
  flex-wrap: wrap;
  box-sizing: border-box;
  flex-wrap: nowrap;
  line-height: 1.2;
  white-space: nowrap;
}
math-type editarea.no-area-container > line block,
math-type editarea.text-mode > line block,
math-type area-container > line block,
math-type .print-as-area-container > line block {
  white-space: pre;
}
math-type editarea.no-area-container > line.single-block > blocks > baselineblock,
math-type editarea.text-mode > line.single-block > blocks > baselineblock,
math-type area-container > line.single-block > blocks > baselineblock,
math-type .print-as-area-container > line.single-block > blocks > baselineblock {
  display: none;
}
math-type editarea.no-area-container > line > blocks,
math-type editarea.text-mode > line > blocks,
math-type area-container > line > blocks,
math-type .print-as-area-container > line > blocks {
  /**
            Different between inline and inline-block is about whether Section Text will be wrap in next wrapped line 
            */
  display: inline-block;
  text-align: left;
}
math-type editarea.no-area-container > line.root,
math-type editarea.text-mode > line.root,
math-type area-container > line.root,
math-type .print-as-area-container > line.root,
math-type editarea.no-area-container > line.text-mode,
math-type editarea.text-mode > line.text-mode,
math-type area-container > line.text-mode,
math-type .print-as-area-container > line.text-mode {
  display: block;
  font-style: normal;
}
math-type editarea.no-area-container > line.root > prefix,
math-type editarea.text-mode > line.root > prefix,
math-type area-container > line.root > prefix,
math-type .print-as-area-container > line.root > prefix,
math-type editarea.no-area-container > line.text-mode > prefix,
math-type editarea.text-mode > line.text-mode > prefix,
math-type area-container > line.text-mode > prefix,
math-type .print-as-area-container > line.text-mode > prefix {
  white-space: pre;
  display: inline-block;
  cursor: default;
  text-align: left;
}
math-type editarea.no-area-container > line.root > blocks,
math-type editarea.text-mode > line.root > blocks,
math-type area-container > line.root > blocks,
math-type .print-as-area-container > line.root > blocks,
math-type editarea.no-area-container > line.text-mode > blocks,
math-type editarea.text-mode > line.text-mode > blocks,
math-type area-container > line.text-mode > blocks,
math-type .print-as-area-container > line.text-mode > blocks {
  /** should not wrap here*/
  align-items: baseline;
  box-sizing: border-box;
}
math-type editarea.no-area-container > line.root > blocks > block,
math-type editarea.text-mode > line.root > blocks > block,
math-type area-container > line.root > blocks > block,
math-type .print-as-area-container > line.root > blocks > block,
math-type editarea.no-area-container > line.text-mode > blocks > block,
math-type editarea.text-mode > line.text-mode > blocks > block,
math-type area-container > line.text-mode > blocks > block,
math-type .print-as-area-container > line.text-mode > blocks > block {
  white-space: pre-wrap;
  white-space: break-spaces;
}
math-type editarea.no-area-container > line.root.full-line-block-inside > prefix,
math-type editarea.text-mode > line.root.full-line-block-inside > prefix,
math-type area-container > line.root.full-line-block-inside > prefix,
math-type .print-as-area-container > line.root.full-line-block-inside > prefix,
math-type editarea.no-area-container > line.text-mode.full-line-block-inside > prefix,
math-type editarea.text-mode > line.text-mode.full-line-block-inside > prefix,
math-type area-container > line.text-mode.full-line-block-inside > prefix,
math-type .print-as-area-container > line.text-mode.full-line-block-inside > prefix {
  float: left;
  vertical-align: top;
}
math-type editarea.no-area-container > line.root.full-line-block-inside > blocks,
math-type editarea.text-mode > line.root.full-line-block-inside > blocks,
math-type area-container > line.root.full-line-block-inside > blocks,
math-type .print-as-area-container > line.root.full-line-block-inside > blocks,
math-type editarea.no-area-container > line.text-mode.full-line-block-inside > blocks,
math-type editarea.text-mode > line.text-mode.full-line-block-inside > blocks,
math-type area-container > line.text-mode.full-line-block-inside > blocks,
math-type .print-as-area-container > line.text-mode.full-line-block-inside > blocks {
  display: block;
  width: 100%;
}
math-type editarea.no-area-container > line.root.full-line-block-inside > blocks > baselineblock,
math-type editarea.text-mode > line.root.full-line-block-inside > blocks > baselineblock,
math-type area-container > line.root.full-line-block-inside > blocks > baselineblock,
math-type .print-as-area-container > line.root.full-line-block-inside > blocks > baselineblock,
math-type editarea.no-area-container > line.text-mode.full-line-block-inside > blocks > baselineblock,
math-type editarea.text-mode > line.text-mode.full-line-block-inside > blocks > baselineblock,
math-type area-container > line.text-mode.full-line-block-inside > blocks > baselineblock,
math-type .print-as-area-container > line.text-mode.full-line-block-inside > blocks > baselineblock {
  display: inline-block;
  float: left;
}
math-type editarea.no-area-container > line.root.has-rtl.align-justify,
math-type editarea.text-mode > line.root.has-rtl.align-justify,
math-type area-container > line.root.has-rtl.align-justify,
math-type .print-as-area-container > line.root.has-rtl.align-justify,
math-type editarea.no-area-container > line.text-mode.has-rtl.align-justify,
math-type editarea.text-mode > line.text-mode.has-rtl.align-justify,
math-type area-container > line.text-mode.has-rtl.align-justify,
math-type .print-as-area-container > line.text-mode.has-rtl.align-justify {
  direction: rtl;
}
math-type editarea.no-area-container > line.root.section,
math-type editarea.text-mode > line.root.section,
math-type area-container > line.root.section,
math-type .print-as-area-container > line.root.section,
math-type editarea.no-area-container > line.text-mode.section,
math-type editarea.text-mode > line.text-mode.section,
math-type area-container > line.text-mode.section,
math-type .print-as-area-container > line.text-mode.section {
  text-align: left;
}
math-type editarea.no-area-container > line.root.section > blocks,
math-type editarea.text-mode > line.root.section > blocks,
math-type area-container > line.root.section > blocks,
math-type .print-as-area-container > line.root.section > blocks,
math-type editarea.no-area-container > line.text-mode.section > blocks,
math-type editarea.text-mode > line.text-mode.section > blocks,
math-type area-container > line.text-mode.section > blocks,
math-type .print-as-area-container > line.text-mode.section > blocks {
  /**
                    Different between inline and inline-block is about whether Section Text will be wrap in next wrapped line 
                    */
  display: inline;
}
math-type editarea.no-area-container > line.root.section.has-rtl,
math-type editarea.text-mode > line.root.section.has-rtl,
math-type area-container > line.root.section.has-rtl,
math-type .print-as-area-container > line.root.section.has-rtl,
math-type editarea.no-area-container > line.text-mode.section.has-rtl,
math-type editarea.text-mode > line.text-mode.section.has-rtl,
math-type area-container > line.text-mode.section.has-rtl,
math-type .print-as-area-container > line.text-mode.section.has-rtl {
  direction: rtl;
}
math-type editarea.no-area-container > line.root.section.has-rtl > prefix,
math-type editarea.text-mode > line.root.section.has-rtl > prefix,
math-type area-container > line.root.section.has-rtl > prefix,
math-type .print-as-area-container > line.root.section.has-rtl > prefix,
math-type editarea.no-area-container > line.text-mode.section.has-rtl > prefix,
math-type editarea.text-mode > line.text-mode.section.has-rtl > prefix,
math-type area-container > line.text-mode.section.has-rtl > prefix,
math-type .print-as-area-container > line.text-mode.section.has-rtl > prefix {
  direction: rtl;
  order: 1;
}
math-type editarea.no-area-container > line.root.theorem,
math-type editarea.text-mode > line.root.theorem,
math-type area-container > line.root.theorem,
math-type .print-as-area-container > line.root.theorem,
math-type editarea.no-area-container > line.text-mode.theorem,
math-type editarea.text-mode > line.text-mode.theorem,
math-type area-container > line.text-mode.theorem,
math-type .print-as-area-container > line.text-mode.theorem {
  padding-top: 0.3em;
  padding-bottom: 0.3em;
}
math-type editarea.no-area-container > line > prefix,
math-type editarea.text-mode > line > prefix,
math-type area-container > line > prefix,
math-type .print-as-area-container > line > prefix {
  text-align: right;
}
math-type editarea.no-area-container > line.has-indent,
math-type editarea.text-mode > line.has-indent,
math-type area-container > line.has-indent,
math-type .print-as-area-container > line.has-indent {
  display: flex;
  justify-content: flex-start;
}
math-type editarea.no-area-container > line.has-rtl.has-indent > prefix,
math-type editarea.text-mode > line.has-rtl.has-indent > prefix,
math-type area-container > line.has-rtl.has-indent > prefix,
math-type .print-as-area-container > line.has-rtl.has-indent > prefix {
  direction: rtl;
  order: 1;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-0,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-0,
math-type area-container > line.has-rtl.has-indent.indent-0,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-0 {
  padding-left: 0;
  padding-right: 30px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-1,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-1,
math-type area-container > line.has-rtl.has-indent.indent-1,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-1 {
  padding-left: 0;
  padding-right: 65px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-2,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-2,
math-type area-container > line.has-rtl.has-indent.indent-2,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-2 {
  padding-left: 0;
  padding-right: 105px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-3,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-3,
math-type area-container > line.has-rtl.has-indent.indent-3,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-3 {
  padding-left: 0;
  padding-right: 145px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-4,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-4,
math-type area-container > line.has-rtl.has-indent.indent-4,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-4 {
  padding-left: 0;
  padding-right: 185px;
}
math-type editarea.no-area-container > line.indent-0,
math-type editarea.text-mode > line.indent-0,
math-type area-container > line.indent-0,
math-type .print-as-area-container > line.indent-0 {
  padding-left: 30px;
}
math-type editarea.no-area-container > line.indent-1,
math-type editarea.text-mode > line.indent-1,
math-type area-container > line.indent-1,
math-type .print-as-area-container > line.indent-1 {
  padding-left: 65px;
}
math-type editarea.no-area-container > line.indent-2,
math-type editarea.text-mode > line.indent-2,
math-type area-container > line.indent-2,
math-type .print-as-area-container > line.indent-2 {
  padding-left: 105px;
}
math-type editarea.no-area-container > line.indent-3,
math-type editarea.text-mode > line.indent-3,
math-type area-container > line.indent-3,
math-type .print-as-area-container > line.indent-3 {
  padding-left: 145px;
}
math-type editarea.no-area-container > line.indent-4,
math-type editarea.text-mode > line.indent-4,
math-type area-container > line.indent-4,
math-type .print-as-area-container > line.indent-4 {
  padding-left: 185px;
}
math-type editarea.no-area-container > line.math-container-selected,
math-type editarea.text-mode > line.math-container-selected,
math-type area-container > line.math-container-selected,
math-type .print-as-area-container > line.math-container-selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type editarea.no-area-container > line.math-container,
math-type editarea.text-mode > line.math-container,
math-type area-container > line.math-container,
math-type .print-as-area-container > line.math-container {
  font-family: 'Asana';
  justify-content: center;
  text-align: center;
  text-align-last: auto;
  display: flex;
}
math-type editarea.no-area-container > line.math-container block,
math-type editarea.text-mode > line.math-container block,
math-type area-container > line.math-container block,
math-type .print-as-area-container > line.math-container block {
  white-space: pre;
}
math-type editarea.no-area-container > line.align-center,
math-type editarea.text-mode > line.align-center,
math-type area-container > line.align-center,
math-type .print-as-area-container > line.align-center {
  text-align: center;
  text-align-last: auto;
}
math-type editarea.no-area-container > line.align-center.has-indent,
math-type editarea.text-mode > line.align-center.has-indent,
math-type area-container > line.align-center.has-indent,
math-type .print-as-area-container > line.align-center.has-indent {
  justify-content: center;
}
math-type editarea.no-area-container > line.align-center.section,
math-type editarea.text-mode > line.align-center.section,
math-type area-container > line.align-center.section,
math-type .print-as-area-container > line.align-center.section {
  text-align: center;
  text-align-last: auto;
}
math-type editarea.no-area-container > line.align-center > blocks,
math-type editarea.text-mode > line.align-center > blocks,
math-type area-container > line.align-center > blocks,
math-type .print-as-area-container > line.align-center > blocks {
  text-align: center;
  text-align-last: auto;
}
math-type editarea.no-area-container > line.align-justify,
math-type editarea.text-mode > line.align-justify,
math-type area-container > line.align-justify,
math-type .print-as-area-container > line.align-justify {
  text-align: justify;
}
math-type editarea.no-area-container > line.align-justify.section,
math-type editarea.text-mode > line.align-justify.section,
math-type area-container > line.align-justify.section,
math-type .print-as-area-container > line.align-justify.section {
  text-align: justify;
}
math-type editarea.no-area-container > line.align-justify > blocks,
math-type editarea.text-mode > line.align-justify > blocks,
math-type area-container > line.align-justify > blocks,
math-type .print-as-area-container > line.align-justify > blocks {
  text-align: justify;
}
math-type editarea.no-area-container > line.align-left,
math-type editarea.text-mode > line.align-left,
math-type area-container > line.align-left,
math-type .print-as-area-container > line.align-left {
  text-align: left;
}
math-type editarea.no-area-container > line.align-left > blocks,
math-type editarea.text-mode > line.align-left > blocks,
math-type area-container > line.align-left > blocks,
math-type .print-as-area-container > line.align-left > blocks {
  text-align: left;
}
math-type editarea.no-area-container > line.align-right,
math-type editarea.text-mode > line.align-right,
math-type area-container > line.align-right,
math-type .print-as-area-container > line.align-right {
  text-align: right;
}
math-type editarea.no-area-container > line.align-right.has-indent,
math-type editarea.text-mode > line.align-right.has-indent,
math-type area-container > line.align-right.has-indent,
math-type .print-as-area-container > line.align-right.has-indent {
  justify-content: flex-end;
}
math-type editarea.no-area-container > line.align-right.section,
math-type editarea.text-mode > line.align-right.section,
math-type area-container > line.align-right.section,
math-type .print-as-area-container > line.align-right.section {
  text-align: right;
}
math-type editarea.no-area-container > line.align-right > blocks,
math-type editarea.text-mode > line.align-right > blocks,
math-type area-container > line.align-right > blocks,
math-type .print-as-area-container > line.align-right > blocks {
  text-align: right;
}
math-type editarea.no-area-container > line > blocks > block,
math-type editarea.text-mode > line > blocks > block,
math-type area-container > line > blocks > block,
math-type .print-as-area-container > line > blocks > block {
  display: inline;
}
math-type editarea.no-area-container,
math-type area-container {
  align-items: initial;
}
math-type editarea.root-editor {
  align-items: initial;
  display: block;
  color: black;
  fill: black;
  stroke: black;
  border-color: black;
}
math-type editarea.root-editor.read-only {
  cursor: default;
}
math-type editarea.root-editor.read-only block {
  cursor: default;
}
math-type editarea.root-editor > area-container {
  display: block;
}
math-type area-container {
  width: 100%;
}
math-type block {
  cursor: text;
}
math-type editarea {
  box-sizing: border-box;
  display: flex;
  overflow-x: visible;
  align-items: center;
  justify-content: center;
  flex-direction: row;
  flex-wrap: nowrap;
}
math-type editarea block {
  cursor: text;
}
math-type editarea.high-order {
  position: relative;
  z-index: 10;
}
math-type editarea.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type editarea.bordered {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type editarea.center > area-container > line,
math-type editarea.center > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type editarea.left > area-container > line,
math-type editarea.left > line {
  justify-content: flex-start;
  text-align: left;
}
math-type editarea.right > area-container > line,
math-type editarea.right > line {
  justify-content: flex-end;
  text-align: right;
}
math-type editarea > area-baseline {
  width: 0;
  overflow: hidden;
  display: inline-block;
  float: left;
}
math-type setting.mt-common-dialog.line-tag-setting {
  transform: translate(0, -100%);
  position: absolute;
  font-family: serif;
  font-size: 11px;
  top: -4px;
  left: -10px;
  outline: none;
}
math-type setting.mt-common-dialog.line-tag-setting i {
  font-style: normal;
  padding: 1px 3px;
}
baselineblock {
  height: 0px;
  display: inline-block;
  width: 0;
  overflow: hidden;
}
baselineblock.inline {
  display: inline;
}
emptyblock {
  white-space: pre;
}
composite {
  display: inline-block;
}
block.Binary {
  padding: 0 0.2em;
}
block.Relation {
  padding: 0 0.3em;
}
block.Punctuation {
  padding-right: 0.2em;
}




check-box-wrapper {
  display: block;
  font-size: 11px;
  color: gray;
  cursor: pointer;
}
check-box-wrapper.disabled {
  color: lightgray;
}
check-box-wrapper.disabled check-box-rect {
  border: 1px solid #e2e1e1;
  color: lightgray;
}
check-box-wrapper.disabled check-box-rect:hover {
  border: 1px solid #e2e1e1;
}
check-box-wrapper.mobile-tablet check-box-rect {
  margin-top: -3px;
  width: 16px;
  height: 15px;
  font-size: 13px;
}
check-box-wrapper.mobile-tablet check-box-rect > i {
  left: 2px;
  top: 1px;
}
check-box-wrapper check-box-rect {
  width: 1.4em;
  height: 1.35em;
  border: 1px solid #c3c2c2;
  position: relative;
  display: inline-flex;
  font-size: 11px;
  color: green;
  background: white;
  justify-content: center;
  align-items: center;
}
check-box-wrapper check-box-rect:hover {
  border: 1px solid gray;
}
check-box-wrapper.unchecked check-box-rect > i {
  visibility: hidden;
}

vcomposed-symbol {
  display: flex;
  width: 100%;
  height: 100%;
  overflow: hidden;
  flex-direction: column;
}
vcomposed-symbol > start {
  display: block;
  float: left;
  overflow: hidden;
  margin-bottom: -0.02em;
}
vcomposed-symbol > middle-center {
  overflow: hidden;
  margin-top: -0.02em;
  margin-bottom: -0.02em;
}
vcomposed-symbol > middle {
  display: block;
  flex-grow: 1;
  position: relative;
  overflow: hidden;
  margin-top: -0.02em;
  margin-bottom: -0.02em;
}
vcomposed-symbol > middle > fixed {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
}
vcomposed-symbol > middle > fixed > inside {
  display: block;
  overflow: hidden;
}
vcomposed-symbol > end {
  margin-top: -0.02em;
  display: block;
  overflow: hidden;
}


.open-brace,
.close-brace {
  padding: 0 0.1em;
  width: 0.5em;
  min-width: 0.5em;
}
.open-brace > start,
.close-brace > start {
  min-height: 0.75em;
  height: 0.75em;
}
.open-brace > middle-center,
.close-brace > middle-center {
  min-height: 0.6em;
  height: 0.6em;
}
.open-brace > end,
.close-brace > end {
  min-height: 0.75em;
  height: 0.75em;
}
.open-bracket,
.close-bracket {
  width: 0.43em;
  min-width: 0.43em;
}
.open-bracket > start,
.close-bracket > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-bracket > end,
.close-bracket > end {
  height: 0.7em;
  min-height: 0.7em;
}
.open-parenthesis,
.close-parenthesis {
  width: 0.45em;
  min-width: 0.45em;
}
.open-parenthesis > start,
.close-parenthesis > start {
  min-height: 0.85em;
  height: 0.85em;
}
.open-parenthesis > end,
.close-parenthesis > end {
  min-height: 0.8em;
  height: 0.8em;
}
.open-floor,
.close-floor {
  width: 0.45em;
  min-width: 0.45em;
}
.open-floor > end,
.close-floor > end {
  height: 0.35em;
  min-height: 0.35em;
}
.open-ceil,
.close-ceil {
  width: 0.45em;
  min-width: 0.45em;
}
.open-ceil > start,
.close-ceil > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-vert,
.close-vert {
  width: 0.3em;
  min-width: 0.3em;
}
.open-Vert,
.close-Vert {
  width: 0.5em;
  min-width: 0.5em;
}
.open-uparrow,
.close-uparrow {
  width: 0.45em;
  min-width: 0.45em;
}
.open-uparrow > start,
.close-uparrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-downarrow,
.close-downarrow {
  width: 0.45em;
  min-width: 0.45em;
}
.open-downarrow > end,
.close-downarrow > end {
  height: 0.4em;
  min-height: 0.4em;
}
.open-updownarrow,
.close-updownarrow {
  width: 0.45em;
  min-width: 0.45em;
}
.open-updownarrow > start,
.close-updownarrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-updownarrow > end,
.close-updownarrow > end {
  height: 0.4em;
  min-height: 0.4em;
}
.open-Uparrow,
.close-Uparrow {
  width: 0.7em;
  min-width: 0.7em;
}
.open-Uparrow > start,
.close-Uparrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-Downarrow,
.close-Downarrow {
  width: 0.7em;
  min-width: 0.7em;
}
.open-Downarrow > end,
.close-Downarrow > end {
  height: 0.5em;
  min-height: 0.5em;
}
.open-Updownarrow,
.close-Updownarrow {
  width: 0.6em;
  min-width: 0.6em;
}
.open-Updownarrow > start,
.close-Updownarrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-Updownarrow > end,
.close-Updownarrow > end {
  height: 0.5em;
  min-height: 0.5em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
opensymbolblock,
closesymbolblock,
.middle-vert-symbol {
  display: inline-flex;
  align-items: center;
  position: relative;
  text-align: left;
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}
opensymbolblock.normal,
closesymbolblock.normal,
.middle-vert-symbol.normal {
  margin-top: 0;
  margin-bottom: 0;
}
opensymbolblock > hidden-span,
closesymbolblock > hidden-span,
.middle-vert-symbol > hidden-span {
  visibility: hidden;
  width: 0px;
}
opensymbolblock[type='brace'],
closesymbolblock[type='brace'],
.middle-vert-symbol[type='brace'] {
  margin-left: 0.05em;
  margin-right: 0.05em;
  overflow: visible;
}
opensymbolblock[type='brace'] > svg,
closesymbolblock[type='brace'] > svg,
.middle-vert-symbol[type='brace'] > svg {
  overflow: visible;
  width: 0.5em;
  height: 100%;
}
opensymbolblock[type='parenthesis'] > svg,
closesymbolblock[type='parenthesis'] > svg,
.middle-vert-symbol[type='parenthesis'] > svg {
  width: 0.5em;
  height: 100%;
}
opensymbolblock[type='bracket'] > svg,
closesymbolblock[type='bracket'] > svg,
.middle-vert-symbol[type='bracket'] > svg {
  width: 0.5em;
  height: 100%;
}
opensymbolblock[type='angle'].sm-1 > svg,
closesymbolblock[type='angle'].sm-1 > svg,
.middle-vert-symbol[type='angle'].sm-1 > svg {
  width: 0.3em;
}
opensymbolblock[type='angle'].sm-2 > svg,
closesymbolblock[type='angle'].sm-2 > svg,
.middle-vert-symbol[type='angle'].sm-2 > svg {
  width: 0.45em;
}
opensymbolblock[type='angle'] > svg,
closesymbolblock[type='angle'] > svg,
.middle-vert-symbol[type='angle'] > svg {
  width: 0.6em;
  height: 100%;
}
opensymbolblock[type='slash'] > svg,
closesymbolblock[type='slash'] > svg,
.middle-vert-symbol[type='slash'] > svg {
  width: 0.7em;
  height: 100%;
}
opensymbolblock > bracket-span,
closesymbolblock > bracket-span,
.middle-vert-symbol > bracket-span {
  display: block;
}
opensymbolblock > vcomposed-symbol,
closesymbolblock > vcomposed-symbol,
.middle-vert-symbol > vcomposed-symbol,
opensymbolblock > bracket-span,
closesymbolblock > bracket-span,
.middle-vert-symbol > bracket-span {
  height: 100%;
  width: 100%;
  font-style: normal;
}
opensymbolblock > brace-span,
closesymbolblock > brace-span,
.middle-vert-symbol > brace-span {
  visibility: hidden;
  display: inline-block;
  padding: 0 0.1em;
}
opensymbolblock,
.middle-vert-symbol {
  margin-left: 0.07em;
}
opensymbolblock.normal,
.middle-vert-symbol.normal {
  margin-left: 0;
}
opensymbolblock[type='vert'],
.middle-vert-symbol[type='vert'],
opensymbolblock.middle-vert-symbol,
.middle-vert-symbol.middle-vert-symbol {
  margin-left: 0.05em;
  margin-right: 0.05em;
}
opensymbolblock[type='vert'] > svg,
.middle-vert-symbol[type='vert'] > svg,
opensymbolblock.middle-vert-symbol > svg,
.middle-vert-symbol.middle-vert-symbol > svg {
  width: 0.4em;
  height: 100%;
}
opensymbolblock[type='parenthesis'] > svg,
.middle-vert-symbol[type='parenthesis'] > svg {
  margin-right: -0.1em;
}
closesymbolblock {
  margin-right: 0.07em;
}
closesymbolblock.normal {
  margin-right: 0;
}
closesymbolblock[type='vert'] {
  margin-left: 0.05em;
  margin-right: 0.05em;
}
closesymbolblock[type='vert'] > svg {
  width: 0.4em;
  height: 100%;
}
closesymbolblock[type='parenthesis'] > svg {
  margin-left: -0.1em;
}

opensymbolblock[type=empty] > empty,
closesymbolblock[type=empty] > empty {
  width: 2px;
  height: 100%;
  display: block;
}
opensymbolblock[type=empty] > empty.normal-size,
closesymbolblock[type=empty] > empty.normal-size {
  height: 1em;
}
opensymbolblock[type=empty] > empty.line-selected,
closesymbolblock[type=empty] > empty.line-selected {
  background-color: lightgray;
}

.dirac-bracket-symbol > div > .oangle,
.dirac-bracket-symbol > div > .cangle {
  align-self: stretch;
  width: 0.55em;
  position: relative;
  margin-top: 0.1em;
  margin-bottom: -0.1em;
}
.dirac-bracket-symbol > div > .oangle > svg,
.dirac-bracket-symbol > div > .cangle > svg {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}
.dirac-bracket-symbol > div > .vert {
  align-self: stretch;
  width: 0.25em;
  position: relative;
  margin-top: 0.1em;
  margin-bottom: -0.1em;
}
.dirac-bracket-symbol > div > .vert > svg {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}
.dirac-bracket-symbol > div > editarea.first {
  min-width: 0.3em;
  padding-right: 0.1em;
}
.dirac-bracket-symbol > div > editarea.last {
  min-width: 0.3em;
  padding-left: 0.1em;
}
.dirac-bracket-symbol > div > editarea.middle {
  min-width: 0.3em;
  padding-left: 0.1em;
  padding-right: 0.1em;
}

cancel-symbol > editarea {
  display: inline-flex;
}
cancel-symbol > svg {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: visible;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.frac-slashed-symbol.frac-inline {
  font-size: 0.75em;
}
math-type compositeblock.fraction-symbol {
  margin-left: 0.1em;
  margin-right: 0.1em;
  vertical-align: baseline;
}
math-type compositeblock.fraction-symbol.frac-inline {
  font-size: 0.75em;
}
math-type compositeblock.fraction-symbol > .enumerator {
  float: left;
  width: 100%;
  clear: both;
}
math-type compositeblock.fraction-symbol > .denominator {
  margin-top: -5px;
  float: left;
  width: 100%;
}
math-type compositeblock.fraction-symbol > .frac-line {
  clear: both;
  pointer-events: none;
}
math-type compositeblock.fraction-symbol > .frac-line > inline {
  display: inline-block;
  width: 100%;
  vertical-align: 0.25em;
  border-bottom: solid 1px;
}
math-type compositeblock.fraction-symbol > editarea {
  border: 0px;
  min-width: 0.6em;
  text-align: center;
  text-align-last: auto;
}
math-type compositeblock.fraction-symbol > editarea > area-container > line,
math-type compositeblock.fraction-symbol > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type compositeblock.fraction-symbol > editarea-line {
  text-align: center;
  text-align-last: auto;
}

.stackrel-icon {
  margin: auto;
  display: flex;
  align-items: center;
  flex-direction: column;
}
.stackrel-icon .square {
  width: 6px;
  height: 6px;
  border-style: solid;
  border-width: 1px;
  border-color: gray;
}
.stackrel-icon .distance {
  margin-top: 3px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .stackrel-symbol.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type .stackrel-symbol > .cur-value {
  clear: both;
  display: inline-flex;
  width: 100%;
}
math-type .stackrel-symbol > .top {
  float: left;
  clear: both;
  width: 100%;
  font-size: 0.7em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .underset-symbol > .center {
  display: inline-flex;
  width: 100%;
}
math-type .underset-symbol > .bottom {
  float: left;
  display: block;
  width: 100%;
  font-size: 0.7em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-under-set-symbol.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type .over-under-set-symbol > .top {
  display: flex;
  float: left;
  clear: both;
  width: 100%;
}
math-type .over-under-set-symbol > .top > line {
  font-size: 0.7em;
}
math-type .over-under-set-symbol > .middle {
  display: inline-flex;
  width: 100%;
  clear: both;
}
math-type .over-under-set-symbol > .middle.select {
  border-bottom: none;
}
math-type .over-under-set-symbol > .bottom {
  display: flex;
  float: left;
  width: 100%;
}
math-type .over-under-set-symbol > .bottom > line {
  font-size: 0.7em;
}

expandable-component.thickness item-option.thickness-option {
  width: 40px;
  height: 12px;
}
expandable-component.thickness svg {
  stroke: gray;
  stroke-width: 1px;
  fill: none;
}
expandable-component.thickness thickness {
  position: relative;
  display: flex;
  height: 100%;
}
expandable-component.thickness thickness > svg.thickness {
  width: 25px;
  height: 100%;
  position: static;
}
expandable-component.thickness thickness > svg.thickness line {
  stroke: gray;
  stroke-width: 1px;
}
expandable-component.thickness thickness > svg.thickness path {
  fill: #d2cfcf;
  stroke: none;
}



/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .textcircled > div > editarea {
  text-align: center;
  text-align-last: auto;
}
math-type .textcircled > div > editarea > area-container > line,
math-type .textcircled > div > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.math-container-symbol {
  margin-top: 0.3em;
  margin-bottom: 0.3em;
  display: inline-flex;
}
.math-container-symbol.inline {
  margin-top: 0px;
  margin-bottom: 0px;
}
.math-container-symbol.selected {
  background-color: rgba(76, 175, 80, 0.05);
  outline: 1px solid #c1d4c1;
}
.math-container-symbol.display {
  display: block;
}
.math-container-symbol.display.selected {
  background-color: rgba(76, 175, 80, 0.05);
  outline: none;
}
.math-container-symbol.display > editarea {
  width: 100%;
  flex-grow: 1;
  display: block;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol.display > editarea > area-container > line,
.math-container-symbol.display > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol.display > editarea > area-container > line {
  padding-top: 8px;
  padding-bottom: 8px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.math-container-symbol > editarea.multiline {
  display: block;
  flex-grow: 1;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol > editarea.multiline > area-container > line,
.math-container-symbol > editarea.multiline > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol > editarea.multiline > line:last-child {
  justify-content: flex-end;
  text-align: right;
}
.math-container-symbol > editarea.multiline > line:first-child {
  justify-content: flex-start;
  text-align: left;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .icon-sqrt,
.auto-complete-external-area .icon-sqrt {
  display: flex;
  margin: auto;
  font-size: 12px;
}
math-type .icon-sqrt .square,
.auto-complete-external-area .icon-sqrt .square {
  margin-top: 3px;
  margin-right: -6px;
}
math-type .icon-sqrt .square-expand,
.auto-complete-external-area .icon-sqrt .square-expand {
  background-color: #f7f7f7;
}
math-type .icon-sqrt .align-end,
.auto-complete-external-area .icon-sqrt .align-end {
  margin-top: 8px;
}
math-type .icon-sqrt .line,
.auto-complete-external-area .icon-sqrt .line {
  width: 10px;
  border-top: solid 1px black;
  margin-top: 6px;
}
math-type .icon-sqrt .big-square,
.auto-complete-external-area .icon-sqrt .big-square {
  margin-top: 11px;
  margin-left: -8px;
}
math-type .sqrt-symbol {
  white-space: nowrap;
  align-items: stretch;
  position: relative;
}
math-type .sqrt-symbol > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  left: 50%;
  top: -0.5em;
  left: 0.5em;
}
math-type .sqrt-symbol > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .sqrt-symbol > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .sqrt-symbol text {
  fill: black;
}
math-type .sqrt-symbol > sqrt-edit {
  position: relative;
  order: 3;
  display: inline-block;
  align-self: flex-end;
}
math-type .sqrt-symbol > sqrt-edit > sqrt-symbol-line {
  overflow: visible;
  z-index: 1;
  width: 100%;
  height: 100%;
  display: block;
  position: absolute;
  left: 0;
  top: 0;
  pointer-events: none;
}
math-type .sqrt-symbol > sqrt-edit > sqrt-symbol-line > svg {
  overflow: visible;
  width: 100%;
  height: 1em;
}
math-type .sqrt-symbol > sqrt-edit > area-container > line {
  width: 1em;
  position: relative;
}
math-type .sqrt-symbol > sqrt-edit > editarea,
math-type .sqrt-symbol > sqrt-edit > editarea-line {
  z-index: 2;
  display: inline-block;
  min-width: 0.5em;
  margin-left: 1em;
}
math-type .sqrt-symbol > sqrt-top {
  position: relative;
  z-index: 2;
  vertical-align: bottom;
  padding-bottom: 0.95em;
  align-self: flex-end;
  display: inline-block;
}
math-type .sqrt-symbol > sqrt-top.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type .sqrt-symbol > sqrt-top > editarea {
  font-size: 0.7em;
  border: none 0px;
  min-width: 0.5em;
  display: flex;
  float: right;
  text-align: center;
  text-align-last: auto;
}
math-type .sqrt-symbol > sqrt-top > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}





/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
image-viewer {
  width: 100%;
}
image-viewer.inline {
  width: auto;
}
image-viewer .image-content {
  cursor: pointer;
  text-align: left;
}
image-viewer detail list-items-options div {
  border: 1px solid transparent;
  cursor: pointer;
  margin-left: 3px;
  padding: 0 2px 0 2px;
}
image-viewer detail list-items-options div:hover {
  background-color: white;
  border: 1px solid lightgray;
}
image-viewer detail list-items-options div.selected {
  background-color: white;
  border: 1px solid lightgray;
}
image-viewer image-container {
  display: flex;
  flex-direction: column;
}
image-viewer image-container img {
  position: absolute;
}
image-viewer image-container.center {
  align-items: center;
}
image-viewer image-container.left {
  align-items: flex-start;
}
image-viewer image-container.right {
  align-items: flex-end;
}
.resize-box {
  position: absolute;
  width: 8px;
  height: 8px;
  border-width: 1px;
  border-color: gray;
  border-style: solid;
  background-color: white;
  z-index: 999;
}
.resize-box.mobile-tablet {
  width: 16px;
  height: 16px;
}
.resize-box.hide {
  display: none;
}
topleft {
  top: 0;
  left: 0;
  margin-left: -5px;
  margin-top: -5px;
  cursor: nwse-resize;
}
topleft.mobile-tablet {
  margin-left: -8px;
  margin-top: -8px;
}
topright {
  top: 0;
  right: 0;
  margin-right: -5px;
  margin-top: -5px;
  cursor: nesw-resize;
}
topright.mobile-tablet {
  margin-right: -8px;
  margin-top: -8px;
}
topmiddle {
  top: 0;
  left: 50%;
  margin-left: -5px;
  margin-top: -5px;
  cursor: ns-resize;
}
topmiddle.mobile-tablet {
  margin-left: -8px;
  margin-top: -8px;
}
leftmiddle {
  top: 50%;
  left: 0;
  margin-left: -5px;
  margin-top: -5px;
  cursor: ew-resize;
}
leftmiddle.mobile-tablet {
  margin-left: -8px;
  margin-top: -8px;
}
rightmiddle {
  top: 50%;
  right: 0;
  margin-right: -5px;
  margin-top: -5px;
  cursor: ew-resize;
}
rightmiddle.mobile-tablet {
  margin-right: -8px;
  margin-top: -8px;
}
bottomleft {
  bottom: 0;
  left: 0;
  margin-left: -5px;
  margin-bottom: -5px;
  cursor: nesw-resize;
}
bottomleft.mobile-tablet {
  margin-left: -8px;
  margin-bottom: -8px;
}
bottomright {
  bottom: 0;
  right: 0;
  margin-right: -5px;
  margin-bottom: -5px;
  cursor: nwse-resize;
}
bottomright.mobile-tablet {
  margin-right: -8px;
  margin-bottom: -8px;
}
bottommiddle {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  margin-bottom: -5px;
  cursor: ns-resize;
}
bottommiddle.mobile-tablet {
  margin-left: -8px;
  margin-bottom: -8px;
}
.ghost-viewer {
  outline: 1px dotted gray;
  width: 100%;
  height: 100%;
  display: block;
}

compositeblock.image-container {
  position: relative;
  width: 100%;
  margin-top: 10px;
  margin-bottom: 10px;
}
compositeblock.image-container > image-viewer {
  display: block;
}
compositeblock.image-container.inline {
  width: auto;
  margin-top: 0;
  margin-bottom: 0;
  display: inline-block;
}
.image-caption > line.text-mode:first-child {
  display: inline;
}
.image-caption > line.text-mode:first-child > blocks {
  display: inline;
}
.add-caption {
  opacity: 0.85;
  text-align: "center";
  color: #1155cc;
  cursor: pointer;
  position: absolute;
  bottom: -35px;
  left: 50%;
  transform: translate(-50%, 0);
  z-index: 10;
  font-size: 13px;
  background: white;
  border: 1px solid lightgray;
  padding: 5px;
}
.add-caption:hover {
  opacity: 1;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .power-index-symbol-container {
  margin-right: 0.06em;
  margin-left: 0.03em;
}
math-type .power-index-symbol-container.has-power > .power-value {
  margin-left: 0.04em;
}
math-type .power-index-symbol-container > .power-value,
math-type .pre-script-symbol-container > .power-value {
  /*margin-bottom: -2px;*/
  float: left;
  clear: both;
  text-align: left;
}
math-type .power-index-symbol-container > .power-value.small > line,
math-type .pre-script-symbol-container > .power-value.small > line {
  margin-bottom: -0.35em;
}
math-type .power-index-symbol-container > .power-value > line,
math-type .pre-script-symbol-container > .power-value > line {
  font-size: 0.7em;
}
math-type .power-index-symbol-container > .power-value > area-container > line,
math-type .pre-script-symbol-container > .power-value > area-container > line,
math-type .power-index-symbol-container > .power-value > line,
math-type .pre-script-symbol-container > .power-value > line {
  justify-content: flex-start;
  text-align: left;
}
math-type .power-index-symbol-container > middle-base,
math-type .pre-script-symbol-container > middle-base {
  display: block;
  clear: both;
  height: 1em;
}
math-type .power-index-symbol-container > middle-base > inline,
math-type .pre-script-symbol-container > middle-base > inline {
  display: inline-block;
}
math-type .power-index-symbol-container > .index-value,
math-type .pre-script-symbol-container > .index-value {
  float: left;
  text-align: left;
}
math-type .power-index-symbol-container > .index-value > line,
math-type .pre-script-symbol-container > .index-value > line {
  font-size: 0.7em;
}
math-type .power-index-symbol-container > .index-value > area-container > line,
math-type .pre-script-symbol-container > .index-value > area-container > line,
math-type .power-index-symbol-container > .index-value > line,
math-type .pre-script-symbol-container > .index-value > line {
  justify-content: flex-start;
  text-align: left;
}
math-type .power-index-symbol-container > editarea-block.index-value,
math-type .pre-script-symbol-container > editarea-block.index-value,
math-type .power-index-symbol-container > editarea-line.index-value,
math-type .pre-script-symbol-container > editarea-line.index-value {
  font-size: 0.7em;
}
math-type .power-index-symbol-container > editarea-block.power-value,
math-type .pre-script-symbol-container > editarea-block.power-value,
math-type .power-index-symbol-container > editarea-line.power-value,
math-type .pre-script-symbol-container > editarea-line.power-value {
  font-size: 0.7em;
}
math-type .pre-script-symbol-container > .power-value {
  float: right;
}
math-type .pre-script-symbol-container > .index-value {
  float: right;
}
.icon-power-index-symbol {
  display: flex;
  margin: auto;
  width: 20px;
  padding-bottom: 6px;
}
.icon-power-index-symbol .square-up {
  margin-top: 4px;
}
.icon-power-index-symbol .square-down {
  margin-top: 14px;
  margin-left: -6px;
}
.icon-power-index-symbol .align-end {
  margin-top: 4px;
}
.icon-power-symbol {
  display: flex;
  margin: auto;
  width: 20px;
  padding-bottom: 6px;
}
.icon-power-symbol .square {
  margin-top: 4px;
}
.icon-power-symbol .align-end {
  margin-top: 4px;
}
.icon-index-symbol {
  display: flex;
  margin: auto;
  width: 20px;
  padding-bottom: 6px;
}
.icon-index-symbol .square {
  margin-top: 14px;
  margin-left: 0px;
}
.icon-index-symbol .align-end {
  margin-top: 4px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.matrix-like > matrix > table > tbody > tr > td {
  padding-bottom: 0.1em;
  padding-top: 0.1em;
}
.matrix-symbol.matrix-like > matrix > table > tbody > tr.hline {
  border-top: 1px solid;
}
.matrix-symbol.matrix-like > matrix > table > tbody > tr:last-child.last-hline {
  border-bottom: 1px solid;
}
.matrix-symbol {
  /* must be flex to have vertical center align , unless figure out another way */
  display: inline-flex;
  align-items: center;
}
.matrix-symbol > matrix > table > tbody > tr > td > .sbd {
  position: absolute;
  left: -1px;
  top: -1px;
  right: -1px;
  bottom: -1px;
  pointer-events: none;
  background: none;
}
.matrix-symbol.selected > matrix > table > tbody > tr > td > .sbd {
  border-top: 1px solid rgba(93, 92, 92, 0.15);
  border-left: 1px solid rgba(93, 92, 92, 0.15);
}
.matrix-symbol.selected > matrix > table > tbody > tr > td > .sbd.sbd-lr {
  border-bottom: 1px solid rgba(93, 92, 92, 0.15);
}
.matrix-symbol.selected > matrix > table > tbody > tr > td > .sbd.sbd-lc {
  border-right: 1px solid rgba(93, 92, 92, 0.15);
}
.matrix-symbol > base-line-indicator {
  height: inherit;
  margin-top: -0.18em;
}
.matrix-symbol matrixclosesymbol,
.matrix-symbol matrixopensymbol {
  font-style: normal;
  color: black;
  position: relative;
}
.matrix-symbol matrixclosesymbol > span,
.matrix-symbol matrixopensymbol > span {
  visibility: hidden;
  display: inline-block;
}
.matrix-symbol matrixclosesymbol > svg,
.matrix-symbol matrixopensymbol > svg {
  overflow: visible;
  font-size: 15px;
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
}
.matrix-symbol matrixclosesymbol > svg text,
.matrix-symbol matrixopensymbol > svg text {
  fill: black;
}
.matrix-symbol > matrix.matrix > table > tbody > tr > td {
  padding: 0 0.3em;
}
.matrix-symbol > matrix {
  display: flex;
  position: relative;
  float: left;
  align-items: flex-start;
  break-inside: avoid;
}
.matrix-symbol > matrix > svg {
  width: 0.6em;
  /*init height, willl be changed by inline style*/
  height: 3px;
  overflow: visible;
  align-self: flex-start;
}
.matrix-symbol > matrix > vcomposed-symbol {
  height: inherit;
  align-self: stretch;
}
.matrix-symbol > matrix > table {
  border: 1px solid transparent;
  border-collapse: collapse;
}
.matrix-symbol > matrix > table > tbody > tr {
  box-sizing: border-box;
}
.matrix-symbol > matrix > table > tbody > tr.smaller {
  font-size: 0.75em;
}
.matrix-symbol > matrix > table > tbody > tr > td {
  position: relative;
  border: 1px dotted transparent;
  box-sizing: border-box;
  padding: 0 0.3em;
  vertical-align: baseline;
}
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell {
  display: inline-block;
  width: 100%;
}
.matrix-symbol > matrix > table > tbody > tr > td.vline {
  border-left: 1px solid;
}
.matrix-symbol > matrix > table > tbody > tr > td:last-child.last-vline {
  border-right: 1px solid;
}
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell {
  min-width: 0.5em;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.matrix > table {
  margin-left: -0.2em;
  margin-right: -0.2em;
}
.matrix-symbol > matrix.matrix > table > tbody > tr > td > .editor-cell {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol > matrix.matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.left {
  text-align: left;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.left > area-container > line,
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.left > line {
  justify-content: flex-start;
  text-align: left;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.center {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.center > area-container > line,
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.center > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.right {
  text-align: right;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.right > area-container > line,
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.right > line {
  justify-content: flex-end;
  text-align: right;
}
.matrix-symbol > matrix.gathered > table > tbody > tr > td:nth-child(2n+3) {
  padding-left: 1em;
}
.matrix-symbol > matrix.gathered line {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td {
  padding: 0;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+3) {
  padding-left: 1em;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+1) > .editor-cell {
  text-align: right;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+1) > .editor-cell > area-container > line,
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+1) > .editor-cell > line {
  justify-content: flex-end;
  text-align: right;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n) > .editor-cell {
  text-align: left;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n) > .editor-cell > area-container > line,
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n) > .editor-cell > line {
  justify-content: flex-start;
  text-align: left;
}
.matrix-symbol > matrix > border-design {
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  display: block;
  background-color: rgba(255, 255, 255, 0.7);
  z-index: 10;
}
.matrix-symbol > matrix > border-design > border-line {
  cursor: pointer;
  position: absolute;
  /*border:1px solid gray;*/
}
.matrix-symbol > matrix > border-design > border-line > horizontal-line {
  border-top: 1px solid #eceaea;
  display: block;
  position: absolute;
  top: 50%;
  width: 100%;
  height: 1px;
  margin-top: 0;
  left: 0;
}
.matrix-symbol > matrix > border-design > border-line > vertical-line {
  border-left: 1px solid #eceaea;
  display: block;
  position: absolute;
  left: 50%;
  width: 1px;
  height: 100%;
  top: 0;
}
.matrix-symbol > matrix > border-design > border-line > vertical-line.enabled {
  border-top: 1px solid;
}
.matrix-symbol > matrix > border-design > border-line:hover > horizontal-line {
  border-top: 1px solid gray;
}
.matrix-symbol > matrix > border-design > border-line:hover > vertical-line {
  border-left: 1px solid gray;
}
.matrix-symbol > matrix > border-design > border-line.enabled > horizontal-line {
  border-top: 1px solid;
}
.matrix-symbol > matrix > border-design > border-line.enabled > vertical-line {
  border-left: 1px solid;
}
.matrix-symbol > matrix > setting {
  padding: 7px;
  position: absolute;
  top: -6px;
  font-family: "Segoe UI", Arial, Verdana, sans-serif;
  transform: translate(0, -100%);
  left: 0;
}
.matrix-symbol > matrix > setting > main-setting {
  display: flex;
  flex-direction: row;
}
.matrix-symbol > matrix > setting > main-setting styled-select {
  display: block;
  background-color: white;
}
.fa-table.array-settings {
  border: 1px solid lightgray;
  padding: 3px 5px;
  font-size: 14px;
  color: gray;
  cursor: pointer;
  /*margin-left: 5px;*/
}
.fa-table.array-settings:hover {
  color: black;
  background: white;
}
.matrix-icon {
  display: flex;
}
.matrix-icon .square {
  margin-top: 2px;
}
.matrix-icon .display-flex {
  display: flex;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td {
  padding: 0 0.2em;
}
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td.non-select,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td.non-select {
  user-select: none;
  width: 0.2em;
  padding: 0;
}
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td > .editor-cell,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td > .editor-cell {
  text-align: left;
}
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td > .editor-cell > line,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: flex-start;
  text-align: left;
}
.case-icon {
  display: flex;
  font-size: 18px;
  line-height: 18px;
}
.case-icon .square {
  margin-top: 2px;
}
.case-icon .display-flex {
  display: flex;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td {
  padding: 0 0.2em;
}
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #e0e0e0;
}
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td > .editor-cell {
  text-align: left;
}
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: flex-start;
  text-align: left;
}
.case-icon {
  display: flex;
  font-size: 18px;
  line-height: 18px;
}
.case-icon .square {
  margin-top: 2px;
}
.case-icon .display-flex {
  display: flex;
}

.array-icon .square {
  margin-top: 2px;
}
.array-icon .display-flex {
  display: flex;
}

.matrix-like.binom > .binom > table > tbody > tr > td {
  padding: 0;
}
.matrix-like.binom > .binom > table > tbody > tr > td line {
  text-align: center;
  text-align-last: auto;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.align-symbol {
  /*display flex because to make sure it's spend whole line*/
  display: flex;
  justify-content: center;
  margin-top: 10px;
  margin-bottom: 10px;
  width: 100%;
}
.matrix-symbol.align-symbol.selected {
  background-color: rgba(76, 175, 80, 0.05);
}
.matrix-symbol.align-symbol > matrix > setting > main-setting {
  margin-bottom: 0px;
}
.matrix-symbol.align-symbol > matrix > bulb {
  left: 50%;
}
.matrix-symbol.align-symbol > matrix > setting {
  margin-left: 20px;
}
.matrix-symbol.align-symbol > matrix.align {
  width: 100%;
  display: block;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td {
  padding: 0;
  vertical-align: baseline;
  border: 1px solid transparent;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell {
  /* should align start and area-container level (instead of line level)
                as for lazy rendering, we need to have exact line width */
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container {
  align-items: flex-start;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line {
  width: auto;
  text-align: left;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.align-right > .editor-cell {
  /* should align start and area-container level (instead of line level)
                as for lazy rendering, we need to have exact line width */
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.align-right > .editor-cell > area-container {
  align-items: flex-end;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.align-right > .editor-cell > area-container > line {
  width: auto;
  text-align: right;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.non-select {
  border: none;
  user-select: none;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.expand {
  width: 100%;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #e0e0e0;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell {
  min-width: 1.5em;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > tupple {
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: baseline;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.gather-symbol {
  /*display flex because to make sure it's spend whole line*/
  display: flex;
  justify-content: center;
  margin-top: 10px;
  margin-bottom: 10px;
  width: 100%;
}
.matrix-symbol.gather-symbol.selected {
  background-color: rgba(76, 175, 80, 0.05);
}
.matrix-symbol.gather-symbol > matrix.gather {
  width: 100%;
  display: block;
}
.matrix-symbol.gather-symbol > matrix > setting > main-setting {
  margin-bottom: 0px;
}
.matrix-symbol.gather-symbol > matrix > bulb {
  left: -1em;
}
.matrix-symbol.gather-symbol > matrix > setting {
  margin-left: 20px;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td {
  padding: 0;
  vertical-align: baseline;
  border: 1px solid transparent;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.non-select {
  user-select: none;
  width: 1.5em;
  border: none;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.expand {
  width: 100%;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #e0e0e0;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td line {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > .editor-cell {
  min-width: 1.5em;
  /* should align start and area-container level (instead of line level)
                as for lazy rendering, we need to have exact line width */
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container {
  align-items: center;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line {
  width: auto;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > tupple {
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: baseline;
}

math-type compositeblock.table-symbol {
  width: 100%;
  display: flex;
}
math-type compositeblock.table-symbol.cap-above {
  flex-direction: column;
}
math-type .matrix-symbol > matrix.table {
  width: 100%;
  flex-direction: column;
  align-items: stretch;
}
math-type .matrix-symbol > matrix.table > table {
  table-layout: fixed;
  border: unset;
  width: 100%;
}
math-type .matrix-symbol > matrix.table > table > tbody > tr > td {
  vertical-align: top;
  padding: 0;
  position: relative;
}
math-type .cell-border-box {
  position: absolute;
  left: -1px;
  top: -1px;
  width: 100%;
  height: 100%;
}
.table-caption > line.text-mode:first-child {
  display: inline;
}
.table-caption > line.text-mode:first-child > blocks {
  display: inline;
}

editarea.lttb.text-mode > line.text-mode > blocks {
  text-align: inherit;
}



math-type compositeblock.table-of-content {
  display: block;
  width: 100%;
}
math-type compositeblock.table-of-content > toc-wrapper {
  position: relative;
  width: 100%;
  display: block;
  cursor: default;
}
math-type compositeblock.table-of-content > toc-wrapper .toc-setting-icons {
  display: none;
  position: absolute;
  left: -65px;
  width: 70px;
  top: -20px;
  bottom: 0;
  font-size: 1em;
  z-index: 999;
  padding-top: 20px;
}
math-type compositeblock.table-of-content > toc-wrapper .toc-setting-icons > .icon-refresh,
math-type compositeblock.table-of-content > toc-wrapper .toc-setting-icons > .icon-settings {
  border: 1px solid #c3c2c2;
  padding: 0.3em;
  padding-top: 0.1em;
  line-height: 1.2;
  padding-bottom: 0;
  cursor: pointer;
  background-color: #f7f7f7;
  color: gray;
  width: 12px;
  display: inline-block;
  margin-left: 5px;
}
math-type compositeblock.table-of-content > toc-wrapper:hover .toc-setting-icons {
  display: block;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode {
  width: 100%;
  cursor: default;
  display: block;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode {
  display: block;
  width: auto;
  cursor: default;
  padding-left: 1em;
  padding-right: 15px;
  font-style: unset;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > blocks,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > blocks {
  display: block;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > prefix,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > prefix {
  display: none;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl {
  padding-left: 15px;
  padding-right: 1em;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl > a > blocks,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl > blocks {
  text-align: right;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl a > blocks > compositeblock.toc-page-number-symbol,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl > blocks > compositeblock.toc-page-number-symbol {
  float: left;
  padding-left: 0;
  margin-right: 0;
  margin-left: 0;
  padding-right: 0.5em;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > block,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > block,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > blocks > block,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode a > blocks > block {
  white-space: pre-wrap;
  white-space: break-spaces;
  cursor: pointer;
  font-style: unset;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > blocks > compositeblock.toc-page-number-symbol,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > blocks > compositeblock.toc-page-number-symbol {
  float: right;
  padding-left: 0.5em;
  margin-right: 0;
}

.icon-integral-symbol {
  margin: auto 4px auto auto;
  display: flex;
  flex-direction: row-reverse;
  font-size: 12px;
}
.icon-integral-symbol .square-up {
  border-width: 1px;
  margin-top: 0px;
}
.icon-integral-symbol .square-down {
  border-width: 1px;
  margin-top: 21px;
  margin-left: -10px;
}
.icon-integral-symbol .align-end {
  margin-top: 6px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .limit-type {
  position: relative;
}
math-type .limit-type > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  top: -1.4em;
  left: 0.6em;
  align-items: flex-start;
}
math-type .limit-type > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .limit-type > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .limit-type > .to,
math-type .limit-type > .from {
  float: left;
  clear: both;
}
math-type .limit-type > .to > line,
math-type .limit-type > .from > line,
math-type .limit-type > .to > editarea > line,
math-type .limit-type > .from > editarea > line {
  font-size: 0.7em;
}
math-type .limit-type > editarea-line,
math-type .limit-type > editarea-block {
  font-size: 0.7em;
}
math-type .limit-type > symbol {
  display: block;
  clear: both;
  pointer-events: none;
}
math-type .limit-type > symbol > span {
  white-space: nowrap;
  pointer-events: none;
}
math-type .limit-type > setting {
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  opacity: 0.5;
  opacity: 1;
  position: absolute;
  left: 50%;
  top: -2em;
  font-size: 0.6em;
  margin-left: -0.6em;
  padding: 0 0.2em;
  cursor: pointer;
}
math-type .limit-type > setting:hover {
  border-color: gray;
  opacity: 1;
}
math-type .limit-type > setting:hover {
  border: 1px solid gray;
}
math-type .limit-type > setting > i {
  transform: rotate(-60deg);
}
math-type .limit-type.limit-kind > setting > i {
  transform: rotate(45deg);
}
math-type .limit-type.limit-kind > symbol {
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > .from,
math-type .limit-type.limit-kind > .to {
  width: 100%;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > .from > line,
math-type .limit-type.limit-kind > .to > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > empty.from {
  height: 0;
  margin-top: -0.75em;
}
math-type .limit-type.limit-kind > empty.from > editarea.selected > line,
math-type .limit-type.limit-kind > empty.from > editarea-block.selected,
math-type .limit-type.limit-kind > empty.from > editarea-line.selected {
  background-color: white;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > empty.to {
  height: 0;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > empty.to > editarea.selected > line,
math-type .limit-type.limit-kind > empty.to > editarea-block.selected,
math-type .limit-type.limit-kind > empty.to > editarea-line.selected {
  background-color: white;
  text-align: center;
  text-align-last: auto;
}
math-type .integral-like-symbol.inline > symbol {
  font-size: 1em;
}
math-type .integral-like-symbol.int-ml {
  margin-left: -0.5em;
}
math-type .integral-like-symbol.oint-ml {
  margin-left: -0.3em;
}
math-type .integral-like-symbol > symbol {
  font-size: 1.5em;
}
math-type .integral-like-symbol > symbol > span {
  line-height: 1.4em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .limit-type.lim-like-symbol {
  margin-left: 0.2em;
  margin-right: 0.2em;
}
math-type .limit-type.lim-like-symbol.close-left {
  margin-left: 0;
}
math-type .limit-type.lim-like-symbol.close-right {
  margin-right: 0;
}
math-type .limit-type.lim-like-symbol.limit-kind > empty.from > editarea {
  margin-top: -0.4em;
}
math-type .lim-like-symbol > add {
  left: 50%;
  top: -1em;
}
math-type .lim-like-symbol > symbol.inf {
  text-decoration: underline;
}
math-type .lim-like-symbol > symbol.sup {
  text-decoration: overline;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from,
math-type .lim-like-symbol.non-limit-kind > editarea.to {
  margin-left: 1.47em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-lim,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-lim {
  margin-left: 1.5435em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-liminf,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-liminf {
  margin-left: 3.15em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-limsup,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-limsup {
  margin-left: 3.528em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-sup,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-sup {
  margin-left: 1.6905em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-varlimsup,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-varlimsup {
  margin-left: 1.5435em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to {
  margin-left: 2.072em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-lim,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-lim {
  margin-left: 2.1756em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-liminf,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-liminf {
  margin-left: 4.44em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-limsup,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-limsup {
  margin-left: 4.9728em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-sup,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-sup {
  margin-left: 2.3828em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-varlimsup,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-varlimsup {
  margin-left: 2.1756em;
}



/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .limit-type.summation-like-symbol.limit-kind > empty.from {
  margin-top: -0.3em;
}
math-type .limit-type.summation-like-symbol.limit-kind > empty.from > editarea,
math-type .limit-type.summation-like-symbol.limit-kind > empty.from > editarea-block {
  margin-top: -0.2em;
}
math-type .summation-like-symbol.inline > add {
  top: -1.1em;
}
math-type .summation-like-symbol.inline > symbol {
  font-size: 1em;
}
math-type .summation-like-symbol.inline > symbol > span {
  vertical-align: 0.15em;
}
math-type .summation-like-symbol {
  padding-right: 0.15em;
}
math-type .summation-like-symbol > symbol {
  font-size: 1.5em;
}
math-type .summation-like-symbol > symbol > span {
  vertical-align: 0.1em;
  line-height: 1.4em;
}
math-type .summation-like-symbol > add {
  top: -1.5em;
}
math-type .summation-like-symbol > .custom-symbol {
  font-weight: bold;
}

hcomposed-symbol {
  display: flex;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
hcomposed-symbol > start {
  display: block;
  float: left;
  overflow: hidden;
}
hcomposed-symbol > middle {
  display: block;
  flex-grow: 1;
  white-space: nowrap;
  position: relative;
  overflow: hidden;
}
hcomposed-symbol > middle > fixed {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
}
hcomposed-symbol > middle > fixed > inside {
  display: inline-block;
  overflow: hidden;
}
hcomposed-symbol > end {
  display: block;
  overflow: hidden;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .arrow-like-symbol {
  padding: 0 0.2em;
}
math-type .arrow-like-symbol > arrow-like-simple > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  left: 0.8em;
  top: -0.7em;
}
math-type .arrow-like-symbol > arrow-like-simple > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .arrow-like-symbol > arrow-like-simple > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .arrow-like-symbol > middle {
  display: block;
  text-align: center;
  text-align-last: auto;
  clear: both;
  width: 100%;
  position: relative;
}
math-type .arrow-like-symbol > middle > inside {
  display: inline-block;
  height: 0.55em;
  width: 100%;
}
math-type .arrow-like-symbol > middle > inside > hcomposed-symbol {
  position: absolute;
  top: 0.4em;
  left: 0;
}
math-type .arrow-like-symbol > editarea.sright-1 {
  padding-left: 0.55em;
  padding-right: 0.25em;
}
math-type .arrow-like-symbol > editarea.sleft-1 {
  padding-left: 0.25em;
  padding-right: 0.55em;
}
math-type .arrow-like-symbol > editarea.small-margin {
  padding-left: 0.4em;
  padding-right: 0.4em;
}
math-type .arrow-like-symbol > editarea.large-padding {
  margin: 0 1.3em;
}
math-type .arrow-like-symbol > editarea > line {
  font-size: 0.7em;
}
math-type .arrow-like-symbol > .top {
  float: left;
  width: 100%;
  clear: both;
  margin-bottom: -0.5em;
  z-index: 1;
  position: relative;
}
math-type .arrow-like-symbol > .top.space-1,
math-type .arrow-like-symbol > .top.up-space-1-lower-space-2 {
  margin-bottom: -0.4em;
}
math-type .arrow-like-symbol > .bottom {
  margin-top: -0.45em;
  float: left;
  width: 100%;
}
math-type .arrow-like-symbol > .bottom.space-1,
math-type .arrow-like-symbol > .bottom.lower-space-1 {
  margin-top: -0.35em;
}
math-type .arrow-like-symbol > .bottom.space-2,
math-type .arrow-like-symbol > .bottom.up-space-1-lower-space-2 {
  margin-top: -0.25em;
}

.over-icon {
  margin: auto;
  width: 12px;
  font-size: 13px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-arrow-symbol > arrow-symbol {
  display: block;
  margin-right: -0.05em;
  position: relative;
}
math-type .over-arrow-symbol > arrow-symbol > hcomposed-symbol {
  position: absolute;
}
math-type .over-arrow-symbol > arrow-symbol > arrow-wrapper {
  margin-right: -0.2em;
}
math-type .over-arrow-symbol > editarea {
  display: inline-flex;
  text-align: center;
  text-align-last: auto;
}
math-type .over-arrow-symbol > editarea > area-container > line,
math-type .over-arrow-symbol > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type .over-arrow-symbol > editarea-block {
  min-width: 0.5em;
  text-align: center;
  text-align-last: auto;
  display: inline-block;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-line-symbol {
  margin-left: 0.05em;
  margin-right: 0.05em;
}
math-type .over-line-symbol > editarea {
  display: inline-flex;
  min-width: 0.5em;
}
math-type .over-line-symbol > editarea-line {
  min-width: 0.5em;
  display: inline-block;
  text-align: center;
  text-align-last: auto;
}
math-type .over-line-symbol > line-border {
  display: block;
  position: relative;
}
math-type .over-line-symbol > line-border > hcomposed-symbol {
  position: absolute;
}
math-type .over-line-symbol > line-border > svg {
  position: absolute;
  width: 100%;
  height: 100%;
}

brace-top-wrapper {
  display: flex;
  flex-direction: row;
  height: 100%;
  font-family: Asana-Math, Asana;
}
brace-top-wrapper > middle-wrapper {
  flex-grow: 1;
  position: relative;
  overflow: hidden;
}
brace-top-wrapper > middle-wrapper > fixed {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
}
brace-top-wrapper > middle-wrapper > fixed > middle-inside {
  overflow: hidden;
}
brace-top-wrapper first,
brace-top-wrapper middle,
brace-top-wrapper last {
  overflow: hidden;
  position: relative;
}
brace-top-wrapper first {
  min-width: 0.7em;
  width: 0.7em;
}
brace-top-wrapper > middle {
  min-width: 0.6em;
  width: 0.6em;
}
brace-top-wrapper > last {
  min-width: 0.7em;
  width: 0.7em;
}
bracket-top-wrapper {
  display: flex;
  flex-direction: column;
  width: 100%;
  font-family: Asana-Math, Asana;
}
bracket-top-wrapper > first,
bracket-top-wrapper middle,
bracket-top-wrapper last {
  overflow: hidden;
  position: relative;
}
bracket-top-wrapper > first {
  height: 0.5em;
  min-height: 0.5em;
}
bracket-top-wrapper middle-wrapper {
  flex-grow: 1;
  position: relative;
  overflow: hidden;
}
bracket-top-wrapper middle-wrapper > fixed {
  overflow: hidden;
  position: absolute;
  left: 0;
  top: 0;
}
bracket-top-wrapper middle-wrapper > fixed > middle {
  display: block;
  overflow: hidden;
}
bracket-top-wrapper > last {
  height: 0.65em;
  min-height: 0.65em;
}
parenthesis-top-wrapper {
  display: flex;
  flex-direction: column;
  width: 100%;
  font-family: Asana-Math, Asana;
}
parenthesis-top-wrapper > first,
parenthesis-top-wrapper middle,
parenthesis-top-wrapper last {
  overflow: hidden;
  position: relative;
  height: 1em;
  min-height: 1em;
}
parenthesis-top-wrapper > first {
  min-height: 0.9em;
  height: 0.9em;
}
parenthesis-top-wrapper middle-wrapper {
  flex-grow: 1;
  position: relative;
  overflow: hidden;
}
parenthesis-top-wrapper middle-wrapper > fixed {
  position: absolute;
  top: 0;
  left: 0;
}
parenthesis-top-wrapper middle-wrapper > fixed > middle {
  display: block;
  overflow: hidden;
}
parenthesis-top-wrapper > last {
  min-height: 1em;
  height: 1em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-brace-symbol {
  position: relative;
}
math-type .over-brace-symbol > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  top: -1.5em;
  margin-left: -0.6em;
}
math-type .over-brace-symbol > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .over-brace-symbol > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .over-brace-symbol > top-brace {
  pointer-events: none;
  display: block;
  min-width: 1.1em;
  position: relative;
  clear: both;
  margin-bottom: -0.1em;
  font-style: normal;
  font-weight: normal;
}
math-type .over-brace-symbol > top-brace > brace-top-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  left: 50%;
  transform: translate(-50%, 0);
}
math-type .over-brace-symbol > editarea {
  display: inline-flex;
  width: 100%;
  align-self: center;
  clear: both;
}
math-type .over-brace-symbol > editarea.overValue {
  font-size: 0.7em;
  float: left;
  width: 100%;
  margin-bottom: 0.1em;
}

.icon-hat {
  margin: auto;
  width: 12px;
  font-size: 12px;
}
.icon-hat .square {
  margin-top: -3px;
}

.under-arc-symbol {
  display: inline-block;
}
.under-arc-symbol > editarea {
  display: inline-flex;
}
.under-arc-symbol > symbol {
  display: block;
  width: 100%;
  position: relative;
}
.under-arc-symbol > symbol > svg {
  position: absolute;
  left: 0;
  top: 0;
  display: block;
  width: 100%;
  height: 100%;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .under-line-symbol > editarea {
  display: inline-flex;
}
math-type .under-line-symbol > line-border {
  display: block;
  position: relative;
  float: left;
  width: 100%;
}
math-type .under-line-symbol > line-border > svg {
  position: absolute;
  width: 100%;
  height: 100%;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.under-brace-symbol {
  display: inline-flex;
  flex-flow: column;
  position: relative;
}
math-type compositeblock.under-brace-symbol > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  top: 3em;
}
math-type compositeblock.under-brace-symbol > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type compositeblock.under-brace-symbol > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type compositeblock.under-brace-symbol > bottom-brace {
  pointer-events: none;
  display: block;
  position: relative;
  min-width: 1.3em;
  font-style: normal;
  font-weight: normal;
}
math-type compositeblock.under-brace-symbol > bottom-brace > brace-top-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  left: 50%;
  transform: translate(-50%, 0);
}
math-type compositeblock.under-brace-symbol > editarea {
  margin-left: 0.15em;
  margin-right: 0.15em;
  align-self: center;
}
math-type compositeblock.under-brace-symbol > editarea.underValue {
  font-size: 0.7em;
}
.under-brace-icon {
  width: 12px;
  margin: auto;
  font-size: 12px;
}
.under-brace-icon .brace-wrapper {
  margin-top: -14px;
}


math-type .operator-name > editarea {
  margin-left: 0.2em;
  margin-right: 0.2em;
  display: inline-flex;
}
math-type .operator-name > editarea.close-left {
  margin-left: 0;
}
math-type .operator-name > editarea.close-right {
  margin-right: 0;
}

.math-group > editarea {
  float: left;
}
.group-icon .rectangle {
  width: 23px;
  height: 12px;
  border-style: solid;
  border-width: 1px;
  text-align: center;
  border-color: gray;
  font-family: fantasy;
  color: black;
  padding-top: 1px;
  font-size: 9px;
  line-height: 14px;
  vertical-align: middle;
  margin: auto;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.over-symbol {
  position: relative;
}
math-type compositeblock.over-symbol > symbol {
  font-family: Asana-Math, Asana, Arial;
  height: 8em;
  display: block;
  text-align: center;
  text-align-last: auto;
  position: relative;
}
math-type compositeblock.over-symbol > symbol > inner {
  display: block;
  position: absolute;
  text-align: center;
  text-align-last: auto;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}
math-type compositeblock.over-symbol > symbol.dot > inner.left-sign,
math-type compositeblock.over-symbol > symbol.ring > inner.left-sign {
  transform: translate(-0.07em, 0);
}
math-type compositeblock.over-symbol > symbol.dot > inner.right-sign,
math-type compositeblock.over-symbol > symbol.ring > inner.right-sign {
  transform: translate(0.2em, 0);
}
math-type compositeblock.over-symbol > symbol.dot > inner,
math-type compositeblock.over-symbol > symbol.ring > inner {
  transform: translate(0.05em, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner.left-sign,
math-type compositeblock.over-symbol > symbol.small-tilde > inner.left-sign {
  transform: translate(-0.04em, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner.right-sign,
math-type compositeblock.over-symbol > symbol.small-tilde > inner.right-sign {
  transform: translate(0.15em, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner.ignore-shift,
math-type compositeblock.over-symbol > symbol.small-tilde > inner.ignore-shift {
  transform: translate(0, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner,
math-type compositeblock.over-symbol > symbol.small-tilde > inner {
  transform: translate(0.05em, 0);
}
math-type compositeblock.over-symbol > symbol.acute > inner.left-sign {
  transform: translate(-0.04em, 0);
}
math-type compositeblock.over-symbol > symbol.acute > inner.right-sign {
  transform: translate(0.25em, 0);
}
math-type compositeblock.over-symbol > symbol.acute > inner {
  transform: translate(0.1em, 0);
}
math-type compositeblock.over-symbol > symbol.grave,
math-type compositeblock.over-symbol > symbol.breve,
math-type compositeblock.over-symbol > symbol.acute {
  font-family: 'Times New Roman', Times, serif;
}
math-type compositeblock.over-symbol > symbol.grave > inner.left-sign,
math-type compositeblock.over-symbol > symbol.breve > inner.left-sign,
math-type compositeblock.over-symbol > symbol.check > inner.left-sign {
  transform: translate(-0.07em, 0);
}
math-type compositeblock.over-symbol > symbol.grave > inner.right-sign,
math-type compositeblock.over-symbol > symbol.breve > inner.right-sign,
math-type compositeblock.over-symbol > symbol.check > inner.right-sign {
  transform: translate(0.17em, 0);
}
math-type compositeblock.over-symbol > symbol.ddddot {
  min-width: 0.9em;
}
math-type compositeblock.over-symbol > symbol.dddot {
  min-width: 0.7em;
}

.math-xx > editarea {
  float: left;
}

math-type .big-delimiter-symbol {
  display: inline-flex;
  align-items: center;
  position: relative;
  margin: 0.1em 0;
}
math-type .big-delimiter-symbol big-delimiter.big-open {
  margin-left: 0.09em;
}
math-type .big-delimiter-symbol big-delimiter.big-close {
  margin-right: 0.07em;
}
math-type .big-delimiter-symbol > base-line-indicator {
  height: inherit;
}
math-type .big-delimiter-symbol > big-delimiter > svg {
  height: 100%;
  width: 100%;
}
math-type .big-delimiter-symbol > big-delimiter > bulb {
  left: -10px;
}
math-type .big-delimiter-symbol > big-delimiter > setting {
  width: 158px;
  display: flex;
  position: absolute;
  left: 0;
  top: -40px;
}
math-type .big-delimiter-symbol > big-delimiter > setting > .select-box-container {
  margin-right: 4px;
}
math-type .big-delimiter-symbol > big-delimiter > setting > .select-box-container:last-child {
  margin-right: 0px;
}

select-buttons {
  font-size: 13px;
  color: gray;
  display: block;
}
select-buttons > sb-item {
  display: inline-block;
  padding: 2px 2px;
  cursor: pointer;
  border: 1px solid transparent;
  /*box-sizing: border-box;*/
}
select-buttons > sb-item.selected {
  background-color: white;
  border: 1px solid lightgray;
}
select-buttons > sb-item:hover {
  border: 1px solid lightgray;
}
select-buttons > sb-item.disabled {
  opacity: 0.3;
  cursor: default;
  border: 1px solid transparent;
}
select-buttons > sb-item.disabled:hover {
  background-color: inherit;
  border: 1px solid transparent;
}

tabs-container tab-item {
  color: gray;
}
tabs-container tab-item:hover {
  color: black;
}

expandable-component.button-action {
  cursor: pointer;
  color: gray;
  fill: gray;
}
expandable-component.button-action:hover,
expandable-component.button-action.selected {
  color: black;
  fill: black;
}
expandable-component.button-action:hover label-display,
expandable-component.button-action.selected label-display {
  border: 1px solid #e2e0e0;
}
expandable-component.button-action label-display {
  font-size: 12px;
  padding-top: 5px;
  display: flex;
  border: 1px solid transparent;
  padding-left: 2px;
  padding-right: 2px;
  margin-top: 0px;
  padding-bottom: 4px;
  cursor: pointer;
}
expandable-component.button-action label-display > i {
  padding-left: 5px;
  padding-top: 1px;
}
expandable-component.button-action label-item-container > label-item:hover {
  background-color: #bfe4bd;
}
expandable-component.button-action label-item-container > label-item.ignore-select {
  background-color: inherit;
  cursor: default;
}
expandable-component.button-action.button-style label-display {
  background: white;
  border: 1px solid lightgray;
}
expandable-component.button-action.button-style:hover,
expandable-component.button-action.button-style.selected {
  color: gray;
}
expandable-component.button-action.button-style:hover label-display,
expandable-component.button-action.button-style.selected label-display {
  background: #f7f6f6;
}

g.group-box-move {
  opacity: 0.2;
}
g.group-box-move:hover {
  opacity: 0.8;
}




.math-diagram .intersections-group {
  stroke-width: 2px;
  stroke: black;
  fill: transparent;
  cursor: move;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.math-diagram > math-diagram {
  background: white;
}
math-type compositeblock.math-diagram {
  cursor: default;
  width: 100%;
  /** display block as if inline block, it will be disapear in some cases*/
  display: block;
}
math-type compositeblock.math-diagram .connection-point {
  cursor: crosshair;
}
math-type compositeblock.math-diagram .connection-point g {
  fill-opacity: 0.6;
}
math-type compositeblock.math-diagram .connection-point:hover g {
  fill-opacity: 1;
}
math-type compositeblock.math-diagram .text-diagram-editor editarea.text-mode.non-wrap > line.text-mode {
  font-size: unset;
}
math-type compositeblock.math-diagram .text-diagram-editor editarea.text-mode.non-wrap > line.text-mode > block {
  white-space: pre;
}
math-type compositeblock.math-diagram .text-diagram-editor editarea.text-mode.non-wrap > line.text-mode > blocks > block {
  white-space: pre;
}
math-type compositeblock.math-diagram > math-diagram {
  border: 1px solid transparent;
}
math-type compositeblock.math-diagram > math-diagram > clip-region > zoom-region {
  display: block;
  width: 100%;
  height: 100%;
}
math-type compositeblock.math-diagram > math-diagram > clip-region > zoom-region > svg {
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}
math-type compositeblock.math-diagram .add-label {
  fill: gray;
}
math-type compositeblock.math-diagram .add-label:hover {
  fill: black;
}
math-type compositeblock.math-diagram .diagram-editor {
  margin: 0 2px;
}
math-type compositeblock.math-diagram .control-point-guide {
  stroke: lightgray;
  stroke-width: 0.5px;
  pointer-events: none;
}
math-type compositeblock.math-diagram .connection-group {
  stroke: black;
  fill: none;
}
math-type compositeblock.math-diagram .arrow-line {
  cursor: move;
}
math-type compositeblock.math-diagram .mobile-tablet .shape .transparent,
math-type compositeblock.math-diagram .mobile-tablet .composite-shape .transparent {
  stroke-width: 10px;
}
math-type compositeblock.math-diagram .shape,
math-type compositeblock.math-diagram .composite-shape {
  stroke-width: 1px;
  fill: none;
  cursor: move;
}
math-type compositeblock.math-diagram .shape .transparent,
math-type compositeblock.math-diagram .composite-shape .transparent {
  pointer-events: visiblePainted;
  stroke-width: 6px;
  stroke: transparent;
  stroke-dasharray: none;
  fill: none;
}
math-type compositeblock.math-diagram .mobile-tablet .connection.transparent,
math-type compositeblock.math-diagram .mobile-tablet .connection.transparent > line,
math-type compositeblock.math-diagram .mobile-tablet .connection.transparent > path {
  stroke-width: 10px;
}
math-type compositeblock.math-diagram .connection {
  stroke-width: 1px;
  fill: none;
  cursor: move;
}
math-type compositeblock.math-diagram .connection.transparent,
math-type compositeblock.math-diagram .connection.transparent > line,
math-type compositeblock.math-diagram .connection.transparent > path {
  pointer-events: visiblePainted;
  stroke-width: 6px;
  stroke: transparent;
  stroke-dasharray: none;
  fill: none;
}
math-type compositeblock.math-diagram .frame {
  stroke-width: 1px;
  fill: transparent;
}
math-type math-diagram {
  display: block;
  position: relative;
  width: 100%;
  height: 300px;
}
math-type math-diagram position-container {
  position: absolute;
  width: 1px;
  height: 1px;
  display: block;
}
math-type math-diagram dg-editor-container {
  position: absolute;
  min-width: 0.85em;
  border-collapse: border-box;
}
math-type math-diagram coverlayer {
  position: absolute;
  background: transparent;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  z-index: 2;
  cursor: move;
}
math-type math-diagram connection-point {
  position: absolute;
  display: block;
  height: 6px;
  width: 6px;
  background: lightgray;
  border: 1px solid gray;
  bottom: -10px;
  left: 50%;
  margin-left: -3px;
  cursor: e-resize;
}
math-type .diagram-caption > line.text-mode:first-child {
  display: inline;
}
math-type .diagram-caption > line.text-mode:first-child > blocks {
  display: inline;
}


.plot-input-style-settings {
  opacity: 0.5;
}
.plot-input-style-settings:hover {
  opacity: 1;
}

.psa-cn .ps-hint {
  opacity: 0;
  transition: opacity 0.3s linear;
}
.psa-cn:hover .ps-hint {
  opacity: 0.6;
}

.role-toolbar-wrapper.dg-full-view tool-bar too-bar-container {
  justify-content: start;
  width: auto;
  min-width: 0;
}
.role-toolbar-wrapper.dg-full-view diagram-settings {
  width: auto;
}

.dg-items-bar-container item {
  display: inline-block;
  padding: 3px;
  fill: gray;
  stroke: gray;
}
.dg-items-bar-container item,
.dg-items-bar-container item-option {
  border: 1px transparent solid;
}
.dg-items-bar-container item:hover,
.dg-items-bar-container item-option:hover {
  border: 1px #c4c1c1 solid;
  background: white;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.theorem {
  display: block;
}
math-type compositeblock.theorem.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type theorem-name {
  min-width: 20px;
  display: inline;
}
math-type theorem-name > line.text-mode:first-child {
  display: inline;
}
math-type editarea.text-mode.edit-theorem-content {
  min-width: 100px;
  display: inline;
  font-style: italic;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode:first-child {
  display: inline;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode:first-child > blocks {
  display: inline;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode > block {
  font-style: italic;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode > blocks > block {
  font-style: italic;
}
math-type editarea.text-mode.edit-theorem-content.normal > line.text-mode > block {
  font-style: normal;
}
math-type editarea.text-mode.edit-theorem-content.normal > line.text-mode > blocks > block {
  font-style: normal;
}
math-type editarea.text-mode.edit-theorem-content .qed-symbol {
  line-height: 1em;
}
.deletable {
  cursor: pointer;
}
.deletable:hover {
  color: red;
}

.regular-checkbox:hover {
  background-color: #f3f2f2;
}

@media print {
  code[class*="language-"],
  pre[class*="language-"] {
    text-shadow: none !important;
  }
}
math-type .code-section prefix.code-line-number {
  color: #a9a7a7;
  width: 2.5em;
  display: inline-block;
  flex-shrink: 0;
}
math-type .code-section prefix.code-line-number.prefix-l10 {
  width: 1.5em;
}
math-type .code-section prefix.code-line-number.prefix-l100 {
  width: 2em;
}
math-type .code-section .code-line-blocks-container {
  white-space: pre-wrap;
  white-space: break-spaces;
}
math-type .code-section .code-line-blocks-container block.token {
  white-space: pre-wrap;
  white-space: break-spaces;
}
math-type .code-section line.text-mode.code-section-line {
  display: flex;
  flex-direction: row;
  line-height: 1.5;
}

/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */
.code-section.theme-default editarea {
  color: black;
}
.code-section.theme-default .token.comment,
.code-section.theme-default .token.prolog,
.code-section.theme-default .token.doctype,
.code-section.theme-default .token.cdata {
  color: slategray;
}
.code-section.theme-default .token.punctuation {
  color: #999;
}
.code-section.theme-default .namespace {
  opacity: 0.7;
}
.code-section.theme-default .token.property,
.code-section.theme-default .token.tag,
.code-section.theme-default .token.boolean,
.code-section.theme-default .token.number,
.code-section.theme-default .token.constant,
.code-section.theme-default .token.symbol,
.code-section.theme-default .token.deleted {
  color: #905;
}
.code-section.theme-default .token.selector,
.code-section.theme-default .token.attr-name,
.code-section.theme-default .token.string,
.code-section.theme-default .token.char,
.code-section.theme-default .token.builtin,
.code-section.theme-default .token.inserted {
  color: #690;
}
.code-section.theme-default .token.operator,
.code-section.theme-default .token.entity,
.code-section.theme-default .token.url,
.code-section.theme-default .language-css .token.string,
.code-section.theme-default .style .token.string {
  color: #9a6e3a;
}
.code-section.theme-default .token.atrule,
.code-section.theme-default .token.attr-value,
.code-section.theme-default .token.keyword {
  color: #07a;
}
.code-section.theme-default .token.function,
.code-section.theme-default .token.class-name {
  color: #DD4A68;
}
.code-section.theme-default .token.regex,
.code-section.theme-default .token.important,
.code-section.theme-default .token.important1,
.code-section.theme-default .token.variable {
  color: #e90;
}
.code-section.theme-default .token.important,
.code-section.theme-default .token.bold,
.code-section.theme-default .token.bold1 {
  font-weight: bold;
}
.code-section.theme-default .token.italic,
.code-section.theme-default .token.italic1 {
  font-style: italic;
}
.code-section.theme-default .token.entity {
  cursor: help;
}

/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */
.code-section.theme-tomorrow-night {
  /**
 * prism.js tomorrow night eighties for JavaScript, CoffeeScript, CSS and HTML
 * Based on https://github.com/chriskempson/tomorrow-theme
 * @author Rose Pritchard
 */
}
.code-section.theme-tomorrow-night editarea {
  caret-color: #ccc;
}
.code-section.theme-tomorrow-night editarea {
  color: #ccc;
}
.code-section.theme-tomorrow-night .token.comment,
.code-section.theme-tomorrow-night .token.block-comment,
.code-section.theme-tomorrow-night .token.prolog,
.code-section.theme-tomorrow-night .token.doctype,
.code-section.theme-tomorrow-night .token.cdata {
  color: #999;
}
.code-section.theme-tomorrow-night .token.punctuation {
  color: #ccc;
}
.code-section.theme-tomorrow-night .token.tag,
.code-section.theme-tomorrow-night .token.attr-name,
.code-section.theme-tomorrow-night .token.namespace,
.code-section.theme-tomorrow-night .token.deleted {
  color: #e2777a;
}
.code-section.theme-tomorrow-night .token.function-name {
  color: #6196cc;
}
.code-section.theme-tomorrow-night .token.boolean,
.code-section.theme-tomorrow-night .token.number,
.code-section.theme-tomorrow-night .token.function {
  color: #f08d49;
}
.code-section.theme-tomorrow-night .token.property,
.code-section.theme-tomorrow-night .token.class-name,
.code-section.theme-tomorrow-night .token.constant,
.code-section.theme-tomorrow-night .token.symbol {
  color: #f8c555;
}
.code-section.theme-tomorrow-night .token.selector,
.code-section.theme-tomorrow-night .token.important,
.code-section.theme-tomorrow-night .token.important1,
.code-section.theme-tomorrow-night .token.atrule,
.code-section.theme-tomorrow-night .token.keyword,
.code-section.theme-tomorrow-night .token.builtin {
  color: #cc99cd;
}
.code-section.theme-tomorrow-night .token.string,
.code-section.theme-tomorrow-night .token.char,
.code-section.theme-tomorrow-night .token.attr-value,
.code-section.theme-tomorrow-night .token.regex,
.code-section.theme-tomorrow-night .token.variable {
  color: #7ec699;
}
.code-section.theme-tomorrow-night .token.operator,
.code-section.theme-tomorrow-night .token.entity,
.code-section.theme-tomorrow-night .token.url {
  color: #67cdcc;
}
.code-section.theme-tomorrow-night .token.important,
.code-section.theme-tomorrow-night .token.bold,
.code-section.theme-tomorrow-night .token.bold1 {
  font-weight: bold;
}
.code-section.theme-tomorrow-night .token.italic,
.code-section.theme-tomorrow-night .token.italic1 {
  font-style: italic;
}
.code-section.theme-tomorrow-night .token.entity {
  cursor: help;
}
.code-section.theme-tomorrow-night .token.inserted {
  color: green;
}

editor-container > math-type.dark-mode {
  background: #1e1e1e;
}
math-type.dark-mode {
  background: #1e1e1e;
}
math-type.dark-mode.math-type-for-print {
  -webkit-print-color-adjust: exact;
}
math-type.dark-mode editarea.root-editor {
  color: #e0e0e0;
  fill: #e0e0e0;
  stroke: #e0e0e0;
  border-color: #e0e0e0;
}
math-type.dark-mode editarea.root-editor {
  background: #1e1e1e;
}
math-type.dark-mode .math-container-symbol.selected,
math-type.dark-mode .math-container-symbol.display.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.gather-symbol.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.align-symbol.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.align-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.matrix-like.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.matrix-like > matrix > table > tbody > tr.selected:not(.hline) {
  border-top: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.matrix-like > matrix > table > tbody > tr:last-child.selected {
  border-bottom: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol > matrix > table > tbody > tr > td.selected:not(.vline) {
  border-left: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol > matrix > table > tbody > tr > td:last-child.selected {
  border-right: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.case-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #525252;
}
math-type.dark-mode selection-wrapper > selection {
  background-color: rgba(33, 150, 243, 0.25);
}
math-type.dark-mode selection-wrapper.inactive > selection {
  background-color: rgba(255, 255, 255, 0.27);
}
math-type.dark-mode editarea.selected {
  outline: 1px solid rgba(177, 174, 174, 0.3);
}
math-type.dark-mode compositeblock.math-diagram > math-diagram {
  background: #1e1e1e;
}
container-layer.dark-mode editor-container {
  background: #1e1e1e;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
editor-container > math-type {
  background: white;
  outline: 1px solid lightgray;
}
math-type {
  display: block;
  position: relative;
  padding: 20px;
  color: black;
  padding-top: 15px;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  outline: none;
  cursor: text;
  text-align: initial;
}
math-type .rcnt {
  color: white;
  font-size: 12px;
  position: -webkit-sticky;
  position: sticky;
  top: 0;
  bottom: 0;
  display: flex;
  flex-direction: row;
}
math-type > .mt-sa {
  position: absolute;
  top: 0;
  left: -100px;
  right: -100px;
  bottom: -400px;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  pointer-events: none;
}
math-type.math-only compositeblock.math-container-symbol {
  width: 100%;
}
math-type.math-only compositeblock.math-container-symbol.selected {
  outline: none;
  background: none;
}
math-type.math-only compositeblock.math-container-symbol > editarea {
  width: 100%;
}
math-type.math-only compositeblock.math-container-symbol > editarea > line {
  justify-content: flex-start;
}
math-type > input:not([type]),
math-type input[type="text"] {
  width: 50px;
}
math-type composition-indicator {
  display: block;
  position: absolute;
  height: 2px;
  min-width: 2px;
  border-bottom: 2px solid gray;
  left: 0;
  top: 0;
}
math-type .focus-element {
  outline: none;
  overflow: hidden;
  width: 0px;
  height: 0px;
  top: 0px;
  left: 0px;
  display: block;
  position: absolute;
  font-size: 40px;
}
.scroll-without-scrollbar {
  scrollbar-width: none;
  /* Firefox */
  -ms-overflow-style: none;
  /* IE 10+ */
}
.scroll-without-scrollbar::-webkit-scrollbar {
  width: 0;
  height: 0;
  display: none;
}
#root,
.main-container {
  width: 100%;
  color: #212121;
}
.sub-text-cursor,
.text-cursor {
  position: absolute;
  color: green;
  /*font-size: 1.2em;*/
  pointer-events: none;
  border-left: 2px solid green;
  display: block;
  top: 0px;
  left: 0px;
  z-index: 10;
}
.sub-text-cursor {
  opacity: 0.4;
}
math-edit-container {
  display: block;
  outline: none;
  position: relative;
  font-family: 'Asana';
}
.root-editor {
  min-height: 500px;
  box-sizing: border-box;
}
.root-editor.restricted-view {
  min-height: unset;
}
.root-editor.test-view {
  min-height: 100px;
}
.menu {
  color: #ffffff;
  text-transform: uppercase;
  text-decoration: none;
  font-family: "HelveticaNeue-Medium", sans-serif;
  font-size: 14px;
  display: inline-block;
  transform: scale(1, 1.5);
  -webkit-transform: scale(1, 1.5);
  /* Safari and Chrome */
  -moz-transform: scale(1, 1.5);
  /* Firefox */
  -ms-transform: scale(1, 1.5);
  /* IE 9+ */
  -o-transform: scale(1, 1.5);
  /* Opera */
}
.setting-group-options {
  font-size: 13px;
  color: gray;
  fill: gray;
}
.setting-group-options > i,
.setting-group-options > svg.icon {
  padding: 3px;
  cursor: pointer;
  border: 1px solid transparent;
  /*box-sizing: border-box;*/
}
.setting-group-options > i.selected,
.setting-group-options > svg.icon.selected {
  background-color: white;
  border: 1px solid lightgray;
}
.setting-group-options > i:hover,
.setting-group-options > svg.icon:hover {
  border: 1px solid lightgray;
}
.setting-group-options > i.disabled,
.setting-group-options > svg.icon.disabled {
  opacity: 0.3;
}
.setting-group-options > i.disabled:hover,
.setting-group-options > svg.icon.disabled:hover {
  background-color: inherit;
  border: 1px solid transparent;
}
math-type .math-text,
math-type .normal-text,
math-type .raw-latex {
  font-family: arial, verdana, geneva, lucida, 'lucida grande', arial, helvetica, sans-serif;
}
math-type .math-text editarea.text-mode > line.text-mode > blocks > block,
math-type .normal-text editarea.text-mode > line.text-mode > blocks > block,
math-type .raw-latex editarea.text-mode > line.text-mode > blocks > block {
  white-space: nowrap;
}
.mt-common-dialog {
  box-shadow: 1px 1px 1px 0px #e0dddd;
  background-color: #f7f7f7;
  border: 1px lightgray solid;
  z-index: 14;
  padding: 6px;
  cursor: default;
  font-family: "Segoe UI", Arial, Verdana, sans-serif;
}
disabled-layer {
  display: block;
  position: absolute;
  left: 0;
  top: 1px;
  right: 0;
  bottom: 2px;
  background: rgba(247, 247, 247, 0.66);
  /** consider export button z-index when change this one*/
  z-index: 500;
}
math-type tag-container tag-select-wrapper {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}
math-type tag-container tag-box-select {
  position: absolute;
  display: block;
  background-color: green;
  opacity: 0;
  cursor: pointer;
  z-index: 15;
}
math-type tag-container tag-box-select:hover {
  opacity: 0.2;
}
math-type tag-container tag-box-gap {
  position: absolute;
  display: block;
  background-color: white;
  opacity: 0.9;
  z-index: 15;
}
.setting-popup-zindex {
  z-index: 11;
}
svg.selectable {
  cursor: pointer;
  border: 1px solid transparent;
}
svg.selectable.selected {
  background: white;
  border: solid 1px lightgray;
}
svg.selectable:hover {
  border: solid 1px lightgray;
}


@media print {
  @page {
    margin: 0;
  }
  /**
    Convert Preview into main print area
    */
  .math-type-doc,
  .docs-container,
  .modal-dialog-root-container,
  instructions-container {
    display: none !important;
  }
  .print-preview-container {
    position: static !important;
    display: block !important;
    visibility: visible !important;
    width: auto !important;
    height: auto !important;
    z-index: 99999 !important;
  }
  .print-container {
    position: static !important;
    overflow: hidden;
  }
  .print-preview-controls-container {
    display: none !important;
  }
  .math-type-no-print {
    display: none !important;
  }
  area-container.print-page-level {
    margin-left: 0 !important;
    margin-top: 0 !important;
    margin-right: 0 !important;
    margin-bottom: 0 !important;
    border: none !important;
    border-left: none !important;
    border-top: none !important;
    border-right: none !important;
    border-bottom: none !important;
    break-inside: avoid !important;
  }
  .area-container-border {
    border: none !important;
    border-left: none !important;
    border-top: none !important;
    border-right: none !important;
    border-bottom: none !important;
    display: none !important;
  }
  #print-container {
    background-color: transparent !important;
  }
  #print-container > math-type {
    background-color: transparent !important;
  }
  #print-container > math-type > math-edit-container > editarea {
    background-color: transparent !important;
  }
  /*-----------------------------*/
  header,
  .export-bar-container {
    display: none !important;
  }
  math-type {
    padding: 0 !important;
  }
  .print-remove-background {
    background-color: transparent !important;
  }
  document-info-bar {
    display: none !important;
  }
  document-sidebar-container {
    display: none !important;
  }
  body {
    position: relative !important;
  }
  page,
  #root,
  body,
  html {
    height: 100% !important;
    width: 100% !important;
    position: relative !important;
    background: white !important;
    overflow: visible !important;
  }
}
.print-background.math-type-for-print {
  -webkit-print-color-adjust: exact;
}
@media print {
  outline: none !important;
  .npm__react-simple-code-editor__textarea {
    display: none !important;
  }
  math-diagram {
    border: none !important;
  }
  .no-border-on-print {
    border: none !important;
  }
  .setting-select {
    display: none !important;
  }
  .no-print,
  ref-tag.empty-line-tag,
  .text-cursor,
  .sub-text-cursor,
  selection-wrapper,
  message-box-container,
  connection-controls,
  .control-point-guide,
  tool-bar,
  items-bar,
  document-sidebar,
  resize-bar,
  diagram-expander,
  warning-error-region,
  loading-layer,
  resizing-info,
  toc-refresh {
    display: none !important;
  }
  .no-print-outline {
    outline: none !important;
  }
  .selected {
    background: unset !important;
  }
  .math-container-symbol.selected {
    background: unset !important;
  }
  .matrix-symbol.align-symbol {
    background: unset !important;
  }
  .matrix-symbol.gather-symbol {
    background: unset !important;
  }
  tr.selected,
  td.selected {
    border: unset !important;
  }
  tr.selected.hline {
    border-top: 1px solid black !important;
  }
  tr.selected.last-hline {
    border-bottom: 1px solid black !important;
  }
  td.selected.vline {
    border-left: 1px solid black !important;
  }
  td.selected.last-vline {
    border-right: 1px solid black !important;
  }
  .selected {
    outline: unset !important;
  }
  container-layer {
    margin: 0 !important;
    padding: 0 !important;
    background: transparent !important;
    height: initial !important;
    overflow: visible !important;
  }
  editor-container {
    border: none !important;
    margin: 0 !important;
    padding: 0 !important;
    background: transparent !important;
    width: 100% !important;
  }
  content-area {
    padding: 0px !important;
    margin: 0;
    background: transparent !important;
  }
  vcomposed-symbol.non-safari > start {
    margin-bottom: -0.05em !important;
  }
  vcomposed-symbol.non-safari > middle-center {
    margin-top: -0.05em;
    margin-bottom: -0.05em !important;
  }
  vcomposed-symbol.non-safari > middle {
    margin-top: -0.05em;
    margin-bottom: -0.05em !important;
  }
  vcomposed-symbol.non-safari > end {
    margin-top: -0.05em !important;
  }
}
.math-type-for-print {
  outline: none !important;
}
.math-type-for-print .npm__react-simple-code-editor__textarea {
  display: none !important;
}
.math-type-for-print math-diagram {
  border: none !important;
}
.math-type-for-print .no-border-on-print {
  border: none !important;
}
.math-type-for-print .setting-select {
  display: none !important;
}
.math-type-for-print .no-print,
.math-type-for-print ref-tag.empty-line-tag,
.math-type-for-print .text-cursor,
.math-type-for-print .sub-text-cursor,
.math-type-for-print selection-wrapper,
.math-type-for-print message-box-container,
.math-type-for-print connection-controls,
.math-type-for-print .control-point-guide,
.math-type-for-print tool-bar,
.math-type-for-print items-bar,
.math-type-for-print document-sidebar,
.math-type-for-print resize-bar,
.math-type-for-print diagram-expander,
.math-type-for-print warning-error-region,
.math-type-for-print loading-layer,
.math-type-for-print resizing-info,
.math-type-for-print toc-refresh {
  display: none !important;
}
.math-type-for-print .no-print-outline {
  outline: none !important;
}
.math-type-for-print .selected {
  background: unset !important;
}
.math-type-for-print .math-container-symbol.selected {
  background: unset !important;
}
.math-type-for-print .matrix-symbol.align-symbol {
  background: unset !important;
}
.math-type-for-print .matrix-symbol.gather-symbol {
  background: unset !important;
}
.math-type-for-print tr.selected,
.math-type-for-print td.selected {
  border: unset !important;
}
.math-type-for-print tr.selected.hline {
  border-top: 1px solid black !important;
}
.math-type-for-print tr.selected.last-hline {
  border-bottom: 1px solid black !important;
}
.math-type-for-print td.selected.vline {
  border-left: 1px solid black !important;
}
.math-type-for-print td.selected.last-vline {
  border-right: 1px solid black !important;
}
.math-type-for-print .selected {
  outline: unset !important;
}
.math-type-for-print container-layer {
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  height: initial !important;
  overflow: visible !important;
}
.math-type-for-print editor-container {
  border: none !important;
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  width: 100% !important;
}
.math-type-for-print content-area {
  padding: 0px !important;
  margin: 0;
  background: transparent !important;
}
.math-type-for-print vcomposed-symbol.non-safari > start {
  margin-bottom: -0.05em !important;
}
.math-type-for-print vcomposed-symbol.non-safari > middle-center {
  margin-top: -0.05em;
  margin-bottom: -0.05em !important;
}
.math-type-for-print vcomposed-symbol.non-safari > middle {
  margin-top: -0.05em;
  margin-bottom: -0.05em !important;
}
.math-type-for-print vcomposed-symbol.non-safari > end {
  margin-top: -0.05em !important;
}
.justify-single-line {
  display: inline-block;
  text-align-last: justify;
  width: 100%;
}
.rtl-on-line-level {
  direction: rtl;
}

math-type modal-dialog.import-latex math-type editarea.root-editor {
  min-height: 100px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .mobile-keys-support-region {
  position: fixed;
  top: 84px;
  left: 45px;
  color: gray;
  z-index: 11609;
  opacity: 0.9;
  display: flex;
  width: auto;
  z-index: 600;
  cursor: pointer;
}
math-type .mobile-keys-support-region.is-android {
  top: unset;
  bottom: 4px;
  left: 17px;
}
math-type .mobile-keys-support-region.select-only {
  top: 40px;
  left: 25px;
}
math-type .mobile-keys-support-region.select-only .btn-suggestion-box-mobile {
  display: none;
}



.special-symbol-dialog__special-char {
  display: inline-block;
  width: 24px;
  height: 24px;
  line-height: 24px;
  border-bottom: 1px solid #ddd;
  border-right: 1px solid #ddd;
  text-align: center;
  cursor: pointer;
  outline: none;
}
.special-symbol-dialog__special-char:hover {
  background: #bfe4bd;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
context-menu-container {
  position: fixed;
  left: 100px;
  top: 300px;
  z-index: 13;
  box-shadow: 2px 2px 3px 0px #c3c3c3;
  border: 1px solid lightgray;
  width: 200px;
  background: white;
  cursor: default;
  outline: none;
  font-family: "Segoe UI", Arial, Verdana, sans-serif;
}
context-menu-container ct-item {
  display: block;
  padding: 6px 9px;
  font-size: 13px;
  color: gray;
}
context-menu-container ct-item.disabled {
  color: lightgray;
}
context-menu-container ct-item:hover {
  background: #eae9e9;
}
context-menu-container ct-item.hidden {
  display: none;
}
context-menu-container ct-icon {
  width: 20px;
  display: inline-block;
}
context-menu-container ct-separator {
  width: 100%;
  display: block;
  height: 1px;
  margin-top: 2px;
  margin-bottom: 2px;
  border-top: 1px solid lightgray;
}

/* Collection default theme */
/* Grid default theme */
/* Table default theme */









/* List default theme */



math-type .symbol-container,
.auto-complete-external-area .symbol-container {
  display: flex;
  flex-direction: row;
  min-height: 25px;
  padding-left: 4px;
  padding-right: 12px;
  align-items: center;
  cursor: pointer;
}
math-type .symbol-container.selected,
.auto-complete-external-area .symbol-container.selected {
  background-color: #bfe4bd;
}
math-type .symbol-friendly-name,
.auto-complete-external-area .symbol-friendly-name {
  flex-grow: 1;
  font-family: Asana;
  /*padding-top: 6px;*/
}
math-type .symbol-icon,
.auto-complete-external-area .symbol-icon {
  /*padding-top: 6px;*/
  margin-right: 15px;
  min-width: 20px;
  text-align: center;
}
math-type .short-cut,
.auto-complete-external-area .short-cut {
  text-align: center;
  color: gray;
  /*vertical-align: middle;*/
  /*line-height: 20px;*/
  margin: 0 2px 0 2px;
  font-size: 12px;
  display: flex;
  align-items: center;
}
math-type .short-cut span,
.auto-complete-external-area .short-cut span {
  font-size: 10px;
}
math-type .hidden,
.auto-complete-external-area .hidden {
  display: none;
}







/**different context*/
/**different context*/
selection-wrapper {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
  user-select: none;
  pointer-events: none;
  z-index: 9;
}
selection-wrapper > selection {
  display: block;
  position: absolute;
  background-color: rgba(0, 126, 255, 0.15);
  user-select: none;
  width: 100px;
  height: 100px;
  transform-origin: 0 0;
}
selection-wrapper.inactive > selection {
  background-color: rgba(58, 57, 57, 0.13);
}

region-highlight-container {
  user-select: none;
  pointer-events: none;
  display: block;
  position: absolute;
  width: 0px;
  height: 0px;
  top: 0;
  left: 0;
  border: 1px solid lightgoldenrodyellow;
  opacity: 0.2;
}
region-highlight-container > rhc-all > rh-rect {
  display: block;
  position: absolute;
  background: orange;
}
region-highlight-container > rh-selected-rect {
  display: block;
  position: absolute;
  background: red;
}

.math-template-btb.btn-normal {
  background: transparent;
  margin-left: 0;
  font-size: 12px;
  border: none;
}
.math-template-btb.btn-normal:hover {
  background: white;
}
.math-template-name-item:hover {
  background: #f7f7f7;
}

.math-template-tree .tree-node-name {
  white-space: nowrap;
}
.math-template-tree .tree-node-name:hover {
  background: #f7f7f7;
}

math-type compositeblock.bib-bibliography {
  width: 100%;
  display: block;
}
math-type compositeblock.bib-cite {
  display: inline;
  white-space: break-spaces;
}
math-type compositeblock.bib-cite > editarea.text-mode {
  display: inline;
}
math-type compositeblock.bib-cite > editarea.text-mode > line.text-mode {
  display: inline;
}
math-type compositeblock.bib-cite > editarea.text-mode > line.text-mode > blocks {
  display: inline;
}
.csl-context {
  white-space: pre-wrap;
}
.csl-context.csl-cite div {
  display: inline;
}
.csl-context div.csl-left-margin {
  float: left;
}
.csl-context div.csl-block {
  font-weight: bold;
}
.csl-context div.csl-right-inline {
  margin-left: 2.5em;
}
.csl-context div.csl-indent {
  margin-top: 0.5em;
  margin-left: 2em;
  padding-bottom: 0.2em;
  padding-left: 0.5em;
  border-left: 5px solid #ccc;
}

.caption-ref-select .role-item:hover {
  background: #edf9ec;
}

.footnote-mt-container {
  position: relative;
}
.footnote-mt-container .more-option-box {
  position: absolute;
  left: -25px;
  top: 0;
  width: 30px;
  bottom: 0;
  display: none;
}
.footnote-mt-container .more-option-box > div {
  background: #f7f7f7;
  border: 1px solid #d6d3d3;
  padding: 0 0.2em;
  cursor: pointer;
  color: gray;
  display: inline-block;
}
.footnote-mt-container.hover-select:hover .more-option-box {
  display: block;
}
.mt-doc-fn > math-edit-container > editarea > area-container > line > first-line-prefix {
  padding-right: 0.3em;
}
.mt-doc-fn > math-edit-container > editarea > area-container > line.has-rtl {
  direction: rtl;
}
.mt-doc-fn > math-edit-container > editarea > area-container > line.has-rtl > first-line-prefix {
  padding-left: 0.3em;
}
.blocks-inline > math-edit-container > editarea > area-container > line > blocks {
  display: inline;
}

.lang-name:hover {
  background: #f7f7f7;
}
.lang-name.selected {
  background: #e1e8f5;
}
.custom-lange-area input::placeholder,
.custom-lange-area textarea::placeholder {
  color: lightgray;
}

.page-print-item {
  position: relative;
}
.page-print-item:hover .page-print-item-hover {
  display: block;
}
.page-print-item-hover {
  display: none;
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  margin-top: 10px;
  background: #f7f6f6;
  z-index: 10;
  padding: 5px;
  font-size: 0.8em;
  white-space: nowrap;
  color: gray;
  border: 1px solid lightgray;
}

.settings-show-hide {
  background: rgba(255, 255, 255, 0.61);
}
.settings-show-hide:hover {
  background: white;
}
.group-symbol-collapsed {
  display: block;
  border: 1px dotted lightgray;
  padding-top: 0.1em;
  padding-bottom: 0.1em;
}
.role-math-mode-group.math-mode-group-expanded .settings-show-hide,
.role-text-mode-group-inline.text-mode-group-inline-expanded .settings-show-hide {
  display: none;
}
.role-math-mode-group.math-mode-group-expanded:hover,
.role-text-mode-group-inline.text-mode-group-inline-expanded:hover {
  outline: 1px solid lightgray;
}
.role-math-mode-group.math-mode-group-expanded:hover .settings-show-hide,
.role-text-mode-group-inline.text-mode-group-inline-expanded:hover .settings-show-hide {
  display: flex;
}

math-type compositeblock.text-super-script-symbol,
math-type compositeblock.text-sub-script-symbol {
  display: inline;
}
math-type compositeblock.text-super-script-symbol > editarea.text-mode,
math-type compositeblock.text-sub-script-symbol > editarea.text-mode {
  display: inline;
}
math-type compositeblock.text-super-script-symbol > editarea.text-mode > line.text-mode,
math-type compositeblock.text-sub-script-symbol > editarea.text-mode > line.text-mode {
  display: inline;
}
math-type compositeblock.text-super-script-symbol > editarea.text-mode > line.text-mode > blocks,
math-type compositeblock.text-sub-script-symbol > editarea.text-mode > line.text-mode > blocks {
  display: inline;
}
math-type .text-super-script-symbol {
  vertical-align: super;
}
math-type .text-sub-script-symbol {
  vertical-align: sub;
}

compositeblock.section-ref {
  display: inline;
}
compositeblock.section-ref > .section-ref-border {
  display: inline;
  white-space: pre-wrap;
}
compositeblock.section-ref > div {
  display: inline;
}



icon-dropdown-items icon-dropdown-item:hover {
  background: #eae9e9;
}
icon-dropdown ii-icon {
  fill: gray;
}
icon-dropdown:hover {
  color: #4e4d4d;
}
icon-dropdown:hover ii-icon {
  fill: #4e4d4d;
}

resizable-container {
  display: block;
  position: relative;
  min-height: 0;
  flex-shrink: 0;
}





a.fce {
  cursor: pointer;
}
a.fce:hover svg {
  fill: #2d4373;
}
a.fce svg {
  fill: #3b5998;
}
a.fce i {
  text-align: center;
  color: white;
}
a.gg {
  cursor: pointer;
}
a.gg:hover svg {
  fill: #c23321;
}
a.gg svg {
  fill: #dd4b39;
}
a.gg i {
  text-align: center;
  color: white;
}
a.twr {
  cursor: pointer;
}
a.twr:hover svg {
  fill: #2795e9;
}
a.twr svg {
  fill: #55acee;
}
a.twr i {
  text-align: center;
  color: white;
}
a.gh {
  cursor: pointer;
}
a.gh:hover svg {
  fill: #2b2b2b;
}
a.gh svg {
  fill: #444;
}
a.gh i {
  text-align: center;
  color: white;
}





modal-dialog.swift.document-name modal-container.mt-common-dialog {
  width: 500px;
  max-width: 95vw;
}
modal-dialog.swift.document-name document-name {
  width: 100%;
  display: flex;
  flex-direction: column;
}
modal-dialog.swift.document-name document-name label {
  display: block;
  font-size: 13px;
}
modal-dialog.swift.document-name document-name textarea {
  width: auto;
  display: block;
  margin: 5px 0px;
  height: 39px;
  outline: none;
  border: 1px solid lightgray;
  resize: vertical;
}

.dock-tab-content {
  flex: 1;
  min-height: 0;
  min-width: 0;
  display: none;
}
.dock-tab-content.active {
  display: flex;
}

quick-start editarea.root-editor {
  min-height: 100px;
}
quick-start > qs-math-type-container > math-type:hover {
  border: 1px solid gray;
}
quick-start > qs-math-type-container > math-type tool-bar {
  display: none;
}
quick-start > qs-math-type-container > math-type items-bar {
  display: none;
  left: -60px;
  top: 0px;
  box-shadow: 0px 1px 2px 0px #4c4949;
}





/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**Context Level 1*/
/**both Level 1 and 2 Context */
/**Context Level 2 inside docsContainerZIndex*/
document-info-container document-info-bar {
  display: block;
  position: absolute;
  right: 15px;
  bottom: 5px;
  background: #f7f7f7;
  box-shadow: 1px 1px 1px 0px #e0dddd;
  border: 1px lightgray solid;
  font-size: 12px;
  padding: 0px;
  color: gray;
  opacity: 0.8;
  z-index: 4;
}
document-info-container document-info-bar:hover {
  opacity: 1;
}
document-info-container modal-container button.ok.btn-primary {
  display: none;
}
.Popover-body {
  font-size: 12px;
  padding: 10px;
  background: #4CAF50;
  box-shadow: #888686 1px 1px 1px 1px;
  color: white;
  max-width: 250px;
}
.Popover-tip {
  fill: #4CAF50;
}

/**Context Level 1*/
/**both Level 1 and 2 Context */
/**Context Level 2 inside docsContainerZIndex*/
.doc-toolbar-container {
  position: relative;
  background: #f7f7f7;
  top: 0;
  left: 0;
  width: 100%;
  border: 1px lightgray solid;
  margin-left: -2px;
  z-index: 6;
}
.doc-toolbar-container > tool-bar {
  position: relative;
  top: 0;
  left: 0;
  display: block;
  padding-left: 0px;
  min-width: 770px;
  width: 770px;
  margin: auto;
  background: transparent;
  box-shadow: none;
  border: none;
  height: 35px;
}











/**Context Level 1*/
/**both Level 1 and 2 Context */
/**Context Level 2 inside docsContainerZIndex*/


</style><style>/* @font-face {
  font-family: 'FontAwesome';
  src: format('woff'), url('fonts/icomoon.svg?erlpdm#icomoon') format('svg');
  font-weight: normal;
  font-style: normal;
} */

[class^="fa-"], [class*=" fa-"] {
  /* use !important to prevent issues with browser extensions that change fonts */
  /* font-family: 'FontAwesome' !important;
  speak: none;
  font-style: normal;
  font-weight: normal;
  font-variant: normal;
  text-transform: none; */
  /* line-height: 1; */
  /* Better Font Rendering =========== */
  /* -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale; */
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.fa-plus:before {
  content: "\f067";
}
.fa-user:before {
  content: "\f007";
}
.fa-check:before {
  content: "\f00c";
}
.fa-close:before {
  content: "\f00d";
}
.fa-remove:before {
  content: "\f00d";
}
.fa-times:before {
  content: "\f00d";
}
.fa-search-plus:before {
  content: "\f00e";
}
.fa-search-minus:before {
  content: "\f010";
}
.fa-cog:before {
  content: "\f013";
}
.fa-gear:before {
  content: "\f013";
}
.fa-trash-o:before {
  content: "\f014";
}
.fa-file-o:before {
  content: "\f016";
}
.fa-refresh:before {
  content: "\f021";
}
.fa-font:before {
  content: "\f031";
}
.fa-bold:before {
  content: "\f032";
}
.fa-italic:before {
  content: "\f033";
}
.fa-align-left:before {
  content: "\f036";
}
.fa-align-center:before {
  content: "\f037";
}
.fa-align-right:before {
  content: "\f038";
}
.fa-dedent:before {
  content: "\f03b";
}
.fa-outdent:before {
  content: "\f03b";
}
.fa-indent:before {
  content: "\f03c";
}
.fa-image:before {
  content: "\f03e";
}
.fa-photo:before {
  content: "\f03e";
}
.fa-picture-o:before {
  content: "\f03e";
}
.fa-pencil:before {
  content: "\f040";
}
.fa-edit:before {
  content: "\f044";
}
.fa-pencil-square-o:before {
  content: "\f044";
}
.fa-share-square-o:before {
  content: "\f045";
}
.fa-arrows:before {
  content: "\f047";
}
.fa-chevron-left:before {
  content: "\f053";
}
.fa-chevron-right:before {
  content: "\f054";
}
.fa-times-circle:before {
  content: "\f057";
}
.fa-info-circle:before {
  content: "\f05a";
}
.fa-arrow-left:before {
  content: "\f060";
}
.fa-arrow-right:before {
  content: "\f061";
}
.fa-arrow-up:before {
  content: "\f062";
}
.fa-arrow-down:before {
  content: "\f063";
}
.fa-mail-forward:before {
  content: "\f064";
}
.fa-share:before {
  content: "\f064";
}
.fa-exclamation-circle:before {
  content: "\f06a";
}
.fa-exclamation-triangle:before {
  content: "\f071";
}
.fa-warning:before {
  content: "\f071";
}
.fa-chevron-up:before {
  content: "\f077";
}
.fa-chevron-down:before {
  content: "\f078";
}
.fa-folder:before {
  content: "\f07b";
}
.fa-folder-open:before {
  content: "\f07c";
}
.fa-twitter:before {
  content: "\f099";
}
.fa-twr:before {
  content: "\f099";
}
.fa-facebook:before {
  content: "\f09a";
}
.fa-fce:before {
  content: "\f09a";
}
.fa-facebook-f:before {
  content: "\f09a";
}
.fa-github:before {
  content: "\f09b";
}
.fa-gh:before {
  content: "\f09b";
}
.fa-cut:before {
  content: "\f0c4";
}
.fa-scissors:before {
  content: "\f0c4";
}
.fa-copy:before {
  content: "\f0c5";
}
.fa-files-o:before {
  content: "\f0c5";
}
.fa-bars:before {
  content: "\f0c9";
}
.fa-navicon:before {
  content: "\f0c9";
}
.fa-reorder:before {
  content: "\f0c9";
}
.fa-list-ul:before {
  content: "\f0ca";
}
.fa-list-ol:before {
  content: "\f0cb";
}
.fa-strikethrough:before {
  content: "\f0cc";
}
.fa-underline:before {
  content: "\f0cd";
}
.fa-table:before {
  content: "\f0ce";
}
.fa-magic:before {
  content: "\f0d0";
}
.fa-caret-down:before {
  content: "\f0d7";
}
.fa-caret-right:before {
  content: "\f0da";
}
.fa-sort-desc:before {
  content: "\f0dd";
}
.fa-sort-down:before {
  content: "\f0dd";
}
.fa-clipboard:before {
  content: "\f0ea";
}
.fa-paste:before {
  content: "\f0ea";
}
.fa-angle-double-left:before {
  content: "\f100";
}
.fa-angle-double-right:before {
  content: "\f101";
}
.fa-angle-double-up:before {
  content: "\f102";
}
.fa-angle-double-down:before {
  content: "\f103";
}
.fa-circle:before {
  content: "\f111";
}
.fa-mail-reply:before {
  content: "\f112";
}
.fa-reply:before {
  content: "\f112";
}
.fa-exclamation:before {
  content: "\f12a";
}
.fa-eraser:before {
  content: "\f12d";
}
.fa-ellipsis-h:before {
  content: "\f141";
}
.fa-ellipsis-v:before {
  content: "\f142";
}
.fa-file:before {
  content: "\f15b";
}
.fa-file-text:before {
  content: "\f15c";
}
.fa-google:before {
  content: "\f1a0";
}
.fa-gg:before {
  content: "\f1a0";
}
.fa-trash:before {
  content: "\f1f8";
}
.fa-i-cursor:before {
  content: "\f246";
}
.fa-hand-paper-o:before {
  content: "\f256";
}
.fa-hand-stop-o:before {
  content: "\f256";
}
</style><style>.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style>#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style>.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style>.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style>#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style>.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style>.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head><body style="overflow:auto;background:rgb(255, 255, 255);width:auto;height:auto;"><editor-container style="display:block;margin:auto;width:816px;"><math-type style="user-select:text;" class=" math-type-for-print "><math-edit-container><editarea class="root-editor" style="font-family: &quot;Computer Modern Sans&quot;, serif; font-size: 17px;"><area-baseline aria-hidden="true">a</area-baseline><area-container><line class="root text-mode selected align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 1.73em; font-weight: bold;">ML in Production</block></blocks></line><line class="root text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 1.73em; font-weight: bold;"> </block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 1.2em; font-weight: bold;">(Training Notes)</block></blocks></line><line class="root text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="anchor-tag inline" style="font-family: &quot;Computer Modern Serif&quot;, serif; font-weight: bold;"><div data-id="n0.6237036695443519" class="anchor-tag-border no-border-on-print" id="n0.6237036695443519"><span>Table of Content</span></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="table-of-content inline"><toc-wrapper><editarea class="edit-area toc-ea no-area-container text-mode"><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.8496160874342302" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.8496160874342302" style="display: inline-block; white-space: pre;">1. </span></compositeblock><block>What's MLOps?</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 590.648px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L590.6484375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.0381755258270049" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.0381755258270049" style="display: inline-block; white-space: pre;">2. </span></compositeblock><block>Data Management</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 574.211px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L574.2109375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.3251481849407132" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.3251481849407132" style="display: inline-block; white-space: pre;">2.1. </span></compositeblock><block>Delta Lake</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 582.773px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L582.7734375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.7215891277174367" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.7215891277174367" style="display: inline-block; white-space: pre;">2.1.1. </span></compositeblock><block>Versioning with Delta Tables</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 390.727px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L390.7265625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.6906605281064426" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.6906605281064426" style="display: inline-block; white-space: pre;">2.1.2. </span></compositeblock><block>Feature Store</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 499.344px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L499.34375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.6299362918481715" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.6299362918481715" style="display: inline-block; white-space: pre;">3. </span></compositeblock><block>Experiment Tracking (MLflow)</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 487.234px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L487.234375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.19193334075998858" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.19193334075998858" style="display: inline-block; white-space: pre;">3.1. </span></compositeblock><block>Tracking Experiments with MLflow</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 410.469px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L410.46875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.638064320597376" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.638064320597376" style="display: inline-block; white-space: pre;">3.1.1. </span></compositeblock><block>Parameters, Metrics, Artifacts, Signature, and Input Examples</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 153.031px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L153.03125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.43002470001253146" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.43002470001253146" style="display: inline-block; white-space: pre;">3.1.2. </span></compositeblock><block>Querying Past Runs</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 453.711px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L453.7109375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.8707844432012006" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.8707844432012006" style="display: inline-block; white-space: pre;">3.1.3. </span></compositeblock><block>Autologging</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 509.469px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L509.46875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.04983054387977792" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.04983054387977792" style="display: inline-block; white-space: pre;">4. </span></compositeblock><block>Model Management - Intro</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 513.742px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L513.7421875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.5631081581417163" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.5631081581417163" style="display: inline-block; white-space: pre;">4.1. </span></compositeblock><block>Custom Models Using </block><block>pyfunc</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 451.328px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L451.328125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.9717172073834675" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.9717172073834675" style="display: inline-block; white-space: pre;">4.1.1. </span></compositeblock><block>Implementation</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 484.906px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L484.90625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.2866218232609259" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.2866218232609259" style="display: inline-block; white-space: pre;">5. </span></compositeblock><block>Model Management - Model Registry</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 440.406px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L440.40625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.14698272352640784" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.14698272352640784" style="display: inline-block; white-space: pre;">5.1. </span></compositeblock><block>Registering a Model</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 517.188px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L517.1875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.16867376294427627" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.16867376294427627" style="display: inline-block; white-space: pre;">5.2. </span></compositeblock><block>Deploying a Model</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 525.758px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L525.7578125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.9773001458931918" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.9773001458931918" style="display: inline-block; white-space: pre;">5.2.1. </span></compositeblock><block>Transition a model to the Production stage</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 286.945px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L286.9453125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.3613103051557516" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.3613103051557516" style="display: inline-block; white-space: pre;">5.2.2. </span></compositeblock><block>Deploying a New Model Version</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 366.93px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L366.9296875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.2578612698125524" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.2578612698125524" style="display: inline-block; white-space: pre;">6. </span></compositeblock><block>Model Management - Webhooks and Testing</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 385.953px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L385.953125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.9704514065486807" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.9704514065486807" style="display: inline-block; white-space: pre;">6.1. </span></compositeblock><block>Automated Testing</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 523.125px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L523.125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.019357381149047947" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.019357381149047947" style="display: inline-block; white-space: pre;">6.2. </span></compositeblock><block>Implementation</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 549.133px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L549.1328125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.7733419660531118" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.7733419660531118" style="display: inline-block; white-space: pre;">6.2.1. </span></compositeblock><block>Creating a Model</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 471.547px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L471.546875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.12603074872240883" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.12603074872240883" style="display: inline-block; white-space: pre;">6.2.2. </span></compositeblock><block>Creating a Job</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 490.484px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L490.484375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.2548292696319181" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.2548292696319181" style="display: inline-block; white-space: pre;">6.2.3. </span></compositeblock><block>Review the Job Code</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 444.617px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L444.6171875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.9324798662185614" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.9324798662185614" style="display: inline-block; white-space: pre;">6.2.4. </span></compositeblock><block>Create a Job Webhook</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 432.141px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L432.140625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.6466191374168306" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.6466191374168306" style="display: inline-block; white-space: pre;">7. </span></compositeblock><block>Deployment</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 622.102px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L622.1015625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.08949011200488655" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.08949011200488655" style="display: inline-block; white-space: pre;">7.1. </span></compositeblock><block>Deployment Patterns</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 509.727px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L509.7265625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.11997379479821202" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.11997379479821202" style="display: inline-block; white-space: pre;">7.2. </span></compositeblock><block>Deployment Paradigms</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 495.805px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L495.8046875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.863619984305142" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.863619984305142" style="display: inline-block; white-space: pre;">7.3. </span></compositeblock><block>Batch Deployment</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 527.234px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L527.234375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.8221328526190008" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.8221328526190008" style="display: inline-block; white-space: pre;">7.3.1. </span></compositeblock><block>Inference in Batch</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 465.508px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L465.5078125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.6815142886314369" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.6815142886314369" style="display: inline-block; white-space: pre;">7.3.2. </span></compositeblock><block>Inference in Spark</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 467.445px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L467.4453125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.16090080787783356" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.16090080787783356" style="display: inline-block; white-space: pre;">7.3.3. </span></compositeblock><block>Write Optimizers</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 474.031px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L474.03125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.6023371476204555" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.6023371476204555" style="display: inline-block; white-space: pre;">7.3.4. </span></compositeblock><block>Feature Store Batch Scoring</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 393.875px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L393.875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.281338563937128" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.281338563937128" style="display: inline-block; white-space: pre;">7.4. </span></compositeblock><block>Real-Time Deployment</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 496.125px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L496.125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.030406830091177284" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.030406830091177284" style="display: inline-block; white-space: pre;">7.4.1. </span></compositeblock><block>Real-Time Inference</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 452.914px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L452.9140625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.1951110625130037" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.1951110625130037" style="display: inline-block; white-space: pre;">7.4.2. </span></compositeblock><block>Method 1: Using </block><block>click</block><block> Library</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 384.344px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L384.34375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.15864167933976425" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.15864167933976425" style="display: inline-block; white-space: pre;">7.4.3. </span></compositeblock><block>Method 2: MLflow Model Serving</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 355.094px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L355.09375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.8140649805225104" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.8140649805225104" style="display: inline-block; white-space: pre;">7.4.4. </span></compositeblock><block>AWS SageMaker</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 476.68px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L476.6796875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.9844223303422417" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.9844223303422417" style="display: inline-block; white-space: pre;">7.4.5. </span></compositeblock><block>Online Feature Store Real-Time Model Serving</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 261.609px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L261.609375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.6558603215690391" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.6558603215690391" style="display: inline-block; white-space: pre;">8. </span></compositeblock><block>Production</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 628.336px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L628.3359375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.5167080365339114" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.5167080365339114" style="display: inline-block; white-space: pre;">8.1. </span></compositeblock><block>CI/CD</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 612.156px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L612.15625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.9861012482801415" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.9861012482801415" style="display: inline-block; white-space: pre;">8.2. </span></compositeblock><block>Monitoring</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 581.828px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L581.828125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.5961855230586066" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.5961855230586066" style="display: inline-block; white-space: pre;">8.2.1. </span></compositeblock><block>Drift Monitoring</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 478.461px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L478.4609375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.8475046366155559" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.8475046366155559" style="display: inline-block; white-space: pre;">8.2.2. </span></compositeblock><block>Drift Monitoring - Implementation - Kolmogorov-Smirnov Test</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 150.094px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L150.09375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.45587163358318117" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.45587163358318117" style="display: inline-block; white-space: pre;">8.2.3. </span></compositeblock><block>Drift Monitoring - Implementation - Jensen Shannon</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 220.133px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L220.1328125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.5615474093602371" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.5615474093602371" style="display: inline-block; white-space: pre;">8.2.4. </span></compositeblock><block>Drift Monitoring - Implementation - Apply Summary Stats</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 179.18px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L179.1796875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.9031778150948311" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.9031778150948311" style="display: inline-block; white-space: pre;">8.2.5. </span></compositeblock><block>Drift Monitoring - Implementation - Bonferroni Correction</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 181.148px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L181.1484375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.12143262869501559" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.12143262869501559" style="display: inline-block; white-space: pre;">8.2.6. </span></compositeblock><block>Drift Monitoring - Implementation - Categorical Features</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 190.008px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L190.0078125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.2068117739195432" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.2068117739195432" style="display: inline-block; white-space: pre;">8.2.7. </span></compositeblock><block>Drift Monitoring - Implementation - Combine into One Class</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 162.773px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L162.7734375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.3510942035189164" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.3510942035189164" style="display: inline-block; white-space: pre;">8.2.8. </span></compositeblock><block>Drift Monitoring Architecture</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 385.727px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L385.7265625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.3961261153696858" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.3961261153696858" style="display: inline-block; white-space: pre;">8.3. </span></compositeblock><block>Model Rollout Strategies</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 482.922px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L482.921875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line></editarea></toc-wrapper></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.8496160874342302" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.8496160874342302" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>What's MLOps?</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>MLOps is a set of processes and automation for managing code, data, and models to improve performance, stability and long-term efciency of ML systems.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 514px; height: 116.41px; position: relative;"><img src="image-resources/ff67bcee-4dd0-49e8-99e5-7fd1440ed06e.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 682px; height: 468.21px; position: relative;"><img src="image-resources/19eb7e86-ce7b-413b-8f26-cd9d17ca6a20.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; font-style: italic;">Hardest Part of ML isn't ML, it's Data</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 732.75px; height: 262.31px; position: relative;"><img src="image-resources/1d69212b-1859-4dee-bd8f-d745e13725a7.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Guiding principles</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Always keep your business goals in mind</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Take a data-centric approach to machine learning</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Implement MLOps in a modular fashion</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Process should guide automation.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Benefits of MLOps</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">It helps reducing risk</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Technical risk  poorly performing models, fragile infrastructure</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Compliance risk  violating regulatory or corporate policies</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">It improves long-term efficiency through automation</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Catch errors before they hit production</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Avoid slow, manual processes</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 720.75px; height: 238.69px; position: relative;"><img src="image-resources/dfd42e0c-1611-4e59-83ce-49c79e468653.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Data is never static: model centric  data centric</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 735px; height: 324.76px; position: relative;"><img src="image-resources/8205f7a6-5677-4d18-b73e-51c2b32c372a.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.0381755258270049" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.0381755258270049" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Data Management</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Production machine learning solutions start with reproducible data management. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Strategies that we'll cover in this training include </block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/delta/versioning.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/delta/versioning.html" target="_blank" style="color: inherit; text-decoration: inherit;">Delta Table Versioning</a></block><block> and the Databricks </block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/applications/machine-learning/feature-store.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/applications/machine-learning/feature-store.html" target="_blank" style="color: inherit; text-decoration: inherit;">Feature Store</a></block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Managing the machine learning lifecycle means...</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Reproducibility of data</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Reproducibility of code</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Reproducibility of models</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Automated integration with production systems</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We'll begin with </block><block style="font-weight: bold;">data management</block><block>, which can be accomplished in a number of ways including:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Saving a snapshot of your data</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Table versioning and time travel using Delta</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Using a feature table</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.3251481849407132" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.3251481849407132" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">2.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Delta Lake</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 710.5px; height: 323.01px; position: relative;"><img src="image-resources/40372bb6-730e-4e15-a03b-24b5c8bb5111.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Delta Lake key features:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>ACID transactions  reliability </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Time travel (data versioning)  reliability, error recovery, synchronization </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Schema enforcement and evolution  reliability </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Audit history  data governance and compliance </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Parquet format + transaction log </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Compatible with Apache Spark API</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Delta Lake Optimize</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Compaction</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Data skipping</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/en/delta/data-skipping.html#delta-zorder" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/en/delta/data-skipping.html#delta-zorder" target="_blank" style="color: inherit; text-decoration: inherit;">Z-ordering</a></block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/en/delta/optimize.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/en/delta/optimize.html" target="_blank" style="color: inherit; text-decoration: inherit;">FAQs on Optimize</a></block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.7215891277174367" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.7215891277174367" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">2.1.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Versioning with Delta Tables</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Sample code to read and write data to a delta table:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">(</block><block class=" token">airbnb_df</block><block class="punctuation token">.</block><block class=" token">write</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">          </block><block class="punctuation token">.</block><block class="builtin token">format</block><block class="punctuation token">(</block><block class="string token">"delta"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">          </block><block class="punctuation token">.</block><block class=" token">mode</block><block class="punctuation token">(</block><block class="string token">"overwrite"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">          </block><block class="punctuation token">.</block><block class=" token">save</block><block class="punctuation token">(</block><block class=" token">DA</block><block class="punctuation token">.</block><block class=" token">paths</block><block class="punctuation token">.</block><block class=" token">airbnb</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">delta_df </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">spark</block><block class="punctuation token">.</block><block class=" token">read</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 </block><block class="punctuation token">.</block><block class="builtin token">format</block><block class="punctuation token">(</block><block class="string token">"delta"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 </block><block class="punctuation token">.</block><block class=" token">load</block><block class="punctuation token">(</block><block class=" token">DA</block><block class="punctuation token">.</block><block class=" token">paths</block><block class="punctuation token">.</block><block class=" token">airbnb</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 </block><block class="punctuation token">.</block><block class=" token">drop</block><block class="punctuation token">(</block><block class="string token">"cancellation_policy"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"instant_bookable"</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>To get the history of a delta table:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="operator token">%</block><block class=" token">sql</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">DESCRIBE HISTORY delta</block><block class="punctuation token">.</block><block class=" token">`$</block><block class="punctuation token">{</block><block class=" token">DA</block><block class="punctuation token">.</block><block class=" token">paths</block><block class="punctuation token">.</block><block class=" token">airbnb</block><block class="punctuation token">}</block><block class=" token">`</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">delta_df </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">spark</block><block class="punctuation token">.</block><block class=" token">read</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 </block><block class="punctuation token">.</block><block class="builtin token">format</block><block class="punctuation token">(</block><block class="string token">"delta"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 </block><block class="punctuation token">.</block><block class=" token">option</block><block class="punctuation token">(</block><block class="string token">"versionAsOf"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 </block><block class="punctuation token">.</block><block class=" token">load</block><block class="punctuation token">(</block><block class=" token">DA</block><block class="punctuation token">.</block><block class=" token">paths</block><block class="punctuation token">.</block><block class=" token">airbnb</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>You can also query based upon timestamp.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Note:</block><block> Note that the ability to query an older snapshot of a table (time travel) is lost after running a </block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/en/delta/vacuum.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/en/delta/vacuum.html" target="_blank" style="color: inherit; text-decoration: inherit;">VACUUM command</a></block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">timestamp </block><block class="operator token">=</block><block class=" token"> spark</block><block class="punctuation token">.</block><block class=" token">sql</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"DESCRIBE HISTORY delta.`</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">paths</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">airbnb</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">`"</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">orderBy</block><block class="punctuation token">(</block><block class="string token">"version"</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">first</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">timestamp</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">display</block><block class="punctuation token">(</block><block class=" token">spark</block><block class="punctuation token">.</block><block class=" token">read</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">             </block><block class="punctuation token">.</block><block class="builtin token">format</block><block class="punctuation token">(</block><block class="string token">"delta"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">             </block><block class="punctuation token">.</block><block class=" token">option</block><block class="punctuation token">(</block><block class="string token">"timestampAsOf"</block><block class="punctuation token">,</block><block class=" token"> timestamp</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">             </block><block class="punctuation token">.</block><block class=" token">load</block><block class="punctuation token">(</block><block class=" token">DA</block><block class="punctuation token">.</block><block class=" token">paths</block><block class="punctuation token">.</block><block class=" token">airbnb</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Example syntax for vacuum</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">VACUUM eventsTable   -- vacuum files not required by versions older than the default retention period</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">VACUUM </block><block class="string token">'/data/events'</block><block class=" token"> -- vacuum files </block><block class="keyword token">in</block><block class=" token"> path-based table</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">VACUUM delta.</block><block class="variable variable token">`</block><block class="variable token">/data/events/</block><block class="variable variable token">`</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">VACUUM delta.</block><block class="variable variable token">`</block><block class="variable token">/data/events/</block><block class="variable variable token">`</block><block class=" token"> RETAIN </block><block class="number token">100</block><block class=" token"> HOURS  -- vacuum files not required by versions </block><block class="function token">more</block><block class=" token"> than </block><block class="number token">100</block><block class=" token"> hours old</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">VACUUM eventsTable DRY RUN    -- </block><block class="keyword token">do</block><block class=" token"> dry run to get the list of files to be deleted</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.6906605281064426" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.6906605281064426" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">2.1.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Feature Store</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Production ML  Production Software + Data</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>A </block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/en/machine-learning/feature-store/index.html#databricks-feature-store" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/en/machine-learning/feature-store/index.html#databricks-feature-store" target="_blank" style="color: inherit; text-decoration: inherit;">feature store</a></block><block> is a </block><block style="font-weight: bold;">centralized repository of features</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>It enables </block><block style="font-weight: bold;">feature sharing and discovery across your organization</block><block> and also ensures that the </block><block style="font-weight: bold;">same feature computation code is used for model training and inference</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">What challenges does the Feature Store help solve?</block><block> A key issue many ML pipelines struggle with is </block><block style="font-weight: bold; color: rgb(255, 64, 0);">feature reproducibility</block><block> and </block><block style="font-weight: bold; color: rgb(255, 64, 0);">data sharing</block><block>. The Feature Store lets different users across the same organization utilize the same feature computation code.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>An </block><block class="role-hyper-link" data-hyper-link-url="https://www.databricks.com/blog/2021/04/26/reproduce-anything-machine-learning-meets-data-lakehouse.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.databricks.com/blog/2021/04/26/reproduce-anything-machine-learning-meets-data-lakehouse.html" target="_blank" style="color: inherit; text-decoration: inherit;">article</a></block><block> on the importance of data reproducibility.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 670px; height: 229.83px; position: relative;"><img src="image-resources/21ebd003-a7fd-447a-9c20-18ac8111bfc6.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Data Challenges in ML: </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Data silos</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Online/offline skew</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Client configuration</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Data freshness</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 676px; height: 372.09px; position: relative;"><img src="image-resources/cb0e1433-9252-4428-8abf-1fcd5ee2ab2e.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 674.5px; height: 416.11px; position: relative;"><img src="image-resources/6d34b89b-fd83-4b05-8365-4b26abd5a5ef.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Creating a </block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/applications/machine-learning/feature-store.html#create-a-feature-table-in-databricks-feature-store" style="text-decoration: underline; font-weight: bold; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/applications/machine-learning/feature-store.html#create-a-feature-table-in-databricks-feature-store" target="_blank" style="color: inherit; text-decoration: inherit;">Feature Store Client</a></block><block> so we can populate our feature store.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> databricks </block><block class="keyword token">import</block><block class=" token"> feature_store</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">fs </block><block class="operator token">=</block><block class=" token"> feature_store</block><block class="punctuation token">.</block><block class=" token">FeatureStoreClient</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="builtin token">help</block><block class="punctuation token">(</block><block class=" token">fs</block><block class="punctuation token">.</block><block class=" token">create_table</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Create Feature Table</block><block>  Next, we can create the Feature Table using the create_table method. This method takes a few parameters as inputs:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">name</block><block>  A feature table name of the form </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">&lt;database_name&gt;.&lt;table_name&gt;</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">primary_keys</block><block>  The primary key(s). If multiple columns are required, specify a list of column names.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">df</block><block>  Data to insert into this feature table.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">schema</block><block>  Feature table schema. </block><block style="text-decoration: underline;">Note</block><block> that either schema or df must be provided.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">description</block><block>  Description of the feature table</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">partition_columns</block><block>  Column(s) used to partition the feature table. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Note:</block><block> As a best practice, Databricks recommends you do NOT partition tables that contains less than a terabyte of data.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">* </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">table_name </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">schema_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">.airbnb"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Table: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">table_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">\n"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">fs</block><block class="punctuation token">.</block><block class=" token">create_table</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="operator token">=</block><block class=" token">table_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    primary_keys</block><block class="operator token">=</block><block class="punctuation token">[</block><block class="string token">"id"</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    df</block><block class="operator token">=</block><block class=" token">airbnb_df</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    partition_columns</block><block class="operator token">=</block><block class="punctuation token">[</block><block class="string token">"neighbourhood"</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> </block><block class="comment token"># for such a small dataset we shouldn't partition, this is just for demonstration</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    description</block><block class="operator token">=</block><block class="string token">"Original Airbnb data"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Alternatively,</block><block> you can </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">create_table</block><block> with schema only (without </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">df</block><block>), and populate data to the feature table with </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">fs.write_table</block><block>, </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">fs.write_table</block><block> has both </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">overwrite</block><block> and </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">merge</block><block> mode.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">fs</block><block class="punctuation token">.</block><block class=" token">create_table</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="operator token">=</block><block class=" token">table_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    primary_keys</block><block class="operator token">=</block><block class="punctuation token">[</block><block class="string token">"index"</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    schema</block><block class="operator token">=</block><block class=" token">airbnb_df</block><block class="punctuation token">.</block><block class=" token">schema</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    description</block><block class="operator token">=</block><block class="string token">"Original Airbnb data"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">fs</block><block class="punctuation token">.</block><block class=" token">write_table</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="operator token">=</block><block class=" token">table_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    df</block><block class="operator token">=</block><block class=" token">airbnb_df</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mode</block><block class="operator token">=</block><block class="string token">"overwrite"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The UI for feature store is available through:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 300px; height: 1123.5px; position: relative;"><img src="image-resources/5740ecfe-515f-4b49-9a65-0cefdbf46cbd.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 736px; height: 406.48px; position: relative;"><img src="image-resources/18eb741d-2acc-4b7b-8f3a-8029842fa0f9.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block> We can also look at the metadata of the feature store via the FeatureStore client by using </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">get_table()</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Feature table description : </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">fs</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">get_table</block><block class="string-interpolation interpolation punctuation token">(</block><block class="string-interpolation interpolation token">table_name</block><block class="string-interpolation interpolation punctuation token">)</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">description</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Feature table data source : </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">fs</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">get_table</block><block class="string-interpolation interpolation punctuation token">(</block><block class="string-interpolation interpolation token">table_name</block><block class="string-interpolation interpolation punctuation token">)</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">path_data_sources</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Overwrite Feature</block><block>  We set the mode to </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">overwrite</block><block> to remove the deleted feature columns from the latest table. Let's say, we added a column and removed another one.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>By navigating back to the UI, we should see that the modified date has changed and a new column has been added to the feature list.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>The deleted columns are still present in the schema of the table and their values have been replaced by </block><block style="font-weight: bold;">null</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">fs</block><block class="punctuation token">.</block><block class=" token">write_table</block><block class="punctuation token">(</block><block class=" token">name</block><block class="operator token">=</block><block class=" token">table_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">               df</block><block class="operator token">=</block><block class=" token">airbnb_df_short_reviews</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">               mode</block><block class="operator token">=</block><block class="string token">"overwrite"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Display most recent table</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">feature_df </block><block class="operator token">=</block><block class=" token"> fs</block><block class="punctuation token">.</block><block class=" token">read_table</block><block class="punctuation token">(</block><block class=" token">name</block><block class="operator token">=</block><block class=" token">table_name</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">display</block><block class="punctuation token">(</block><block class=" token">feature_df</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> Why do we care about Data Management? </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> Data Management is an oftentimes overlooked aspect of end-to-end reproducibility.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> How do we version data with Delta Tables? </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> Delta Tables are automatically versioned everytime a new data is written. Accessing a previous version of the table is as simple as using </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">display(spark.sql(f"DESCRIBE HISTORY delta.{delta_path}"))</block><block> to find the version to revert to and loading it in. You can also revert to previous version using timestamps.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> What challenges does the Feature Store help solve? </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> A key issue many ML pipelines struggle with is feature reproducibility and data sharing. The Feature Store lets different users across the same organization utilize the same feature computation code.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.6299362918481715" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.6299362918481715" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Experiment Tracking (MLflow)</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Record runs, and keep track of models parameters, results, code, and data from each experiment and in one place.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Over the course of the machine learning life cycle...</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Data scientists test many different models</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Using various libraries</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Each with different hyperparameters</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Tracking these various results poses an organizational challenge, including...</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Storing experiments</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Results</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Models</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Supplementary artifacts</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Code</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Data snapshots</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 724px; height: 397.43px; position: relative;"><img src="image-resources/ed8a3ad4-69f5-4842-8d84-b08c95d2911d.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.19193334075998858" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.19193334075998858" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">3.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Tracking Experiments with MLflow</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">MLflow Tracking is...</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>a logging API specific for machine learning</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>agnostic to libraries and environments that do the training</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>organized around the concept of runs, which are executions of data science code</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>runs are aggregated into experiments where many runs can be a part of a given experiment</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>An MLflow server can host many experiments.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Each run can record the following information:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Parameters</block><block>  Key-value pairs of input parameters such as the number of trees in a random forest model</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Metrics</block><block>  Evaluation metrics such as RMSE or Area Under the ROC Curve</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Artifacts</block><block>  Arbitrary output files in any format. This can include images, pickled models, and data files</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Source</block><block>  The code that originally ran the experiment</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://www.mlflow.org/docs/latest/index.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.mlflow.org/docs/latest/index.html" target="_blank" style="color: inherit; text-decoration: inherit;">MLflow docs</a></block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Experiments can be tracked using libraries in Python, R, and Java as well as by using the CLI and REST calls.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The experiment UI can be accessed from the sidebar.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 300px; height: 830.41px; position: relative;"><img src="image-resources/26bef6d8-9d36-4bad-95ea-739d7130cc8a.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Note:</block><block> Every Python notebook in a Databricks Workspace has its own experiment. When you use MLflow in a notebook, it records runs in the notebook experiment. A notebook experiment shares the same name and ID as its corresponding notebook.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Log a basic experiment by doing the following:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Start an experiment using </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">mlflow.start_run()</block><block> and passing it a name for the run</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Train your model</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Log the model using </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">mlflow.sklearn.log_model()</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Log the model error using </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">mlflow.log_metric()</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">5. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Print out the run id using </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">run.info.run_id</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">5. </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">ensemble </block><block class="keyword token">import</block><block class=" token"> RandomForestRegressor</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">metrics </block><block class="keyword token">import</block><block class=" token"> mean_squared_error</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">with</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">start_run</block><block class="punctuation token">(</block><block class=" token">run_name</block><block class="operator token">=</block><block class="string token">"Basic RF Run"</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">as</block><block class=" token"> run</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Create model, train it, and create predictions</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    rf </block><block class="operator token">=</block><block class=" token"> RandomForestRegressor</block><block class="punctuation token">(</block><block class=" token">random_state</block><block class="operator token">=</block><block class="number token">42</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    rf</block><block class="punctuation token">.</block><block class=" token">fit</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    predictions </block><block class="operator token">=</block><block class=" token"> rf</block><block class="punctuation token">.</block><block class=" token">predict</block><block class="punctuation token">(</block><block class=" token">X_test</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Log model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block><block class="punctuation token">.</block><block class=" token">log_model</block><block class="punctuation token">(</block><block class=" token">rf</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"random_forest_model"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Log metrics</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mse </block><block class="operator token">=</block><block class=" token"> mean_squared_error</block><block class="punctuation token">(</block><block class=" token">y_test</block><block class="punctuation token">,</block><block class=" token"> predictions</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">log_metric</block><block class="punctuation token">(</block><block class="string token">"mse"</block><block class="punctuation token">,</block><block class=" token"> mse</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    run_id </block><block class="operator token">=</block><block class=" token"> run</block><block class="punctuation token">.</block><block class=" token">info</block><block class="punctuation token">.</block><block class=" token">run_id</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    experiment_id </block><block class="operator token">=</block><block class=" token"> run</block><block class="punctuation token">.</block><block class=" token">info</block><block class="punctuation token">.</block><block class=" token">experiment_id</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Inside MLflow Run with run_id `</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">run_id</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">` and experiment_id `</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">experiment_id</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">`"</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.638064320597376" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.638064320597376" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">3.1.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Parameters, Metrics, Artifacts, Signature, and Input Examples</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In the last example, we logged the run name, an evaluation metric, and your model itself as an artifact. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Now let's log parameters, multiple metrics, and other artifacts including the feature importances.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Note:</block><block> It is a </block><block style="text-decoration: underline;">best practice</block><block> to also log a </block><block style="font-weight: bold;">model signature</block><block> and </block><block style="font-weight: bold;">input example</block><block>. This allows for better schema checks and, therefore, integration with automated deployment tools.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Signature</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>A model signature is just the schema of the input(s) and the output(s) of the model</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We usually get this with the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">infer_schema</block><block> function</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Input Example</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This is simply a few example inputs to the model</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This will be converted to JSON and stored in our MLflow run</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>It integrates well with MLflow model serving</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In general, logging a model with these looks like </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">.log_model(model, model_name, signature=signature, input_example=input_example)</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Where do logged artifacts get saved?</block><block> Logged artifacts are saved in a directory of your choosing. On Databricks, this would be DBFS (Databricks File System).</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>First, create a function to perform this.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: underline;">To log artifacts, we have to save them somewhere before MLflow can log them</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The code below accomplishes that by using a temporary file that it then deletes.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> matplotlib</block><block class="punctuation token">.</block><block class=" token">pyplot </block><block class="keyword token">as</block><block class=" token"> plt</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">metrics </block><block class="keyword token">import</block><block class=" token"> mean_squared_error</block><block class="punctuation token">,</block><block class=" token"> mean_absolute_error</block><block class="punctuation token">,</block><block class=" token"> r2_score</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">models</block><block class="punctuation token">.</block><block class=" token">signature </block><block class="keyword token">import</block><block class=" token"> infer_signature</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">log_rf</block><block class="punctuation token">(</block><block class=" token">experiment_id</block><block class="punctuation token">,</block><block class=" token"> run_name</block><block class="punctuation token">,</block><block class=" token"> params</block><block class="punctuation token">,</block><block class=" token"> X_train</block><block class="punctuation token">,</block><block class=" token"> X_test</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">,</block><block class=" token"> y_test</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">with</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">start_run</block><block class="punctuation token">(</block><block class=" token">experiment_id</block><block class="operator token">=</block><block class=" token">experiment_id</block><block class="punctuation token">,</block><block class=" token"> run_name</block><block class="operator token">=</block><block class=" token">run_name</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">as</block><block class=" token"> run</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="comment token"># Create model, train it, and create predictions</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        rf </block><block class="operator token">=</block><block class=" token"> RandomForestRegressor</block><block class="punctuation token">(</block><block class="operator token">**</block><block class=" token">params</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        rf</block><block class="punctuation token">.</block><block class=" token">fit</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        predictions </block><block class="operator token">=</block><block class=" token"> rf</block><block class="punctuation token">.</block><block class=" token">predict</block><block class="punctuation token">(</block><block class=" token">X_test</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="comment token"># Log the model with signature and input example</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        signature </block><block class="operator token">=</block><block class=" token"> infer_signature</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">DataFrame</block><block class="punctuation token">(</block><block class=" token">y_train</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        input_example </block><block class="operator token">=</block><block class=" token"> X_train</block><block class="punctuation token">.</block><block class=" token">head</block><block class="punctuation token">(</block><block class="number token">3</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="comment token"># Log model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block><block class="punctuation token">.</block><block class=" token">log_model</block><block class="punctuation token">(</block><block class=" token">rf</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"random_forest_model"</block><block class="punctuation token">,</block><block class=" token"> signature</block><block class="operator token">=</block><block class=" token">signature</block><block class="punctuation token">,</block><block class=" token"> input_example</block><block class="operator token">=</block><block class=" token">input_example</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="comment token"># Log params</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        mlflow</block><block class="punctuation token">.</block><block class=" token">log_params</block><block class="punctuation token">(</block><block class=" token">params</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="comment token"># Log metrics</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        mlflow</block><block class="punctuation token">.</block><block class=" token">log_metrics</block><block class="punctuation token">(</block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"mse"</block><block class="punctuation token">:</block><block class=" token"> mean_squared_error</block><block class="punctuation token">(</block><block class=" token">y_test</block><block class="punctuation token">,</block><block class=" token"> predictions</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"mae"</block><block class="punctuation token">:</block><block class=" token"> mean_absolute_error</block><block class="punctuation token">(</block><block class=" token">y_test</block><block class="punctuation token">,</block><block class=" token"> predictions</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"r2"</block><block class="punctuation token">:</block><block class=" token"> r2_score</block><block class="punctuation token">(</block><block class=" token">y_test</block><block class="punctuation token">,</block><block class=" token"> predictions</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="comment token"># Log feature importance</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        importance </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">pd</block><block class="punctuation token">.</block><block class=" token">DataFrame</block><block class="punctuation token">(</block><block class="builtin token">list</block><block class="punctuation token">(</block><block class="builtin token">zip</block><block class="punctuation token">(</block><block class=" token">df</block><block class="punctuation token">.</block><block class=" token">columns</block><block class="punctuation token">,</block><block class=" token"> rf</block><block class="punctuation token">.</block><block class=" token">feature_importances_</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> columns</block><block class="operator token">=</block><block class="punctuation token">[</block><block class="string token">"Feature"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"Importance"</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                      </block><block class="punctuation token">.</block><block class=" token">sort_values</block><block class="punctuation token">(</block><block class="string token">"Importance"</block><block class="punctuation token">,</block><block class=" token"> ascending</block><block class="operator token">=</block><block class="boolean token">False</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        importance_path </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">paths</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">working_path</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/importance.csv"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        importance</block><block class="punctuation token">.</block><block class=" token">to_csv</block><block class="punctuation token">(</block><block class=" token">importance_path</block><block class="punctuation token">,</block><block class=" token"> index</block><block class="operator token">=</block><block class="boolean token">False</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        mlflow</block><block class="punctuation token">.</block><block class=" token">log_artifact</block><block class="punctuation token">(</block><block class=" token">importance_path</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"feature-importance.csv"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="comment token"># Log plot</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        fig</block><block class="punctuation token">,</block><block class=" token"> ax </block><block class="operator token">=</block><block class=" token"> plt</block><block class="punctuation token">.</block><block class=" token">subplots</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        importance</block><block class="punctuation token">.</block><block class=" token">plot</block><block class="punctuation token">.</block><block class=" token">bar</block><block class="punctuation token">(</block><block class=" token">ax</block><block class="operator token">=</block><block class=" token">ax</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        plt</block><block class="punctuation token">.</block><block class=" token">title</block><block class="punctuation token">(</block><block class="string token">"Feature Importances"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        mlflow</block><block class="punctuation token">.</block><block class=" token">log_figure</block><block class="punctuation token">(</block><block class=" token">fig</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"feature_importances.png"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">return</block><block class=" token"> run</block><block class="punctuation token">.</block><block class=" token">info</block><block class="punctuation token">.</block><block class=" token">run_id</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Now, let's run this experiment</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">params </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"n_estimators"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">100</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"max_depth"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">5</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"random_state"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">42</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">log_rf</block><block class="punctuation token">(</block><block class=" token">experiment_id</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"Second Run"</block><block class="punctuation token">,</block><block class=" token"> params</block><block class="punctuation token">,</block><block class=" token"> X_train</block><block class="punctuation token">,</block><block class=" token"> X_test</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">,</block><block class=" token"> y_test</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.43002470001253146" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.43002470001253146" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">3.1.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Querying Past Runs</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>You can query past runs programatically in order to use this data back in Python. The pathway to doing this is an </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">MlflowClient</block><block> object.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Note:</block><block> You can also set tags for runs using </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">client.set_tag(run.info.run_id, "tag_key", "tag_value")</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">tracking </block><block class="keyword token">import</block><block class=" token"> MlflowClient</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client </block><block class="operator token">=</block><block class=" token"> MlflowClient</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># display experiment runs</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">display</block><block class="punctuation token">(</block><block class=" token">client</block><block class="punctuation token">.</block><block class=" token">search_runs</block><block class="punctuation token">(</block><block class=" token">experiment_id</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># or use "mlflow-experiment" table</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">runs </block><block class="operator token">=</block><block class=" token"> spark</block><block class="punctuation token">.</block><block class=" token">read</block><block class="punctuation token">.</block><block class="builtin token">format</block><block class="punctuation token">(</block><block class="string token">"mlflow-experiment"</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">load</block><block class="punctuation token">(</block><block class=" token">experiment_id</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">display</block><block class="punctuation token">(</block><block class=" token">runs</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Pull the last run</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">run_rf </block><block class="operator token">=</block><block class=" token"> runs</block><block class="punctuation token">.</block><block class=" token">orderBy</block><block class="punctuation token">(</block><block class="string token">"start_time"</block><block class="punctuation token">,</block><block class=" token"> ascending</block><block class="operator token">=</block><block class="boolean token">False</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">first</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client</block><block class="punctuation token">.</block><block class=" token">list_artifacts</block><block class="punctuation token">(</block><block class=" token">run_rf</block><block class="punctuation token">.</block><block class=" token">run_id</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Return the evaluation metrics for the last run</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client</block><block class="punctuation token">.</block><block class=" token">get_run</block><block class="punctuation token">(</block><block class=" token">run_rf</block><block class="punctuation token">.</block><block class=" token">run_id</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">data</block><block class="punctuation token">.</block><block class=" token">metrics</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Reload the model and look at the feature importance</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model </block><block class="operator token">=</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block><block class="punctuation token">.</block><block class=" token">load_model</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"runs:/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">run_rf</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">run_id</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/random_forest_model"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model</block><block class="punctuation token">.</block><block class=" token">feature_importances_</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.8707844432012006" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.8707844432012006" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">3.1.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Autologging</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>So far we have explored methods for </block><block style="text-decoration: underline;">manually logging</block><block> models, parameters, metrics, and artifacts to MLflow.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>However, in some cases it would be convenient to </block><block style="text-decoration: underline;">do this automatically</block><block>. This is where </block><block style="font-weight: bold; color: rgb(255, 64, 0);">MLflow Autologging</block><block> comes in.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Autologging allows you to log metrics, parameters, and models </block><block style="text-decoration: underline;">without the need for explicit log statements</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There are two ways to enable autologging:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Call </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">mlflow.autolog()</block><block> before your training code. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>This will enable autologging for each supported library you have installed as soon as you import it. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>A list of supported libraries can be found </block><block class="role-hyper-link" data-hyper-link-url="https://www.mlflow.org/docs/latest/tracking.html#automatic-logging" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.mlflow.org/docs/latest/tracking.html#automatic-logging" target="_blank" style="color: inherit; text-decoration: inherit;">here</a></block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Use library-specific autolog calls for each library you use in your code. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>For example, enabling mlflow for sklearn specically would use </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">mlflow.sklearn.autolog()</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Note:</block><block> We do not need to put the code in a </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">mlflow.start_run()</block><block> block.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">mlflow</block><block class="punctuation token">.</block><block class=" token">autolog</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">rf </block><block class="operator token">=</block><block class=" token"> RandomForestRegressor</block><block class="punctuation token">(</block><block class=" token">random_state</block><block class="operator token">=</block><block class="number token">42</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">rf_model </block><block class="operator token">=</block><block class=" token"> rf</block><block class="punctuation token">.</block><block class=" token">fit</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> What can MLflow Tracking log? </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> MLflow can log the following:</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Parameters:</block><block> inputs to a model</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Metrics:</block><block> the performance of the model</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Artifacts:</block><block> any object including data, models, and images</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Source:</block><block> the original code, including the commit hash if linked to git</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> How do you log experiments? </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> Experiments are logged by first creating a run and using the logging methods on that run object (e.g. </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">run.log_param("MSE", .2)</block><block>).</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> Where do logged artifacts get saved? </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> Logged artifacts are saved in a directory of your choosing. On Databricks, this would be DBFS (Databricks File System).</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> How can I query past runs? </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> This can be done using an </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">MlflowClient</block><block> object. This allows you do everything you can within the UI programatically so you never have to step outside of your programming environment.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.04983054387977792" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.04983054387977792" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Model Management - Intro</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>An MLflow </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">pyfunc</block><block> allows fully customizable deployments.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Once a model has been trained and bundled with the environment it was trained in, the next step is to </block><block style="text-decoration: underline;">package the model</block><block> so that </block><block style="font-weight: bold;">it can be used by a variety of serving tools</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Packaging</block><block> the final model in a platform-agnostic way offers the </block><block style="text-decoration: underline;">most flexibility in deployment</block><block> options and allows for model reuse across a number of platforms.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">MLflow</block><block> models is a convention for packaging machine learning models that offers self-contained code, environments, and models.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The main abstraction in this package is the concept of </block><block style="font-weight: bold; color: rgb(255, 64, 0);">flavors</block><block>:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>A </block><block style="font-weight: bold;">flavor</block><block> is a different ways the model can be used.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>For instance, a TensorFlow model can be loaded as a </block><block style="font-weight: bold;">TensorFlow DAG</block><block> or as a </block><block style="font-weight: bold;">Python function</block><block>.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: underline;">Using an MLflow model convention allows for both of these flavors</block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">python_function</block><block> or </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">pyfunc</block><block> flavor of models gives a generic way of bundling models.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We can thereby deploy a python function without worrying about the underlying format of the model</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgb(255, 254, 0);">MLflow, therefore, maps any training framework to any deployment using these platform-agnostic representations, massively reducing the complexity of inference</block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Arbitrary logic including pre and post-processing steps, arbitrary code executed when loading the model, side artifacts, and more can be included in the pipeline to customize it as needed  This means that </block><block style="text-decoration: underline;">the full pipeline, not just the model, can be preserved as a single object that works with the rest of the MLflow ecosystem</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 723.5px; height: 393.05px; position: relative;"><img src="image-resources/7c71a0c4-6bc7-4d86-94c6-b4e829ea16f1.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 732.5px; height: 385.23px; position: relative;"><img src="image-resources/29887396-0c80-4d36-a1de-e71336c0490c.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Some of the </block><block style="font-weight: bold; color: rgb(255, 64, 0);">most popular built-in flavors</block><block> include:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://mlflow.org/docs/latest/python_api/mlflow.keras.html#module-mlflow.keras" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://mlflow.org/docs/latest/python_api/mlflow.keras.html#module-mlflow.keras" target="_blank" style="color: inherit; text-decoration: inherit;">mlflow.keras</a></block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://mlflow.org/docs/latest/python_api/mlflow.sklearn.html#module-mlflow.sklearn" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://mlflow.org/docs/latest/python_api/mlflow.sklearn.html#module-mlflow.sklearn" target="_blank" style="color: inherit; text-decoration: inherit;">mlflow.sklearn</a></block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://mlflow.org/docs/latest/python_api/mlflow.spark.html#module-mlflow.spark" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://mlflow.org/docs/latest/python_api/mlflow.spark.html#module-mlflow.spark" target="_blank" style="color: inherit; text-decoration: inherit;">mlflow.spark</a></block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>See the rest </block><block class="role-hyper-link" data-hyper-link-url="https://mlflow.org/docs/latest/python_api/index.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://mlflow.org/docs/latest/python_api/index.html" target="_blank" style="color: inherit; text-decoration: inherit;">here</a></block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 609.597px; height: 250px; position: relative;"><img src="image-resources/1747de4b-88f1-48fb-bbaf-a33282376b82.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.5631081581417163" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.5631081581417163" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">4.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Custom Models Using </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace;">pyfunc</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>A </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">pyfunc</block><block> is a generic python model that can define any arbitrary logic, regardless of the libraries used to train it. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This object </block><block style="text-decoration: underline;">interoperates with any MLflow functionality</block><block>, especially downstream scoring tools. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>As such, it's defined as a class with a related directory structure with all of the dependencies. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>It is then "just an object" with a various methods such as a predict method. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Since it makes very few assumptions, it can be deployed using MLflow, SageMaker, a Spark UDF, or in any other environment.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://mlflow.org/docs/latest/python_api/mlflow.pyfunc.html#pyfunc-create-custom" style="text-decoration: underline; font-family: &quot;Courier New&quot;, Courier, monospace; color: rgb(17, 85, 204);"><a href="https://mlflow.org/docs/latest/python_api/mlflow.pyfunc.html#pyfunc-create-custom" target="_blank" style="color: inherit; text-decoration: inherit;">pyfunc</a></block><block class="role-hyper-link" data-hyper-link-url="https://mlflow.org/docs/latest/python_api/mlflow.pyfunc.html#pyfunc-create-custom" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://mlflow.org/docs/latest/python_api/mlflow.pyfunc.html#pyfunc-create-custom" target="_blank" style="color: inherit; text-decoration: inherit;"> documentation</a></block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>A generic </block><block class="role-hyper-link" data-hyper-link-url="https://github.com/mlflow/mlflow/blob/master/docs/source/models.rst#example-saving-an-xgboost-model-in-mlflow-format" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://github.com/mlflow/mlflow/blob/master/docs/source/models.rst#example-saving-an-xgboost-model-in-mlflow-format" target="_blank" style="color: inherit; text-decoration: inherit;">example</a></block><block> code and integration with XGBoost</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>An </block><block class="role-hyper-link" data-hyper-link-url="https://mlflow.org/docs/latest/models.html#example-creating-a-custom-add-n-model" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://mlflow.org/docs/latest/models.html#example-creating-a-custom-add-n-model" target="_blank" style="color: inherit; text-decoration: inherit;">example</a></block><block> that creates a basic class that adds </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(0, 0, 0);">n</block><block> to the input values</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.9717172073834675" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.9717172073834675" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">4.1.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Implementation</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We will train a random forest model using a pre-processed training set. The input dataframes are processed with the following steps:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Create an additional feature (</block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">review_scores_sum</block><block>) aggregated from various review scores.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Enforce the proper data types.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>When creating predictions from our model, we need to re-apply the same pre-processing logic to the data each time we use our model.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>To streamline the steps, we define a custom </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">RFWithPreprocess</block><block> model class that uses a </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">preprocess_input(self, model_input)</block><block> helper method to automatically pre-processes the raw input it receives before executing a custom </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">fit()</block><block> method or before passing that input into the trained model's </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">.predict()</block><block> function. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This way, in future applications of our model we will no longer have to handle arbitrary pre-processing logic for every batch of data.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> mlflow</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">RFWithPreprocess</block><block class="punctuation token">(</block><block class=" token">mlflow</block><block class="punctuation token">.</block><block class=" token">pyfunc</block><block class="punctuation token">.</block><block class=" token">PythonModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">__init__</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">,</block><block class=" token"> params</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Initialize with just the model hyperparameters</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">params </block><block class="operator token">=</block><block class=" token"> params</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">rf_model </block><block class="operator token">=</block><block class=" token"> </block><block class="boolean token">None</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">config </block><block class="operator token">=</block><block class=" token"> </block><block class="boolean token">None</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">load_context</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">,</block><block class=" token"> context</block><block class="operator token">=</block><block class="boolean token">None</block><block class="punctuation token">,</block><block class=" token"> config_path</block><block class="operator token">=</block><block class="boolean token">None</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        When loading a pyfunc, this method runs automatically with the related</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        context.  This method is designed to perform the same functionality when</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        run in a notebook or a downstream operation (like a REST endpoint).</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        If the `context` object is provided, it will load the path to a config from </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        that object (this happens with `mlflow.pyfunc.load_model()` is called).</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        If the `config_path` argument is provided instead, it uses this argument</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        in order to load in the config.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">if</block><block class=" token"> context</block><block class="punctuation token">:</block><block class=" token"> </block><block class="comment token"># This block executes for server run</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            config_path </block><block class="operator token">=</block><block class=" token"> context</block><block class="punctuation token">.</block><block class=" token">artifacts</block><block class="punctuation token">[</block><block class="string token">"config_path"</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">else</block><block class="punctuation token">:</block><block class=" token"> </block><block class="comment token"># This block executes for notebook run</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">pass</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">config </block><block class="operator token">=</block><block class=" token"> json</block><block class="punctuation token">.</block><block class=" token">load</block><block class="punctuation token">(</block><block class="builtin token">open</block><block class="punctuation token">(</block><block class=" token">config_path</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">      </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">preprocess_input</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">,</block><block class=" token"> model_input</block><block class="punctuation token">:</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">DataFrame</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">-</block><block class="operator token">&gt;</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">DataFrame</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Return pre-processed model_input</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        processed_input </block><block class="operator token">=</block><block class=" token"> model_input</block><block class="punctuation token">.</block><block class=" token">copy</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        processed_input</block><block class="punctuation token">[</block><block class="string token">"review_scores_sum"</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            processed_input</block><block class="punctuation token">[</block><block class="string token">"review_scores_accuracy"</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">+</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            processed_input</block><block class="punctuation token">[</block><block class="string token">"review_scores_cleanliness"</block><block class="punctuation token">]</block><block class="operator token">+</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            processed_input</block><block class="punctuation token">[</block><block class="string token">"review_scores_checkin"</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">+</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            processed_input</block><block class="punctuation token">[</block><block class="string token">"review_scores_communication"</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">+</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            processed_input</block><block class="punctuation token">[</block><block class="string token">"review_scores_location"</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">+</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            processed_input</block><block class="punctuation token">[</block><block class="string token">"review_scores_value"</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        processed_input </block><block class="operator token">=</block><block class=" token"> processed_input</block><block class="punctuation token">.</block><block class=" token">drop</block><block class="punctuation token">(</block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"review_scores_accuracy"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"review_scores_cleanliness"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"review_scores_checkin"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"review_scores_communication"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"review_scores_location"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"review_scores_value"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> axis</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        processed_input</block><block class="punctuation token">[</block><block class="string token">"latitude_cleaned"</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> processed_input</block><block class="punctuation token">[</block><block class="string token">"latitude"</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class=" token">astype</block><block class="punctuation token">(</block><block class="builtin token">float</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        processed_input</block><block class="punctuation token">[</block><block class="string token">"longitude_cleaned"</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> processed_input</block><block class="punctuation token">[</block><block class="string token">"longitude"</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class=" token">astype</block><block class="punctuation token">(</block><block class="builtin token">float</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        processed_input </block><block class="operator token">=</block><block class=" token"> processed_input</block><block class="punctuation token">.</block><block class=" token">drop</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class="string token">"latitude"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"longitude"</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> axis</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">return</block><block class=" token"> processed_input</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">fit</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">,</block><block class=" token"> X_train</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Uses the same preprocessing logic to fit the model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">ensemble </block><block class="keyword token">import</block><block class=" token"> RandomForestRegressor</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        processed_model_input </block><block class="operator token">=</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">preprocess_input</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        rf_model </block><block class="operator token">=</block><block class=" token"> RandomForestRegressor</block><block class="punctuation token">(</block><block class="operator token">**</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">params</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        rf_model</block><block class="punctuation token">.</block><block class=" token">fit</block><block class="punctuation token">(</block><block class=" token">processed_model_input</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">rf_model </block><block class="operator token">=</block><block class=" token"> rf_model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">predict</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">,</block><block class=" token"> context</block><block class="punctuation token">,</block><block class=" token"> model_input</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        This is the main entrance to the model in deployment systems</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        processed_model_input </block><block class="operator token">=</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">preprocess_input</block><block class="punctuation token">(</block><block class=" token">model_input</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">return</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">rf_model</block><block class="punctuation token">.</block><block class=" token">predict</block><block class="punctuation token">(</block><block class=" token">processed_model_input</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The </block><block style="font-weight: bold; color: rgb(255, 64, 0);">context</block><block> parameter is provided automatically by MLflow in downstream tools. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This can be used to add custom dependent objects such as models that are not easily serialized (e.g. </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">keras</block><block> models) or custom configuration files.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Use the following to provide a </block><block style="font-weight: bold;">config file</block><block>:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Save any file we want to load into the class.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Create an artifact dictionary of key/value pairs where the value is the path to that object.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>When saving the model, all artifacts will be copied over into the same directory for downstream use.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In our case, we'll save some model hyperparameters as our config.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Note:</block><block> </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">pyfunc</block><block> interoperates with any downstream serving tool. It allows you to use arbitrary code, niche libraries, and complex side information.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> json </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> os</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">params </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"n_estimators"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">15</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"max_depth"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">5</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Designate a path</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">config_path </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">paths</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">working_path</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/data.json"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Save the results</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">with</block><block class=" token"> </block><block class="builtin token">open</block><block class="punctuation token">(</block><block class=" token">config_path</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"w"</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">as</block><block class=" token"> f</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    json</block><block class="punctuation token">.</block><block class=" token">dump</block><block class="punctuation token">(</block><block class=" token">params</block><block class="punctuation token">,</block><block class=" token"> f</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Generate an artifact object to saved</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># All paths to the associated values will be copied over when saving</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">artifacts </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block><block class="string token">"config_path"</block><block class="punctuation token">:</block><block class=" token"> config_path</block><block class="punctuation token">}</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Instantiate the class. Run `load_context` to load the config. This automatically runs in downstream serving tools.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model </block><block class="operator token">=</block><block class=" token"> RFWithPreprocess</block><block class="punctuation token">(</block><block class=" token">params</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Run manually (this happens automatically in serving integrations)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model</block><block class="punctuation token">.</block><block class=" token">load_context</block><block class="punctuation token">(</block><block class=" token">config_path</block><block class="operator token">=</block><block class=" token">config_path</block><block class="punctuation token">)</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Confirm the config has loaded</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model</block><block class="punctuation token">.</block><block class=" token">config</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># {'n_estimators': 15, 'max_depth': 5}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Train the model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model</block><block class="punctuation token">.</block><block class=" token">fit</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Generate predictions</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">predictions </block><block class="operator token">=</block><block class=" token"> model</block><block class="punctuation token">.</block><block class=" token">predict</block><block class="punctuation token">(</block><block class=" token">context</block><block class="operator token">=</block><block class="boolean token">None</block><block class="punctuation token">,</block><block class=" token"> model_input</block><block class="operator token">=</block><block class=" token">X_test</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">predictions</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Generate the model signature</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">models</block><block class="punctuation token">.</block><block class=" token">signature </block><block class="keyword token">import</block><block class=" token"> infer_signature</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">signature </block><block class="operator token">=</block><block class=" token"> infer_signature</block><block class="punctuation token">(</block><block class=" token">X_test</block><block class="punctuation token">,</block><block class=" token"> predictions</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">signature</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Generate the conda environment.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># This is necessary because when we use `mlflow.sklearn`, we automatically</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># log the appropriate version of `sklearn`.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># With `pyfunc`, we must manually construct our deployment environment.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sys </block><block class="keyword token">import</block><block class=" token"> version_info</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> sklearn</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">conda_env </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"channels"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">[</block><block class="string token">"defaults"</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"dependencies"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string-interpolation string token">f"python=</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">version_info</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">major</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">.</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">version_info</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">minor</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">.</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">version_info</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">micro</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"pip"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">{</block><block class="string token">"pip"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">[</block><block class="string token">"mlflow"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                 </block><block class="string-interpolation string token">f"scikit-learn==</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">sklearn</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">__version__</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">}</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"name"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"sklearn_env"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">conda_env</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Save the model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">with</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">start_run</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">as</block><block class=" token"> run</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">pyfunc</block><block class="punctuation token">.</block><block class=" token">log_model</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"rf_preprocessed_model"</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        python_model</block><block class="operator token">=</block><block class=" token">model</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        artifacts</block><block class="operator token">=</block><block class=" token">artifacts</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        conda_env</block><block class="operator token">=</block><block class=" token">conda_env</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        signature</block><block class="operator token">=</block><block class=" token">signature</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        input_example</block><block class="operator token">=</block><block class=" token">X_test</block><block class="punctuation token">[</block><block class="punctuation token">:</block><block class="number token">3</block><block class="punctuation token">]</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Load the model in `python_function` format</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">mlflow_pyfunc_model_path </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"runs:/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">run</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">info</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">run_id</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/rf_preprocessed_model"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">loaded_preprocess_model </block><block class="operator token">=</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">pyfunc</block><block class="punctuation token">.</block><block class=" token">load_model</block><block class="punctuation token">(</block><block class=" token">mlflow_pyfunc_model_path</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Apply the model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">loaded_preprocess_model</block><block class="punctuation token">.</block><block class=" token">predict</block><block class="punctuation token">(</block><block class=" token">X_test</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> How do MLflow projects differ from models? </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> The focus of MLflow projects is reproducibility of runs and packaging of code. MLflow models focuses on various deployment environments.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> What is a ML model flavor? </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> Flavors are a convention that deployment tools can use to understand the model, which makes it possible to write tools that work with models from any ML library without having to integrate each tool with each library. Instead of having to map each training environment to a deployment environment, ML model flavors manages this mapping for you.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> How do I add pre and post processing logic to my models? </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> A model class that extends mlflow.pyfunc.PythonModel allows you to have load, pre-processing, and post-processing logic.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.2866218232609259" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.2866218232609259" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">5. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Model Management - Model Registry</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">MLflow Model Registry</block><block> (</block><block class="role-hyper-link" data-hyper-link-url="Model registry has the following features:   Central Repository: Register MLflow models with the MLflow Model Registry. A registered model has a unique name, version, stage, and other metadata. Model Versioning: Automatically keep track of versions for registered models when updated. Model Stage: Assigned preset or custom stages to each model version, like Staging and Production to represent the lifecycle of a model. Model Stage Transitions: Record new registration events or changes as activities that automatically log users, changes, and additional metadata such as comments. CI/CD Workflow Integration: Record stage transitions, request, review and approve changes as part of CI/CD pipelines for better control and governance." style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="Model registry has the following features:   Central Repository: Register MLflow models with the MLflow Model Registry. A registered model has a unique name, version, stage, and other metadata. Model Versioning: Automatically keep track of versions for registered models when updated. Model Stage: Assigned preset or custom stages to each model version, like Staging and Production to represent the lifecycle of a model. Model Stage Transitions: Record new registration events or changes as activities that automatically log users, changes, and additional metadata such as comments. CI/CD Workflow Integration: Record stage transitions, request, review and approve changes as part of CI/CD pipelines for better control and governance." target="_blank" style="color: inherit; text-decoration: inherit;">source</a></block><block>) is a collaborative hub where teams can share ML models, work together from experimentation to online testing and production, integrate with approval and governance workflows, and monitor ML deployments and their performance. </block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The </block><block style="font-weight: bold;">MLflow Model Registry</block><block> component is a </block><block style="text-decoration: underline;">centralized model store</block><block>, </block><block style="text-decoration: underline;">set of APIs</block><block>, and UI, to collaboratively manage the full lifecycle of an MLflow Model. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>It provides: </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: none; font-weight: bold;">Model lineage</block><block> (which MLflow Experiment and Run produced the model), </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: none; font-weight: bold;">Model versioning</block><block>, </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: none; font-weight: bold;">Stage transitions</block><block> (e.g. from staging to production), </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: none; font-weight: bold;">Annotations</block><block> (e.g. with comments, tags), and </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: none; font-weight: bold;">Deployment management</block><block> (e.g. which production jobs have requested a specific model version).</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Model registry has the following feature</block><block>s:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Central Repository:</block><block> Register MLflow models with the MLflow Model Registry. A registered model has a unique name, version, stage, and other metadata.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Model Versioning:</block><block> Automatically keep track of versions for registered models when updated.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Model Stage:</block><block> Assigned preset or custom stages to each model version, like Staging and Production to represent the lifecycle of a model.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Model Stage Transitions:</block><block> Record new registration events or changes as activities that automatically log users, changes, and additional metadata such as comments.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">CI/CD Workflow Integration:</block><block> Record stage transitions, request, review and approve changes as part of CI/CD pipelines for better control and governance.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 684.086px; height: 359.93px; position: relative;"><img src="image-resources/b35a623c-2e5f-4a7d-9501-ee5405eafb7f.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 686.592px; height: 374.07px; position: relative;"><img src="image-resources/09c636e2-e39c-4656-9b68-f6c190846f9c.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Model registery workflow options</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Central Model Registery</block><block>  Dedicated workspace(s) to store models and experiments.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Refer to this </block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/en/machine-learning/manage-model-lifecycle/multiple-workspaces.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/en/machine-learning/manage-model-lifecycle/multiple-workspaces.html" target="_blank" style="color: inherit; text-decoration: inherit;">documentation</a></block><block>.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Pros:</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Visibility into current state of all models</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Central management of models</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Cross cloud</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Cons:</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Setup is a bit complicted  * We need PAT &amp; other configuration in a secret scope, * We can have </block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/en/security/secrets/secret-scopes.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/en/security/secrets/secret-scopes.html" target="_blank" style="color: inherit; text-decoration: inherit;">max 100 secret scopes per workspace</a></block><block>, * Using shared PATs isn't good from compliance point of view</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Per-workspace Model Registeries</block><block>  Each workspace has its own model registery, </block><block style="text-decoration: underline; background-color: rgb(255, 254, 0);">model transition is made via CI/CD</block><block>.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Pros:</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Narrowed access to staging/production workspace</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>PAT is required only for a system account (e.g., service principals)</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Cons:</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Limited observability  you need to visit staging/production workspaces to get information about model state</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Approvals need to be done in relevant workspaces</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There are no built-in tools for transitioning of models/experiments between workspaces, although </block><block class="role-hyper-link" data-hyper-link-url="https://github.com/amesar/mlflow-export-import" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://github.com/amesar/mlflow-export-import" target="_blank" style="color: inherit; text-decoration: inherit;">there is some tooling</a></block><block>.</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Requires implementation as part of CI/CD pipeline</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 676.792px; height: 217.6px; position: relative;"><img src="image-resources/61af192c-5d1d-48f8-a32a-701e8a6c5200.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 729.597px; height: 288.28px; position: relative;"><img src="image-resources/0cf22c55-784b-4394-88b7-92f5e6a0585f.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.14698272352640784" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.14698272352640784" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">5.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Registering a Model</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The following workflow will work with either the UI or in pure Python.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>For the UI, look under the "Models" section from the sidebar. MLflow logs things like:</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>It logged who trained the model and what code was used</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>It logged a history of actions taken on this model</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>It logged this model as a first version (if it's first time registering)</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Train a model and log it into MLflow</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> mlflow</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> pandas </block><block class="keyword token">as</block><block class=" token"> pd</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">ensemble </block><block class="keyword token">import</block><block class=" token"> RandomForestRegressor</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">metrics </block><block class="keyword token">import</block><block class=" token"> mean_squared_error</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">model_selection </block><block class="keyword token">import</block><block class=" token"> train_test_split</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">models</block><block class="punctuation token">.</block><block class=" token">signature </block><block class="keyword token">import</block><block class=" token"> infer_signature</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">df </block><block class="operator token">=</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">read_parquet</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">paths</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">datasets_path</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/airbnb/sf-listings/airbnb-cleaned-mlflow.parquet"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> X_test</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">,</block><block class=" token"> y_test </block><block class="operator token">=</block><block class=" token"> train_test_split</block><block class="punctuation token">(</block><block class=" token">df</block><block class="punctuation token">.</block><block class=" token">drop</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class="string token">"price"</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> axis</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> df</block><block class="punctuation token">[</block><block class="string token">"price"</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> random_state</block><block class="operator token">=</block><block class="number token">42</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">n_estimators </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">100</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">max_depth </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">5</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">rf </block><block class="operator token">=</block><block class=" token"> RandomForestRegressor</block><block class="punctuation token">(</block><block class=" token">n_estimators</block><block class="operator token">=</block><block class=" token">n_estimators</block><block class="punctuation token">,</block><block class=" token"> max_depth</block><block class="operator token">=</block><block class=" token">max_depth</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">rf</block><block class="punctuation token">.</block><block class=" token">fit</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">input_example </block><block class="operator token">=</block><block class=" token"> X_train</block><block class="punctuation token">.</block><block class=" token">head</block><block class="punctuation token">(</block><block class="number token">3</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">signature </block><block class="operator token">=</block><block class=" token"> infer_signature</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">DataFrame</block><block class="punctuation token">(</block><block class=" token">y_train</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">with</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">start_run</block><block class="punctuation token">(</block><block class=" token">run_name</block><block class="operator token">=</block><block class="string token">"RF Model"</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">as</block><block class=" token"> run</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block><block class="punctuation token">.</block><block class=" token">log_model</block><block class="punctuation token">(</block><block class=" token">rf</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"model"</block><block class="punctuation token">,</block><block class=" token"> input_example</block><block class="operator token">=</block><block class=" token">input_example</block><block class="punctuation token">,</block><block class=" token"> signature</block><block class="operator token">=</block><block class=" token">signature</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">log_metric</block><block class="punctuation token">(</block><block class="string token">"mse"</block><block class="punctuation token">,</block><block class=" token"> mean_squared_error</block><block class="punctuation token">(</block><block class=" token">y_test</block><block class="punctuation token">,</block><block class=" token"> rf</block><block class="punctuation token">.</block><block class=" token">predict</block><block class="punctuation token">(</block><block class=" token">X_test</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">log_param</block><block class="punctuation token">(</block><block class="string token">"n_estimators"</block><block class="punctuation token">,</block><block class=" token"> n_estimators</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">log_param</block><block class="punctuation token">(</block><block class="string token">"max_depth"</block><block class="punctuation token">,</block><block class=" token"> max_depth</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    run_id </block><block class="operator token">=</block><block class=" token"> run</block><block class="punctuation token">.</block><block class=" token">info</block><block class="punctuation token">.</block><block class=" token">run_id</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Create a unique model name so you don't clash with other workspace users.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">suffix </block><block class="operator token">=</block><block class=" token"> DA</block><block class="punctuation token">.</block><block class=" token">unique_name</block><block class="punctuation token">(</block><block class="string token">"-"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_name </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"airbnb-rf-model_</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">suffix</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Register the model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_uri </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"runs:/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">run_id</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/model"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_details </block><block class="operator token">=</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">register_model</block><block class="punctuation token">(</block><block class=" token">model_uri</block><block class="operator token">=</block><block class=" token">model_uri</block><block class="punctuation token">,</block><block class=" token"> name</block><block class="operator token">=</block><block class=" token">model_name</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>After registering the model, initially the status is </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">PENDING_REGISTRATION</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">tracking</block><block class="punctuation token">.</block><block class=" token">client </block><block class="keyword token">import</block><block class=" token"> MlflowClient</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client </block><block class="operator token">=</block><block class=" token"> MlflowClient</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_version_details </block><block class="operator token">=</block><block class=" token"> client</block><block class="punctuation token">.</block><block class=" token">get_model_version</block><block class="punctuation token">(</block><block class=" token">name</block><block class="operator token">=</block><block class=" token">model_name</block><block class="punctuation token">,</block><block class=" token"> version</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_version_details</block><block class="punctuation token">.</block><block class=" token">status</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Add model description</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client</block><block class="punctuation token">.</block><block class=" token">update_registered_model</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="operator token">=</block><block class=" token">model_details</block><block class="punctuation token">.</block><block class=" token">name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    description</block><block class="operator token">=</block><block class="string token">"This model forecasts Airbnb housing list prices based on various listing inputs."</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Add a version-specific description</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client</block><block class="punctuation token">.</block><block class=" token">update_model_version</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="operator token">=</block><block class=" token">model_details</block><block class="punctuation token">.</block><block class=" token">name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    version</block><block class="operator token">=</block><block class=" token">model_details</block><block class="punctuation token">.</block><block class=" token">version</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    description</block><block class="operator token">=</block><block class="string token">"This model version was built using sklearn."</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.16867376294427627" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.16867376294427627" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">5.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Deploying a Model</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The </block><block style="font-weight: bold;">MLflow Model Registry</block><block> defines several model stages: </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">None</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Staging </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Production</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Archived</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: underline;">Each stage has a unique meaning</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>For example, </block><block style="font-weight: bold;">Staging</block><block> is meant for model testing, while </block><block style="font-weight: bold;">Production</block><block> is for models that have completed the testing or review processes and have been deployed to applications.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: underline;">Users with appropriate permissions can transition models between stages</block><block>. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">If you have permission</block><block> to transition a model to a particular stage, you can make the transition directly by using the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">MlflowClient.update_model_version()</block><block> function. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">If you do not have permission</block><block>, you can request a stage transition using the REST API; for example: </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">%sh </block><block class="function token">curl</block><block class=" token"> -i -X POST -H </block><block class="string token">"X-Databricks-Org-Id: &lt;YOUR_ORG_ID&gt;"</block><block class=" token"> -H </block><block class="string token">"Authorization: Bearer &lt;YOUR_ACCESS_TOKEN&gt;"</block><block class=" token"> https://</block><block class="operator token">&lt;</block><block class=" token">YOUR_DATABRICKS_WORKSPACE_URL</block><block class="operator token">&gt;</block><block class=" token">/api/2.0/preview/mlflow/transition-requests/create -d </block><block class="string token">'{"comment": "Please move this model into production!", "model_version": {"version": 1, "registered_model": {"name": "power-forecasting-model"}}, "stage": "Production"}'</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.9773001458931918" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.9773001458931918" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">5.2.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Transition a model to the Production stage</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client</block><block class="punctuation token">.</block><block class=" token">transition_model_version_stage</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="operator token">=</block><block class=" token">model_details</block><block class="punctuation token">.</block><block class=" token">name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    version</block><block class="operator token">=</block><block class=" token">model_details</block><block class="punctuation token">.</block><block class=" token">version</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    stage</block><block class="operator token">=</block><block class="string token">"Production"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Fetch the model's current status</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_version_details </block><block class="operator token">=</block><block class=" token"> client</block><block class="punctuation token">.</block><block class=" token">get_model_version</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  name</block><block class="operator token">=</block><block class=" token">model_details</block><block class="punctuation token">.</block><block class=" token">name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  version</block><block class="operator token">=</block><block class=" token">model_details</block><block class="punctuation token">.</block><block class=" token">version</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"The current model stage is: '</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_version_details</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">current_stage</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">'"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Fetch the latest model using a `pyfunc`. Loading the model in this way allows us to use the model regardless of the package that was used to train it. You can load a specific version of the model too.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">pyfunc</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_version_uri </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"models:/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/1"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Loading registered model version from URI: '</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_version_uri</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">'"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_version_1 </block><block class="operator token">=</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">pyfunc</block><block class="punctuation token">.</block><block class=" token">load_model</block><block class="punctuation token">(</block><block class=" token">model_version_uri</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Predict</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_version_1</block><block class="punctuation token">.</block><block class=" token">predict</block><block class="punctuation token">(</block><block class=" token">X_test</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.3613103051557516" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.3613103051557516" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">5.2.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Deploying a New Model Version</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The </block><block style="font-weight: bold;">MLflow Model Registry</block><block> enables you to create multiple model versions corresponding to a single registered model. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>By performing stage transitions, you can seamlessly integrate new model versions into your staging or production environments.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Create a new model version and register that model when it's logged.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">n_estimators </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">300</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">max_depth </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">10</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">rf </block><block class="operator token">=</block><block class=" token"> RandomForestRegressor</block><block class="punctuation token">(</block><block class=" token">n_estimators</block><block class="operator token">=</block><block class=" token">n_estimators</block><block class="punctuation token">,</block><block class=" token"> max_depth</block><block class="operator token">=</block><block class=" token">max_depth</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">rf</block><block class="punctuation token">.</block><block class=" token">fit</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">input_example </block><block class="operator token">=</block><block class=" token"> X_train</block><block class="punctuation token">.</block><block class=" token">head</block><block class="punctuation token">(</block><block class="number token">3</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">signature </block><block class="operator token">=</block><block class=" token"> infer_signature</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">DataFrame</block><block class="punctuation token">(</block><block class=" token">y_train</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">with</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">start_run</block><block class="punctuation token">(</block><block class=" token">run_name</block><block class="operator token">=</block><block class="string token">"RF Model"</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">as</block><block class=" token"> run</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Specify the `registered_model_name` parameter of the `mlflow.sklearn.log_model()`</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># function to register the model with the MLflow Model Registry. This automatically</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># creates a new model version</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block><block class="punctuation token">.</block><block class=" token">log_model</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        sk_model</block><block class="operator token">=</block><block class=" token">rf</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        artifact_path</block><block class="operator token">=</block><block class="string token">"sklearn-model"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        registered_model_name</block><block class="operator token">=</block><block class=" token">model_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        input_example</block><block class="operator token">=</block><block class=" token">input_example</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        signature</block><block class="operator token">=</block><block class=" token">signature</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">log_metric</block><block class="punctuation token">(</block><block class="string token">"mse"</block><block class="punctuation token">,</block><block class=" token"> mean_squared_error</block><block class="punctuation token">(</block><block class=" token">y_test</block><block class="punctuation token">,</block><block class=" token"> rf</block><block class="punctuation token">.</block><block class=" token">predict</block><block class="punctuation token">(</block><block class=" token">X_test</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">log_param</block><block class="punctuation token">(</block><block class="string token">"n_estimators"</block><block class="punctuation token">,</block><block class=" token"> n_estimators</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">log_param</block><block class="punctuation token">(</block><block class="string token">"max_depth"</block><block class="punctuation token">,</block><block class=" token"> max_depth</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    run_id </block><block class="operator token">=</block><block class=" token"> run</block><block class="punctuation token">.</block><block class=" token">info</block><block class="punctuation token">.</block><block class=" token">run_id</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Check the UI to see the new model version.</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 691.195px; height: 360.73px; position: relative;"><img src="image-resources/50573f8b-dffb-4e7c-b381-3fcac1683179.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Use the search functionality to grab the latest model version.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_version_infos </block><block class="operator token">=</block><block class=" token"> client</block><block class="punctuation token">.</block><block class=" token">search_model_versions</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"name = '</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">'"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">new_model_version </block><block class="operator token">=</block><block class=" token"> </block><block class="builtin token">max</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class=" token">model_version_info</block><block class="punctuation token">.</block><block class=" token">version </block><block class="keyword token">for</block><block class=" token"> model_version_info </block><block class="keyword token">in</block><block class=" token"> model_version_infos</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"New model version: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">new_model_version</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Add a description to this new version</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client</block><block class="punctuation token">.</block><block class=" token">update_model_version</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="operator token">=</block><block class=" token">model_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    version</block><block class="operator token">=</block><block class=" token">new_model_version</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    description</block><block class="operator token">=</block><block class="string token">"This model version is a random forest containing 300 decision trees and a max depth of 10 that was trained in scikit-learn."</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Put this new model version into `Staging`</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">time</block><block class="punctuation token">.</block><block class=" token">sleep</block><block class="punctuation token">(</block><block class="number token">10</block><block class="punctuation token">)</block><block class=" token"> </block><block class="comment token"># In case the registration is still pending</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client</block><block class="punctuation token">.</block><block class=" token">transition_model_version_stage</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="operator token">=</block><block class=" token">model_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    version</block><block class="operator token">=</block><block class=" token">new_model_version</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    stage</block><block class="operator token">=</block><block class="string token">"Staging"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Since this model is now in staging, you can execute an automated CI/CD pipeline against it to test it before going into production. Once that is completed, you can push that model into production.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client</block><block class="punctuation token">.</block><block class=" token">transition_model_version_stage</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="operator token">=</block><block class=" token">model_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    version</block><block class="operator token">=</block><block class=" token">new_model_version</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    stage</block><block class="operator token">=</block><block class="string token">"Production"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    archive_existing_versions</block><block class="operator token">=</block><block class="boolean token">True</block><block class=" token"> </block><block class="comment token"># Archive old versions of this model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Deleting</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># We can now delete the older versions of the model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Note: You cannot delete a model before it's archived</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client</block><block class="punctuation token">.</block><block class=" token">transition_model_version_stage</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="operator token">=</block><block class=" token">model_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    version</block><block class="operator token">=</block><block class="number token">2</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    stage</block><block class="operator token">=</block><block class="string token">"Archived"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client</block><block class="punctuation token">.</block><block class=" token">delete_model_version</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="operator token">=</block><block class=" token">model_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    version</block><block class="operator token">=</block><block class="number token">1</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Deleting the entire registered model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client</block><block class="punctuation token">.</block><block class=" token">delete_registered_model</block><block class="punctuation token">(</block><block class=" token">model_name</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> How does MLflow tracking differ from the model registry?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> Tracking is meant for experimentation and development. The model registry is designed to take a model from tracking and put it through staging and into production. This is often the point that a data engineer or a machine learning engineer takes responsibility for the depoloyment process.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> Why do I need a model registry?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> Just as MLflow tracking provides end-to-end reproducibility for the machine learning training process, a model registry provides reproducibility and governance for the deployment process. Since production systems are mission critical, components can be isolated with ACL's so only specific individuals can alter production models. Version control and CI/CD workflow integration is also a critical dimension of deploying models into production.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> What can I do programatically versus using the UI?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> Most operations can be done using the UI or in pure Python. A model must be tracked using Python, but from that point on everything can be done either way. For instance, a model logged using the MLflow tracking API can then be registered using the UI and can then be pushed into production.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.2578612698125524" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.2578612698125524" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">6. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Model Management - Webhooks and Testing</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Webhooks</block><block> </block><block style="text-decoration: underline;">trigger the execution of code (oftentimes tests) upon some event</block><block>. </block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.9704514065486807" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.9704514065486807" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">6.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Automated Testing</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgb(255, 254, 0);">The backbone of the continuous integration, continuous deployment (CI/CD) process is the automated building, testing, and deployment of code</block><block>. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>A </block><block style="font-weight: bold;">webhook</block><block> or </block><block style="font-weight: bold;">trigger</block><block> causes the execution of code based upon some event. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This is commonly </block><block style="text-decoration: underline;">when new code is pushed to a code repository</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In the case of machine learning jobs, this could be the </block><block style="text-decoration: underline;">arrival of a new model in the model registry</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The two types of </block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/applications/mlflow/model-registry-webhooks.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/applications/mlflow/model-registry-webhooks.html" target="_blank" style="color: inherit; text-decoration: inherit;">MLflow Model Registry Webhooks</a></block><block>:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Webhooks with Job triggers:</block><block> Trigger a job in a Databricks workspace</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Webhooks with HTTP endpoints:</block><block> Send triggers to any HTTP endpoint</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This lesson uses:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>A </block><block style="font-weight: bold;">Job webhook</block><block> to trigger the execution of a Databricks job.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>A </block><block style="font-weight: bold;">HTTP webhook</block><block> to send notifications to Slack.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Upon the arrival of a new model version with a given name in the model registry, the </block><block style="font-weight: bold;">function of the Databricks job is to</block><block>:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Import the new model version</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Test the schema of its inputs and outputs</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Pass example code through the model</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This covers many of the desired tests for ML models. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>However, </block><block style="text-decoration: underline;">throughput testing could also be performed</block><block> using this paradigm. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Also, the </block><block style="text-decoration: underline;">model could also be promoted to the production stage in an automated fashion</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Note:</block><block> You need to install the webhook library before you can use it  </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">pip install databricks-registry-webhooks</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.019357381149047947" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.019357381149047947" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">6.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Implementation</block></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.7733419660531118" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.7733419660531118" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.2.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Creating a Model</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We follow these steps to create a Databricks job:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Create a user access token</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Click the Settings icon</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Click User Settings</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Go to the Access Tokens tab</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Click the Generate New Token button</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">5. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Optionally enter a description (comment) and expiration period</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">6. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Click the Generate button</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">7. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Copy the generated token and use it in your code.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">7. </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Note:</block><block> Ensure that you are an admin on this workspace and that you're not using Community Edition (which has jobs disabled).</block></blocks></line><line class="root text-mode indent-2 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>You can set:</block><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">token </block><block class="operator token">=</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">utils</block><block class="punctuation token">.</block><block class=" token">databricks_utils</block><block class="punctuation token">.</block><block class=" token">_get_command_context</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">apiToken</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>However, this is </block><block style="text-decoration: underline;">not a best practice</block><block>. </block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>We recommend you create your personal access token using the steps above and save it in your </block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/security/secrets/secret-scopes.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/security/secrets/secret-scopes.html" target="_blank" style="color: inherit; text-decoration: inherit;">secret scope</a></block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>More details about access tokens </block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/dev-tools/api/latest/authentication.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/dev-tools/api/latest/authentication.html" target="_blank" style="color: inherit; text-decoration: inherit;">here</a></block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> mlflow</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># With the token, we can create our authorization header for our subsequent REST calls</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">headers </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block><block class="string token">"Authorization"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string-interpolation string token">f"Bearer </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">token</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">instance </block><block class="operator token">=</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">utils</block><block class="punctuation token">.</block><block class=" token">databricks_utils</block><block class="punctuation token">.</block><block class=" token">get_webapp_url</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Train and register a model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">models</block><block class="punctuation token">.</block><block class=" token">signature </block><block class="keyword token">import</block><block class=" token"> infer_signature</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">metrics </block><block class="keyword token">import</block><block class=" token"> mean_squared_error</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> pandas </block><block class="keyword token">as</block><block class=" token"> pd</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">ensemble </block><block class="keyword token">import</block><block class=" token"> RandomForestRegressor</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">model_selection </block><block class="keyword token">import</block><block class=" token"> train_test_split</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">with</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">start_run</block><block class="punctuation token">(</block><block class=" token">run_name</block><block class="operator token">=</block><block class="string token">"Webhook RF Experiment"</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">as</block><block class=" token"> run</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Data prep</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    df </block><block class="operator token">=</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">read_parquet</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">paths</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">datasets_path</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/airbnb/sf-listings/airbnb-cleaned-mlflow.parquet"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    X_train</block><block class="punctuation token">,</block><block class=" token"> X_test</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">,</block><block class=" token"> y_test </block><block class="operator token">=</block><block class=" token"> train_test_split</block><block class="punctuation token">(</block><block class=" token">df</block><block class="punctuation token">.</block><block class=" token">drop</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class="string token">"price"</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> axis</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> df</block><block class="punctuation token">[</block><block class="string token">"price"</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> random_state</block><block class="operator token">=</block><block class="number token">42</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    signature </block><block class="operator token">=</block><block class=" token"> infer_signature</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">DataFrame</block><block class="punctuation token">(</block><block class=" token">y_train</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    example </block><block class="operator token">=</block><block class=" token"> X_train</block><block class="punctuation token">.</block><block class=" token">head</block><block class="punctuation token">(</block><block class="number token">3</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Train and log model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    rf </block><block class="operator token">=</block><block class=" token"> RandomForestRegressor</block><block class="punctuation token">(</block><block class=" token">random_state</block><block class="operator token">=</block><block class="number token">42</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    rf</block><block class="punctuation token">.</block><block class=" token">fit</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block><block class="punctuation token">.</block><block class=" token">log_model</block><block class="punctuation token">(</block><block class=" token">rf</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"random-forest-model"</block><block class="punctuation token">,</block><block class=" token"> signature</block><block class="operator token">=</block><block class=" token">signature</block><block class="punctuation token">,</block><block class=" token"> input_example</block><block class="operator token">=</block><block class=" token">example</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mse </block><block class="operator token">=</block><block class=" token"> mean_squared_error</block><block class="punctuation token">(</block><block class=" token">y_test</block><block class="punctuation token">,</block><block class=" token"> rf</block><block class="punctuation token">.</block><block class=" token">predict</block><block class="punctuation token">(</block><block class=" token">X_test</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">log_metric</block><block class="punctuation token">(</block><block class="string token">"mse"</block><block class="punctuation token">,</block><block class=" token"> mse</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    run_id </block><block class="operator token">=</block><block class=" token"> run</block><block class="punctuation token">.</block><block class=" token">info</block><block class="punctuation token">.</block><block class=" token">run_id</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    experiment_id </block><block class="operator token">=</block><block class=" token"> run</block><block class="punctuation token">.</block><block class=" token">info</block><block class="punctuation token">.</block><block class=" token">experiment_id</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">suffix </block><block class="operator token">=</block><block class=" token"> DA</block><block class="punctuation token">.</block><block class=" token">unique_name</block><block class="punctuation token">(</block><block class="string token">"-"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">name </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"webhook-demo_</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">suffix</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_uri </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"runs:/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">run_id</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/random-forest-model"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_details </block><block class="operator token">=</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">register_model</block><block class="punctuation token">(</block><block class=" token">model_uri</block><block class="operator token">=</block><block class=" token">model_uri</block><block class="punctuation token">,</block><block class=" token"> name</block><block class="operator token">=</block><block class=" token">name</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.12603074872240883" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.12603074872240883" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.2.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Creating a Job</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There's a job notebook called  </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">03b-Webhooks-Job-Demo</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>You can access the jobs through the </block><block style="font-weight: bold;">"Workflows"</block><block> or </block><block style="font-weight: bold;">"Job Runs"</block><block> in the sidebar.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Click on the </block><block style="font-weight: bold;">"Create Job"</block><block> button to create and specify a new job (see below).</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 710.792px; height: 400.65px; position: relative;"><img src="image-resources/5323b477-65df-461b-92b9-86fcef6cd031.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 710.994px; height: 261.87px; position: relative;"><img src="image-resources/d5c2b6a9-957b-442e-b174-c0e5dd009386.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Alternatively, the code below will programmatically create the job.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> requests</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">find_job_id</block><block class="punctuation token">(</block><block class=" token">instance</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="punctuation token">,</block><block class=" token"> job_name</block><block class="punctuation token">,</block><block class=" token"> offset_limit</block><block class="operator token">=</block><block class="number token">1000</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    params </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block><block class="string token">"offset"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    uri </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">instance</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/api/2.1/jobs/list"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    res </block><block class="operator token">=</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class=" token">uri</block><block class="punctuation token">,</block><block class=" token"> params</block><block class="operator token">=</block><block class=" token">params</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="operator token">=</block><block class=" token">headers</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> res</block><block class="punctuation token">.</block><block class=" token">status_code </block><block class="operator token">==</block><block class=" token"> </block><block class="number token">200</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        job_list </block><block class="operator token">=</block><block class=" token"> res</block><block class="punctuation token">.</block><block class=" token">json</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class="string token">"jobs"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">if</block><block class=" token"> </block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">job_list</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">&gt;</block><block class=" token"> </block><block class="number token">0</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">return</block><block class=" token"> job_list</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="string token">"job_id"</block><block class="punctuation token">]</block><block class=" token"> </block><block class="comment token">## return the first matching job</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">else</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="boolean token">None</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">get_job_parameters</block><block class="punctuation token">(</block><block class=" token">job_name</block><block class="punctuation token">,</block><block class=" token"> cluster_id</block><block class="punctuation token">,</block><block class=" token"> notebook_path</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    params </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"name"</block><block class="punctuation token">:</block><block class=" token"> job_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="string token">"tasks"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">{</block><block class="string token">"task_key"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"webhook_task"</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                       </block><block class="string token">"existing_cluster_id"</block><block class="punctuation token">:</block><block class=" token"> cluster_id</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                       </block><block class="string token">"notebook_task"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                           </block><block class="string token">"notebook_path"</block><block class="punctuation token">:</block><block class=" token"> notebook_path</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                       </block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                      </block><block class="punctuation token">}</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> params</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">get_create_parameters</block><block class="punctuation token">(</block><block class=" token">job_name</block><block class="punctuation token">,</block><block class=" token"> cluster_id</block><block class="punctuation token">,</block><block class=" token"> notebook_path</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    api </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">"api/2.1/jobs/create"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> api</block><block class="punctuation token">,</block><block class=" token"> get_job_parameters</block><block class="punctuation token">(</block><block class=" token">job_name</block><block class="punctuation token">,</block><block class=" token"> cluster_id</block><block class="punctuation token">,</block><block class=" token"> notebook_path</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">get_reset_parameters</block><block class="punctuation token">(</block><block class=" token">job_name</block><block class="punctuation token">,</block><block class=" token"> cluster_id</block><block class="punctuation token">,</block><block class=" token"> notebook_path</block><block class="punctuation token">,</block><block class=" token"> job_id</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    api </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">"api/2.1/jobs/reset"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    params </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block><block class="string token">"job_id"</block><block class="punctuation token">:</block><block class=" token"> job_id</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"new_settings"</block><block class="punctuation token">:</block><block class=" token"> get_job_parameters</block><block class="punctuation token">(</block><block class=" token">job_name</block><block class="punctuation token">,</block><block class=" token"> cluster_id</block><block class="punctuation token">,</block><block class=" token"> notebook_path</block><block class="punctuation token">)</block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> api</block><block class="punctuation token">,</block><block class=" token"> params</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">get_webhook_job</block><block class="punctuation token">(</block><block class=" token">instance</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="punctuation token">,</block><block class=" token"> job_name</block><block class="punctuation token">,</block><block class=" token"> cluster_id</block><block class="punctuation token">,</block><block class=" token"> notebook_path</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    job_id </block><block class="operator token">=</block><block class=" token"> find_job_id</block><block class="punctuation token">(</block><block class=" token">instance</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="punctuation token">,</block><block class=" token"> job_name</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> job_id </block><block class="keyword token">is</block><block class=" token"> </block><block class="boolean token">None</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        api</block><block class="punctuation token">,</block><block class=" token"> params </block><block class="operator token">=</block><block class=" token"> get_create_parameters</block><block class="punctuation token">(</block><block class=" token">job_name</block><block class="punctuation token">,</block><block class=" token"> cluster_id</block><block class="punctuation token">,</block><block class=" token"> notebook_path</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">else</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        api</block><block class="punctuation token">,</block><block class=" token"> params </block><block class="operator token">=</block><block class=" token"> get_reset_parameters</block><block class="punctuation token">(</block><block class=" token">job_name</block><block class="punctuation token">,</block><block class=" token"> cluster_id</block><block class="punctuation token">,</block><block class=" token"> notebook_path</block><block class="punctuation token">,</block><block class=" token"> job_id</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    uri </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">instance</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">api</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    res </block><block class="operator token">=</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">post</block><block class="punctuation token">(</block><block class=" token">uri</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="operator token">=</block><block class=" token">headers</block><block class="punctuation token">,</block><block class=" token"> json</block><block class="operator token">=</block><block class=" token">params</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">assert</block><block class=" token"> res</block><block class="punctuation token">.</block><block class=" token">status_code </block><block class="operator token">==</block><block class=" token"> </block><block class="number token">200</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string-interpolation string token">f"Expected an HTTP 200 response, received </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">res</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">status_code</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">; </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">res</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">content</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    job_id </block><block class="operator token">=</block><block class=" token"> res</block><block class="punctuation token">.</block><block class=" token">json</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class="string token">"job_id"</block><block class="punctuation token">,</block><block class=" token"> job_id</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> job_id</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">notebook_path </block><block class="operator token">=</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">utils</block><block class="punctuation token">.</block><block class=" token">databricks_utils</block><block class="punctuation token">.</block><block class=" token">get_notebook_path</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">replace</block><block class="punctuation token">(</block><block class="string token">"03a-Webhooks-and-Testing"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"03b-Webhooks-Job-Demo"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># We can use our utility method for creating a unique </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># database name to help us construct a unique job name.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prefix </block><block class="operator token">=</block><block class=" token"> DA</block><block class="punctuation token">.</block><block class=" token">unique_name</block><block class="punctuation token">(</block><block class="string token">"-"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">job_name </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">prefix</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">_webhook-job"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># if the Job was created via UI, set it here.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">job_id </block><block class="operator token">=</block><block class=" token"> get_webhook_job</block><block class="punctuation token">(</block><block class=" token">instance</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                         headers</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                         job_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                         spark</block><block class="punctuation token">.</block><block class=" token">conf</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class="string token">"spark.databricks.clusterUsageTags.clusterId"</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                         notebook_path</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Job ID:   </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">job_id</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Job name: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">job_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.2548292696319181" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.2548292696319181" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.2.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Review the Job Code</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In this section, we review the codes in the Databricks job notebook for this demo.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The job notebook is intended to be run as a job called by a webhook and therefore receiving an input parameter.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Load the model name. The </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">event_message</block><block> is automatically populated by the webhook.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> json</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">event_message </block><block class="operator token">=</block><block class=" token"> dbutils</block><block class="punctuation token">.</block><block class=" token">widgets</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class="string token">"event_message"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">event_message_dict </block><block class="operator token">=</block><block class=" token"> json</block><block class="punctuation token">.</block><block class=" token">loads</block><block class="punctuation token">(</block><block class=" token">event_message</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_name </block><block class="operator token">=</block><block class=" token"> event_message_dict</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class="string token">"model_name"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">event_message_dict</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">model_name</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Use the model name to get the latest model version.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">tracking </block><block class="keyword token">import</block><block class=" token"> MlflowClient</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client </block><block class="operator token">=</block><block class=" token"> MlflowClient</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">version </block><block class="operator token">=</block><block class=" token"> client</block><block class="punctuation token">.</block><block class=" token">get_registered_model</block><block class="punctuation token">(</block><block class=" token">model_name</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">latest_versions</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class=" token">version</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">version</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Use the model name and version to load a </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">pyfunc</block><block> model of our model in production.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">3. </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> mlflow</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">pyfunc_model </block><block class="operator token">=</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">pyfunc</block><block class="punctuation token">.</block><block class=" token">load_model</block><block class="punctuation token">(</block><block class=" token">model_uri</block><block class="operator token">=</block><block class="string-interpolation string token">f"models:/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">version</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">3. </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Get the input and output schema of our logged model.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">4. </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">input_schema </block><block class="operator token">=</block><block class=" token"> pyfunc_model</block><block class="punctuation token">.</block><block class=" token">metadata</block><block class="punctuation token">.</block><block class=" token">get_input_schema</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">as_spark_schema</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">output_schema </block><block class="operator token">=</block><block class=" token"> pyfunc_model</block><block class="punctuation token">.</block><block class=" token">metadata</block><block class="punctuation token">.</block><block class=" token">get_output_schema</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">as_spark_schema</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">4. </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">5. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Here we define our expected input and output schema.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">5. </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> pyspark</block><block class="punctuation token">.</block><block class=" token">sql</block><block class="punctuation token">.</block><block class=" token">types </block><block class="keyword token">import</block><block class=" token"> StructType</block><block class="punctuation token">,</block><block class=" token"> StructField</block><block class="punctuation token">,</block><block class=" token"> LongType</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">,</block><block class=" token"> IntegerType</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">expected_input_schema </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">StructType</block><block class="punctuation token">(</block><block class="punctuation token">[</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"host_total_listings_count"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"neighbourhood_cleansed"</block><block class="punctuation token">,</block><block class=" token"> IntegerType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"zipcode"</block><block class="punctuation token">,</block><block class=" token"> IntegerType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"latitude"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"longitude"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"property_type"</block><block class="punctuation token">,</block><block class=" token"> IntegerType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"accommodates"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"bathrooms"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"bedrooms"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"beds"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"bed_type"</block><block class="punctuation token">,</block><block class=" token"> IntegerType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"minimum_nights"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"number_of_reviews"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"review_scores_rating"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"review_scores_accuracy"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"review_scores_cleanliness"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"review_scores_checkin"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"review_scores_communication"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"review_scores_location"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    StructField</block><block class="punctuation token">(</block><block class="string token">"review_scores_value"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">     StructField</block><block class="punctuation token">(</block><block class="string token">"room_type"</block><block class="punctuation token">,</block><block class=" token"> IntegerType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">]</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">expected_output_schema </block><block class="operator token">=</block><block class=" token"> StructType</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class=" token">StructField</block><block class="punctuation token">(</block><block class="string token">"price"</block><block class="punctuation token">,</block><block class=" token"> DoubleType</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">)</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">assert</block><block class=" token"> </block><block class="builtin token">sorted</block><block class="punctuation token">(</block><block class=" token">expected_input_schema</block><block class="punctuation token">,</block><block class=" token"> key</block><block class="operator token">=</block><block class="keyword token">lambda</block><block class=" token"> x</block><block class="punctuation token">:</block><block class=" token"> x</block><block class="punctuation token">.</block><block class=" token">name</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">==</block><block class=" token"> </block><block class="builtin token">sorted</block><block class="punctuation token">(</block><block class=" token">input_schema</block><block class="punctuation token">,</block><block class=" token"> key</block><block class="operator token">=</block><block class="keyword token">lambda</block><block class=" token"> x</block><block class="punctuation token">:</block><block class=" token"> x</block><block class="punctuation token">.</block><block class=" token">name</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">assert</block><block class=" token"> </block><block class="builtin token">sorted</block><block class="punctuation token">(</block><block class=" token">expected_output_schema</block><block class="punctuation token">,</block><block class=" token"> key</block><block class="operator token">=</block><block class="keyword token">lambda</block><block class=" token"> x</block><block class="punctuation token">:</block><block class=" token"> x</block><block class="punctuation token">.</block><block class=" token">name</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">==</block><block class=" token"> </block><block class="builtin token">sorted</block><block class="punctuation token">(</block><block class=" token">output_schema</block><block class="punctuation token">,</block><block class=" token"> key</block><block class="operator token">=</block><block class="keyword token">lambda</block><block class=" token"> x</block><block class="punctuation token">:</block><block class=" token"> x</block><block class="punctuation token">.</block><block class=" token">name</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">5. </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">6. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Load the dataset and generate some predictions to ensure our model is working correctly.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">6. </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> pandas </block><block class="keyword token">as</block><block class=" token"> pd</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">df </block><block class="operator token">=</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">read_parquet</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">paths</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">datasets_path</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/airbnb/sf-listings/airbnb-cleaned-mlflow.parquet"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">predictions </block><block class="operator token">=</block><block class=" token"> pyfunc_model</block><block class="punctuation token">.</block><block class=" token">predict</block><block class="punctuation token">(</block><block class=" token">df</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">predictions</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">6. </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">7. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Make sure our prediction types are correct.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">7. </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> numpy </block><block class="keyword token">as</block><block class=" token"> np</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">assert</block><block class=" token"> </block><block class="builtin token">type</block><block class="punctuation token">(</block><block class=" token">predictions</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">==</block><block class=" token"> np</block><block class="punctuation token">.</block><block class=" token">ndarray</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">assert</block><block class=" token"> </block><block class="builtin token">type</block><block class="punctuation token">(</block><block class=" token">predictions</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">==</block><block class=" token"> np</block><block class="punctuation token">.</block><block class=" token">float64</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string token">"All tests passed!"</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.9324798662185614" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.9324798662185614" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.2.4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Create a Job Webhook</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There are a few different events that can trigger a Webhook. Here, </block><block style="text-decoration: underline;">we will be experimenting with triggering a job when our model transitions between stages</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Get it from the Workflow's jobs UI</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">job_id </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">'166193863379691'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> databricks_registry_webhooks </block><block class="keyword token">import</block><block class=" token"> RegistryWebhooksClient</block><block class="punctuation token">,</block><block class=" token"> JobSpec </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">job_spec </block><block class="operator token">=</block><block class=" token"> JobSpec</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    job_id</block><block class="operator token">=</block><block class=" token">job_id</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    workspace_url</block><block class="operator token">=</block><block class=" token">instance</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    access_token</block><block class="operator token">=</block><block class=" token">token </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">job_webhook </block><block class="operator token">=</block><block class=" token"> RegistryWebhooksClient</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">create_webhook</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model_name</block><block class="operator token">=</block><block class=" token">name</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    events</block><block class="operator token">=</block><block class="punctuation token">[</block><block class="string token">"MODEL_VERSION_TRANSITIONED_STAGE"</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    job_spec</block><block class="operator token">=</block><block class=" token">job_spec</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    description</block><block class="operator token">=</block><block class="string token">"Job webhook trigger"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    status</block><block class="operator token">=</block><block class="string token">"ACTIVE"</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Now that we have registered the webhook, </block><block style="text-decoration: underline;">we can test it by transitioning our model from stage </block><block style="text-decoration: underline; font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold;">None</block><block style="text-decoration: underline;"> to </block><block style="text-decoration: underline; font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold;">Staging</block><block style="text-decoration: underline;"> in the Experiment UI</block><block>. </block><block style="text-decoration: underline;">We should see in the Jobs tab that our Job has run</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>To get the active Webhook related to our model, use </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">list_webhooks</block><block> and specify the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">model_name</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">webhooks_list </block><block class="operator token">=</block><block class=" token"> RegistryWebhooksClient</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">list_webhooks</block><block class="punctuation token">(</block><block class=" token">model_name</block><block class="operator token">=</block><block class=" token">name</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">current_job_webhook_id </block><block class="operator token">=</block><block class=" token"> job_webhook</block><block class="punctuation token">.</block><block class="builtin token">id</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">webhooks_list</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Delete the webhook</block><block> by copying the webhook ID to the curl or python request. You can confirm that the Webhook was deleted by using the list request.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">http_webhook </block><block class="operator token">=</block><block class=" token"> RegistryWebhooksClient</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">delete_webhook</block><block class="punctuation token">(</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="builtin token">id</block><block class="operator token">=</block><block class="string token">"&lt;insert your webhook id here&gt;"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">webhooks_list </block><block class="operator token">=</block><block class=" token"> RegistryWebhooksClient</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">list_webhooks</block><block class="punctuation token">(</block><block class=" token">model_name</block><block class="operator token">=</block><block class=" token">name</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">webhooks_list</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/mlflow/model-registry-webhooks.html#examples" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/mlflow/model-registry-webhooks.html#examples" target="_blank" style="color: inherit; text-decoration: inherit;">Databricks documentation for webhooks</a></block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.6466191374168306" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.6466191374168306" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">7. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Deployment</block></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.08949011200488655" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.08949011200488655" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">7.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Deployment Patterns</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Data Science != ML Engineering</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Data science is scientic </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Business problems  data problems </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Model mathematically </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Optimize performance</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>ML engineers are concerned with </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Reliability </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Scalability </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Maintainability </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>SLAs </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>...</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 722.5px; height: 370.23px; position: relative;"><img src="image-resources/cb184f62-544b-4bd2-b09b-ef59779406c3.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 718.5px; height: 354.03px; position: relative;"><img src="image-resources/1b978931-1b16-4092-a788-774e496aad10.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 719px; height: 440.54px; position: relative;"><img src="image-resources/46eae802-5e5a-4d17-98ee-ed1fe004db11.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 726px; height: 350.58px; position: relative;"><img src="image-resources/a81e7605-b855-40c7-9f38-54445d6994a8.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 718.5px; height: 393.16px; position: relative;"><img src="image-resources/cc0973fe-e1ff-49e0-8a08-e20e2db51591.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 747.75px; height: 383.07px; position: relative;"><img src="image-resources/4c3e77e1-606c-4858-9510-ee4e2c7713f4.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 714.75px; height: 411.84px; position: relative;"><img src="image-resources/cfbcb2b3-819e-4862-a6f6-fd44f739a707.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 711.5px; height: 509.28px; position: relative;"><img src="image-resources/a743fc77-c762-4d1e-9bf0-107f6e8f017d.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 707px; height: 503.53px; position: relative;"><img src="image-resources/91c88af4-e8c0-4d59-bfa2-c103669b4705.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 713.75px; height: 381.05px; position: relative;"><img src="image-resources/77abc182-eb2a-4c7a-9162-952d4bb2e181.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 716.5px; height: 439.48px; position: relative;"><img src="image-resources/91658dda-5b14-434c-a16a-7f1d746c6ecf.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 727.25px; height: 435.21px; position: relative;"><img src="image-resources/82b2a6db-8bb2-4023-bd51-ab8eb1147f07.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.11997379479821202" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.11997379479821202" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">7.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Deployment Paradigms</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 699.5px; height: 385.85px; position: relative;"><img src="image-resources/e59c88b5-ab97-4994-ad55-e3c828fb716c.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 702.125px; height: 420.93px; position: relative;"><img src="image-resources/10179ca9-5d09-4cab-8ff4-4e70ccb22486.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 706.5px; height: 313.85px; position: relative;"><img src="image-resources/b37a2da4-fe01-416e-873f-e7a7f99a703d.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 705px; height: 381.88px; position: relative;"><img src="image-resources/1e045407-1a4d-41f5-b21f-181fc68a118b.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 703px; height: 261.93px; position: relative;"><img src="image-resources/d8ad161f-1d56-4fca-8244-6657eee7e52e.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 708.5px; height: 403.71px; position: relative;"><img src="image-resources/9a113080-dede-4d5b-8c66-337b71ff310c.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 712.75px; height: 362.28px; position: relative;"><img src="image-resources/47cb98e0-71f3-4743-b3dd-b63e08a01a3e.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 717.25px; height: 368.32px; position: relative;"><img src="image-resources/803315c3-cc59-48b6-93d3-bb578eeb2436.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.863619984305142" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.863619984305142" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">7.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Batch Deployment</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Batch inference is the </block><block style="text-decoration: underline;">most common way</block><block> of deploying machine learning models.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.8221328526190008" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.8221328526190008" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">7.3.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Inference in Batch</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Batch deployment represents the vast majority of use cases for deploying machine learning models.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This normally means running the predictions from a model and saving them somewhere for later use.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>For live serving, results are often saved to a database that will serve the saved prediction quickly.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In other cases, such as populating emails, they can be stored in less performant data stores such as a blob store.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Writing the results of an inference can be optimized in a number of ways...</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>For large amounts of data, predictions and writes should be performed in parallel.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">The access pattern for the saved predictions should also be kept in mind in how the data is written.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>For static files or data warehouses, partitioning speeds up data reads.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>For databases, indexing the database on the relevant query generally improves performance.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>In either case, the index is working similar to an index in a book: it allows you to skip ahead to the relevant content.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">There are a few other considerations to ensure the accuracy of a model...</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">First is to make sure that the model matches expectations.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block> </block><block style="font-weight: bold; color: rgb(255, 64, 0);">Model drift</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Second is to retrain the model on the majority of your dataset.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Either use the entire dataset for training or around </block><block style="text-decoration: underline; font-weight: bold;">95% of it</block><block>.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: underline;">A train/test split is a good method in tuning hyperparameters and estimating how the model will perform on unseen data</block><block>.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Retraining the model on the majority of the dataset </block><block style="text-decoration: underline;">ensures that you have as much information as possible factored into the model</block><block>.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">It is common to skip the train/test split in training a final model.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.6815142886314369" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.6815142886314369" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">7.3.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Inference in Spark</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Models trained in various machine learning libraries can be applied at scale using Spark. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>To do this, use </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">mlflow.pyfunc.spark_udf</block><block> and pass in the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">SparkSession</block><block>, name of the model, and run id.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: underline;">Using UDF's in Spark means that supporting libraries must be installed on every node in the cluster</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In the case of </block><block style="text-decoration: underline;">sklearn</block><block>, this is installed in Databricks clusters by default. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgb(255, 254, 0);">When using other libraries, you will need to install them to ensure that they will work as UDFs.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Let's start by training an </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">sklearn</block><block> model and apply it using Spark UDF generated by </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">mlflow</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> pandas </block><block class="keyword token">as</block><block class=" token"> pd</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">df </block><block class="operator token">=</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">read_parquet</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">paths</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">datasets_path</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/airbnb/sf-listings/airbnb-cleaned-mlflow.parquet"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">X </block><block class="operator token">=</block><block class=" token"> df</block><block class="punctuation token">.</block><block class=" token">drop</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class="string token">"price"</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> axis</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">y </block><block class="operator token">=</block><block class=" token"> df</block><block class="punctuation token">[</block><block class="string token">"price"</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Train and log the model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">ensemble </block><block class="keyword token">import</block><block class=" token"> RandomForestRegressor</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">metrics </block><block class="keyword token">import</block><block class=" token"> mean_squared_error</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">with</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">start_run</block><block class="punctuation token">(</block><block class=" token">run_name</block><block class="operator token">=</block><block class="string token">"Final RF Model"</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">as</block><block class=" token"> run</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    rf </block><block class="operator token">=</block><block class=" token"> RandomForestRegressor</block><block class="punctuation token">(</block><block class=" token">n_estimators</block><block class="operator token">=</block><block class="number token">100</block><block class="punctuation token">,</block><block class=" token"> max_depth</block><block class="operator token">=</block><block class="number token">5</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    rf</block><block class="punctuation token">.</block><block class=" token">fit</block><block class="punctuation token">(</block><block class=" token">X</block><block class="punctuation token">,</block><block class=" token"> y</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    predictions </block><block class="operator token">=</block><block class=" token"> rf</block><block class="punctuation token">.</block><block class=" token">predict</block><block class="punctuation token">(</block><block class=" token">X</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block><block class="punctuation token">.</block><block class=" token">log_model</block><block class="punctuation token">(</block><block class=" token">rf</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"random_forest_model"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mse </block><block class="operator token">=</block><block class=" token"> mean_squared_error</block><block class="punctuation token">(</block><block class=" token">y</block><block class="punctuation token">,</block><block class=" token"> predictions</block><block class="punctuation token">)</block><block class=" token"> </block><block class="comment token"># This is on the same data the model was trained</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">log_metric</block><block class="punctuation token">(</block><block class="string token">"mse"</block><block class="punctuation token">,</block><block class=" token"> mse</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Create Spakr DataFrame</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">spark_df </block><block class="operator token">=</block><block class=" token"> spark</block><block class="punctuation token">.</block><block class=" token">createDataFrame</block><block class="punctuation token">(</block><block class=" token">X</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># MLflow easily produces a Spark user defined function (UDF). This bridges the gap between Python environments and applying models at scale using Spark.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">predict </block><block class="operator token">=</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">pyfunc</block><block class="punctuation token">.</block><block class=" token">spark_udf</block><block class="punctuation token">(</block><block class=" token">spark</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string-interpolation string token">f"runs:/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">run</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">info</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">run_id</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/random_forest_model"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Apply the model as a standard UDF using the column names as the input to the function.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prediction_df </block><block class="operator token">=</block><block class=" token"> spark_df</block><block class="punctuation token">.</block><block class=" token">withColumn</block><block class="punctuation token">(</block><block class="string token">"prediction"</block><block class="punctuation token">,</block><block class=" token"> predict</block><block class="punctuation token">(</block><block class="operator token">*</block><block class=" token">spark_df</block><block class="punctuation token">.</block><block class=" token">columns</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.16090080787783356" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.16090080787783356" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">7.3.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Write Optimizers</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There are many possible optimizations depending on your batch deployment scenerio. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In Spark and Delta Lake, the following optimizations are possible:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Partitioning:</block><block> stores data associated with different categorical values in different directories.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Z-Ordering:</block><block> colocates related information in the same set of files.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Data Skipping:</block><block> aims at speeding up queries that contain filters (WHERE clauses).</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Partition Pruning:</block><block> speeds up queries by limiting the amount of data read.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Other optimizations include:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Database indexing:</block><block> allows certain table columns to be more effectively queried.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Geo-replication:</block><block> replicates data in different geographical regions.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Partition by neighborhood</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">dbutils</block><block class="punctuation token">.</block><block class=" token">fs</block><block class="punctuation token">.</block><block class=" token">rm</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">paths</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">working_dir</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/batch-predictions-partitioned.delta"</block><block class="punctuation token">,</block><block class=" token"> recurse</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">delta_partitioned_path </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">paths</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">working_dir</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/batch-predictions-partitioned.delta"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">prediction_df</block><block class="punctuation token">.</block><block class=" token">write</block><block class="punctuation token">.</block><block class=" token">partitionBy</block><block class="punctuation token">(</block><block class="string token">"neighbourhood_cleansed"</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">mode</block><block class="punctuation token">(</block><block class="string token">"OVERWRITE"</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class="builtin token">format</block><block class="punctuation token">(</block><block class="string token">"delta"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">.</block><block class=" token">save</block><block class="punctuation token">(</block><block class=" token">delta_partitioned_path</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Take a look at the files</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">display</block><block class="punctuation token">(</block><block class=" token">dbutils</block><block class="punctuation token">.</block><block class=" token">fs</block><block class="punctuation token">.</block><block class=" token">ls</block><block class="punctuation token">(</block><block class=" token">delta_partitioned_path</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Z-Ordering is a form of multi-dimensional clustering that colocates related information in the same set of files. It reduces the amount of data that needs to be read. You can read more about it here -&gt; "https://docs.databricks.com/delta/optimizations/file-mgmt.html#z-ordering-multi-dimensional-clustering". </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Let's z-order by zipcode.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">spark</block><block class="punctuation token">.</block><block class=" token">sql</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"OPTIMIZE delta.`</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">delta_partitioned_path</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">` ZORDER BY (zipcode)"</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.6023371476204555" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.6023371476204555" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">7.3.4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Feature Store Batch Scoring</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Create feature table</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Read dataframe from the csv file with spark directly to track data source in Feature Store</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> databricks </block><block class="keyword token">import</block><block class=" token"> feature_store</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> databricks</block><block class="punctuation token">.</block><block class=" token">feature_store </block><block class="keyword token">import</block><block class=" token"> feature_table</block><block class="punctuation token">,</block><block class=" token">FeatureLookup</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">## create a feature store client</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">fs </block><block class="operator token">=</block><block class=" token"> feature_store</block><block class="punctuation token">.</block><block class=" token">FeatureStoreClient</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> pyspark</block><block class="punctuation token">.</block><block class=" token">sql</block><block class="punctuation token">.</block><block class=" token">functions </block><block class="keyword token">import</block><block class=" token"> monotonically_increasing_id</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">## build feature dataframe, add index column and drop label</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">df </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">spark</block><block class="punctuation token">.</block><block class=" token">read</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">           </block><block class="punctuation token">.</block><block class=" token">csv</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">paths</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">datasets</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/airbnb/sf-listings/airbnb-cleaned-mlflow.csv"</block><block class="punctuation token">,</block><block class=" token"> header</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">,</block><block class=" token"> inferSchema</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">           </block><block class="punctuation token">.</block><block class=" token">withColumn</block><block class="punctuation token">(</block><block class="string token">"index"</block><block class="punctuation token">,</block><block class=" token"> monotonically_increasing_id</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">## feature data - all the columns except for the true label</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">features_df </block><block class="operator token">=</block><block class=" token"> df</block><block class="punctuation token">.</block><block class=" token">drop</block><block class="punctuation token">(</block><block class="string token">"price"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">## inference data - contains only index and label columns, if you have online features, it should be added to inference_df as well</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">inference_df </block><block class="operator token">=</block><block class=" token"> df</block><block class="punctuation token">.</block><block class=" token">select</block><block class="punctuation token">(</block><block class="string token">"index"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"price"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Declare a fully-qualified, unique table name.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># In DBR 10.5+, we can drop Feature Store tables, but for now we need a uniuqe name in case we re-run this notebook.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">feature_table_name </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">schema_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">.airbnb_fs"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Table: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">feature_table_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">\n"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># create feature table</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">result </block><block class="operator token">=</block><block class=" token"> fs</block><block class="punctuation token">.</block><block class=" token">create_table</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="operator token">=</block><block class=" token">feature_table_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    primary_keys</block><block class="operator token">=</block><block class="punctuation token">[</block><block class="string token">"index"</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    df</block><block class="operator token">=</block><block class=" token">features_df</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    description</block><block class="operator token">=</block><block class="string token">"review cols of Airbnb data"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Create training set from feature store using fs.create_training_set</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">## FeatureLoopup object</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">#feature_lookups = [FeatureLookup(feature_table_name, f, "index") for f in features_df.columns if f!="index"] ## exclude index colum</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">## uncomment the command below to create lookup features if using Runtime 9.1 ML</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">feature_lookups </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class=" token">FeatureLookup</block><block class="punctuation token">(</block><block class=" token">table_name </block><block class="operator token">=</block><block class=" token"> feature_table_name</block><block class="punctuation token">,</block><block class=" token"> feature_names </block><block class="operator token">=</block><block class=" token"> </block><block class="boolean token">None</block><block class="punctuation token">,</block><block class=" token"> lookup_key </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">"index"</block><block class="punctuation token">)</block><block class=" token"> </block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">## fs.create_training_set will look up features in model_feature_lookups with matched key from inference_data_df</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">training_set </block><block class="operator token">=</block><block class=" token"> fs</block><block class="punctuation token">.</block><block class=" token">create_training_set</block><block class="punctuation token">(</block><block class=" token">inference_df</block><block class="punctuation token">,</block><block class=" token"> feature_lookups</block><block class="punctuation token">,</block><block class=" token"> label</block><block class="operator token">=</block><block class="string token">"price"</block><block class="punctuation token">,</block><block class=" token"> exclude_columns</block><block class="operator token">=</block><block class="string token">"index"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Log a feature store packaged model.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># We need a unique model name and we can use our unique database name to construct it.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">suffix </block><block class="operator token">=</block><block class=" token"> DA</block><block class="punctuation token">.</block><block class=" token">unique_name</block><block class="punctuation token">(</block><block class="string token">"-"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_name </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"airbnb-fs-model_</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">suffix</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Model Name: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">models</block><block class="punctuation token">.</block><block class=" token">signature </block><block class="keyword token">import</block><block class=" token"> infer_signature</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">## log RF model as a feature store packaged model and register the packaged model in model registry as `model_name`</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">fs</block><block class="punctuation token">.</block><block class=" token">log_model</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model</block><block class="operator token">=</block><block class=" token">rf</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    artifact_path</block><block class="operator token">=</block><block class="string token">"feature_store_model"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    flavor</block><block class="operator token">=</block><block class=" token">mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    training_set</block><block class="operator token">=</block><block class=" token">training_set</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    registered_model_name</block><block class="operator token">=</block><block class=" token">model_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    input_example</block><block class="operator token">=</block><block class=" token">X</block><block class="punctuation token">[</block><block class="punctuation token">:</block><block class="number token">5</block><block class="punctuation token">]</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    signature</block><block class="operator token">=</block><block class=" token">infer_signature</block><block class="punctuation token">(</block><block class=" token">X</block><block class="punctuation token">,</block><block class=" token"> y</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">View the model in the Model Registry UI.</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 724px; height: 345.4px; position: relative;"><img src="image-resources/c2021830-fe6c-4884-b2b5-254da9482d1f.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">You can also find the registered model on the Feature Store UI.</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 716px; height: 483.5px; position: relative;"><img src="image-resources/9e8b854a-8ea7-4d97-81cc-c84ecb874e3f.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Let's now perform batch scoring with the feature store model.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token">## for simplicity sake, we will just predict on the same inference_data_df</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">batch_input_df </block><block class="operator token">=</block><block class=" token"> inference_df</block><block class="punctuation token">.</block><block class=" token">drop</block><block class="punctuation token">(</block><block class="string token">"price"</block><block class="punctuation token">)</block><block class=" token"> </block><block class="comment token">#exclude true label</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">with_predictions </block><block class="operator token">=</block><block class=" token"> fs</block><block class="punctuation token">.</block><block class=" token">score_batch</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"models:/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/1"</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                                  batch_input_df</block><block class="punctuation token">,</block><block class=" token"> result_type</block><block class="operator token">=</block><block class="string token">'double'</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">display</block><block class="punctuation token">(</block><block class=" token">with_predictions</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> What are the main considerations in batch deployments?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> The following considerations help determine the best way to deploy batch inference results:</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>How the data will be queried</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>How the data will be written</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>The training and deployment environment</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>What data the final model is trained on</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">* </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> How can you optimize inference reads and writes?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> Writes can be optimized by managing parallelism. In Spark, this would mean managing the partitions of a DataFrame such that work is evenly distributed and you have the most efficient connections back to the target database.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.281338563937128" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.281338563937128" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">7.4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Real-Time Deployment</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>While real time deployment represents a smaller share of the deployment landscape, </block><block style="text-decoration: underline;">many of these deployments represent high value tasks</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Note:</block><block> You need </block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/applications/mlflow/model-serving.html#requirements" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/applications/mlflow/model-serving.html#requirements" target="_blank" style="color: inherit; text-decoration: inherit;">cluster creation</a></block><block> permissions to create a model serving endpoint.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.030406830091177284" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.030406830091177284" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">7.4.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Real-Time Inference</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Real time inference is...</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Generating predictions for a small number of records with fast results</block><block> (e.g. results in </block><block style="text-decoration: underline;">milliseconds</block><block>)</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The first question to ask when considering real time deployment is: </block><block style="font-weight: bold;">do I need it?</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>It represents a minority of machine learning inference use cases  </block><block style="text-decoration: underline; background-color: rgb(255, 254, 0);">it's necessary when features are only available at the time of serving</block><block>.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Is one of the more complicated ways of deploying models.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>That being said, domains where real time deployment is often needed </block><block style="text-decoration: underline;">are often of great business value</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Domains needing real time deployment include...</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Financial services (especially with fraud detection)</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Mobile</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Ad tech</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">There are a number of ways of deploying models...</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Many use </block><block style="background-color: rgb(255, 254, 0);">REST</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: underline;">For </block><block style="text-decoration: underline; font-weight: bold;">basic prototypes</block><block style="text-decoration: underline;">, MLflow can act as a development deployment server</block><block>.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>The MLflow implementation is backed by the Python library </block><block style="text-decoration: underline;">Flask</block><block>.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>This is </block><block style="text-decoration: underline;">not intended for production environments</block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In addition, Databricks offers a managed </block><block style="font-weight: bold; color: rgb(255, 64, 0);">MLflow Model Serving</block><block> solution. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This solution allows you to host machine learning models from </block><block style="font-weight: bold;">Model Registry</block><block> as </block><block style="font-weight: bold;">REST</block><block> endpoints that are automatically updated based on the availability of model versions and their stages.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">For production RESTful deployment</block><block>, there are two main options...</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">A managed solution</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Azure ML</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>SageMaker (AWS)</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>VertexAI (GCP)</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">A custom solution</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Involve deployments using a range of tools</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Often using </block><block style="font-weight: bold;">Docker</block><block> or </block><block style="font-weight: bold;">Kubernetes</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>One of the crucial elements of deployment in </block><block style="font-weight: bold; background-color: rgb(255, 254, 0);">containerization</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Software is packaged and isolated with its own application, tools, and libraries.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Containers are a more lightweight alternative to virtual machines.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Finally, </block><block style="font-weight: bold;">embedded solutions</block><block> are another way of deploying machine learning models, such as storing a model on IoT devices for inference.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> mlflow</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">pyfunc</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">models</block><block class="punctuation token">.</block><block class=" token">signature </block><block class="keyword token">import</block><block class=" token"> infer_signature</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> pandas </block><block class="keyword token">as</block><block class=" token"> pd</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">TestModel</block><block class="punctuation token">(</block><block class=" token">mlflow</block><block class="punctuation token">.</block><block class=" token">pyfunc</block><block class="punctuation token">.</block><block class=" token">PythonModel</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">predict</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">,</block><block class=" token"> context</block><block class="punctuation token">,</block><block class=" token"> input_df</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">return</block><block class=" token"> </block><block class="number token">5</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_run_name</block><block class="operator token">=</block><block class="string token">"pyfunc-model"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">with</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">start_run</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">as</block><block class=" token"> run</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model </block><block class="operator token">=</block><block class=" token"> TestModel</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">pyfunc</block><block class="punctuation token">.</block><block class=" token">log_model</block><block class="punctuation token">(</block><block class=" token">artifact_path</block><block class="operator token">=</block><block class=" token">model_run_name</block><block class="punctuation token">,</block><block class=" token"> python_model</block><block class="operator token">=</block><block class=" token">model</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    model_uri </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"runs:/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">run</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">info</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">run_id</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_run_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There are a </block><block style="font-weight: bold; background-color: rgb(255, 254, 0);">few ways to send requests to the development server for testing purpose</block><block>:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Using </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">click</block><block> library</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>using MLflow Model Serving API</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>through CLI using </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">mlflow models serve</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Here, we are going to see how to use both the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">click</block><block> library and </block><block style="font-weight: bold;">MLflow Model Serving API</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Note:</block><block> This is just to demonstrate how a basic development server works. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This design pattern (which hosts a server on the driver of your Spark cluster) is </block><block style="text-decoration: underline;">not recommended for production</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block> Models can be served in this way in other languages as well.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.1951110625130037" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.1951110625130037" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">7.4.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Method 1: Using </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace;">click</block><block> Library</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> time</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> multiprocessing </block><block class="keyword token">import</block><block class=" token"> Process</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">server_port_number </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">6501</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">host_name </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">"127.0.0.1"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">run_server</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">try</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">import</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">models</block><block class="punctuation token">.</block><block class=" token">cli</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">from</block><block class=" token"> click</block><block class="punctuation token">.</block><block class=" token">testing </block><block class="keyword token">import</block><block class=" token"> CliRunner</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        CliRunner</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">invoke</block><block class="punctuation token">(</block><block class=" token">mlflow</block><block class="punctuation token">.</block><block class=" token">models</block><block class="punctuation token">.</block><block class=" token">cli</block><block class="punctuation token">.</block><block class=" token">commands</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                         </block><block class="punctuation token">[</block><block class="string token">"serve"</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                          </block><block class="string token">"--model-uri"</block><block class="punctuation token">,</block><block class=" token"> model_uri</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                          </block><block class="string token">"-p"</block><block class="punctuation token">,</block><block class=" token"> server_port_number</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                          </block><block class="string token">"-w"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">4</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                          </block><block class="string token">"--host"</block><block class="punctuation token">,</block><block class=" token"> host_name</block><block class="punctuation token">,</block><block class=" token"> </block><block class="comment token"># "127.0.0.1", </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                          </block><block class="string token">"--no-conda"</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">except</block><block class=" token"> Exception </block><block class="keyword token">as</block><block class=" token"> e</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">e</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">p </block><block class="operator token">=</block><block class=" token"> Process</block><block class="punctuation token">(</block><block class=" token">target</block><block class="operator token">=</block><block class=" token">run_server</block><block class="punctuation token">)</block><block class=" token"> </block><block class="comment token"># Create a background process</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">p</block><block class="punctuation token">.</block><block class=" token">start</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class=" token">                      </block><block class="comment token"># Start the process</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">time</block><block class="punctuation token">.</block><block class=" token">sleep</block><block class="punctuation token">(</block><block class="number token">5</block><block class="punctuation token">)</block><block class=" token">                  </block><block class="comment token"># Give it 5 seconds to startup</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">p</block><block class="punctuation token">)</block><block class=" token">                       </block><block class="comment token"># Print its status to ensure it's runnning</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Create an input for our REST input</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> json</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">input_json0 </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block><block class="string token">"dataframe_split"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">{</block><block class="string token">"index"</block><block class="punctuation token">:</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"columns"</block><block class="punctuation token">:</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"data"</block><block class="punctuation token">:</block><block class="punctuation token">[</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">]</block><block class="punctuation token">}</block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">input_json </block><block class="operator token">=</block><block class=" token"> json</block><block class="punctuation token">.</block><block class=" token">dumps</block><block class="punctuation token">(</block><block class=" token">input_json0</block><block class="punctuation token">,</block><block class=" token"> indent</block><block class="operator token">=</block><block class="number token">4</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">input_json</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Perform a POST request against the endpoint</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> requests</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">exceptions </block><block class="keyword token">import</block><block class=" token"> ConnectionError</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> time </block><block class="keyword token">import</block><block class=" token"> sleep</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">headers </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block><block class="string token">"Content-type"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"application/json"</block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">url </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"http://</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">host_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">:</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">server_port_number</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/invocations"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">try</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    response </block><block class="operator token">=</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">post</block><block class="punctuation token">(</block><block class=" token">url</block><block class="operator token">=</block><block class=" token">url</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="operator token">=</block><block class=" token">headers</block><block class="punctuation token">,</block><block class=" token"> data</block><block class="operator token">=</block><block class=" token">input_json</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">except</block><block class=" token"> ConnectionError</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string token">"Connection fails on a Run All.  Sleeping and will try again momentarily..."</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    sleep</block><block class="punctuation token">(</block><block class="number token">5</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    response </block><block class="operator token">=</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">post</block><block class="punctuation token">(</block><block class=" token">url</block><block class="operator token">=</block><block class=" token">url</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="operator token">=</block><block class=" token">headers</block><block class="punctuation token">,</block><block class=" token"> data</block><block class="operator token">=</block><block class=" token">input_json</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Status: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">response</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">status_code</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Value:  </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">response</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">text</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Do the same in bash.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">%sh </block><block class="punctuation token">(</block><block class=" token">echo -n </block><block class="string token">'{"dataframe_split": {"index": [0], "columns": [0], "data": [[0]]}}'</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">|</block><block class=" token"> </block><block class="function token">curl</block><block class=" token"> -H </block><block class="string token">"Content-Type: application/json"</block><block class=" token"> -d @- http://127.0.0.1:6501/invocations</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.15864167933976425" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.15864167933976425" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">7.4.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Method 2: MLflow Model Serving</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Step 1</block><block>  We first need to register the model in MLflow Model Registry and load the model. At this step, we don't specify the model stage, so that the stage version would be </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">None</block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>You can refer to the MLflow documentation </block><block class="role-hyper-link" data-hyper-link-url="https://www.mlflow.org/docs/latest/model-registry.html#api-workflow" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.mlflow.org/docs/latest/model-registry.html#api-workflow" target="_blank" style="color: inherit; text-decoration: inherit;">here</a></block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Train a model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">ensemble </block><block class="keyword token">import</block><block class=" token"> RandomForestRegressor</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> sklearn</block><block class="punctuation token">.</block><block class=" token">model_selection </block><block class="keyword token">import</block><block class=" token"> train_test_split</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">models</block><block class="punctuation token">.</block><block class=" token">signature </block><block class="keyword token">import</block><block class=" token"> infer_signature</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">suffix </block><block class="operator token">=</block><block class=" token"> DA</block><block class="punctuation token">.</block><block class=" token">unique_name</block><block class="punctuation token">(</block><block class="string token">"-"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_name </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"demo-model_</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">suffix</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">df </block><block class="operator token">=</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">read_parquet</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">paths</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">datasets_path</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/airbnb/sf-listings/airbnb-cleaned-mlflow.parquet"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> X_test</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">,</block><block class=" token"> y_test </block><block class="operator token">=</block><block class=" token"> train_test_split</block><block class="punctuation token">(</block><block class=" token">df</block><block class="punctuation token">.</block><block class=" token">drop</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class="string token">"price"</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> axis</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> df</block><block class="punctuation token">[</block><block class="string token">"price"</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> random_state</block><block class="operator token">=</block><block class="number token">42</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">rf </block><block class="operator token">=</block><block class=" token"> RandomForestRegressor</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">rf</block><block class="punctuation token">.</block><block class=" token">fit</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> y_train</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">input_example </block><block class="operator token">=</block><block class=" token"> X_train</block><block class="punctuation token">.</block><block class=" token">head</block><block class="punctuation token">(</block><block class="number token">3</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">signature </block><block class="operator token">=</block><block class=" token"> infer_signature</block><block class="punctuation token">(</block><block class=" token">X_train</block><block class="punctuation token">,</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">DataFrame</block><block class="punctuation token">(</block><block class=" token">y_train</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">with</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">start_run</block><block class="punctuation token">(</block><block class=" token">run_name</block><block class="operator token">=</block><block class="string token">"RF Model"</block><block class="punctuation token">)</block><block class=" token"> </block><block class="keyword token">as</block><block class=" token"> run</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    mlflow</block><block class="punctuation token">.</block><block class=" token">sklearn</block><block class="punctuation token">.</block><block class=" token">log_model</block><block class="punctuation token">(</block><block class=" token">rf</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                             </block><block class="string token">"model"</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                             input_example</block><block class="operator token">=</block><block class=" token">input_example</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                             signature</block><block class="operator token">=</block><block class=" token">signature</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                             registered_model_name</block><block class="operator token">=</block><block class=" token">model_name</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                             extra_pip_requirements</block><block class="operator token">=</block><block class="punctuation token">[</block><block class="string token">"mlflow==2.*"</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                            </block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Step 2</block><block>  Run Tests Against Registered Model.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">time</block><block class="punctuation token">.</block><block class=" token">sleep</block><block class="punctuation token">(</block><block class="number token">10</block><block class="punctuation token">)</block><block class=" token"> </block><block class="comment token"># to wait for registration to complete</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_version_uri </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"models:/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/1"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Loading registered model version from URI: '</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_version_uri</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">'"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_version_1 </block><block class="operator token">=</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">pyfunc</block><block class="punctuation token">.</block><block class=" token">load_model</block><block class="punctuation token">(</block><block class=" token">model_version_uri</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Enable model inference via API call:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>After calling </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">log_model</block><block>, a new version of the model is saved. To provision a serving endpoint, follow the steps below.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Click </block><block style="font-weight: bold;">Serving</block><block> in the left sidebar. If you don't see it, switch to the Machine Learning Persona (</block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/workspace/index.html#use-the-sidebar" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/workspace/index.html#use-the-sidebar" target="_blank" style="color: inherit; text-decoration: inherit;">AWS</a></block><block>|</block><block class="role-hyper-link" data-hyper-link-url="https://docs.microsoft.com/azure/databricks//workspace/index#use-the-sidebar" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.microsoft.com/azure/databricks//workspace/index#use-the-sidebar" target="_blank" style="color: inherit; text-decoration: inherit;">Azure</a></block><block>).</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Enable serving for your model. See the Databricks documentation for details (</block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/machine-learning/model-inference/serverless/create-manage-serverless-endpoints.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/machine-learning/model-inference/serverless/create-manage-serverless-endpoints.html" target="_blank" style="color: inherit; text-decoration: inherit;">AWS</a></block><block>|</block><block class="role-hyper-link" data-hyper-link-url="https://learn.microsoft.com/en-us/azure/databricks/machine-learning/model-inference/serverless/create-manage-serverless-endpoints" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://learn.microsoft.com/en-us/azure/databricks/machine-learning/model-inference/serverless/create-manage-serverless-endpoints" target="_blank" style="color: inherit; text-decoration: inherit;">Azure</a></block><block>).</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The code below automatically creates a model serving endpoint.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> mlflow</block><block class="punctuation token">.</block><block class=" token">tracking</block><block class="punctuation token">.</block><block class=" token">client </block><block class="keyword token">import</block><block class=" token"> MlflowClient</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">model_serving_endpoint_name </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">"endpoint-"</block><block class=" token"> </block><block class="operator token">+</block><block class=" token"> model_name </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Provide both a token for the API, which can be obtained from the notebook.</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">token </block><block class="operator token">=</block><block class=" token"> dbutils</block><block class="punctuation token">.</block><block class=" token">notebook</block><block class="punctuation token">.</block><block class=" token">entry_point</block><block class="punctuation token">.</block><block class=" token">getDbutils</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">notebook</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">getContext</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">apiToken</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">getOrElse</block><block class="punctuation token">(</block><block class="boolean token">None</block><block class="punctuation token">)</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># With the token, we can create our authorization header for our subsequent REST calls</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">headers </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"Authorization"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string-interpolation string token">f"Bearer </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">token</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"Content-Type"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"application/json"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">workspace_domain </block><block class="operator token">=</block><block class=" token"> sc</block><block class="punctuation token">.</block><block class=" token">getConf</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class="string token">"spark.databricks.workspaceUrl"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">api_url </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"https://</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">workspace_domain</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/api/2.0/serving-endpoints"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"API URL: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">api_url</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">get_latest_model_version</block><block class="punctuation token">(</block><block class=" token">model_name</block><block class="punctuation token">:</block><block class=" token"> </block><block class="builtin token">str</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    client </block><block class="operator token">=</block><block class=" token"> MlflowClient</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    models </block><block class="operator token">=</block><block class=" token"> client</block><block class="punctuation token">.</block><block class=" token">get_latest_versions</block><block class="punctuation token">(</block><block class=" token">model_name</block><block class="punctuation token">,</block><block class=" token"> stages</block><block class="operator token">=</block><block class="punctuation token">[</block><block class="string token">"None"</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">for</block><block class=" token"> m </block><block class="keyword token">in</block><block class=" token"> models</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        new_model_version </block><block class="operator token">=</block><block class=" token"> m</block><block class="punctuation token">.</block><block class=" token">version</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> new_model_version</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Set up configurations for Serverless model serving endpoint:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Create the serving endpooint if it does not exist yet.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Or update the configuration of the model serving endpoint if it already exists.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>It may take a couple of minutes doe the endpoint and model to be ready.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">my_json </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"name"</block><block class="punctuation token">:</block><block class=" token"> model_serving_endpoint_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="string token">"config"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">{</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="string token">"served_models"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="punctuation token">[</block><block class="punctuation token">{</block><block class="string token">"model_name"</block><block class="punctuation token">:</block><block class=" token"> model_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                           </block><block class="string token">"model_version"</block><block class="punctuation token">:</block><block class=" token"> get_latest_model_version</block><block class="punctuation token">(</block><block class=" token">model_name</block><block class="operator token">=</block><block class=" token">model_name</block><block class="punctuation token">)</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                           </block><block class="string token">"workload_size"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="string token">"Small"</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                           </block><block class="string token">"scale_to_zero_enabled"</block><block class="punctuation token">:</block><block class=" token"> </block><block class="boolean token">True</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                          </block><block class="punctuation token">}</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">create_endpoint</block><block class="punctuation token">(</block><block class=" token">model_serving_endpoint_name</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># get endpoint status</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    r </block><block class="operator token">=</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">api_url</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_serving_endpoint_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="operator token">=</block><block class=" token">headers</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> </block><block class="string token">"RESOURCE_DOES_NOT_EXIST"</block><block class=" token"> </block><block class="keyword token">in</block><block class=" token"> r</block><block class="punctuation token">.</block><block class=" token">text</block><block class="punctuation token">:</block><block class=" token">  </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Creating this new endpoint: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">api_url</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_serving_endpoint_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/invocations"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        re </block><block class="operator token">=</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">post</block><block class="punctuation token">(</block><block class=" token">api_url</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="operator token">=</block><block class=" token">headers</block><block class="punctuation token">,</block><block class=" token"> json</block><block class="operator token">=</block><block class=" token">my_json</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">   </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">else</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        new_model_version </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">my_json</block><block class="punctuation token">[</block><block class="string token">'config'</block><block class="punctuation token">]</block><block class="punctuation token">)</block><block class="punctuation token">[</block><block class="string token">'served_models'</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">[</block><block class="string token">'model_version'</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"This endpoint existed previously! We are updating it to a new config with a new model version: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">new_model_version</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="comment token"># update config</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        re </block><block class="operator token">=</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">put</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">api_url</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_serving_endpoint_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/config"</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="operator token">=</block><block class=" token">headers</block><block class="punctuation token">,</block><block class=" token"> json</block><block class="operator token">=</block><block class=" token">my_json</block><block class="punctuation token">[</block><block class="string token">'config'</block><block class="punctuation token">]</block><block class="punctuation token">)</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="comment token"># wait until new config file in place</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        retry </block><block class="operator token">=</block><block class=" token"> </block><block class="boolean token">True</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        total_wait </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">0</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">while</block><block class=" token"> retry</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            r </block><block class="operator token">=</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">api_url</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_serving_endpoint_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="operator token">=</block><block class=" token">headers</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">assert</block><block class=" token"> r</block><block class="punctuation token">.</block><block class=" token">status_code </block><block class="operator token">==</block><block class=" token"> </block><block class="number token">200</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string-interpolation string token">f"Expected an HTTP 200 response when accessing endpoint info, received </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">r</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">status_code</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            endpoint </block><block class="operator token">=</block><block class=" token"> json</block><block class="punctuation token">.</block><block class=" token">loads</block><block class="punctuation token">(</block><block class=" token">r</block><block class="punctuation token">.</block><block class=" token">text</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">if</block><block class=" token"> </block><block class="string token">"pending_config"</block><block class=" token"> </block><block class="keyword token">in</block><block class=" token"> endpoint</block><block class="punctuation token">.</block><block class=" token">keys</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                seconds </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">10</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string token">"\nNew config still pending"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                </block><block class="keyword token">if</block><block class=" token"> total_wait </block><block class="operator token">&lt;</block><block class=" token"> </block><block class="number token">6000</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                    </block><block class="comment token">#if less than 10 mins, keep waiting</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                    </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Wait for </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">seconds</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token"> seconds"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                    </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Total waiting time so far: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">total_wait</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token"> seconds"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                    time</block><block class="punctuation token">.</block><block class=" token">sleep</block><block class="punctuation token">(</block><block class=" token">seconds</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                    total_wait </block><block class="operator token">+=</block><block class=" token"> seconds</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                </block><block class="keyword token">else</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                    </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Stopping,  waited for </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">total_wait</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token"> seconds"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                    retry </block><block class="operator token">=</block><block class=" token"> </block><block class="boolean token">False</block><block class=" token">  </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">else</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string token">"New config in place now!"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                retry </block><block class="operator token">=</block><block class=" token"> </block><block class="boolean token">False</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">assert</block><block class=" token"> re</block><block class="punctuation token">.</block><block class=" token">status_code </block><block class="operator token">==</block><block class=" token"> </block><block class="number token">200</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string-interpolation string token">f"Expected an HTTP 200 response, received </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">re</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">status_code</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">create_endpoint</block><block class="punctuation token">(</block><block class=" token">model_serving_endpoint_name</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Define a </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">wait_for_endpoint()</block><block> function.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">wait_for_endpoint</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">while</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        response </block><block class="operator token">=</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">api_url</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_serving_endpoint_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="operator token">=</block><block class=" token">headers</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">assert</block><block class=" token"> response</block><block class="punctuation token">.</block><block class=" token">status_code </block><block class="operator token">==</block><block class=" token"> </block><block class="number token">200</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string-interpolation string token">f"Expected an HTTP 200 response, received </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">response</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">status_code</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">\n</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">response</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">text</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        status </block><block class="operator token">=</block><block class=" token"> response</block><block class="punctuation token">.</block><block class=" token">json</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class="string token">"state"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="punctuation token">{</block><block class="punctuation token">}</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">get</block><block class="punctuation token">(</block><block class="string token">"ready"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="punctuation token">{</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">       </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">if</block><block class=" token"> status </block><block class="operator token">==</block><block class=" token"> </block><block class="string token">"READY"</block><block class="punctuation token">:</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">status</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"-"</block><block class="operator token">*</block><block class="number token">80</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">return</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">else</block><block class="punctuation token">:</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Endpoint not ready (</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">status</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">), waiting 10 seconds"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            time</block><block class="punctuation token">.</block><block class=" token">sleep</block><block class="punctuation token">(</block><block class="number token">10</block><block class="punctuation token">)</block><block class=" token"> </block><block class="comment token"># Wait 10 seconds</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">wait_for_endpoint</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Give the system just a couple extra seconds to transition</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">time</block><block class="punctuation token">.</block><block class=" token">sleep</block><block class="punctuation token">(</block><block class="number token">5</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Define the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">score_model()</block><block> function.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">score_model</block><block class="punctuation token">(</block><block class=" token">dataset</block><block class="punctuation token">:</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">DataFrame</block><block class="punctuation token">,</block><block class=" token"> timeout_sec</block><block class="operator token">=</block><block class="number token">300</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    start </block><block class="operator token">=</block><block class=" token"> </block><block class="builtin token">int</block><block class="punctuation token">(</block><block class=" token">time</block><block class="punctuation token">.</block><block class=" token">time</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    serving_url </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"https://</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">workspace_domain</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/serving-endpoints/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_serving_endpoint_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/invocations"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Scoring </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token"> at </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">serving_url</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    data_json </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">{</block><block class="string token">"dataframe_split"</block><block class="punctuation token">:</block><block class=" token"> dataset</block><block class="punctuation token">.</block><block class=" token">to_dict</block><block class="punctuation token">(</block><block class=" token">orient</block><block class="operator token">=</block><block class="string token">"split"</block><block class="punctuation token">)</block><block class="punctuation token">}</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">while</block><block class=" token"> </block><block class="boolean token">True</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        response </block><block class="operator token">=</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">request</block><block class="punctuation token">(</block><block class=" token">method</block><block class="operator token">=</block><block class="string token">"POST"</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="operator token">=</block><block class=" token">headers</block><block class="punctuation token">,</block><block class=" token"> url</block><block class="operator token">=</block><block class=" token">serving_url</block><block class="punctuation token">,</block><block class=" token"> json</block><block class="operator token">=</block><block class=" token">data_json</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        elapsed </block><block class="operator token">=</block><block class=" token"> </block><block class="builtin token">int</block><block class="punctuation token">(</block><block class=" token">time</block><block class="punctuation token">.</block><block class=" token">time</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">-</block><block class=" token"> start</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">if</block><block class=" token"> response</block><block class="punctuation token">.</block><block class=" token">status_code </block><block class="operator token">==</block><block class=" token"> </block><block class="number token">200</block><block class="punctuation token">:</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">return</block><block class=" token"> response</block><block class="punctuation token">.</block><block class=" token">json</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">elif</block><block class=" token"> elapsed </block><block class="operator token">&gt;</block><block class=" token"> timeout_sec</block><block class="punctuation token">:</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">raise</block><block class=" token"> Exception</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Endpoint was not ready after </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">timeout_sec</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token"> seconds"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">elif</block><block class=" token"> response</block><block class="punctuation token">.</block><block class=" token">status_code </block><block class="keyword token">in</block><block class=" token"> </block><block class="punctuation token">[</block><block class="number token">404</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">503</block><block class="punctuation token">]</block><block class="punctuation token">:</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string token">"Temporarily unavailable, retry in 5"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            time</block><block class="punctuation token">.</block><block class=" token">sleep</block><block class="punctuation token">(</block><block class="number token">5</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">else</block><block class="punctuation token">:</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">raise</block><block class=" token"> Exception</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Request failed with status </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">response</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">status_code</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">, </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">response</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">text</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Now that the model serving cluster is in the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">ready</block><block> state, you can send requests to the REST endpoint.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">results </block><block class="operator token">=</block><block class=" token"> score_model</block><block class="punctuation token">(</block><block class=" token">X_test</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">json</block><block class="punctuation token">.</block><block class=" token">dumps</block><block class="punctuation token">(</block><block class=" token">results</block><block class="punctuation token">,</block><block class=" token"> indent</block><block class="operator token">=</block><block class="number token">4</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>You can also optionally transition the model to the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">Staging</block><block> or </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">Production</block><block> stage, using </block><block class="role-hyper-link" data-hyper-link-url="https://www.mlflow.org/docs/latest/model-registry.html#transitioning-an-mlflow-models-stage" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.mlflow.org/docs/latest/model-registry.html#transitioning-an-mlflow-models-stage" target="_blank" style="color: inherit; text-decoration: inherit;">MLflow Model Registry</a></block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client</block><block class="punctuation token">.</block><block class=" token">transition_model_version_stage</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    name</block><block class="operator token">=</block><block class=" token">model_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    version</block><block class="operator token">=</block><block class=" token">model_version</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    stage</block><block class="operator token">=</block><block class="string token">"Staging"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Once your serving endpoint is ready, </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">score_model</block><block> should give you the model inference result.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">OPTIONAL:</block><block> To visualize the UI for model serving or to manually create a model serving endpoint, click the Serving tab on the navbar.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 761px; height: 325.47px; position: relative;"><img src="image-resources/d62cf4c4-bd0f-4d06-b128-d6e6eb068b5e.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Then select the model to enable model serving or to check the status of model serving.</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 759.25px; height: 474.14px; position: relative;"><img src="image-resources/31540c1e-41c8-4900-8ecd-5e4b510c6814.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Use </block><block style="font-weight: bold; color: rgb(255, 64, 0);">"Query endpoint"</block><block style="font-weight: bold;"> to manually input the payload_json and check the inference result.</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 756.75px; height: 466.3px; position: relative;"><img src="image-resources/0f4a2601-a0fa-4240-abec-4aed21eea22e.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Helper code to delete infrastructure</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">delete_model_serving_endpoint</block><block class="punctuation token">(</block><block class=" token">model_serving_endpoint_name</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    response </block><block class="operator token">=</block><block class=" token"> requests</block><block class="punctuation token">.</block><block class=" token">delete</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">api_url</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">model_serving_endpoint_name</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">,</block><block class=" token"> headers</block><block class="operator token">=</block><block class=" token">headers</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> response</block><block class="punctuation token">.</block><block class=" token">status_code </block><block class="operator token">!=</block><block class=" token"> </block><block class="number token">200</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">raise</block><block class=" token"> Exception</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Request failed with status </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">response</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">status_code</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">, </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">response</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">text</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">else</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class=" token">model_serving_endpoint_name</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"endpoint is deleted!"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">delete_model_serving_endpoint</block><block class="punctuation token">(</block><block class=" token">model_serving_endpoint_name</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.8140649805225104" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.8140649805225104" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">7.4.4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>AWS SageMaker</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">mlflow.sagemaker</block><block> can deploy a trained model to SageMaker using a single function: </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">mlflow.sagemaker.deploy</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>During deployment, MLflow will use a specialized Docker container with the resources required to load and serve the model. This container is named </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">mlflow-pyfunc</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>By default, MLflow will search for this container within your </block><block style="font-weight: bold;">AWS Elastic Container Registry (ECR)</block><block>. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>You can build and upload this container to ECR using the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">mlflow sagemaker build-and-push-container</block><block> function in MLflow's CLI. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Alternatively, you can specify an alternative URL for this container by setting an environment variable as follows:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="comment token"># the ECR URL should look like:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="punctuation token">{</block><block class=" token">account_id</block><block class="punctuation token">}</block><block class="punctuation token">.</block><block class=" token">dkr</block><block class="punctuation token">.</block><block class=" token">ecr</block><block class="punctuation token">.</block><block class="punctuation token">{</block><block class=" token">region</block><block class="punctuation token">}</block><block class="punctuation token">.</block><block class=" token">amazonaws</block><block class="punctuation token">.</block><block class=" token">com</block><block class="operator token">/</block><block class="punctuation token">{</block><block class=" token">repo_name</block><block class="punctuation token">}</block><block class="punctuation token">:</block><block class="punctuation token">{</block><block class=" token">tag</block><block class="punctuation token">}</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  image_ecr_url </block><block class="operator token">=</block><block class=" token"> </block><block class="string token">"&lt;ecr-url&gt;"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="comment token"># Set the environment variable based on the URL</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  os</block><block class="punctuation token">.</block><block class=" token">environ</block><block class="punctuation token">[</block><block class="string token">"SAGEMAKER_DEPLOY_IMG_URL"</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> image_ecr_url</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="comment token"># Deploy the model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  mlflow</block><block class="punctuation token">.</block><block class=" token">sagemaker</block><block class="punctuation token">.</block><block class=" token">deploy</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">     app_name</block><block class="punctuation token">,</block><block class=" token"> </block><block class="comment token"># application/model name</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">     model_uri</block><block class="punctuation token">,</block><block class=" token"> </block><block class="comment token"># model URI in Model Registry</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">     image_url</block><block class="operator token">=</block><block class=" token">image_ecr_url</block><block class="punctuation token">,</block><block class=" token"> region_name</block><block class="operator token">=</block><block class=" token">region</block><block class="punctuation token">,</block><block class=" token"> mode</block><block class="operator token">=</block><block class="string token">"create"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Running deployment and inference in a Databricks notebook requires the Databricks cluster to be configured with an AWS IAM role with permissions to perform these operations.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Once the endpoint is up and running, the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">sagemaker-runtime</block><block> API in </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">boto3</block><block> can query against the REST API:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">client </block><block class="operator token">=</block><block class=" token"> boto3</block><block class="punctuation token">.</block><block class=" token">session</block><block class="punctuation token">.</block><block class=" token">Session</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">client</block><block class="punctuation token">(</block><block class="string token">"sagemaker-runtime"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"{region}"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  response </block><block class="operator token">=</block><block class=" token"> client</block><block class="punctuation token">.</block><block class=" token">invoke_endpoint</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">      EndpointName</block><block class="operator token">=</block><block class=" token">app_name</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">      Body</block><block class="operator token">=</block><block class=" token">inputs</block><block class="punctuation token">,</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">      ContentType</block><block class="operator token">=</block><block class="string token">'application/json; format=pandas-split'</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  preds </block><block class="operator token">=</block><block class=" token"> response</block><block class="punctuation token">[</block><block class="string token">'Body'</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class=" token">read</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">decode</block><block class="punctuation token">(</block><block class="string token">"ascii"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  preds </block><block class="operator token">=</block><block class=" token"> json</block><block class="punctuation token">.</block><block class=" token">loads</block><block class="punctuation token">(</block><block class=" token">preds</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Received response: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">preds</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Tip:</block><block> Each Sagemaker endpoint is scoped to a single region. If deployment is required across regions, Sagemaker endpoints must exist in each region.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.9844223303422417" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.9844223303422417" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">7.4.5. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Online Feature Store Real-Time Model Serving</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>You can also work with </block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/machine-learning/feature-store/online-feature-stores.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/machine-learning/feature-store/online-feature-stores.html" target="_blank" style="color: inherit; text-decoration: inherit;">online feature stores</a></block><block> for real-time serving of feature values. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>With real-time serving, you publish feature tables to a low-latency database and deploy the model to a REST endpoint. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Databricks Feature Store</block><block> also supports </block><block style="text-decoration: underline;">automatic feature lookup</block><block>. Please refer to the example notebooks below:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>AWS version (at the end of the page) </block><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/machine-learning/feature-store/automatic-feature-lookup.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/machine-learning/feature-store/automatic-feature-lookup.html" target="_blank" style="color: inherit; text-decoration: inherit;">here</a></block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Azure version </block><block class="role-hyper-link" data-hyper-link-url="https://learn.microsoft.com/en-us/azure/databricks/_extras/notebooks/source/machine-learning/feature-store-online-example-cosmosdb.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://learn.microsoft.com/en-us/azure/databricks/_extras/notebooks/source/machine-learning/feature-store-online-example-cosmosdb.html" target="_blank" style="color: inherit; text-decoration: inherit;">here</a></block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> What are the best tools for real time deployment?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> This depends largely on the desired features. The main tools to consider are a way to containerize code and either a REST endpoint or an embedded model. This covers the vast majority of real time deployment options.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> What are the best options for RESTful services?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> The major cloud providers all have their respective deployment options. In the Azure environment, Azure ML manages deployments using Docker images. This provides a REST endpoint that can be queried by various elements of your infrastructure.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Question:</block><block> What factors influence REST deployment latency?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Answer:</block><block> Response time is a function of a few factors. Batch predictions should be used when needed since it improves throughput by lowering the overhead of the REST connection. Geo-location is also an issue, as is server load. This can be handled by geo-located deployments and load balancing with more resources.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.6558603215690391" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.6558603215690391" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">8. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Production</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 736.75px; height: 382.02px; position: relative;"><img src="image-resources/f822ab90-7151-406a-89e5-864eadf4937a.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 740.875px; height: 431.61px; position: relative;"><img src="image-resources/205fa91d-6b82-45d9-b5e4-26b17636e932.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 764.125px; height: 422.16px; position: relative;"><img src="image-resources/30a4e640-c657-472e-89e6-d3b43d9782cd.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.5167080365339114" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.5167080365339114" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">8.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>CI/CD</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 747.25px; height: 444.21px; position: relative;"><img src="image-resources/4238f540-94f4-427e-91d0-5c45847bf063.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 752px; height: 455.41px; position: relative;"><img src="image-resources/8667fb83-3ead-4768-b960-b211f42169c5.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 755.875px; height: 357.2px; position: relative;"><img src="image-resources/70ba0ae7-fcea-48df-a07d-2d2cb6cd2590.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 761.75px; height: 365.17px; position: relative;"><img src="image-resources/4d3dad69-9d00-4a97-9e34-a2a7927b5268.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 760.5px; height: 264.66px; position: relative;"><img src="image-resources/5afdc00d-02ab-4fe5-b15d-f2210d12ca3a.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 757.5px; height: 229.64px; position: relative;"><img src="image-resources/f7478a1f-60fb-4fb0-bd68-577d7e8dd22f.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 766.125px; height: 376.58px; position: relative;"><img src="image-resources/deb246d9-ecac-4415-852d-fd1233d6cf2f.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 765.5px; height: 352.84px; position: relative;"><img src="image-resources/143aaaf6-4cda-4d7f-8a63-6bc42b9b3dbd.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Databricks Resources</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Implementing CI/CD on Databricks using Databricks notebooks and Azure DevOps</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://www.databricks.com/blog/2021/09/20/part-1-implementing-ci-cd-on-databricks-using-databricks-notebooks-and-azure-devops.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.databricks.com/blog/2021/09/20/part-1-implementing-ci-cd-on-databricks-using-databricks-notebooks-and-azure-devops.html" target="_blank" style="color: inherit; text-decoration: inherit;">Part 1</a></block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://www.databricks.com/blog/2022/01/05/implementing-mlops-on-databricks-using-databricks-notebooks-and-azure-devops-part-2.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.databricks.com/blog/2022/01/05/implementing-mlops-on-databricks-using-databricks-notebooks-and-azure-devops-part-2.html" target="_blank" style="color: inherit; text-decoration: inherit;">Part 2</a></block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://docs.databricks.com/en/dev-tools/ci-cd/ci-cd-jenkins.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://docs.databricks.com/en/dev-tools/ci-cd/ci-cd-jenkins.html" target="_blank" style="color: inherit; text-decoration: inherit;">Continuous Integration and Delivery on Databricks using Jenkins</a></block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://www.databricks.com/blog/2020/06/05/automate-continuous-integration-and-continuous-delivery-on-databricks-using-databricks-labs-ci-cd-templates.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.databricks.com/blog/2020/06/05/automate-continuous-integration-and-continuous-delivery-on-databricks-using-databricks-labs-ci-cd-templates.html" target="_blank" style="color: inherit; text-decoration: inherit;">Automate Continuous Integration and Continuous Delivery on Databricks using Databricks Labs CI/CD Templates</a></block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 745px; height: 365.91px; position: relative;"><img src="image-resources/c177ff9d-6398-4641-b878-41d6cd949ae6.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.9861012482801415" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.9861012482801415" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">8.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Monitoring</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 755px; height: 349.69px; position: relative;"><img src="image-resources/74eb730c-c66b-4754-8e69-30f275365ecf.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 749.75px; height: 432.71px; position: relative;"><img src="image-resources/8a7dccb4-9c0b-4040-91d5-76430b4cfc6b.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.1150646831388642" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.1150646831388642"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 71118 --> <!-- /react-text --><!-- react-text: 71119 -->1<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://www.databricks.com/blog/2019/09/18/productionizing-machine-learning-from-deployment-to-drift-detection.html" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.databricks.com/blog/2019/09/18/productionizing-machine-learning-from-deployment-to-drift-detection.html" target="_blank" style="color: inherit; text-decoration: inherit;">Source</a></block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 760.75px; height: 421.67px; position: relative;"><img src="image-resources/1d4e3a88-07eb-48fc-88e7-3f4b27cdcbfa.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">MLOps</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Continuous Integration (CI)</block><block> extends the testing and validating code and components by adding testing and validating data and models.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Continuous Delivery (CD)</block><block> concerns with delivery of an ML training pipeline that automatically deploys another the ML model prediction service.</block></blocks></line><line class="root text-mode indent-0 has-indent" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Continuous Training (CT)</block><block> automatically retrains ML models for redeployment.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Continuous Monitoring (CM)</block><block> concerns with monitoring production data and model performance metrics, which are bound to business metrics.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 738.5px; height: 348.51px; position: relative;"><img src="image-resources/39398184-0add-41a4-911d-baef5b18da79.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 740.25px; height: 307.72px; position: relative;"><img src="image-resources/675e410f-d8eb-4f51-a29f-7e03eb9e46cd.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.4725559845440843" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.4725559845440843"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 71262 --> <!-- /react-text --><!-- react-text: 71263 -->2<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://towardsdatascience.com/machine-learning-in-production-why-you-should-care-about-data-and-concept-drift-d96d0bc907fb" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://towardsdatascience.com/machine-learning-in-production-why-you-should-care-about-data-and-concept-drift-d96d0bc907fb" target="_blank" style="color: inherit; text-decoration: inherit;">Source</a></block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 736px; height: 394.26px; position: relative;"><img src="image-resources/955d875f-8032-4d40-a1ab-7ec97e48848b.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.7831899703901559" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.7831899703901559"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 71297 --> <!-- /react-text --><!-- react-text: 71298 -->3<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://www.researchgate.net/publication/321627304_Online_Ensemble_Learning_with_Abstaining_Classifiers_for_Drifting_and_Noisy_Data_Streams" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.researchgate.net/publication/321627304_Online_Ensemble_Learning_with_Abstaining_Classifiers_for_Drifting_and_Noisy_Data_Streams" target="_blank" style="color: inherit; text-decoration: inherit;">Source</a></block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 743.75px; height: 393.31px; position: relative;"><img src="image-resources/d2908272-cb70-48fd-b10f-ec58e448d63f.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 746.625px; height: 381.59px; position: relative;"><img src="image-resources/eb4e9a50-4ff1-4e1d-9dbe-063a3492c9dc.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 751.75px; height: 416.19px; position: relative;"><img src="image-resources/efbbb367-fe19-4f9e-9be3-afddf785fed2.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.5961855230586066" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.5961855230586066" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">8.2.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Drift Monitoring</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Monitoring models over time entails safeguarding against drift in model performance as well as breaking changes.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: underline;">The majority of machine learning solutions assume that data is generated according to a stationary probability distribution</block><block>. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>However, because most datasets involving human activity change over time, machine learning solutions often go stale.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>For example, a model trained to predict restaurant sales before the COVID-19 pandemic would likely not be an accurate model of restaurant sales during the pandemic. </block><block style="text-decoration: underline;">The distribution generating the data changed, or drifted, over time</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Drift</block><block style="font-weight: bold;"> is composed of number of different types:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Data Drift</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Data Changes</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In practice, upstream data changes is one of the most common sources of drift</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>For instance, null records from a changed ETL task</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Feature Drift</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Change in the distribution of an input feature(s)</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Change in </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>P</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">P</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">X</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>P</mi><mo fence="true" stretchy="false">(</mo><mi>X</mi><mo fence="true" stretchy="false">)</mo></mrow></mstyle></math></span></compositeblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Label Drift</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Change in the distribution of the label in the data</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Change in </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>P</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>Y</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">P</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">Y</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>P</mi><mo fence="true" stretchy="false">(</mo><mi>Y</mi><mo fence="true" stretchy="false">)</mo></mrow></mstyle></math></span></compositeblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Prediction Drift</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Change in the distribution of the predicted label given by the model</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Change in </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>P</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mover accent=&quot;true&quot;><mi>Y</mi><mo>^</mo></mover><mo stretchy=&quot;false&quot;>|</mo><mi>X</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">P</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><compositeblock dir="ltr" class="wide-hat-symbol ig-ex-br"><symbol style="display: block; width: 100%; position: relative; height: 0.529412em; margin-bottom: -0.176471em;"><svg style="position: absolute; left: 0px; top: 0px; display: block; width: 100%; height: 100%; overflow: visible;"><polyline points="0.00,8.06 4.94,4.76 9.88,8.06" stroke-width="1" fill="none" stroke-linejoin="bevel"></polyline></svg></symbol><editarea class="no-area-container" style="display: inline-flex;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">Y</block></line></editarea></compositeblock><block class="Closing">|</block><block class="Normal">X</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>P</mi><mo fence="true" stretchy="false">(</mo><mover accent="true"><mi>Y</mi><mo>^</mo></mover><mo stretchy="false">|</mo><mi>X</mi><mo fence="true" stretchy="false">)</mo></mrow></mstyle></math></span></compositeblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Concept Drift</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Change in the relationship between input variables and label</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Change in distribution of </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>P</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>Y</mi><mo stretchy=&quot;false&quot;>|</mo><mi>X</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">P</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">Y</block><block class="Closing">|</block><block class="Normal">X</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>P</mi><mo fence="true" stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">|</mo><mi>X</mi><mo fence="true" stretchy="false">)</mo></mrow></mstyle></math></span></compositeblock></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Likely results in an invalid current model</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">* </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">A rigorous monitoring solution for drift entails monitoring each cause of drift.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Note:</block><block> It is important to note that </block><block style="text-decoration: underline;">each situation will need to be handled differently</block><block> and that </block><block style="text-decoration: underline;">the presence of drift does not immediately indicate a need to replace the current model</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">For example:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Imagine a model designed to predict snow cone sales with temperature as an input variable. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>If more recent data has higher temperatures and higher snow cone sales, we have both feature and label drift, but as long as the model is performing well, then there is not an issue.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>However, we might still want to take other business action given the change, so it is important to monitor for this anyway.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>However, if temperature rose and sales increased, but our predictions did not match this change, we could have concept drift and will need to retrain the model.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In either case, we may want to alert the company of the changes in case they impact other business processes, so it is important to track all potential drift.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In order to best adapt to possible changes, </block><block style="font-weight: bold; background-color: rgb(255, 254, 0);">we compare data and predictions across time windows to identify any kind of drift that could be occuring</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">The essence of drift monitoring is running statistical tests on time windows of data.</block><block> This allows us to detect drift and </block><block style="text-decoration: underline;">localize it to specific root causes</block><block>. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Here are some solutions:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Numeric Features</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Summary Statisitcs</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Mean, Median, Variance, Missing value count, Max, Min</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Tests</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://en.wikipedia.org/wiki/Jensen%E2%80%93Shannon_divergence" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://en.wikipedia.org/wiki/Jensen%E2%80%93Shannon_divergence" target="_blank" style="color: inherit; text-decoration: inherit;">Jensen-Shannon</a></block><block>  This method provides a smoothed and normalized metric</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test" target="_blank" style="color: inherit; text-decoration: inherit;">Two-Sample Kolmogorov-Smirnov (KS)</a></block><block>, </block><block class="role-hyper-link" data-hyper-link-url="https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U_test" target="_blank" style="color: inherit; text-decoration: inherit;">Mann-Whitney</a></block><block>, or </block><block class="role-hyper-link" data-hyper-link-url="https://en.wikipedia.org/wiki/Wilcoxon_signed-rank_test" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://en.wikipedia.org/wiki/Wilcoxon_signed-rank_test" target="_blank" style="color: inherit; text-decoration: inherit;">Wilcoxon tests</a></block><block>.</block><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Note:</block><block> These tests vary largely in their assumption of normalcy and ability to handle larger data sizes. Do a check of normalcy and choose the appropriate test based on this (</block><block style="font-weight: bold;">e.g. Mann-Whitney is more permissive of skew</block><block>)</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://en.wikipedia.org/wiki/Wasserstein_metric" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://en.wikipedia.org/wiki/Wasserstein_metric" target="_blank" style="color: inherit; text-decoration: inherit;">Wasserstein Distance</a></block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence" target="_blank" style="color: inherit; text-decoration: inherit;">KullbackLeibler divergence</a></block><block>  This is related to Jensen-Shannon divergence</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Categorical Features</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Summary Statistics</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Mode, Number of unique values, Number of missing values</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Tests</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://en.wikipedia.org/wiki/Chi-squared_test" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://en.wikipedia.org/wiki/Chi-squared_test" target="_blank" style="color: inherit; text-decoration: inherit;">One-way Chi-Squared Test</a></block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://en.wikipedia.org/wiki/Chi-squared_test" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://en.wikipedia.org/wiki/Chi-squared_test" target="_blank" style="color: inherit; text-decoration: inherit;">Chi-Squared Contingency Test</a></block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://en.wikipedia.org/wiki/Fisher%27s_exact_test" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://en.wikipedia.org/wiki/Fisher%27s_exact_test" target="_blank" style="color: inherit; text-decoration: inherit;">Fisher's Exact Test</a></block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">We also might want to store the relationship between the input variables and label</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In that case, we handle this differently depending on the label variable type.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Numeric Comparisons</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient" target="_blank" style="color: inherit; text-decoration: inherit;">Pearson Coefficient</a></block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Categorical Comparisons</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://en.wikipedia.org/wiki/Contingency_table#:~:text=In%20statistics%2C%20a%20contingency%20table,frequency%20distribution%20of%20the%20variables.&amp;text=They%20provide%20a%20basic%20picture,help%20find%20interactions%20between%20them." style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://en.wikipedia.org/wiki/Contingency_table#:~:text=In%20statistics%2C%20a%20contingency%20table,frequency%20distribution%20of%20the%20variables.&amp;text=They%20provide%20a%20basic%20picture,help%20find%20interactions%20between%20them." target="_blank" style="color: inherit; text-decoration: inherit;">Contingency Tables</a></block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">* </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">One interesting alternative is to frame monitoring as a supervised learning problem</block><block> where you use your features and label as inputs to a model and your label is whether a given row comes from the training or inference set. As the model's accuracy improves, it would imply that the model as drifted.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.8475046366155559" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.8475046366155559" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">8.2.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Drift Monitoring - Implementation - Kolmogorov-Smirnov Test</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Use the </block><block style="font-weight: bold; color: rgb(255, 64, 0);">Two-Sample Kolmogorov-Smirnov (KS) Test</block><block> for </block><block style="text-decoration: underline;">numeric features</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: underline;">This test determines whether or not two different samples come from the same distribution</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This test:</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Returns a </block><block style="text-decoration: underline;">higher </block><block style="text-decoration: underline; font-weight: bold;">KS statistic</block><block style="text-decoration: underline;"> when there is a higher probability of having two different distributions.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: underline;">Returns a lower p-value the higher the statistical significance</block><block>.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">* </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgb(255, 254, 0);">In practice,</block><block> we need a thershold for the p-value, where we will consider it unlikely enough that the samples did not come from the same distribution. </block><block style="text-decoration: underline;">Usually this threshold, or alpha level, is 0.05</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> seaborn </block><block class="keyword token">as</block><block class=" token"> sns</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> scipy</block><block class="punctuation token">.</block><block class=" token">stats </block><block class="keyword token">import</block><block class=" token"> gaussian_kde</block><block class="punctuation token">,</block><block class=" token"> truncnorm</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> numpy </block><block class="keyword token">as</block><block class=" token"> np</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> matplotlib</block><block class="punctuation token">.</block><block class=" token">pyplot </block><block class="keyword token">as</block><block class=" token"> plt</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> numpy </block><block class="keyword token">as</block><block class=" token"> np</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> pandas </block><block class="keyword token">as</block><block class=" token"> pd</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> scipy </block><block class="keyword token">import</block><block class=" token"> stats</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> scipy</block><block class="punctuation token">.</block><block class=" token">spatial </block><block class="keyword token">import</block><block class=" token"> distance</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">plot_distribution</block><block class="punctuation token">(</block><block class=" token">distibution_1</block><block class="punctuation token">,</block><block class=" token"> distibution_2</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    Plots the two given distributions </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param distribution_1: rv_continuous </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param distribution_2: rv_continuous </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    sns</block><block class="punctuation token">.</block><block class=" token">kdeplot</block><block class="punctuation token">(</block><block class=" token">distibution_1</block><block class="punctuation token">,</block><block class=" token"> shade</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">,</block><block class=" token"> color</block><block class="operator token">=</block><block class="string token">"g"</block><block class="punctuation token">,</block><block class=" token"> label</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    sns</block><block class="punctuation token">.</block><block class=" token">kdeplot</block><block class="punctuation token">(</block><block class=" token">distibution_2</block><block class="punctuation token">,</block><block class=" token"> shade</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">,</block><block class=" token"> color</block><block class="operator token">=</block><block class="string token">"b"</block><block class="punctuation token">,</block><block class=" token"> label</block><block class="operator token">=</block><block class="number token">2</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    plt</block><block class="punctuation token">.</block><block class=" token">legend</block><block class="punctuation token">(</block><block class=" token">loc</block><block class="operator token">=</block><block class="string token">"upper right"</block><block class="punctuation token">,</block><block class=" token"> borderaxespad</block><block class="operator token">=</block><block class="number token">0</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">get_truncated_normal</block><block class="punctuation token">(</block><block class=" token">mean</block><block class="operator token">=</block><block class="number token">0</block><block class="punctuation token">,</block><block class=" token"> sd</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> low</block><block class="operator token">=</block><block class="number token">0.2</block><block class="punctuation token">,</block><block class=" token"> upp</block><block class="operator token">=</block><block class="number token">0.8</block><block class="punctuation token">,</block><block class=" token"> n_size</block><block class="operator token">=</block><block class="number token">1000</block><block class="punctuation token">,</block><block class=" token"> seed</block><block class="operator token">=</block><block class="number token">999</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    Generates truncated normal distribution based on given mean, standard deviation, lower bound, upper bound and sample size </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param mean: float, mean used to create the distribution </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param sd: float, standard deviation used to create distribution</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param low: float, lower bound used to create the distribution </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param upp: float, upper bound used to create the distribution </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param n_size: integer, desired sample size </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :return distb: rv_continuous </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    np</block><block class="punctuation token">.</block><block class=" token">random</block><block class="punctuation token">.</block><block class=" token">seed</block><block class="punctuation token">(</block><block class=" token">seed</block><block class="operator token">=</block><block class=" token">seed</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    a </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">low</block><block class="operator token">-</block><block class=" token">mean</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">/</block><block class=" token"> sd</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    b </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">upp</block><block class="operator token">-</block><block class=" token">mean</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">/</block><block class=" token"> sd</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    distb </block><block class="operator token">=</block><block class=" token"> truncnorm</block><block class="punctuation token">(</block><block class=" token">a</block><block class="punctuation token">,</block><block class=" token"> b</block><block class="punctuation token">,</block><block class=" token"> loc</block><block class="operator token">=</block><block class=" token">mean</block><block class="punctuation token">,</block><block class=" token"> scale</block><block class="operator token">=</block><block class=" token">sd</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">rvs</block><block class="punctuation token">(</block><block class=" token">n_size</block><block class="punctuation token">,</block><block class=" token"> random_state</block><block class="operator token">=</block><block class=" token">seed</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> distb</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">calculate_ks</block><block class="punctuation token">(</block><block class=" token">distibution_1</block><block class="punctuation token">,</block><block class=" token"> distibution_2</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    Helper function that calculated the KS stat and plots the two distributions used in the calculation </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param distribution_1: rv_continuous</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param distribution_2: rv_continuous </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :return p_value: float, resulting p-value from KS calculation</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :return ks_drift: bool, detection of significant difference across the distributions </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    base</block><block class="punctuation token">,</block><block class=" token"> comp </block><block class="operator token">=</block><block class=" token"> distibution_1</block><block class="punctuation token">,</block><block class=" token"> distibution_2</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    p_value </block><block class="operator token">=</block><block class=" token"> np</block><block class="punctuation token">.</block><block class="builtin token">round</block><block class="punctuation token">(</block><block class=" token">stats</block><block class="punctuation token">.</block><block class=" token">ks_2samp</block><block class="punctuation token">(</block><block class=" token">base</block><block class="punctuation token">,</block><block class=" token"> comp</block><block class="punctuation token">)</block><block class="punctuation token">[</block><block class="number token">1</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class="number token">3</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    ks_drift </block><block class="operator token">=</block><block class=" token"> p_value </block><block class="operator token">&lt;</block><block class=" token"> </block><block class="number token">0.05</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Generate plots</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    plot_distribution</block><block class="punctuation token">(</block><block class=" token">base</block><block class="punctuation token">,</block><block class=" token"> comp</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    label </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"KS Stat suggests model drift: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">ks_drift</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token"> \n P-value = </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">p_value</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    plt</block><block class="punctuation token">.</block><block class=" token">title</block><block class="punctuation token">(</block><block class=" token">label</block><block class="punctuation token">,</block><block class=" token"> loc</block><block class="operator token">=</block><block class="string token">"center"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> p_value</block><block class="punctuation token">,</block><block class=" token"> ks_drift</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">calculate_probability_vector</block><block class="punctuation token">(</block><block class=" token">distibution_1</block><block class="punctuation token">,</block><block class=" token"> distibution_2</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    Helper function that turns raw values into a probability vector </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param distribution_1: rv_continuous</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param distribution_2: rv_continuous </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :return p: array, probability vector of distribution_1</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :return q: array, probability vector of distribution_2</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    global_min </block><block class="operator token">=</block><block class=" token"> </block><block class="builtin token">min</block><block class="punctuation token">(</block><block class="builtin token">min</block><block class="punctuation token">(</block><block class=" token">distibution_1</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="builtin token">min</block><block class="punctuation token">(</block><block class=" token">distibution_2</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    global_max </block><block class="operator token">=</block><block class=" token"> </block><block class="builtin token">max</block><block class="punctuation token">(</block><block class="builtin token">max</block><block class="punctuation token">(</block><block class=" token">distibution_1</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="builtin token">max</block><block class="punctuation token">(</block><block class=" token">distibution_2</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    p </block><block class="operator token">=</block><block class=" token"> np</block><block class="punctuation token">.</block><block class=" token">histogram</block><block class="punctuation token">(</block><block class=" token">distibution_1</block><block class="punctuation token">,</block><block class=" token"> bins</block><block class="operator token">=</block><block class="number token">20</block><block class="punctuation token">,</block><block class=" token"> </block><block class="builtin token">range</block><block class="operator token">=</block><block class="punctuation token">(</block><block class=" token">global_min</block><block class="punctuation token">,</block><block class=" token"> global_max</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    q </block><block class="operator token">=</block><block class=" token"> np</block><block class="punctuation token">.</block><block class=" token">histogram</block><block class="punctuation token">(</block><block class=" token">distibution_2</block><block class="punctuation token">,</block><block class=" token"> bins</block><block class="operator token">=</block><block class="number token">20</block><block class="punctuation token">,</block><block class=" token"> </block><block class="builtin token">range</block><block class="operator token">=</block><block class="punctuation token">(</block><block class=" token">global_min</block><block class="punctuation token">,</block><block class=" token"> global_max</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> p</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> q</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">def</block><block class=" token"> </block><block class="function token">calculate_js_distance</block><block class="punctuation token">(</block><block class=" token">p</block><block class="punctuation token">,</block><block class=" token"> q</block><block class="punctuation token">,</block><block class=" token"> raw_distribution_1</block><block class="punctuation token">,</block><block class=" token"> raw_distribution_2</block><block class="punctuation token">,</block><block class=" token"> threshold</block><block class="operator token">=</block><block class="number token">0.2</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    Helper function that calculated the JS distance and plots the two distributions used in the calculation </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param p: array, probability vector for the first distribution</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param q: array, probability vector for the second distribution </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param raw_distribution_1: array, raw values used in plotting</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param raw_distribution_2: array, raw values used in plotting</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :param threshold: float, cutoff threshold for the JS statistic</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :return js_stat: float, resulting distance measure from JS calculation</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    :return js_drift: bool, detection of significant difference across the distributions </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">    """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    js_stat </block><block class="operator token">=</block><block class=" token"> distance</block><block class="punctuation token">.</block><block class=" token">jensenshannon</block><block class="punctuation token">(</block><block class=" token">p</block><block class="punctuation token">,</block><block class=" token"> q</block><block class="punctuation token">,</block><block class=" token"> base</block><block class="operator token">=</block><block class="number token">2</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    js_stat_rounded </block><block class="operator token">=</block><block class=" token"> np</block><block class="punctuation token">.</block><block class="builtin token">round</block><block class="punctuation token">(</block><block class=" token">js_stat</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">3</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    js_drift </block><block class="operator token">=</block><block class=" token"> js_stat </block><block class="operator token">&gt;</block><block class=" token"> threshold</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Generate plot</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    plot_distribution</block><block class="punctuation token">(</block><block class=" token">raw_distribution_1</block><block class="punctuation token">,</block><block class=" token"> raw_distribution_2</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    label </block><block class="operator token">=</block><block class=" token"> </block><block class="string-interpolation string token">f"Jensen Shannon suggests model drift: </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">js_drift</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token"> \n JS Distance = </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">js_stat_rounded</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    plt</block><block class="punctuation token">.</block><block class=" token">title</block><block class="punctuation token">(</block><block class=" token">label</block><block class="punctuation token">,</block><block class=" token"> loc</block><block class="operator token">=</block><block class="string token">"center"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">return</block><block class=" token"> js_stat</block><block class="punctuation token">,</block><block class=" token"> js_drift</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Let's start with a sample size of 50.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">calculate_ks</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  get_truncated_normal</block><block class="punctuation token">(</block><block class=" token">upp</block><block class="operator token">=</block><block class="number token">.80</block><block class="punctuation token">,</block><block class=" token"> n_size</block><block class="operator token">=</block><block class="number token">50</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  get_truncated_normal</block><block class="punctuation token">(</block><block class=" token">upp</block><block class="operator token">=</block><block class="number token">.79</block><block class="punctuation token">,</block><block class=" token"> n_size</block><block class="operator token">=</block><block class="number token">50</block><block class="punctuation token">)</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 445px; height: 313.92px; position: relative;"><img src="image-resources/566a3573-ec94-46b6-8794-52a156fabaed.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Great! We can see the distributions look pretty similar and we have a high p-value. Now, let's increase the sample size and see its impact on the p-value...Let's set N = 1,000.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 471.5px; height: 329.7px; position: relative;"><img src="image-resources/24626c61-0bcd-4ada-b8fe-daab4f8ee06e.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Wow! Increasing the sample size decreased the p-value significantly. Let's bump up the sample size by one more factor of 10: N = 100,000.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 464.25px; height: 322.11px; position: relative;"><img src="image-resources/6fb879bc-29ba-4735-b672-16e49d1f2342.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>With the increased sample size, our </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">ks_stat</block><block> has dropped to near zero indicating that our two samples are significantly different. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>However, by just visually looking at the plot of our two overlapping distributions, they look pretty similar. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Caculating the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">ks_stat</block><block> can be useful when determining the similarity between two distributions, however you can quickly run into limitations based on sample size. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgb(255, 254, 0);">So how can we test for distribution similarity when we have a </block><block style="font-style: italic; background-color: rgb(255, 254, 0);">large sample size</block><block style="background-color: rgb(255, 254, 0);">?</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.45587163358318117" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.45587163358318117" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">8.2.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Drift Monitoring - Implementation - Jensen Shannon</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Jensen Shannon (JS) distance</block><block> is </block><block style="text-decoration: underline;">more appropriate for drift detection on a large dataset</block><block> since it meaures the distance between two probability distributions and it is smoothed and normalized. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: underline; font-weight: bold;">When log base 2 is used for the distance calculation, the JS statistic is bounded between 0 and 1</block><block>:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>0 means the distributions are identical</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>1 means the distributions have no similarity</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The JS distance is defined as the square root of the JS divergence:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area display" style="font-size: 17px;" data-mathml="<math display=&quot;block&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtable columnwidth=&quot;100%&quot; width=&quot;100%&quot; columnalign=&quot;center&quot;><mtr><mtd><mrow><mi>J</mi><mi>S</mi><mi>D</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>P</mi><mo stretchy=&quot;false&quot;>|</mo><mo stretchy=&quot;false&quot;>|</mo><mi>Q</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo><mo form=&quot;infix&quot;>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>D</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>P</mi><mo stretchy=&quot;false&quot;>|</mo><mo stretchy=&quot;false&quot;>|</mo><mi>M</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo><mo form=&quot;infix&quot;>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>D</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>|</mo><mo stretchy=&quot;false&quot;>|</mo><mi>M</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi>J</mi><mi>S</mi><mi>D</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>P</mi><mo stretchy=&quot;false&quot;>|</mo><mo stretchy=&quot;false&quot;>|</mo><mi>Q</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo><mo form=&quot;infix&quot;>=</mo><mi>H</mi><mo fence=&quot;true&quot;>(</mo><mfrac><mrow><mi>P</mi><mo form=&quot;infix&quot;>+</mo><mi>Q</mi></mrow><mn>2</mn></mfrac><mo fence=&quot;true&quot;>)</mo><mo form=&quot;infix&quot;>-</mo><mfrac><mrow><mi>H</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>P</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo><mo form=&quot;infix&quot;>+</mo><mi>H</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>Q</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow><mn>2</mn></mfrac></mrow></mtd></mtr></mtable></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="taggable" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">JSD</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">P</block><block class="Closing">||</block><block class="Normal">Q</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock><block class="Relation">=</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">1</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><block class="Normal">2</block></editarea-line></compositeblock><block class="Normal">D</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">P</block><block class="Closing">||</block><block class="Normal">M</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock><block class="Binary">+</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">1</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><block class="Normal">2</block></editarea-line></compositeblock><block class="Normal">D</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">Q</block><block class="Closing">||</block><block class="Normal">M</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></line><line class="taggable" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">JSD</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">P</block><block class="Closing">||</block><block class="Normal">Q</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock><block class="Relation">=</block><block class="Normal">H</block><opensymbolblock class="" type="parenthesis" style="height: 2.76471em;"><hidden-span style="margin-top: 0.764706em; align-self: flex-start;">(</hidden-span><svg style="width: 0.5em;"><path d=" M 7.13 1.94 c 0.00 -0.14 -0.13 -0.24 -0.27 -0.24 c -0.06 0.00 -0.11 0.02 -0.15 0.05 c -3.42 2.28 -5.39 8.51 -5.39 14.06 v 0.11 h 1.45 v -0.11 c 0.00 -5.32 1.15 -11.50 4.40 -13.69 c 0.08 -0.03 0.11 -0.10 0.11 -0.18 z   M 1.28 15.92 v 15.15 h 1.45 v -15.15 z" stroke="none"></path><path d=" M 7.13 45.06 c 0.00 0.14 -0.13 0.24 -0.27 0.24 c -0.06 0.00 -0.11 -0.02 -0.15 -0.05 c -3.42 -2.28 -5.39 -8.51 -5.39 -14.06 v -0.11 h 1.45 v 0.11 c 0.00 5.32 1.15 11.50 4.40 13.69 c 0.08 0.03 0.11 0.10 0.11 0.18 z" stroke="none"></path></svg></opensymbolblock><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">P</block><block class="Binary">+</block><block class="Normal">Q</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><block class="Normal">2</block></editarea-line></compositeblock><closesymbolblock class="" type="parenthesis" style="height: 2.76471em;"><hidden-span style="margin-top: 0.764706em; align-self: flex-start;">)</hidden-span><svg style="width: 0.5em;"><path d=" M 1.32 1.94 c 0.00 -0.14 0.13 -0.24 0.27 -0.24 c 0.06 0.00 0.11 0.02 0.15 0.05 c 3.42 2.28 5.39 8.51 5.39 14.06 v 0.11 h -1.45 v -0.11 c 0.00 -5.32 -1.15 -11.50 -4.40 -13.69 c -0.08 -0.03 -0.11 -0.10 -0.11 -0.18 z  M 7.17 15.92 v 15.15 h -1.45 v -15.15 z" stroke="none"></path><path d=" M 1.32 45.06 c 0.00 0.14 0.13 0.24 0.27 0.24 c 0.06 0.00 0.11 -0.02 0.15 -0.05 c 3.42 -2.28 5.39 -8.51 5.39 -14.06 v -0.11 h -1.45 v 0.11 c 0.00 5.32 -1.15 11.50 -4.40 13.69 c -0.08 0.03 -0.11 0.10 -0.11 0.18 z" stroke="none"></path></svg></closesymbolblock><block class="Binary">-</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">H</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">P</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock><block class="Binary">+</block><block class="Normal">H</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">Q</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><block class="Normal">2</block></editarea-line></compositeblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnwidth="100%" width="100%" columnalign="center"><mtr><mtd><mrow><mi>J</mi><mi>S</mi><mi>D</mi><mo fence="true" stretchy="false">(</mo><mi>P</mi><mo stretchy="false">|</mo><mo stretchy="false">|</mo><mi>Q</mi><mo fence="true" stretchy="false">)</mo><mo form="infix">=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>D</mi><mo fence="true" stretchy="false">(</mo><mi>P</mi><mo stretchy="false">|</mo><mo stretchy="false">|</mo><mi>M</mi><mo fence="true" stretchy="false">)</mo><mo form="infix">+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>D</mi><mo fence="true" stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">|</mo><mo stretchy="false">|</mo><mi>M</mi><mo fence="true" stretchy="false">)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi>J</mi><mi>S</mi><mi>D</mi><mo fence="true" stretchy="false">(</mo><mi>P</mi><mo stretchy="false">|</mo><mo stretchy="false">|</mo><mi>Q</mi><mo fence="true" stretchy="false">)</mo><mo form="infix">=</mo><mi>H</mi><mo fence="true">(</mo><mfrac><mrow><mi>P</mi><mo form="infix">+</mo><mi>Q</mi></mrow><mn>2</mn></mfrac><mo fence="true">)</mo><mo form="infix">-</mo><mfrac><mrow><mi>H</mi><mo fence="true" stretchy="false">(</mo><mi>P</mi><mo fence="true" stretchy="false">)</mo><mo form="infix">+</mo><mi>H</mi><mo fence="true" stretchy="false">(</mo><mi>Q</mi><mo fence="true" stretchy="false">)</mo></mrow><mn>2</mn></mfrac></mrow></mtd></mtr></mtable></math></span></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Where </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>M</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">M</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>M</mi></mstyle></math></span></compositeblock><block> is defined as the pointwise mean of </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>P</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">P</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>P</mi></mstyle></math></span></compositeblock><block> and </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>Q</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">Q</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>Q</mi></mstyle></math></span></compositeblock><block> and </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>H</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>P</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">H</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">P</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>H</mi><mo fence="true" stretchy="false">(</mo><mi>P</mi><mo fence="true" stretchy="false">)</mo></mrow></mstyle></math></span></compositeblock><block> is defined as the entropy function:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area display" style="font-size: 17px;" data-mathml="<math display=&quot;block&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo><mo form=&quot;infix&quot;>=</mo><mo form=&quot;infix&quot;>-</mo><munderover><mo largeop=&quot;true&quot; movablelimit=&quot;true&quot;></mo><mrow><mi>x</mi><mo form=&quot;infix&quot;></mo><mi></mi></mrow><mrow><mi></mi></mrow></munderover><mi>P</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo><msub><mi>log</mi><mi>b</mi></msub><mi>P</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="taggable" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">H</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">X</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock><block class="Relation">=</block><block class="Binary">-</block><compositeblock dir="ltr" class="summation-like-symbol limit-type limit-kind"><empty class="from"><editarea class="from no-area-container" style="margin-bottom: -0.411765em;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></line></editarea></empty><symbol class="" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana; font-style: normal; font-weight: normal;"><span></span></symbol><editarea class="to to-summation no-area-container" style="margin-top: 0.176471em;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block>x</block></line></editarea></compositeblock><block class="Normal">P</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">x</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock><compositeblock dir="ltr" class="constant-text"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">b</editarea-block></compositeblock><block class="Normal">P</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">x</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi><mo fence="true" stretchy="false">(</mo><mi>X</mi><mo fence="true" stretchy="false">)</mo><mo form="infix">=</mo><mo form="infix">-</mo><munderover><mo largeop="true" movablelimit="true"></mo><mrow><mi>x</mi><mo form="infix"></mo><mi></mi></mrow><mrow><mi></mi></mrow></munderover><mi>P</mi><mo fence="true" stretchy="false">(</mo><mi>x</mi><mo fence="true" stretchy="false">)</mo><msub><mi>log</mi><mi>b</mi></msub><mi>P</mi><mo fence="true" stretchy="false">(</mo><mi>x</mi><mo fence="true" stretchy="false">)</mo></math></span></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgb(255, 254, 0);">Unlike the KS statistic that provides a p-value, the JS statistic only provides a scalar value</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>You therefore need to </block><block style="font-weight: bold; background-color: rgb(255, 254, 0);">manually provide a cutoff threshold</block><block> above which you will count the two datasets as having drifted.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Verify a JS statistic of 0 with two identical distributions. Note that the </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">p</block><block> and </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">q</block><block> arguments here are probability vectors, not raw values.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">distance</block><block class="punctuation token">.</block><block class=" token">jensenshannon</block><block class="punctuation token">(</block><block class=" token">p</block><block class="operator token">=</block><block class="punctuation token">[</block><block class="number token">1.0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0.0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1.0</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> q</block><block class="operator token">=</block><block class="punctuation token">[</block><block class="number token">1.0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">0.0</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">1.0</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> base</block><block class="operator token">=</block><block class="number token">2.0</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># 0.0</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Let's try this example again with N = 1,000.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">raw_distribution_1 </block><block class="operator token">=</block><block class=" token"> get_truncated_normal</block><block class="punctuation token">(</block><block class=" token">upp</block><block class="operator token">=</block><block class="number token">.80</block><block class="punctuation token">,</block><block class=" token"> n_size</block><block class="operator token">=</block><block class="number token">1000</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">raw_distribution_2 </block><block class="operator token">=</block><block class=" token"> get_truncated_normal</block><block class="punctuation token">(</block><block class=" token">upp</block><block class="operator token">=</block><block class="number token">.79</block><block class="punctuation token">,</block><block class=" token"> n_size</block><block class="operator token">=</block><block class="number token">1000</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">p</block><block class="punctuation token">,</block><block class=" token"> q </block><block class="operator token">=</block><block class=" token"> calculate_probability_vector</block><block class="punctuation token">(</block><block class=" token">raw_distribution_1</block><block class="punctuation token">,</block><block class=" token"> raw_distribution_2</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">calculate_js_distance</block><block class="punctuation token">(</block><block class=" token">p</block><block class="punctuation token">,</block><block class=" token"> q</block><block class="punctuation token">,</block><block class=" token"> raw_distribution_1</block><block class="punctuation token">,</block><block class=" token"> raw_distribution_2</block><block class="punctuation token">,</block><block class=" token"> threshold</block><block class="operator token">=</block><block class="number token">0.2</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># (0.04147735123124928, False)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 495px; height: 349.91px; position: relative;"><img src="image-resources/61d1305f-514e-4305-8f3c-ffae51a19f12.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>And now with N = 10,000.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">raw_distribution_1 </block><block class="operator token">=</block><block class=" token"> get_truncated_normal</block><block class="punctuation token">(</block><block class=" token">upp</block><block class="operator token">=</block><block class="number token">.80</block><block class="punctuation token">,</block><block class=" token"> n_size</block><block class="operator token">=</block><block class="number token">10000</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">raw_distribution_2 </block><block class="operator token">=</block><block class=" token"> get_truncated_normal</block><block class="punctuation token">(</block><block class=" token">upp</block><block class="operator token">=</block><block class="number token">.79</block><block class="punctuation token">,</block><block class=" token"> n_size</block><block class="operator token">=</block><block class="number token">10000</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">p</block><block class="punctuation token">,</block><block class=" token"> q </block><block class="operator token">=</block><block class=" token"> calculate_probability_vector</block><block class="punctuation token">(</block><block class=" token">raw_distribution_1</block><block class="punctuation token">,</block><block class=" token"> raw_distribution_2</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">calculate_js_distance</block><block class="punctuation token">(</block><block class=" token">p</block><block class="punctuation token">,</block><block class=" token"> q</block><block class="punctuation token">,</block><block class=" token"> raw_distribution_1</block><block class="punctuation token">,</block><block class=" token"> raw_distribution_2</block><block class="punctuation token">,</block><block class=" token"> threshold</block><block class="operator token">=</block><block class="number token">0.2</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># (0.03279199904482657, False)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 478.5px; height: 336.02px; position: relative;"><img src="image-resources/69bb87f6-2591-4e6c-908e-34bb8cf1d070.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>And lastly with N = 100,000.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">raw_distribution_1 </block><block class="operator token">=</block><block class=" token"> get_truncated_normal</block><block class="punctuation token">(</block><block class=" token">upp</block><block class="operator token">=</block><block class="number token">.80</block><block class="punctuation token">,</block><block class=" token"> n_size</block><block class="operator token">=</block><block class="number token">100000</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">raw_distribution_2 </block><block class="operator token">=</block><block class=" token"> get_truncated_normal</block><block class="punctuation token">(</block><block class=" token">upp</block><block class="operator token">=</block><block class="number token">.79</block><block class="punctuation token">,</block><block class=" token"> n_size</block><block class="operator token">=</block><block class="number token">100000</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">p</block><block class="punctuation token">,</block><block class=" token"> q </block><block class="operator token">=</block><block class=" token"> calculate_probability_vector</block><block class="punctuation token">(</block><block class=" token">raw_distribution_1</block><block class="punctuation token">,</block><block class=" token"> raw_distribution_2</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">calculate_js_distance</block><block class="punctuation token">(</block><block class=" token">p</block><block class="punctuation token">,</block><block class=" token"> q</block><block class="punctuation token">,</block><block class=" token"> raw_distribution_1</block><block class="punctuation token">,</block><block class=" token"> raw_distribution_2</block><block class="punctuation token">,</block><block class=" token"> threshold</block><block class="operator token">=</block><block class="number token">0.2</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># (0.03177292121031257, False)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 518px; height: 367.08px; position: relative;"><img src="image-resources/3ca90d11-da16-4a90-8947-53ea054e53e0.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>As illustrated above, the </block><block style="background-color: rgb(255, 254, 0);">JS distance is much more resilient to increased sample size because it is smoothed and normalized</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">In practice,</block><block> you would have data over a period of time, divide it into groups based on time (e.g. weekly windows), and then run the tests on the two groups to determine if there was a statistically significant change. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The frequency of these monitoring jobs depends on the training window, inference data sample size, and use case. We'll simulate this with our dataset.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Load Dataset</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">airbnb_pdf </block><block class="operator token">=</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">read_parquet</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">DA</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">paths</block><block class="string-interpolation interpolation punctuation token">.</block><block class="string-interpolation interpolation token">datasets_path</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">/airbnb/sf-listings/airbnb-cleaned-mlflow.parquet/"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Identify Numeric &amp; Categorical Columns</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">num_cols </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="string token">"accommodates"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"bedrooms"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"beds"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"minimum_nights"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"number_of_reviews"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"review_scores_rating"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"price"</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">cat_cols </block><block class="operator token">=</block><block class=" token"> </block><block class="punctuation token">[</block><block class="string token">"neighbourhood_cleansed"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"property_type"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"room_type"</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Drop extraneous columns for this example</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">airbnb_pdf </block><block class="operator token">=</block><block class=" token"> airbnb_pdf</block><block class="punctuation token">[</block><block class=" token">num_cols </block><block class="operator token">+</block><block class=" token"> cat_cols</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Split Dataset into the two groups</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">pdf1 </block><block class="operator token">=</block><block class=" token"> airbnb_pdf</block><block class="punctuation token">.</block><block class=" token">sample</block><block class="punctuation token">(</block><block class=" token">frac </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">0.5</block><block class="punctuation token">,</block><block class=" token"> random_state</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">pdf2 </block><block class="operator token">=</block><block class=" token"> airbnb_pdf</block><block class="punctuation token">.</block><block class=" token">drop</block><block class="punctuation token">(</block><block class=" token">pdf1</block><block class="punctuation token">.</block><block class=" token">index</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Alter </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">pdf2</block><block> to simulate drift. Add the following realistic changes:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">The demand for Airbnbs skyrocketed, so the prices of Airbnbs doubled.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Type of Drift</block><block>  </block><block style="font-weight: bold; color: rgb(255, 64, 0);">Concept, Label</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">An upstream data management error resulted in null values for</block><block> </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">neighbourhood_cleansed</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Type of Drift</block><block>  </block><block style="font-weight: bold; color: rgb(255, 64, 0);">Feature</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">An upstream data change resulted in </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">review_score_rating</block><block style="font-weight: bold;"> move to a 5 star rating system, instead of the previous 100 point system.</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Type of Drift</block><block>  </block><block style="font-weight: bold; color: rgb(255, 64, 0);">Feature</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">pdf2</block><block class="punctuation token">[</block><block class="string token">"price"</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">2</block><block class=" token"> </block><block class="operator token">*</block><block class=" token"> pdf2</block><block class="punctuation token">[</block><block class="string token">"price"</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">pdf2</block><block class="punctuation token">[</block><block class="string token">"review_scores_rating"</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> pdf2</block><block class="punctuation token">[</block><block class="string token">"review_scores_rating"</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">/</block><block class=" token"> </block><block class="number token">20</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">pdf2</block><block class="punctuation token">[</block><block class="string token">"neighbourhood_cleansed"</block><block class="punctuation token">]</block><block class=" token"> </block><block class="operator token">=</block><block class=" token"> pdf2</block><block class="punctuation token">[</block><block class="string token">"neighbourhood_cleansed"</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class="builtin token">map</block><block class="punctuation token">(</block><block class="keyword token">lambda</block><block class=" token"> x</block><block class="punctuation token">:</block><block class=" token"> </block><block class="boolean token">None</block><block class=" token"> </block><block class="keyword token">if</block><block class=" token"> x </block><block class="operator token">==</block><block class=" token"> </block><block class="number token">0</block><block class=" token"> </block><block class="keyword token">else</block><block class=" token"> x</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.5615474093602371" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.5615474093602371" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">8.2.4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Drift Monitoring - Implementation - Apply Summary Stats</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Start by looking at the summary statistics for the distribution of data in the two datasets with </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">dbutils.data.summarize</block><block>.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">dbutils</block><block class="punctuation token">.</block><block class=" token">data</block><block class="punctuation token">.</block><block class=" token">summarize</block><block class="punctuation token">(</block><block class=" token">pdf1</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">dbutils</block><block class="punctuation token">.</block><block class=" token">data</block><block class="punctuation token">.</block><block class=" token">summarize</block><block class="punctuation token">(</block><block class=" token">pdf2</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 697px; height: 522.4px; position: relative;"><img src="image-resources/d1d1db1c-4e6e-47e6-8159-f15545936a0d.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>It might be difficult to spot the differences in distribution across the summary plots, so let's visualize the percent change in summary statistics.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Create visual of percent change in summary stats</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">cm </block><block class="operator token">=</block><block class=" token"> sns</block><block class="punctuation token">.</block><block class=" token">light_palette</block><block class="punctuation token">(</block><block class="string token">"#2ecc71"</block><block class="punctuation token">,</block><block class=" token"> as_cmap</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">summary1_pdf </block><block class="operator token">=</block><block class=" token"> pdf1</block><block class="punctuation token">.</block><block class=" token">describe</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">[</block><block class=" token">num_cols</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">summary2_pdf </block><block class="operator token">=</block><block class=" token"> pdf2</block><block class="punctuation token">.</block><block class=" token">describe</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">[</block><block class=" token">num_cols</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">percent_change </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">100</block><block class=" token"> </block><block class="operator token">*</block><block class=" token"> </block><block class="builtin token">abs</block><block class="punctuation token">(</block><block class="punctuation token">(</block><block class=" token">summary1_pdf </block><block class="operator token">-</block><block class=" token"> summary2_pdf</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">/</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">summary1_pdf </block><block class="operator token">+</block><block class=" token"> </block><block class="number token">1e</block><block class="operator token">-</block><block class="number token">100</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">percent_change</block><block class="punctuation token">.</block><block class=" token">style</block><block class="punctuation token">.</block><block class=" token">background_gradient</block><block class="punctuation token">(</block><block class=" token">cmap</block><block class="operator token">=</block><block class=" token">cm</block><block class="punctuation token">,</block><block class=" token"> text_color_threshold</block><block class="operator token">=</block><block class="number token">0.5</block><block class="punctuation token">,</block><block class=" token"> axis</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 696.5px; height: 174.91px; position: relative;"><img src="image-resources/b3e70481-495d-494f-bb30-f49df52341e6.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.9031778150948311" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.9031778150948311" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">8.2.5. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Drift Monitoring - Implementation - Bonferroni Correction</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">review_scores_rating</block><block> and </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">price</block><block> seem to have many of their stats changed significantly, so we would want to look into those. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Now run the KS test on the two subsets of the data. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>However, </block><block style="text-decoration: underline;">we cannot use the default alpha level of 0.05 in this situation</block><block> because we are running a group of tests. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This is because the probability of at least one false positive (concluding the feature's distribution changed when it did not) in a group of tests increases with the number of tests in the group.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>To solve this problem we will employ the </block><block style="font-weight: bold; color: rgb(255, 64, 0);">Bonferroni Correction</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgb(255, 254, 0);">This changes the alpha level to 0.05 / number of tests in group</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgb(255, 254, 0);">It is common practice and reduces the probability of false positives</block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>More information can be found </block><block class="role-hyper-link" data-hyper-link-url="https://en.wikipedia.org/wiki/Bonferroni_correction" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://en.wikipedia.org/wiki/Bonferroni_correction" target="_blank" style="color: inherit; text-decoration: inherit;">here</a></block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Set the Bonferroni Corrected alpha level</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">alpha </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">0.05</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">alpha_corrected </block><block class="operator token">=</block><block class=" token"> alpha </block><block class="operator token">/</block><block class=" token"> </block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">num_cols</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Loop over all numeric attributes (numeric cols and target col, price)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">for</block><block class=" token"> num </block><block class="keyword token">in</block><block class=" token"> num_cols</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Run test comparing old and new for that attribute</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    ks_stat</block><block class="punctuation token">,</block><block class=" token"> ks_pval </block><block class="operator token">=</block><block class=" token"> stats</block><block class="punctuation token">.</block><block class=" token">ks_2samp</block><block class="punctuation token">(</block><block class=" token">pdf1</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> pdf2</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> mode</block><block class="operator token">=</block><block class="string token">"asymp"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> ks_pval </block><block class="operator token">&lt;=</block><block class=" token"> alpha_corrected</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">num</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token"> had statistically significant change between the two samples"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># review_scores_rating had statistically significant change between the two samples</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># price had statistically significant change between the two samples</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>As mentioned above, the Jensen Shannon Distance metric has some advantages over the KS distance, so let's also run that test as well.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Because we do not have p-value we do not need the Bonferroni Correction, however we do need to manually set a threshold based on our knowledge of the dataset.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Set the JS stat threshold</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">threshold </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">0.2</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Loop over all numeric attributes (numeric cols and target col, price)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">for</block><block class=" token"> num </block><block class="keyword token">in</block><block class=" token"> num_cols</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="comment token"># Run test comparing old and new for that attribute</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    range_min </block><block class="operator token">=</block><block class=" token"> </block><block class="builtin token">min</block><block class="punctuation token">(</block><block class=" token">pdf1</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class="builtin token">min</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> pdf2</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class="builtin token">min</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    range_max </block><block class="operator token">=</block><block class=" token"> </block><block class="builtin token">max</block><block class="punctuation token">(</block><block class=" token">pdf1</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class="builtin token">max</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> pdf2</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class="builtin token">max</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    base </block><block class="operator token">=</block><block class=" token"> np</block><block class="punctuation token">.</block><block class=" token">histogram</block><block class="punctuation token">(</block><block class=" token">pdf1</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> bins</block><block class="operator token">=</block><block class="number token">20</block><block class="punctuation token">,</block><block class=" token"> </block><block class="builtin token">range</block><block class="operator token">=</block><block class="punctuation token">(</block><block class=" token">range_min</block><block class="punctuation token">,</block><block class=" token"> range_max</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    comp </block><block class="operator token">=</block><block class=" token"> np</block><block class="punctuation token">.</block><block class=" token">histogram</block><block class="punctuation token">(</block><block class=" token">pdf2</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> bins</block><block class="operator token">=</block><block class="number token">20</block><block class="punctuation token">,</block><block class=" token"> </block><block class="builtin token">range</block><block class="operator token">=</block><block class="punctuation token">(</block><block class=" token">range_min</block><block class="punctuation token">,</block><block class=" token"> range_max</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    js_stat </block><block class="operator token">=</block><block class=" token"> distance</block><block class="punctuation token">.</block><block class=" token">jensenshannon</block><block class="punctuation token">(</block><block class=" token">base</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> comp</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> base</block><block class="operator token">=</block><block class="number token">2</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> js_stat </block><block class="operator token">&gt;=</block><block class=" token"> threshold</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">num</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token"> had statistically significant change between the two samples"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># review_scores_rating had statistically significant change between the two samples</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># price had statistically significant change between the two samples</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.12143262869501559" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.12143262869501559" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">8.2.6. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Drift Monitoring - Implementation - Categorical Features</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Now, let's take a look at the </block><block style="font-weight: bold;">categorical features</block><block>. Check the rate of null values.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Generate missing value counts visual </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">pd</block><block class="punctuation token">.</block><block class=" token">concat</block><block class="punctuation token">(</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block><block class="punctuation token">[</block><block class="number token">100</block><block class=" token"> </block><block class="operator token">*</block><block class=" token"> pdf1</block><block class="punctuation token">.</block><block class=" token">isnull</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class="builtin token">sum</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">/</block><block class=" token"> </block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">pdf1</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="number token">100</block><block class=" token"> </block><block class="operator token">*</block><block class=" token"> pdf2</block><block class="punctuation token">.</block><block class=" token">isnull</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class="builtin token">sum</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">/</block><block class=" token"> </block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">pdf2</block><block class="punctuation token">)</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  axis</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  keys</block><block class="operator token">=</block><block class="punctuation token">[</block><block class="string token">"pdf1"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"pdf2"</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">style</block><block class="punctuation token">.</block><block class=" token">background_gradient</block><block class="punctuation token">(</block><block class=" token">cmap</block><block class="operator token">=</block><block class=" token">cm</block><block class="punctuation token">,</block><block class=" token"> text_color_threshold</block><block class="operator token">=</block><block class="number token">0.5</block><block class="punctuation token">,</block><block class=" token"> axis</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 317px; height: 240.67px; position: relative;"><img src="image-resources/740ce47b-ea80-476d-9b89-ee265630132a.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">neighbourhood_cleansed</block><block> has some missing values it did not before. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Now, let's run the </block><block style="font-weight: bold; color: rgb(255, 64, 0);">Two-Way Chi Squared Contigency Test</block><block> for this example. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This test works by creating a </block><block style="font-weight: bold;">Contingency Table</block><block> with a column for the counts of each feature category for a given categorical feature and a row for </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">pdf1</block><block> and </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">pdf2</block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgb(255, 254, 0);">It will then return a p-value determining whether or not there is an association between the time window of data and the distribution of that feature</block><block>. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgb(255, 254, 0);">If it is significant, we would conclude the distribution did change over time, and so there was drift</block><block>.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">alpha </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">0.05</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">corrected_alpha </block><block class="operator token">=</block><block class=" token"> alpha </block><block class="operator token">/</block><block class=" token"> </block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">cat_cols</block><block class="punctuation token">)</block><block class=" token"> </block><block class="comment token"># Still using the same correction</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">for</block><block class=" token"> feature </block><block class="keyword token">in</block><block class=" token"> cat_cols</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    pdf_count1 </block><block class="operator token">=</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">DataFrame</block><block class="punctuation token">(</block><block class=" token">pdf1</block><block class="punctuation token">[</block><block class=" token">feature</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class=" token">value_counts</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">sort_index</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">rename</block><block class="punctuation token">(</block><block class=" token">columns</block><block class="operator token">=</block><block class="punctuation token">{</block><block class=" token">feature</block><block class="punctuation token">:</block><block class="string token">"pdf1"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    pdf_count2 </block><block class="operator token">=</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">DataFrame</block><block class="punctuation token">(</block><block class=" token">pdf2</block><block class="punctuation token">[</block><block class=" token">feature</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class=" token">value_counts</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">sort_index</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">rename</block><block class="punctuation token">(</block><block class=" token">columns</block><block class="operator token">=</block><block class="punctuation token">{</block><block class=" token">feature</block><block class="punctuation token">:</block><block class="string token">"pdf2"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    pdf_counts </block><block class="operator token">=</block><block class=" token"> pdf_count1</block><block class="punctuation token">.</block><block class=" token">join</block><block class="punctuation token">(</block><block class=" token">pdf_count2</block><block class="punctuation token">,</block><block class=" token"> how</block><block class="operator token">=</block><block class="string token">"outer"</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">fillna</block><block class="punctuation token">(</block><block class="number token">0</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    obs </block><block class="operator token">=</block><block class=" token"> np</block><block class="punctuation token">.</block><block class=" token">array</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class=" token">pdf_counts</block><block class="punctuation token">[</block><block class="string token">"pdf1"</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> pdf_counts</block><block class="punctuation token">[</block><block class="string token">"pdf2"</block><block class="punctuation token">]</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    _</block><block class="punctuation token">,</block><block class=" token"> p</block><block class="punctuation token">,</block><block class=" token"> _</block><block class="punctuation token">,</block><block class=" token"> _ </block><block class="operator token">=</block><block class=" token"> stats</block><block class="punctuation token">.</block><block class=" token">chi2_contingency</block><block class="punctuation token">(</block><block class=" token">obs</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">if</block><block class=" token"> p </block><block class="operator token">&lt;</block><block class=" token"> corrected_alpha</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">feature</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token"> statistically significantly changed"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">else</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">feature</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token"> did not statistically significantly change"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># neighbourhood_cleansed statistically significantly changed</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># property_type did not statistically significantly change</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># room_type did not statistically significantly change</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Note:</block><block> The </block><block style="font-weight: bold;">Two-way Chi-Squared Test</block><block> caught this not because nulls were introduced, but because they were introduced into one neighbourhood specifically, leading to an uneven distribution. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>If nulls were uniform throughout, then the test would see a similar distribution, just with lower counts, which this test would not flag as a change in dependence.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Note on Chi-Squared Tests</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>For the Chi-Squared tests, distributions with low bin counts can invalidate the test's accuracy and lead to false positives.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>There are also two types of Chi-Squared tests: </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">One-way </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Two-way (or contingency) </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">One-way testing</block><block> is a </block><block style="text-decoration: underline; background-color: rgb(255, 254, 0);">goodness of fit test</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>It takes a </block><block style="text-decoration: underline;">single feature distribution</block><block> and </block><block style="text-decoration: underline;">a population distribution</block><block> and reports the </block><block style="font-weight: bold;">probabilty of randomly drawing the single feature distribution from that population</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block style="text-decoration: underline; font-weight: bold;">In the context of drift monitoring,</block><block style="text-decoration: underline;"> you would use the old time window as the population distribution and the new time window as the single feature distribution</block><block>. </block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>If the </block><block style="font-weight: bold;">p-value was low</block><block>, then it would be likely that drift occured and that the new data no longer resembles the old distribution. </block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>This test compares counts, so if a more recent time window has a similar distribution but less data in it, this will return a low p-value when it perhaps should not. </block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>In that situation, try the Two-way test.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The </block><block style="font-weight: bold; color: rgb(255, 64, 0);">Two-way or contingency test</block><block> used above is rather a </block><block style="text-decoration: underline; background-color: rgb(255, 254, 0);">test for independence</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>It takes in a table where the rows represent time window 1 and 2 and the columns represent feature counts for a given feature. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>It </block><block style="text-decoration: underline;">determines whether or not there is a relationship between the time window and the feature distributions</block><block>, or, in other words, </block><block style="text-decoration: underline;">if the distributions are independent of the time window</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>It is important to note that this test </block><block style="text-decoration: underline;">will not catch differences such as a decrease in total counts in the distribution</block><block>. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>This makes it </block><block style="text-decoration: underline;">useful when comparing time windows with unequal amounts of data</block><block>, </block><block style="font-weight: bold;">but</block><block> make sure to check for changes in null counts or differences in counts separately that you might care about.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Both of these assume high bin counts</block><block> (generally &gt;5) for each category in order to work properly. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>In our example, because of the large number of categories, some bin counts were lower than we would want for these tests. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Fortunately, the </block><block style="text-decoration: underline;">scipy implementation of the Two-way test utilizes a correction for low counts</block><block> that makes the Two-way preferable to the One-way in this situation, although ideally we would still want higher bin counts.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>The </block><block style="font-weight: bold; color: rgb(255, 64, 0);">Fisher Exact Test</block><block> is a </block><block style="text-decoration: underline;">good alternative in the situation where the counts are too low</block><block>, however there is currently </block><block style="text-decoration: underline;">no Python implemenation</block><block> for this test in a contingency table larger than 2x2. </block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>If you are looking to run this test, you should explore using R.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>These are subtle differences that are worth taking into account, but in either case, </block><block style="font-weight: bold; background-color: rgb(255, 254, 0);">a low p-value would indicate significantly different distributions across the time window and therefore drift for the One-Way or Two-way Chi-Squared</block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.2068117739195432" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.2068117739195432" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">8.2.7. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Drift Monitoring - Implementation - Combine into One Class</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Here, we'll combine the tests and code we have seen so far into a class </block><block style="font-family: &quot;Courier New&quot;, Courier, monospace; font-weight: bold; color: rgb(79, 167, 176);">Monitor</block><block> that shows how you might implement the code above in practice.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="code-section-symbol inline" style="display: block;"><div class="code-section theme-default" style="display: block; border: 1px solid lightgray; background: rgb(238, 238, 237); padding: 10px; font-size: 12px;"><editarea class="text-mode code-section-edit-area" style="font-family: &quot;Fira code&quot;, &quot;Fira Mono&quot;, monospace;"><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> pandas </block><block class="keyword token">as</block><block class=" token"> pd</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> seaborn </block><block class="keyword token">as</block><block class=" token"> sns</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> scipy </block><block class="keyword token">import</block><block class=" token"> stats</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">import</block><block class=" token"> numpy </block><block class="keyword token">as</block><block class=" token"> np </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">from</block><block class=" token"> scipy</block><block class="punctuation token">.</block><block class=" token">spatial </block><block class="keyword token">import</block><block class=" token"> distance</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="keyword token">class</block><block class=" token"> </block><block class="class-name token">Monitor</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">__init__</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">,</block><block class=" token"> pdf1</block><block class="punctuation token">,</block><block class=" token"> pdf2</block><block class="punctuation token">,</block><block class=" token"> cat_cols</block><block class="punctuation token">,</block><block class=" token"> num_cols</block><block class="punctuation token">,</block><block class=" token"> alpha</block><block class="operator token">=</block><block class="number token">.05</block><block class="punctuation token">,</block><block class=" token"> js_stat_threshold</block><block class="operator token">=</block><block class="number token">0.2</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Pass in two pandas dataframes with the same columns for two time windows</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        List the categorical and numeric columns, and optionally provide an alpha level</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">assert</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">pdf1</block><block class="punctuation token">.</block><block class=" token">columns </block><block class="operator token">==</block><block class=" token"> pdf2</block><block class="punctuation token">.</block><block class=" token">columns</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class="builtin token">all</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"Columns do not match"</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">pdf1 </block><block class="operator token">=</block><block class=" token"> pdf1</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">pdf2 </block><block class="operator token">=</block><block class=" token"> pdf2</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">categorical_columns </block><block class="operator token">=</block><block class=" token"> cat_cols</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">continuous_columns </block><block class="operator token">=</block><block class=" token"> num_cols</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">alpha </block><block class="operator token">=</block><block class=" token"> alpha</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">js_stat_threshold </block><block class="operator token">=</block><block class=" token"> js_stat_threshold</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">run</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Call to run drift monitoring</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">handle_numeric_js</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        self</block><block class="punctuation token">.</block><block class=" token">handle_categorical</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        pdf1_nulls </block><block class="operator token">=</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">pdf1</block><block class="punctuation token">.</block><block class=" token">isnull</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class="builtin token">sum</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class="builtin token">sum</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        pdf2_nulls </block><block class="operator token">=</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">pdf2</block><block class="punctuation token">.</block><block class=" token">isnull</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class="builtin token">sum</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class="builtin token">sum</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"</block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">pdf1_nulls</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token"> total null values found in pdf1 and </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">pdf2_nulls</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token"> in pdf2"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">handle_numeric_ks</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Handle the numeric features with the Two-Sample Kolmogorov-Smirnov (KS) Test with Bonferroni Correction </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        corrected_alpha </block><block class="operator token">=</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">alpha </block><block class="operator token">/</block><block class=" token"> </block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">continuous_columns</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">for</block><block class=" token"> num </block><block class="keyword token">in</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">continuous_columns</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            ks_stat</block><block class="punctuation token">,</block><block class=" token"> ks_pval </block><block class="operator token">=</block><block class=" token"> stats</block><block class="punctuation token">.</block><block class=" token">ks_2samp</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">pdf1</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">pdf2</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> mode</block><block class="operator token">=</block><block class="string token">"asymp"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">if</block><block class=" token"> ks_pval </block><block class="operator token">&lt;=</block><block class=" token"> corrected_alpha</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                self</block><block class="punctuation token">.</block><block class=" token">on_drift</block><block class="punctuation token">(</block><block class=" token">num</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">handle_numeric_js</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Handles the numeric features with the Jensen Shannon (JS) test using the threshold attribute</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">for</block><block class=" token"> num </block><block class="keyword token">in</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">continuous_columns</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="comment token"># Run test comparing old and new for that attribute</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            range_min </block><block class="operator token">=</block><block class=" token"> </block><block class="builtin token">min</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">pdf1</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class="builtin token">min</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">pdf2</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class="builtin token">min</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            range_max </block><block class="operator token">=</block><block class=" token"> </block><block class="builtin token">max</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">pdf1</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class="builtin token">max</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">pdf2</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class="builtin token">max</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            base </block><block class="operator token">=</block><block class=" token"> np</block><block class="punctuation token">.</block><block class=" token">histogram</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">pdf1</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> bins</block><block class="operator token">=</block><block class="number token">20</block><block class="punctuation token">,</block><block class=" token"> </block><block class="builtin token">range</block><block class="operator token">=</block><block class="punctuation token">(</block><block class=" token">range_min</block><block class="punctuation token">,</block><block class=" token"> range_max</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            comp </block><block class="operator token">=</block><block class=" token"> np</block><block class="punctuation token">.</block><block class=" token">histogram</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">pdf2</block><block class="punctuation token">[</block><block class=" token">num</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> bins</block><block class="operator token">=</block><block class="number token">20</block><block class="punctuation token">,</block><block class=" token"> </block><block class="builtin token">range</block><block class="operator token">=</block><block class="punctuation token">(</block><block class=" token">range_min</block><block class="punctuation token">,</block><block class=" token"> range_max</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            js_stat </block><block class="operator token">=</block><block class=" token"> distance</block><block class="punctuation token">.</block><block class=" token">jensenshannon</block><block class="punctuation token">(</block><block class=" token">base</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> comp</block><block class="punctuation token">[</block><block class="number token">0</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> base</block><block class="operator token">=</block><block class="number token">2</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">if</block><block class=" token"> js_stat </block><block class="operator token">&gt;=</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">js_stat_threshold</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                self</block><block class="punctuation token">.</block><block class=" token">on_drift</block><block class="punctuation token">(</block><block class=" token">num</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">      </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">handle_categorical</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Handle the Categorical features with Two-Way Chi-Squared Test with Bonferroni Correction</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Note: null counts can skew the results of the Chi-Squared Test so they're currently dropped</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">            by `.value_counts()`</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        corrected_alpha </block><block class="operator token">=</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">alpha </block><block class="operator token">/</block><block class=" token"> </block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">categorical_columns</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">for</block><block class=" token"> feature </block><block class="keyword token">in</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">categorical_columns</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            pdf_count1 </block><block class="operator token">=</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">DataFrame</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">pdf1</block><block class="punctuation token">[</block><block class=" token">feature</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class=" token">value_counts</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">sort_index</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">rename</block><block class="punctuation token">(</block><block class=" token">columns</block><block class="operator token">=</block><block class="punctuation token">{</block><block class=" token">feature</block><block class="punctuation token">:</block><block class="string token">"pdf1"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            pdf_count2 </block><block class="operator token">=</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">DataFrame</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">pdf2</block><block class="punctuation token">[</block><block class=" token">feature</block><block class="punctuation token">]</block><block class="punctuation token">.</block><block class=" token">value_counts</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">sort_index</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">rename</block><block class="punctuation token">(</block><block class=" token">columns</block><block class="operator token">=</block><block class="punctuation token">{</block><block class=" token">feature</block><block class="punctuation token">:</block><block class="string token">"pdf2"</block><block class="punctuation token">}</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            pdf_counts </block><block class="operator token">=</block><block class=" token"> pdf_count1</block><block class="punctuation token">.</block><block class=" token">join</block><block class="punctuation token">(</block><block class=" token">pdf_count2</block><block class="punctuation token">,</block><block class=" token"> how</block><block class="operator token">=</block><block class="string token">"outer"</block><block class="punctuation token">)</block><block class="comment token">#.fillna(0)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            obs </block><block class="operator token">=</block><block class=" token"> np</block><block class="punctuation token">.</block><block class=" token">array</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class=" token">pdf_counts</block><block class="punctuation token">[</block><block class="string token">"pdf1"</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> pdf_counts</block><block class="punctuation token">[</block><block class="string token">"pdf2"</block><block class="punctuation token">]</block><block class="punctuation token">]</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            _</block><block class="punctuation token">,</block><block class=" token"> p</block><block class="punctuation token">,</block><block class=" token"> _</block><block class="punctuation token">,</block><block class=" token"> _ </block><block class="operator token">=</block><block class=" token"> stats</block><block class="punctuation token">.</block><block class=" token">chi2_contingency</block><block class="punctuation token">(</block><block class=" token">obs</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">            </block><block class="keyword token">if</block><block class=" token"> p </block><block class="operator token">&lt;</block><block class=" token"> corrected_alpha</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                self</block><block class="punctuation token">.</block><block class=" token">on_drift</block><block class="punctuation token">(</block><block class=" token">feature</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">generate_null_counts</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">,</block><block class=" token"> palette</block><block class="operator token">=</block><block class="string token">"#2ecc71"</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Generate the visualization of percent null counts of all features</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Optionally provide a color palette for the visual</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        cm </block><block class="operator token">=</block><block class=" token"> sns</block><block class="punctuation token">.</block><block class=" token">light_palette</block><block class="punctuation token">(</block><block class=" token">palette</block><block class="punctuation token">,</block><block class=" token"> as_cmap</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">return</block><block class=" token"> pd</block><block class="punctuation token">.</block><block class=" token">concat</block><block class="punctuation token">(</block><block class="punctuation token">[</block><block class="number token">100</block><block class=" token"> </block><block class="operator token">*</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">pdf1</block><block class="punctuation token">.</block><block class=" token">isnull</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class="builtin token">sum</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">/</block><block class=" token"> </block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">pdf1</block><block class="punctuation token">)</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                          </block><block class="number token">100</block><block class=" token"> </block><block class="operator token">*</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">pdf2</block><block class="punctuation token">.</block><block class=" token">isnull</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class="builtin token">sum</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">/</block><block class=" token"> </block><block class="builtin token">len</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">pdf2</block><block class="punctuation token">)</block><block class="punctuation token">]</block><block class="punctuation token">,</block><block class=" token"> axis</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">,</block><block class=" token"> </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">                          keys</block><block class="operator token">=</block><block class="punctuation token">[</block><block class="string token">"pdf1"</block><block class="punctuation token">,</block><block class=" token"> </block><block class="string token">"pdf2"</block><block class="punctuation token">]</block><block class="punctuation token">)</block><block class="punctuation token">.</block><block class=" token">style</block><block class="punctuation token">.</block><block class=" token">background_gradient</block><block class="punctuation token">(</block><block class=" token">cmap</block><block class="operator token">=</block><block class=" token">cm</block><block class="punctuation token">,</block><block class=" token"> text_color_threshold</block><block class="operator token">=</block><block class="number token">0.5</block><block class="punctuation token">,</block><block class=" token"> axis</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">generate_percent_change</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">,</block><block class=" token"> palette</block><block class="operator token">=</block><block class="string token">"#2ecc71"</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Generate visualization of percent change in summary statistics of numeric features</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Optionally provide a color palette for the visual</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        cm </block><block class="operator token">=</block><block class=" token"> sns</block><block class="punctuation token">.</block><block class=" token">light_palette</block><block class="punctuation token">(</block><block class=" token">palette</block><block class="punctuation token">,</block><block class=" token"> as_cmap</block><block class="operator token">=</block><block class="boolean token">True</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        summary1_pdf </block><block class="operator token">=</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">pdf1</block><block class="punctuation token">.</block><block class=" token">describe</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">[</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">continuous_columns</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        summary2_pdf </block><block class="operator token">=</block><block class=" token"> self</block><block class="punctuation token">.</block><block class=" token">pdf2</block><block class="punctuation token">.</block><block class=" token">describe</block><block class="punctuation token">(</block><block class="punctuation token">)</block><block class="punctuation token">[</block><block class=" token">self</block><block class="punctuation token">.</block><block class=" token">continuous_columns</block><block class="punctuation token">]</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        percent_change </block><block class="operator token">=</block><block class=" token"> </block><block class="number token">100</block><block class=" token"> </block><block class="operator token">*</block><block class=" token"> </block><block class="builtin token">abs</block><block class="punctuation token">(</block><block class="punctuation token">(</block><block class=" token">summary1_pdf </block><block class="operator token">-</block><block class=" token"> summary2_pdf</block><block class="punctuation token">)</block><block class=" token"> </block><block class="operator token">/</block><block class=" token"> </block><block class="punctuation token">(</block><block class=" token">summary1_pdf </block><block class="operator token">+</block><block class=" token"> </block><block class="number token">1e</block><block class="operator token">-</block><block class="number token">100</block><block class="punctuation token">)</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">return</block><block class=" token"> percent_change</block><block class="punctuation token">.</block><block class=" token">style</block><block class="punctuation token">.</block><block class=" token">background_gradient</block><block class="punctuation token">(</block><block class=" token">cmap</block><block class="operator token">=</block><block class=" token">cm</block><block class="punctuation token">,</block><block class=" token"> text_color_threshold</block><block class="operator token">=</block><block class="number token">0.5</block><block class="punctuation token">,</block><block class=" token"> axis</block><block class="operator token">=</block><block class="number token">1</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">  </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block><block class="keyword token">def</block><block class=" token"> </block><block class="function token">on_drift</block><block class="punctuation token">(</block><block class=" token">self</block><block class="punctuation token">,</block><block class=" token"> feature</block><block class="punctuation token">)</block><block class="punctuation token">:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="triple-quoted-string string token">"""</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        Complete this method with your response to drift.  Options include:</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          - raise an alert</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">          - automatically retrain model</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="triple-quoted-string string token">        """</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">        </block><block class="keyword token">print</block><block class="punctuation token">(</block><block class="string-interpolation string token">f"Drift found in </block><block class="string-interpolation interpolation punctuation token">{</block><block class="string-interpolation interpolation token">feature</block><block class="string-interpolation interpolation punctuation token">}</block><block class="string-interpolation string token">!"</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">    </block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">drift_monitor </block><block class="operator token">=</block><block class=" token"> Monitor</block><block class="punctuation token">(</block><block class=" token">pdf1</block><block class="punctuation token">,</block><block class=" token"> pdf2</block><block class="punctuation token">,</block><block class=" token"> cat_cols</block><block class="punctuation token">,</block><block class=" token"> num_cols</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">drift_monitor</block><block class="punctuation token">.</block><block class=" token">run</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Drift found in review_scores_rating!</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># Drift found in price!</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class="comment token"># 0 total null values found in pdf1 and 200 in pdf2</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">drift_monitor</block><block class="punctuation token">.</block><block class=" token">generate_percent_change</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line><line class="text-mode code-section-line"><prefix></prefix><blocks class="code-line-blocks-container"><baselineblock></baselineblock><block class=" token">drift_monitor</block><block class="punctuation token">.</block><block class=" token">generate_null_counts</block><block class="punctuation token">(</block><block class="punctuation token">)</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 680px; height: 163.66px; position: relative;"><img src="image-resources/77e536ea-468d-4434-839d-4ee4e754c520.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 300px; height: 232.01px; position: relative;"><img src="image-resources/d285370c-499d-4bb2-a121-98186ed1987b.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.3510942035189164" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.3510942035189164" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">8.2.8. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Drift Monitoring Architecture</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>A potential workflow for deployment and dirft monitoring could look something like this:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 778px; height: 420.09px; position: relative;"><img src="image-resources/6e827bcd-5cc0-4aee-aebc-2090bd769fb3.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; background-color: rgb(255, 254, 0);">Workflow</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Deploy a model to production, using MLflow and Delta to log the model and data.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">When the next time step of data arrives:</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Get the logged input data from the current production model</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Get the observed (true) values</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Compare the evaluation metric (e.g. RMSE) between the observed values and predicted values</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Run the statistical tests shown above to identify potential drift</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">If drift is not found:</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Keep monitoring but leave original model deployed</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">If drift is found:</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>Analyze the situation and take action</block></blocks></line><line class="root text-mode indent-2 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="3"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">* </prefix><blocks><baselineblock class="inline"></baselineblock><block>If retraining/deploying an updated model is needed:</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Create a candidate model on the new data</block></blocks></line><line class="root text-mode indent-3 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>Deploy candidate model as long as it performs better than the current model on the more recent data.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block>For more information, a great talk by Chengyin Eng and Niall Turbitt can be found here: </block><block class="role-hyper-link" data-hyper-link-url="https://databricks.com/session_na21/drifting-away-testing-ml-models-in-production" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://databricks.com/session_na21/drifting-away-testing-ml-models-in-production" target="_blank" style="color: inherit; text-decoration: inherit;">Drifting Away: Testing ML Models in Production</a></block><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.3961261153696858" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.3961261153696858" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">8.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Model Rollout Strategies</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Shadow</block><block>  New deployment shows existing system but not used for decision making.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Rolling</block><block>  Updates nodes in a target environment incrementally in batches with the new service version.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 560.5px; height: 326.45px; position: relative;"><img src="image-resources/86e28581-0e41-4f56-a154-39d53652822b.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.01682528609370304" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.01682528609370304"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 74828 --> <!-- /react-text --><!-- react-text: 74829 -->4<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block class="role-hyper-link" data-hyper-link-url="https://www.harness.io/blog/blue-green-canary-deployment-strategies" style="text-decoration: underline; color: rgb(17, 85, 204);"><a href="https://www.harness.io/blog/blue-green-canary-deployment-strategies" target="_blank" style="color: inherit; text-decoration: inherit;">Source</a></block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Blue-Green</block><block>  Utilizes two identical environments, a "blue" and a "green" environment with different versions of an application or service.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 569px; height: 328.72px; position: relative;"><img src="image-resources/c03cb266-8cc2-4fba-a990-ffd5a6e3d822.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Canary</block><block>  Releases an application or service incrementally to a subset of users.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 570.5px; height: 332.07px; position: relative;"><img src="image-resources/e7be59fc-b978-453c-92b6-552b8d8e0edd.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;"> </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;"> </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">A/B Testing</block><block>  Different versions of the same service run simultaneously in the same environment for a period of time.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 583.375px; height: 339.72px; position: relative;"><img src="image-resources/a352944d-9d3e-4627-b82b-7782cab263ec.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 743px; height: 377.67px; position: relative;"><img src="image-resources/96d06af2-0f5c-4c18-8a76-9dfb96ab6641.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 740.25px; height: 295.09px; position: relative;"><img src="image-resources/0b547220-55d3-41ba-96ec-df663e0a1076.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="color: rgb(231, 55, 61);">[</block><block> </block><compositeblock dir="ltr" class="anchor-tag-ref inline" style="font-family: &quot;Computer Modern Serif&quot;, serif;"><a href="#n0.6237036695443519" style="color: inherit; text-decoration: inherit;">Back To Top</a></compositeblock><block> </block><block style="color: rgb(231, 55, 61);">]</block></blocks></line></area-container></editarea><div></div></math-edit-container></math-type></editor-container></body></html>
<!doctype html><html style="overflow:auto;height:auto;width:auto;"><head><title>[INPROGRESS] 2_visual_search_system</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><style>@font-face {
	font-family: Asana;
	src: url("fonts/Asana-Math.otf") format("opentype");
}

@font-face {
	font-family: Asana-Math;
	src: url("fonts/Asana-math-mode.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathbb;
	src: url("fonts/types-generated/Asana-mathbb.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathit;
	src: url("fonts/types-generated/Asana-mathit.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathcal;
	src: url("fonts/types-generated/Asana-mathcal.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathscr;
	src: url("fonts/types-generated/Asana-mathscr.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathfrak;
	src: url("fonts/types-generated/Asana-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathsf;
	src: url("fonts/types-generated/Asana-mathsf.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathtt;
	src: url("fonts/types-generated/Asana-mathtt.otf") format("opentype");
}

@font-face {
	font-family: Asana-Mathrm;
	src: url("fonts/types-generated/Asana-mathrm.otf") format("opentype");
}

@font-face {
	font-family: 'FontAwesome';
	src: url('fonts/icomoon.eot');
	src: url('fonts/icomoon.eot') format('embedded-opentype'), url('fonts/icomoon.woff') format('woff'), url('fonts/icomoon.ttf') format('truetype'), url('fonts/icomoon.svg') format('svg');
	font-weight: normal;
	font-style: normal;
}

/**
Latin Modern
**/

@font-face {
	font-family: LatinModern;
	src: url("fonts/latinmodern-math.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Math;
	src: url("fonts/latinmodern-math-mode.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathbb;
	src: url("fonts/types-generated/latinmodern-mathbb.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathit;
	src: url("fonts/types-generated/latinmodern-mathit.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathcal;
	src: url("fonts/types-generated/latinmodern-mathcal.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathscr;
	src: url("fonts/types-generated/latinmodern-mathscr.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathfrak;
	src: url("fonts/types-generated/latinmodern-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathsf;
	src: url("fonts/types-generated/latinmodern-mathsf.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathtt;
	src: url("fonts/types-generated/latinmodern-mathtt.otf") format("opentype");
}

@font-face {
	font-family: LatinModern-Mathrm;
	src: url("fonts/types-generated/latinmodern-mathrm.otf") format("opentype");
}

/***********************************************************/

/**
Thicker Latin Modern
**/

@font-face {
	font-family: ThickerLm;
	src: url("fonts/thickerlm-math.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Math;
	src: url("fonts/thickerlm-math-mode.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathbb;
	src: url("fonts/types-generated/thickerlm-mathbb.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathit;
	src: url("fonts/types-generated/thickerlm-mathit.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathcal;
	src: url("fonts/types-generated/thickerlm-mathcal.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathscr;
	src: url("fonts/types-generated/thickerlm-mathscr.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathfrak;
	src: url("fonts/types-generated/thickerlm-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathsf;
	src: url("fonts/types-generated/thickerlm-mathsf.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathtt;
	src: url("fonts/types-generated/thickerlm-mathtt.otf") format("opentype");
}

@font-face {
	font-family: ThickerLm-Mathrm;
	src: url("fonts/types-generated/thickerlm-mathrm.otf") format("opentype");
}

/***********************************************************/

/* Computer Modern */

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunss.otf') format("opentype");
	font-weight: normal;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunsx.otf') format("opentype");
	font-weight: bold;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunsi.otf') format("opentype");
	font-weight: normal;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Sans';
	src: url('fonts/others-text-mode/computer-modern/Sans/cmunso.otf') format("opentype");
	font-weight: bold;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunrm.otf') format("opentype");
	font-weight: normal;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunbx.otf') format("opentype");
	font-weight: bold;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunti.otf') format("opentype");
	font-weight: normal;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Serif';
	src: url('fonts/others-text-mode/computer-modern/Serif/cmunbi.otf') format("opentype");
	font-weight: bold;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmuntt.otf') format("opentype");
	font-weight: normal;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmuntb.otf') format("opentype");
	font-weight: bold;
	font-style: normal;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmunit.otf') format("opentype");
	font-weight: normal;
	font-style: italic;
}

@font-face {
	font-family: 'Computer Modern Typewriter';
	src: url('fonts/others-text-mode/computer-modern/Typewriter/cmuntx.otf') format("opentype");
	font-weight: bold;
	font-style: italic;
}

/**/

/**
Sans Math + Liberation Font
**/

@font-face {
	font-family: Sans;
	src: url("fonts/Sans-Math.otf") format("opentype");
}

@font-face {
	font-family: Sans-Math;
	src: url("fonts/Sans-Math-mode.otf") format("opentype");
}

@font-face {
	font-family: Sans-Bold;
	src: url("fonts/types-generated/Sans-bold.otf") format("opentype");
	font-weight: bold;
}

@font-face {
	font-family: Sans-Mathbb;
	src: url("fonts/types-generated/Asana-mathbb.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathit;
	src: url("fonts/types-generated/Sans-mathit.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathcal;
	src: url("fonts/types-generated/Asana-mathcal.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathscr;
	src: url("fonts/types-generated/Asana-mathscr.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathfrak;
	src: url("fonts/types-generated/Asana-mathfrak.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathsf;
	src: url("fonts/types-generated/Asana-mathsf.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathtt;
	src: url("fonts/types-generated/Asana-mathtt.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathrm;
	src: url("fonts/types-generated/Asana-mathrm.otf") format("opentype");
}

@font-face {
	font-family: Sans-Mathbf;
	src: url("fonts/types-generated/Sans-mathbf.otf") format("opentype");
	font-weight: bold;
}

/***********************************************************/</style><style>

compositeblock {
  display: inline-block;
  position: relative;
  text-align: left;
  unicode-bidi: isolate;
}
compositeblock.middle {
  vertical-align: middle;
}
latex-symbol-icon {
  display: inline-block;
  padding: 2px;
  border: 1px solid transparent;
  cursor: pointer;
}
latex-symbol-icon:hover,
latex-symbol-icon.selected {
  background: white;
  border: 1px solid lightgray;
}
inline {
  display: inline-block;
}
base-line-indicator {
  display: inline-block;
  overflow: hidden;
  width: 0px;
  height: inherit;
}

math-type .constant-text > constant-text {
  margin-left: 0.2em;
  margin-right: 0.2em;
}
math-type .constant-text > constant-text.close-left {
  margin-left: 0;
}
math-type .constant-text > constant-text.close-right {
  margin-right: 0;
}



/**different context*/
/**different context*/
math-type ref-tag {
  position: absolute;
  right: 5px;
  top: 50%;
  transform: translate(0, -50%);
  z-index: 8;
  cursor: pointer;
}
math-type ref-tag > label {
  cursor: pointer;
}
math-type ref-tag:hover {
  text-decoration: underline;
}
math-type ref-tag.line-tag {
  transition: background 0.4s;
}
math-type ref-tag.empty-line-tag {
  opacity: 0.5;
  animation: fadein 0.5s;
}
math-type tr.math-row ref-tag {
  left: calc(100% + 20px);
  right: unset;
}
@keyframes fadein {
  0% {
    opacity: 0;
  }
  70% {
    opacity: 0;
  }
  100% {
    opacity: 0.5;
  }
}







.color-picker no-color-select {
  display: block;
  text-align: center;
  /* width: 100%; */
  /* height: 20px; */
  background: white;
  border: 1px solid lightgray;
  margin-bottom: 2px;
  color: gray;
  padding: 2px;
  cursor: default;
  border-radius: 0;
  padding-bottom: 2px;
  margin-bottom: 3px;
  margin-left: -1px;
  margin-right: -1px;
  font-size: 13px;
}
.color-picker no-color-select:hover {
  color: black;
}
.color-picker color-select {
  position: absolute;
  top: 30px;
  left: 0px;
  background: white;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type editarea.no-area-container,
math-type editarea.text-mode,
math-type area-container,
math-type .print-as-area-container {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
math-type editarea.no-area-container > line,
math-type editarea.text-mode > line,
math-type area-container > line,
math-type .print-as-area-container > line {
  min-width: 0.3em;
  position: relative;
  display: block;
  width: 100%;
  align-items: baseline;
  flex-wrap: wrap;
  box-sizing: border-box;
  flex-wrap: nowrap;
  line-height: 1.2;
  white-space: nowrap;
}
math-type editarea.no-area-container > line block,
math-type editarea.text-mode > line block,
math-type area-container > line block,
math-type .print-as-area-container > line block {
  white-space: pre;
}
math-type editarea.no-area-container > line.single-block > blocks > baselineblock,
math-type editarea.text-mode > line.single-block > blocks > baselineblock,
math-type area-container > line.single-block > blocks > baselineblock,
math-type .print-as-area-container > line.single-block > blocks > baselineblock {
  display: none;
}
math-type editarea.no-area-container > line > blocks,
math-type editarea.text-mode > line > blocks,
math-type area-container > line > blocks,
math-type .print-as-area-container > line > blocks {
  /**
            Different between inline and inline-block is about whether Section Text will be wrap in next wrapped line 
            */
  display: inline-block;
  text-align: left;
}
math-type editarea.no-area-container > line.root,
math-type editarea.text-mode > line.root,
math-type area-container > line.root,
math-type .print-as-area-container > line.root,
math-type editarea.no-area-container > line.text-mode,
math-type editarea.text-mode > line.text-mode,
math-type area-container > line.text-mode,
math-type .print-as-area-container > line.text-mode {
  display: block;
  font-style: normal;
}
math-type editarea.no-area-container > line.root > prefix,
math-type editarea.text-mode > line.root > prefix,
math-type area-container > line.root > prefix,
math-type .print-as-area-container > line.root > prefix,
math-type editarea.no-area-container > line.text-mode > prefix,
math-type editarea.text-mode > line.text-mode > prefix,
math-type area-container > line.text-mode > prefix,
math-type .print-as-area-container > line.text-mode > prefix {
  white-space: pre;
  display: inline-block;
  cursor: default;
  text-align: left;
}
math-type editarea.no-area-container > line.root > blocks,
math-type editarea.text-mode > line.root > blocks,
math-type area-container > line.root > blocks,
math-type .print-as-area-container > line.root > blocks,
math-type editarea.no-area-container > line.text-mode > blocks,
math-type editarea.text-mode > line.text-mode > blocks,
math-type area-container > line.text-mode > blocks,
math-type .print-as-area-container > line.text-mode > blocks {
  /** should not wrap here*/
  align-items: baseline;
  box-sizing: border-box;
}
math-type editarea.no-area-container > line.root > blocks > block,
math-type editarea.text-mode > line.root > blocks > block,
math-type area-container > line.root > blocks > block,
math-type .print-as-area-container > line.root > blocks > block,
math-type editarea.no-area-container > line.text-mode > blocks > block,
math-type editarea.text-mode > line.text-mode > blocks > block,
math-type area-container > line.text-mode > blocks > block,
math-type .print-as-area-container > line.text-mode > blocks > block {
  white-space: pre-wrap;
  white-space: break-spaces;
}
math-type editarea.no-area-container > line.root.full-line-block-inside > prefix,
math-type editarea.text-mode > line.root.full-line-block-inside > prefix,
math-type area-container > line.root.full-line-block-inside > prefix,
math-type .print-as-area-container > line.root.full-line-block-inside > prefix,
math-type editarea.no-area-container > line.text-mode.full-line-block-inside > prefix,
math-type editarea.text-mode > line.text-mode.full-line-block-inside > prefix,
math-type area-container > line.text-mode.full-line-block-inside > prefix,
math-type .print-as-area-container > line.text-mode.full-line-block-inside > prefix {
  float: left;
  vertical-align: top;
}
math-type editarea.no-area-container > line.root.full-line-block-inside > blocks,
math-type editarea.text-mode > line.root.full-line-block-inside > blocks,
math-type area-container > line.root.full-line-block-inside > blocks,
math-type .print-as-area-container > line.root.full-line-block-inside > blocks,
math-type editarea.no-area-container > line.text-mode.full-line-block-inside > blocks,
math-type editarea.text-mode > line.text-mode.full-line-block-inside > blocks,
math-type area-container > line.text-mode.full-line-block-inside > blocks,
math-type .print-as-area-container > line.text-mode.full-line-block-inside > blocks {
  display: block;
  width: 100%;
}
math-type editarea.no-area-container > line.root.full-line-block-inside > blocks > baselineblock,
math-type editarea.text-mode > line.root.full-line-block-inside > blocks > baselineblock,
math-type area-container > line.root.full-line-block-inside > blocks > baselineblock,
math-type .print-as-area-container > line.root.full-line-block-inside > blocks > baselineblock,
math-type editarea.no-area-container > line.text-mode.full-line-block-inside > blocks > baselineblock,
math-type editarea.text-mode > line.text-mode.full-line-block-inside > blocks > baselineblock,
math-type area-container > line.text-mode.full-line-block-inside > blocks > baselineblock,
math-type .print-as-area-container > line.text-mode.full-line-block-inside > blocks > baselineblock {
  display: inline-block;
  float: left;
}
math-type editarea.no-area-container > line.root.has-rtl.align-justify,
math-type editarea.text-mode > line.root.has-rtl.align-justify,
math-type area-container > line.root.has-rtl.align-justify,
math-type .print-as-area-container > line.root.has-rtl.align-justify,
math-type editarea.no-area-container > line.text-mode.has-rtl.align-justify,
math-type editarea.text-mode > line.text-mode.has-rtl.align-justify,
math-type area-container > line.text-mode.has-rtl.align-justify,
math-type .print-as-area-container > line.text-mode.has-rtl.align-justify {
  direction: rtl;
}
math-type editarea.no-area-container > line.root.section,
math-type editarea.text-mode > line.root.section,
math-type area-container > line.root.section,
math-type .print-as-area-container > line.root.section,
math-type editarea.no-area-container > line.text-mode.section,
math-type editarea.text-mode > line.text-mode.section,
math-type area-container > line.text-mode.section,
math-type .print-as-area-container > line.text-mode.section {
  text-align: left;
}
math-type editarea.no-area-container > line.root.section > blocks,
math-type editarea.text-mode > line.root.section > blocks,
math-type area-container > line.root.section > blocks,
math-type .print-as-area-container > line.root.section > blocks,
math-type editarea.no-area-container > line.text-mode.section > blocks,
math-type editarea.text-mode > line.text-mode.section > blocks,
math-type area-container > line.text-mode.section > blocks,
math-type .print-as-area-container > line.text-mode.section > blocks {
  /**
                    Different between inline and inline-block is about whether Section Text will be wrap in next wrapped line 
                    */
  display: inline;
}
math-type editarea.no-area-container > line.root.section.has-rtl,
math-type editarea.text-mode > line.root.section.has-rtl,
math-type area-container > line.root.section.has-rtl,
math-type .print-as-area-container > line.root.section.has-rtl,
math-type editarea.no-area-container > line.text-mode.section.has-rtl,
math-type editarea.text-mode > line.text-mode.section.has-rtl,
math-type area-container > line.text-mode.section.has-rtl,
math-type .print-as-area-container > line.text-mode.section.has-rtl {
  direction: rtl;
}
math-type editarea.no-area-container > line.root.section.has-rtl > prefix,
math-type editarea.text-mode > line.root.section.has-rtl > prefix,
math-type area-container > line.root.section.has-rtl > prefix,
math-type .print-as-area-container > line.root.section.has-rtl > prefix,
math-type editarea.no-area-container > line.text-mode.section.has-rtl > prefix,
math-type editarea.text-mode > line.text-mode.section.has-rtl > prefix,
math-type area-container > line.text-mode.section.has-rtl > prefix,
math-type .print-as-area-container > line.text-mode.section.has-rtl > prefix {
  direction: rtl;
  order: 1;
}
math-type editarea.no-area-container > line.root.theorem,
math-type editarea.text-mode > line.root.theorem,
math-type area-container > line.root.theorem,
math-type .print-as-area-container > line.root.theorem,
math-type editarea.no-area-container > line.text-mode.theorem,
math-type editarea.text-mode > line.text-mode.theorem,
math-type area-container > line.text-mode.theorem,
math-type .print-as-area-container > line.text-mode.theorem {
  padding-top: 0.3em;
  padding-bottom: 0.3em;
}
math-type editarea.no-area-container > line > prefix,
math-type editarea.text-mode > line > prefix,
math-type area-container > line > prefix,
math-type .print-as-area-container > line > prefix {
  text-align: right;
}
math-type editarea.no-area-container > line.has-indent,
math-type editarea.text-mode > line.has-indent,
math-type area-container > line.has-indent,
math-type .print-as-area-container > line.has-indent {
  display: flex;
  justify-content: flex-start;
}
math-type editarea.no-area-container > line.has-rtl.has-indent > prefix,
math-type editarea.text-mode > line.has-rtl.has-indent > prefix,
math-type area-container > line.has-rtl.has-indent > prefix,
math-type .print-as-area-container > line.has-rtl.has-indent > prefix {
  direction: rtl;
  order: 1;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-0,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-0,
math-type area-container > line.has-rtl.has-indent.indent-0,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-0 {
  padding-left: 0;
  padding-right: 30px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-1,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-1,
math-type area-container > line.has-rtl.has-indent.indent-1,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-1 {
  padding-left: 0;
  padding-right: 65px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-2,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-2,
math-type area-container > line.has-rtl.has-indent.indent-2,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-2 {
  padding-left: 0;
  padding-right: 105px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-3,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-3,
math-type area-container > line.has-rtl.has-indent.indent-3,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-3 {
  padding-left: 0;
  padding-right: 145px;
}
math-type editarea.no-area-container > line.has-rtl.has-indent.indent-4,
math-type editarea.text-mode > line.has-rtl.has-indent.indent-4,
math-type area-container > line.has-rtl.has-indent.indent-4,
math-type .print-as-area-container > line.has-rtl.has-indent.indent-4 {
  padding-left: 0;
  padding-right: 185px;
}
math-type editarea.no-area-container > line.indent-0,
math-type editarea.text-mode > line.indent-0,
math-type area-container > line.indent-0,
math-type .print-as-area-container > line.indent-0 {
  padding-left: 30px;
}
math-type editarea.no-area-container > line.indent-1,
math-type editarea.text-mode > line.indent-1,
math-type area-container > line.indent-1,
math-type .print-as-area-container > line.indent-1 {
  padding-left: 65px;
}
math-type editarea.no-area-container > line.indent-2,
math-type editarea.text-mode > line.indent-2,
math-type area-container > line.indent-2,
math-type .print-as-area-container > line.indent-2 {
  padding-left: 105px;
}
math-type editarea.no-area-container > line.indent-3,
math-type editarea.text-mode > line.indent-3,
math-type area-container > line.indent-3,
math-type .print-as-area-container > line.indent-3 {
  padding-left: 145px;
}
math-type editarea.no-area-container > line.indent-4,
math-type editarea.text-mode > line.indent-4,
math-type area-container > line.indent-4,
math-type .print-as-area-container > line.indent-4 {
  padding-left: 185px;
}
math-type editarea.no-area-container > line.math-container-selected,
math-type editarea.text-mode > line.math-container-selected,
math-type area-container > line.math-container-selected,
math-type .print-as-area-container > line.math-container-selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type editarea.no-area-container > line.math-container,
math-type editarea.text-mode > line.math-container,
math-type area-container > line.math-container,
math-type .print-as-area-container > line.math-container {
  font-family: 'Asana';
  justify-content: center;
  text-align: center;
  text-align-last: auto;
  display: flex;
}
math-type editarea.no-area-container > line.math-container block,
math-type editarea.text-mode > line.math-container block,
math-type area-container > line.math-container block,
math-type .print-as-area-container > line.math-container block {
  white-space: pre;
}
math-type editarea.no-area-container > line.align-center,
math-type editarea.text-mode > line.align-center,
math-type area-container > line.align-center,
math-type .print-as-area-container > line.align-center {
  text-align: center;
  text-align-last: auto;
}
math-type editarea.no-area-container > line.align-center.has-indent,
math-type editarea.text-mode > line.align-center.has-indent,
math-type area-container > line.align-center.has-indent,
math-type .print-as-area-container > line.align-center.has-indent {
  justify-content: center;
}
math-type editarea.no-area-container > line.align-center.section,
math-type editarea.text-mode > line.align-center.section,
math-type area-container > line.align-center.section,
math-type .print-as-area-container > line.align-center.section {
  text-align: center;
  text-align-last: auto;
}
math-type editarea.no-area-container > line.align-center > blocks,
math-type editarea.text-mode > line.align-center > blocks,
math-type area-container > line.align-center > blocks,
math-type .print-as-area-container > line.align-center > blocks {
  text-align: center;
  text-align-last: auto;
}
math-type editarea.no-area-container > line.align-justify,
math-type editarea.text-mode > line.align-justify,
math-type area-container > line.align-justify,
math-type .print-as-area-container > line.align-justify {
  text-align: justify;
}
math-type editarea.no-area-container > line.align-justify.section,
math-type editarea.text-mode > line.align-justify.section,
math-type area-container > line.align-justify.section,
math-type .print-as-area-container > line.align-justify.section {
  text-align: justify;
}
math-type editarea.no-area-container > line.align-justify > blocks,
math-type editarea.text-mode > line.align-justify > blocks,
math-type area-container > line.align-justify > blocks,
math-type .print-as-area-container > line.align-justify > blocks {
  text-align: justify;
}
math-type editarea.no-area-container > line.align-left,
math-type editarea.text-mode > line.align-left,
math-type area-container > line.align-left,
math-type .print-as-area-container > line.align-left {
  text-align: left;
}
math-type editarea.no-area-container > line.align-left > blocks,
math-type editarea.text-mode > line.align-left > blocks,
math-type area-container > line.align-left > blocks,
math-type .print-as-area-container > line.align-left > blocks {
  text-align: left;
}
math-type editarea.no-area-container > line.align-right,
math-type editarea.text-mode > line.align-right,
math-type area-container > line.align-right,
math-type .print-as-area-container > line.align-right {
  text-align: right;
}
math-type editarea.no-area-container > line.align-right.has-indent,
math-type editarea.text-mode > line.align-right.has-indent,
math-type area-container > line.align-right.has-indent,
math-type .print-as-area-container > line.align-right.has-indent {
  justify-content: flex-end;
}
math-type editarea.no-area-container > line.align-right.section,
math-type editarea.text-mode > line.align-right.section,
math-type area-container > line.align-right.section,
math-type .print-as-area-container > line.align-right.section {
  text-align: right;
}
math-type editarea.no-area-container > line.align-right > blocks,
math-type editarea.text-mode > line.align-right > blocks,
math-type area-container > line.align-right > blocks,
math-type .print-as-area-container > line.align-right > blocks {
  text-align: right;
}
math-type editarea.no-area-container > line > blocks > block,
math-type editarea.text-mode > line > blocks > block,
math-type area-container > line > blocks > block,
math-type .print-as-area-container > line > blocks > block {
  display: inline;
}
math-type editarea.no-area-container,
math-type area-container {
  align-items: initial;
}
math-type editarea.root-editor {
  align-items: initial;
  display: block;
  color: black;
  fill: black;
  stroke: black;
  border-color: black;
}
math-type editarea.root-editor.read-only {
  cursor: default;
}
math-type editarea.root-editor.read-only block {
  cursor: default;
}
math-type editarea.root-editor > area-container {
  display: block;
}
math-type area-container {
  width: 100%;
}
math-type block {
  cursor: text;
}
math-type editarea {
  box-sizing: border-box;
  display: flex;
  overflow-x: visible;
  align-items: center;
  justify-content: center;
  flex-direction: row;
  flex-wrap: nowrap;
}
math-type editarea block {
  cursor: text;
}
math-type editarea.high-order {
  position: relative;
  z-index: 10;
}
math-type editarea.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type editarea.bordered {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type editarea.center > area-container > line,
math-type editarea.center > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type editarea.left > area-container > line,
math-type editarea.left > line {
  justify-content: flex-start;
  text-align: left;
}
math-type editarea.right > area-container > line,
math-type editarea.right > line {
  justify-content: flex-end;
  text-align: right;
}
math-type editarea > area-baseline {
  width: 0;
  overflow: hidden;
  display: inline-block;
  float: left;
}
math-type setting.mt-common-dialog.line-tag-setting {
  transform: translate(0, -100%);
  position: absolute;
  font-family: serif;
  font-size: 11px;
  top: -4px;
  left: -10px;
  outline: none;
}
math-type setting.mt-common-dialog.line-tag-setting i {
  font-style: normal;
  padding: 1px 3px;
}
baselineblock {
  height: 0px;
  display: inline-block;
  width: 0;
  overflow: hidden;
}
baselineblock.inline {
  display: inline;
}
emptyblock {
  white-space: pre;
}
composite {
  display: inline-block;
}
block.Binary {
  padding: 0 0.2em;
}
block.Relation {
  padding: 0 0.3em;
}
block.Punctuation {
  padding-right: 0.2em;
}




check-box-wrapper {
  display: block;
  font-size: 11px;
  color: gray;
  cursor: pointer;
}
check-box-wrapper.disabled {
  color: lightgray;
}
check-box-wrapper.disabled check-box-rect {
  border: 1px solid #e2e1e1;
  color: lightgray;
}
check-box-wrapper.disabled check-box-rect:hover {
  border: 1px solid #e2e1e1;
}
check-box-wrapper.mobile-tablet check-box-rect {
  margin-top: -3px;
  width: 16px;
  height: 15px;
  font-size: 13px;
}
check-box-wrapper.mobile-tablet check-box-rect > i {
  left: 2px;
  top: 1px;
}
check-box-wrapper check-box-rect {
  width: 1.4em;
  height: 1.35em;
  border: 1px solid #c3c2c2;
  position: relative;
  display: inline-flex;
  font-size: 11px;
  color: green;
  background: white;
  justify-content: center;
  align-items: center;
}
check-box-wrapper check-box-rect:hover {
  border: 1px solid gray;
}
check-box-wrapper.unchecked check-box-rect > i {
  visibility: hidden;
}

vcomposed-symbol {
  display: flex;
  width: 100%;
  height: 100%;
  overflow: hidden;
  flex-direction: column;
}
vcomposed-symbol > start {
  display: block;
  float: left;
  overflow: hidden;
  margin-bottom: -0.02em;
}
vcomposed-symbol > middle-center {
  overflow: hidden;
  margin-top: -0.02em;
  margin-bottom: -0.02em;
}
vcomposed-symbol > middle {
  display: block;
  flex-grow: 1;
  position: relative;
  overflow: hidden;
  margin-top: -0.02em;
  margin-bottom: -0.02em;
}
vcomposed-symbol > middle > fixed {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
}
vcomposed-symbol > middle > fixed > inside {
  display: block;
  overflow: hidden;
}
vcomposed-symbol > end {
  margin-top: -0.02em;
  display: block;
  overflow: hidden;
}


.open-brace,
.close-brace {
  padding: 0 0.1em;
  width: 0.5em;
  min-width: 0.5em;
}
.open-brace > start,
.close-brace > start {
  min-height: 0.75em;
  height: 0.75em;
}
.open-brace > middle-center,
.close-brace > middle-center {
  min-height: 0.6em;
  height: 0.6em;
}
.open-brace > end,
.close-brace > end {
  min-height: 0.75em;
  height: 0.75em;
}
.open-bracket,
.close-bracket {
  width: 0.43em;
  min-width: 0.43em;
}
.open-bracket > start,
.close-bracket > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-bracket > end,
.close-bracket > end {
  height: 0.7em;
  min-height: 0.7em;
}
.open-parenthesis,
.close-parenthesis {
  width: 0.45em;
  min-width: 0.45em;
}
.open-parenthesis > start,
.close-parenthesis > start {
  min-height: 0.85em;
  height: 0.85em;
}
.open-parenthesis > end,
.close-parenthesis > end {
  min-height: 0.8em;
  height: 0.8em;
}
.open-floor,
.close-floor {
  width: 0.45em;
  min-width: 0.45em;
}
.open-floor > end,
.close-floor > end {
  height: 0.35em;
  min-height: 0.35em;
}
.open-ceil,
.close-ceil {
  width: 0.45em;
  min-width: 0.45em;
}
.open-ceil > start,
.close-ceil > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-vert,
.close-vert {
  width: 0.3em;
  min-width: 0.3em;
}
.open-Vert,
.close-Vert {
  width: 0.5em;
  min-width: 0.5em;
}
.open-uparrow,
.close-uparrow {
  width: 0.45em;
  min-width: 0.45em;
}
.open-uparrow > start,
.close-uparrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-downarrow,
.close-downarrow {
  width: 0.45em;
  min-width: 0.45em;
}
.open-downarrow > end,
.close-downarrow > end {
  height: 0.4em;
  min-height: 0.4em;
}
.open-updownarrow,
.close-updownarrow {
  width: 0.45em;
  min-width: 0.45em;
}
.open-updownarrow > start,
.close-updownarrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-updownarrow > end,
.close-updownarrow > end {
  height: 0.4em;
  min-height: 0.4em;
}
.open-Uparrow,
.close-Uparrow {
  width: 0.7em;
  min-width: 0.7em;
}
.open-Uparrow > start,
.close-Uparrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-Downarrow,
.close-Downarrow {
  width: 0.7em;
  min-width: 0.7em;
}
.open-Downarrow > end,
.close-Downarrow > end {
  height: 0.5em;
  min-height: 0.5em;
}
.open-Updownarrow,
.close-Updownarrow {
  width: 0.6em;
  min-width: 0.6em;
}
.open-Updownarrow > start,
.close-Updownarrow > start {
  height: 0.5em;
  min-height: 0.5em;
}
.open-Updownarrow > end,
.close-Updownarrow > end {
  height: 0.5em;
  min-height: 0.5em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
opensymbolblock,
closesymbolblock,
.middle-vert-symbol {
  display: inline-flex;
  align-items: center;
  position: relative;
  text-align: left;
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}
opensymbolblock.normal,
closesymbolblock.normal,
.middle-vert-symbol.normal {
  margin-top: 0;
  margin-bottom: 0;
}
opensymbolblock > hidden-span,
closesymbolblock > hidden-span,
.middle-vert-symbol > hidden-span {
  visibility: hidden;
  width: 0px;
}
opensymbolblock[type='brace'],
closesymbolblock[type='brace'],
.middle-vert-symbol[type='brace'] {
  margin-left: 0.05em;
  margin-right: 0.05em;
  overflow: visible;
}
opensymbolblock[type='brace'] > svg,
closesymbolblock[type='brace'] > svg,
.middle-vert-symbol[type='brace'] > svg {
  overflow: visible;
  width: 0.5em;
  height: 100%;
}
opensymbolblock[type='parenthesis'] > svg,
closesymbolblock[type='parenthesis'] > svg,
.middle-vert-symbol[type='parenthesis'] > svg {
  width: 0.5em;
  height: 100%;
}
opensymbolblock[type='bracket'] > svg,
closesymbolblock[type='bracket'] > svg,
.middle-vert-symbol[type='bracket'] > svg {
  width: 0.5em;
  height: 100%;
}
opensymbolblock[type='angle'].sm-1 > svg,
closesymbolblock[type='angle'].sm-1 > svg,
.middle-vert-symbol[type='angle'].sm-1 > svg {
  width: 0.3em;
}
opensymbolblock[type='angle'].sm-2 > svg,
closesymbolblock[type='angle'].sm-2 > svg,
.middle-vert-symbol[type='angle'].sm-2 > svg {
  width: 0.45em;
}
opensymbolblock[type='angle'] > svg,
closesymbolblock[type='angle'] > svg,
.middle-vert-symbol[type='angle'] > svg {
  width: 0.6em;
  height: 100%;
}
opensymbolblock[type='slash'] > svg,
closesymbolblock[type='slash'] > svg,
.middle-vert-symbol[type='slash'] > svg {
  width: 0.7em;
  height: 100%;
}
opensymbolblock > bracket-span,
closesymbolblock > bracket-span,
.middle-vert-symbol > bracket-span {
  display: block;
}
opensymbolblock > vcomposed-symbol,
closesymbolblock > vcomposed-symbol,
.middle-vert-symbol > vcomposed-symbol,
opensymbolblock > bracket-span,
closesymbolblock > bracket-span,
.middle-vert-symbol > bracket-span {
  height: 100%;
  width: 100%;
  font-style: normal;
}
opensymbolblock > brace-span,
closesymbolblock > brace-span,
.middle-vert-symbol > brace-span {
  visibility: hidden;
  display: inline-block;
  padding: 0 0.1em;
}
opensymbolblock,
.middle-vert-symbol {
  margin-left: 0.07em;
}
opensymbolblock.normal,
.middle-vert-symbol.normal {
  margin-left: 0;
}
opensymbolblock[type='vert'],
.middle-vert-symbol[type='vert'],
opensymbolblock.middle-vert-symbol,
.middle-vert-symbol.middle-vert-symbol {
  margin-left: 0.05em;
  margin-right: 0.05em;
}
opensymbolblock[type='vert'] > svg,
.middle-vert-symbol[type='vert'] > svg,
opensymbolblock.middle-vert-symbol > svg,
.middle-vert-symbol.middle-vert-symbol > svg {
  width: 0.4em;
  height: 100%;
}
opensymbolblock[type='parenthesis'] > svg,
.middle-vert-symbol[type='parenthesis'] > svg {
  margin-right: -0.1em;
}
closesymbolblock {
  margin-right: 0.07em;
}
closesymbolblock.normal {
  margin-right: 0;
}
closesymbolblock[type='vert'] {
  margin-left: 0.05em;
  margin-right: 0.05em;
}
closesymbolblock[type='vert'] > svg {
  width: 0.4em;
  height: 100%;
}
closesymbolblock[type='parenthesis'] > svg {
  margin-left: -0.1em;
}

opensymbolblock[type=empty] > empty,
closesymbolblock[type=empty] > empty {
  width: 2px;
  height: 100%;
  display: block;
}
opensymbolblock[type=empty] > empty.normal-size,
closesymbolblock[type=empty] > empty.normal-size {
  height: 1em;
}
opensymbolblock[type=empty] > empty.line-selected,
closesymbolblock[type=empty] > empty.line-selected {
  background-color: lightgray;
}

.dirac-bracket-symbol > div > .oangle,
.dirac-bracket-symbol > div > .cangle {
  align-self: stretch;
  width: 0.55em;
  position: relative;
  margin-top: 0.1em;
  margin-bottom: -0.1em;
}
.dirac-bracket-symbol > div > .oangle > svg,
.dirac-bracket-symbol > div > .cangle > svg {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}
.dirac-bracket-symbol > div > .vert {
  align-self: stretch;
  width: 0.25em;
  position: relative;
  margin-top: 0.1em;
  margin-bottom: -0.1em;
}
.dirac-bracket-symbol > div > .vert > svg {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}
.dirac-bracket-symbol > div > editarea.first {
  min-width: 0.3em;
  padding-right: 0.1em;
}
.dirac-bracket-symbol > div > editarea.last {
  min-width: 0.3em;
  padding-left: 0.1em;
}
.dirac-bracket-symbol > div > editarea.middle {
  min-width: 0.3em;
  padding-left: 0.1em;
  padding-right: 0.1em;
}

cancel-symbol > editarea {
  display: inline-flex;
}
cancel-symbol > svg {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: visible;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.frac-slashed-symbol.frac-inline {
  font-size: 0.75em;
}
math-type compositeblock.fraction-symbol {
  margin-left: 0.1em;
  margin-right: 0.1em;
  vertical-align: baseline;
}
math-type compositeblock.fraction-symbol.frac-inline {
  font-size: 0.75em;
}
math-type compositeblock.fraction-symbol > .enumerator {
  float: left;
  width: 100%;
  clear: both;
}
math-type compositeblock.fraction-symbol > .denominator {
  margin-top: -5px;
  float: left;
  width: 100%;
}
math-type compositeblock.fraction-symbol > .frac-line {
  clear: both;
  pointer-events: none;
}
math-type compositeblock.fraction-symbol > .frac-line > inline {
  display: inline-block;
  width: 100%;
  vertical-align: 0.25em;
  border-bottom: solid 1px;
}
math-type compositeblock.fraction-symbol > editarea {
  border: 0px;
  min-width: 0.6em;
  text-align: center;
  text-align-last: auto;
}
math-type compositeblock.fraction-symbol > editarea > area-container > line,
math-type compositeblock.fraction-symbol > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type compositeblock.fraction-symbol > editarea-line {
  text-align: center;
  text-align-last: auto;
}

.stackrel-icon {
  margin: auto;
  display: flex;
  align-items: center;
  flex-direction: column;
}
.stackrel-icon .square {
  width: 6px;
  height: 6px;
  border-style: solid;
  border-width: 1px;
  border-color: gray;
}
.stackrel-icon .distance {
  margin-top: 3px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .stackrel-symbol.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type .stackrel-symbol > .cur-value {
  clear: both;
  display: inline-flex;
  width: 100%;
}
math-type .stackrel-symbol > .top {
  float: left;
  clear: both;
  width: 100%;
  font-size: 0.7em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .underset-symbol > .center {
  display: inline-flex;
  width: 100%;
}
math-type .underset-symbol > .bottom {
  float: left;
  display: block;
  width: 100%;
  font-size: 0.7em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-under-set-symbol.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type .over-under-set-symbol > .top {
  display: flex;
  float: left;
  clear: both;
  width: 100%;
}
math-type .over-under-set-symbol > .top > line {
  font-size: 0.7em;
}
math-type .over-under-set-symbol > .middle {
  display: inline-flex;
  width: 100%;
  clear: both;
}
math-type .over-under-set-symbol > .middle.select {
  border-bottom: none;
}
math-type .over-under-set-symbol > .bottom {
  display: flex;
  float: left;
  width: 100%;
}
math-type .over-under-set-symbol > .bottom > line {
  font-size: 0.7em;
}

expandable-component.thickness item-option.thickness-option {
  width: 40px;
  height: 12px;
}
expandable-component.thickness svg {
  stroke: gray;
  stroke-width: 1px;
  fill: none;
}
expandable-component.thickness thickness {
  position: relative;
  display: flex;
  height: 100%;
}
expandable-component.thickness thickness > svg.thickness {
  width: 25px;
  height: 100%;
  position: static;
}
expandable-component.thickness thickness > svg.thickness line {
  stroke: gray;
  stroke-width: 1px;
}
expandable-component.thickness thickness > svg.thickness path {
  fill: #d2cfcf;
  stroke: none;
}



/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .textcircled > div > editarea {
  text-align: center;
  text-align-last: auto;
}
math-type .textcircled > div > editarea > area-container > line,
math-type .textcircled > div > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.math-container-symbol {
  margin-top: 0.3em;
  margin-bottom: 0.3em;
  display: inline-flex;
}
.math-container-symbol.inline {
  margin-top: 0px;
  margin-bottom: 0px;
}
.math-container-symbol.selected {
  background-color: rgba(76, 175, 80, 0.05);
  outline: 1px solid #c1d4c1;
}
.math-container-symbol.display {
  display: block;
}
.math-container-symbol.display.selected {
  background-color: rgba(76, 175, 80, 0.05);
  outline: none;
}
.math-container-symbol.display > editarea {
  width: 100%;
  flex-grow: 1;
  display: block;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol.display > editarea > area-container > line,
.math-container-symbol.display > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol.display > editarea > area-container > line {
  padding-top: 8px;
  padding-bottom: 8px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.math-container-symbol > editarea.multiline {
  display: block;
  flex-grow: 1;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol > editarea.multiline > area-container > line,
.math-container-symbol > editarea.multiline > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.math-container-symbol > editarea.multiline > line:last-child {
  justify-content: flex-end;
  text-align: right;
}
.math-container-symbol > editarea.multiline > line:first-child {
  justify-content: flex-start;
  text-align: left;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .icon-sqrt,
.auto-complete-external-area .icon-sqrt {
  display: flex;
  margin: auto;
  font-size: 12px;
}
math-type .icon-sqrt .square,
.auto-complete-external-area .icon-sqrt .square {
  margin-top: 3px;
  margin-right: -6px;
}
math-type .icon-sqrt .square-expand,
.auto-complete-external-area .icon-sqrt .square-expand {
  background-color: #f7f7f7;
}
math-type .icon-sqrt .align-end,
.auto-complete-external-area .icon-sqrt .align-end {
  margin-top: 8px;
}
math-type .icon-sqrt .line,
.auto-complete-external-area .icon-sqrt .line {
  width: 10px;
  border-top: solid 1px black;
  margin-top: 6px;
}
math-type .icon-sqrt .big-square,
.auto-complete-external-area .icon-sqrt .big-square {
  margin-top: 11px;
  margin-left: -8px;
}
math-type .sqrt-symbol {
  white-space: nowrap;
  align-items: stretch;
  position: relative;
}
math-type .sqrt-symbol > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  left: 50%;
  top: -0.5em;
  left: 0.5em;
}
math-type .sqrt-symbol > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .sqrt-symbol > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .sqrt-symbol text {
  fill: black;
}
math-type .sqrt-symbol > sqrt-edit {
  position: relative;
  order: 3;
  display: inline-block;
  align-self: flex-end;
}
math-type .sqrt-symbol > sqrt-edit > sqrt-symbol-line {
  overflow: visible;
  z-index: 1;
  width: 100%;
  height: 100%;
  display: block;
  position: absolute;
  left: 0;
  top: 0;
  pointer-events: none;
}
math-type .sqrt-symbol > sqrt-edit > sqrt-symbol-line > svg {
  overflow: visible;
  width: 100%;
  height: 1em;
}
math-type .sqrt-symbol > sqrt-edit > area-container > line {
  width: 1em;
  position: relative;
}
math-type .sqrt-symbol > sqrt-edit > editarea,
math-type .sqrt-symbol > sqrt-edit > editarea-line {
  z-index: 2;
  display: inline-block;
  min-width: 0.5em;
  margin-left: 1em;
}
math-type .sqrt-symbol > sqrt-top {
  position: relative;
  z-index: 2;
  vertical-align: bottom;
  padding-bottom: 0.95em;
  align-self: flex-end;
  display: inline-block;
}
math-type .sqrt-symbol > sqrt-top.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type .sqrt-symbol > sqrt-top > editarea {
  font-size: 0.7em;
  border: none 0px;
  min-width: 0.5em;
  display: flex;
  float: right;
  text-align: center;
  text-align-last: auto;
}
math-type .sqrt-symbol > sqrt-top > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}





/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
image-viewer {
  width: 100%;
}
image-viewer.inline {
  width: auto;
}
image-viewer .image-content {
  cursor: pointer;
  text-align: left;
}
image-viewer detail list-items-options div {
  border: 1px solid transparent;
  cursor: pointer;
  margin-left: 3px;
  padding: 0 2px 0 2px;
}
image-viewer detail list-items-options div:hover {
  background-color: white;
  border: 1px solid lightgray;
}
image-viewer detail list-items-options div.selected {
  background-color: white;
  border: 1px solid lightgray;
}
image-viewer image-container {
  display: flex;
  flex-direction: column;
}
image-viewer image-container img {
  position: absolute;
}
image-viewer image-container.center {
  align-items: center;
}
image-viewer image-container.left {
  align-items: flex-start;
}
image-viewer image-container.right {
  align-items: flex-end;
}
.resize-box {
  position: absolute;
  width: 8px;
  height: 8px;
  border-width: 1px;
  border-color: gray;
  border-style: solid;
  background-color: white;
  z-index: 999;
}
.resize-box.mobile-tablet {
  width: 16px;
  height: 16px;
}
.resize-box.hide {
  display: none;
}
topleft {
  top: 0;
  left: 0;
  margin-left: -5px;
  margin-top: -5px;
  cursor: nwse-resize;
}
topleft.mobile-tablet {
  margin-left: -8px;
  margin-top: -8px;
}
topright {
  top: 0;
  right: 0;
  margin-right: -5px;
  margin-top: -5px;
  cursor: nesw-resize;
}
topright.mobile-tablet {
  margin-right: -8px;
  margin-top: -8px;
}
topmiddle {
  top: 0;
  left: 50%;
  margin-left: -5px;
  margin-top: -5px;
  cursor: ns-resize;
}
topmiddle.mobile-tablet {
  margin-left: -8px;
  margin-top: -8px;
}
leftmiddle {
  top: 50%;
  left: 0;
  margin-left: -5px;
  margin-top: -5px;
  cursor: ew-resize;
}
leftmiddle.mobile-tablet {
  margin-left: -8px;
  margin-top: -8px;
}
rightmiddle {
  top: 50%;
  right: 0;
  margin-right: -5px;
  margin-top: -5px;
  cursor: ew-resize;
}
rightmiddle.mobile-tablet {
  margin-right: -8px;
  margin-top: -8px;
}
bottomleft {
  bottom: 0;
  left: 0;
  margin-left: -5px;
  margin-bottom: -5px;
  cursor: nesw-resize;
}
bottomleft.mobile-tablet {
  margin-left: -8px;
  margin-bottom: -8px;
}
bottomright {
  bottom: 0;
  right: 0;
  margin-right: -5px;
  margin-bottom: -5px;
  cursor: nwse-resize;
}
bottomright.mobile-tablet {
  margin-right: -8px;
  margin-bottom: -8px;
}
bottommiddle {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  margin-bottom: -5px;
  cursor: ns-resize;
}
bottommiddle.mobile-tablet {
  margin-left: -8px;
  margin-bottom: -8px;
}
.ghost-viewer {
  outline: 1px dotted gray;
  width: 100%;
  height: 100%;
  display: block;
}

compositeblock.image-container {
  position: relative;
  width: 100%;
  margin-top: 10px;
  margin-bottom: 10px;
}
compositeblock.image-container > image-viewer {
  display: block;
}
compositeblock.image-container.inline {
  width: auto;
  margin-top: 0;
  margin-bottom: 0;
  display: inline-block;
}
.image-caption > line.text-mode:first-child {
  display: inline;
}
.image-caption > line.text-mode:first-child > blocks {
  display: inline;
}
.add-caption {
  opacity: 0.85;
  text-align: "center";
  color: #1155cc;
  cursor: pointer;
  position: absolute;
  bottom: -35px;
  left: 50%;
  transform: translate(-50%, 0);
  z-index: 10;
  font-size: 13px;
  background: white;
  border: 1px solid lightgray;
  padding: 5px;
}
.add-caption:hover {
  opacity: 1;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .power-index-symbol-container {
  margin-right: 0.06em;
  margin-left: 0.03em;
}
math-type .power-index-symbol-container.has-power > .power-value {
  margin-left: 0.04em;
}
math-type .power-index-symbol-container > .power-value,
math-type .pre-script-symbol-container > .power-value {
  /*margin-bottom: -2px;*/
  float: left;
  clear: both;
  text-align: left;
}
math-type .power-index-symbol-container > .power-value.small > line,
math-type .pre-script-symbol-container > .power-value.small > line {
  margin-bottom: -0.35em;
}
math-type .power-index-symbol-container > .power-value > line,
math-type .pre-script-symbol-container > .power-value > line {
  font-size: 0.7em;
}
math-type .power-index-symbol-container > .power-value > area-container > line,
math-type .pre-script-symbol-container > .power-value > area-container > line,
math-type .power-index-symbol-container > .power-value > line,
math-type .pre-script-symbol-container > .power-value > line {
  justify-content: flex-start;
  text-align: left;
}
math-type .power-index-symbol-container > middle-base,
math-type .pre-script-symbol-container > middle-base {
  display: block;
  clear: both;
  height: 1em;
}
math-type .power-index-symbol-container > middle-base > inline,
math-type .pre-script-symbol-container > middle-base > inline {
  display: inline-block;
}
math-type .power-index-symbol-container > .index-value,
math-type .pre-script-symbol-container > .index-value {
  float: left;
  text-align: left;
}
math-type .power-index-symbol-container > .index-value > line,
math-type .pre-script-symbol-container > .index-value > line {
  font-size: 0.7em;
}
math-type .power-index-symbol-container > .index-value > area-container > line,
math-type .pre-script-symbol-container > .index-value > area-container > line,
math-type .power-index-symbol-container > .index-value > line,
math-type .pre-script-symbol-container > .index-value > line {
  justify-content: flex-start;
  text-align: left;
}
math-type .power-index-symbol-container > editarea-block.index-value,
math-type .pre-script-symbol-container > editarea-block.index-value,
math-type .power-index-symbol-container > editarea-line.index-value,
math-type .pre-script-symbol-container > editarea-line.index-value {
  font-size: 0.7em;
}
math-type .power-index-symbol-container > editarea-block.power-value,
math-type .pre-script-symbol-container > editarea-block.power-value,
math-type .power-index-symbol-container > editarea-line.power-value,
math-type .pre-script-symbol-container > editarea-line.power-value {
  font-size: 0.7em;
}
math-type .pre-script-symbol-container > .power-value {
  float: right;
}
math-type .pre-script-symbol-container > .index-value {
  float: right;
}
.icon-power-index-symbol {
  display: flex;
  margin: auto;
  width: 20px;
  padding-bottom: 6px;
}
.icon-power-index-symbol .square-up {
  margin-top: 4px;
}
.icon-power-index-symbol .square-down {
  margin-top: 14px;
  margin-left: -6px;
}
.icon-power-index-symbol .align-end {
  margin-top: 4px;
}
.icon-power-symbol {
  display: flex;
  margin: auto;
  width: 20px;
  padding-bottom: 6px;
}
.icon-power-symbol .square {
  margin-top: 4px;
}
.icon-power-symbol .align-end {
  margin-top: 4px;
}
.icon-index-symbol {
  display: flex;
  margin: auto;
  width: 20px;
  padding-bottom: 6px;
}
.icon-index-symbol .square {
  margin-top: 14px;
  margin-left: 0px;
}
.icon-index-symbol .align-end {
  margin-top: 4px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.matrix-like > matrix > table > tbody > tr > td {
  padding-bottom: 0.1em;
  padding-top: 0.1em;
}
.matrix-symbol.matrix-like > matrix > table > tbody > tr.hline {
  border-top: 1px solid;
}
.matrix-symbol.matrix-like > matrix > table > tbody > tr:last-child.last-hline {
  border-bottom: 1px solid;
}
.matrix-symbol {
  /* must be flex to have vertical center align , unless figure out another way */
  display: inline-flex;
  align-items: center;
}
.matrix-symbol > matrix > table > tbody > tr > td > .sbd {
  position: absolute;
  left: -1px;
  top: -1px;
  right: -1px;
  bottom: -1px;
  pointer-events: none;
  background: none;
}
.matrix-symbol.selected > matrix > table > tbody > tr > td > .sbd {
  border-top: 1px solid rgba(93, 92, 92, 0.15);
  border-left: 1px solid rgba(93, 92, 92, 0.15);
}
.matrix-symbol.selected > matrix > table > tbody > tr > td > .sbd.sbd-lr {
  border-bottom: 1px solid rgba(93, 92, 92, 0.15);
}
.matrix-symbol.selected > matrix > table > tbody > tr > td > .sbd.sbd-lc {
  border-right: 1px solid rgba(93, 92, 92, 0.15);
}
.matrix-symbol > base-line-indicator {
  height: inherit;
  margin-top: -0.18em;
}
.matrix-symbol matrixclosesymbol,
.matrix-symbol matrixopensymbol {
  font-style: normal;
  color: black;
  position: relative;
}
.matrix-symbol matrixclosesymbol > span,
.matrix-symbol matrixopensymbol > span {
  visibility: hidden;
  display: inline-block;
}
.matrix-symbol matrixclosesymbol > svg,
.matrix-symbol matrixopensymbol > svg {
  overflow: visible;
  font-size: 15px;
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
}
.matrix-symbol matrixclosesymbol > svg text,
.matrix-symbol matrixopensymbol > svg text {
  fill: black;
}
.matrix-symbol > matrix.matrix > table > tbody > tr > td {
  padding: 0 0.3em;
}
.matrix-symbol > matrix {
  display: flex;
  position: relative;
  float: left;
  align-items: flex-start;
  break-inside: avoid;
}
.matrix-symbol > matrix > svg {
  width: 0.6em;
  /*init height, willl be changed by inline style*/
  height: 3px;
  overflow: visible;
  align-self: flex-start;
}
.matrix-symbol > matrix > vcomposed-symbol {
  height: inherit;
  align-self: stretch;
}
.matrix-symbol > matrix > table {
  border: 1px solid transparent;
  border-collapse: collapse;
}
.matrix-symbol > matrix > table > tbody > tr {
  box-sizing: border-box;
}
.matrix-symbol > matrix > table > tbody > tr.smaller {
  font-size: 0.75em;
}
.matrix-symbol > matrix > table > tbody > tr > td {
  position: relative;
  border: 1px dotted transparent;
  box-sizing: border-box;
  padding: 0 0.3em;
  vertical-align: baseline;
}
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell {
  display: inline-block;
  width: 100%;
}
.matrix-symbol > matrix > table > tbody > tr > td.vline {
  border-left: 1px solid;
}
.matrix-symbol > matrix > table > tbody > tr > td:last-child.last-vline {
  border-right: 1px solid;
}
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell {
  min-width: 0.5em;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol > matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.matrix > table {
  margin-left: -0.2em;
  margin-right: -0.2em;
}
.matrix-symbol > matrix.matrix > table > tbody > tr > td > .editor-cell {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol > matrix.matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.left {
  text-align: left;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.left > area-container > line,
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.left > line {
  justify-content: flex-start;
  text-align: left;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.center {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.center > area-container > line,
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.center > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.right {
  text-align: right;
}
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.right > area-container > line,
.matrix-symbol > matrix.array > table > tbody > tr > td > .editor-cell.right > line {
  justify-content: flex-end;
  text-align: right;
}
.matrix-symbol > matrix.gathered > table > tbody > tr > td:nth-child(2n+3) {
  padding-left: 1em;
}
.matrix-symbol > matrix.gathered line {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td {
  padding: 0;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+3) {
  padding-left: 1em;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+1) > .editor-cell {
  text-align: right;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+1) > .editor-cell > area-container > line,
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n+1) > .editor-cell > line {
  justify-content: flex-end;
  text-align: right;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n) > .editor-cell {
  text-align: left;
}
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n) > .editor-cell > area-container > line,
.matrix-symbol > matrix.aligned > table > tbody > tr > td:nth-child(2n) > .editor-cell > line {
  justify-content: flex-start;
  text-align: left;
}
.matrix-symbol > matrix > border-design {
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  display: block;
  background-color: rgba(255, 255, 255, 0.7);
  z-index: 10;
}
.matrix-symbol > matrix > border-design > border-line {
  cursor: pointer;
  position: absolute;
  /*border:1px solid gray;*/
}
.matrix-symbol > matrix > border-design > border-line > horizontal-line {
  border-top: 1px solid #eceaea;
  display: block;
  position: absolute;
  top: 50%;
  width: 100%;
  height: 1px;
  margin-top: 0;
  left: 0;
}
.matrix-symbol > matrix > border-design > border-line > vertical-line {
  border-left: 1px solid #eceaea;
  display: block;
  position: absolute;
  left: 50%;
  width: 1px;
  height: 100%;
  top: 0;
}
.matrix-symbol > matrix > border-design > border-line > vertical-line.enabled {
  border-top: 1px solid;
}
.matrix-symbol > matrix > border-design > border-line:hover > horizontal-line {
  border-top: 1px solid gray;
}
.matrix-symbol > matrix > border-design > border-line:hover > vertical-line {
  border-left: 1px solid gray;
}
.matrix-symbol > matrix > border-design > border-line.enabled > horizontal-line {
  border-top: 1px solid;
}
.matrix-symbol > matrix > border-design > border-line.enabled > vertical-line {
  border-left: 1px solid;
}
.matrix-symbol > matrix > setting {
  padding: 7px;
  position: absolute;
  top: -6px;
  font-family: "Segoe UI", Arial, Verdana, sans-serif;
  transform: translate(0, -100%);
  left: 0;
}
.matrix-symbol > matrix > setting > main-setting {
  display: flex;
  flex-direction: row;
}
.matrix-symbol > matrix > setting > main-setting styled-select {
  display: block;
  background-color: white;
}
.fa-table.array-settings {
  border: 1px solid lightgray;
  padding: 3px 5px;
  font-size: 14px;
  color: gray;
  cursor: pointer;
  /*margin-left: 5px;*/
}
.fa-table.array-settings:hover {
  color: black;
  background: white;
}
.matrix-icon {
  display: flex;
}
.matrix-icon .square {
  margin-top: 2px;
}
.matrix-icon .display-flex {
  display: flex;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td {
  padding: 0 0.2em;
}
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td.non-select,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td.non-select {
  user-select: none;
  width: 0.2em;
  padding: 0;
}
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td > .editor-cell,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td > .editor-cell {
  text-align: left;
}
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol.case-symbol > matrix > table > tbody > tr > td > .editor-cell > line,
.matrix-symbol.square-case-symbol > matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: flex-start;
  text-align: left;
}
.case-icon {
  display: flex;
  font-size: 18px;
  line-height: 18px;
}
.case-icon .square {
  margin-top: 2px;
}
.case-icon .display-flex {
  display: flex;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td {
  padding: 0 0.2em;
}
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #e0e0e0;
}
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td > .editor-cell {
  text-align: left;
}
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line,
.matrix-symbol.dr-case-symbol > matrix > table > tbody > tr > td > .editor-cell > line {
  justify-content: flex-start;
  text-align: left;
}
.case-icon {
  display: flex;
  font-size: 18px;
  line-height: 18px;
}
.case-icon .square {
  margin-top: 2px;
}
.case-icon .display-flex {
  display: flex;
}

.array-icon .square {
  margin-top: 2px;
}
.array-icon .display-flex {
  display: flex;
}

.matrix-like.binom > .binom > table > tbody > tr > td {
  padding: 0;
}
.matrix-like.binom > .binom > table > tbody > tr > td line {
  text-align: center;
  text-align-last: auto;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.align-symbol {
  /*display flex because to make sure it's spend whole line*/
  display: flex;
  justify-content: center;
  margin-top: 10px;
  margin-bottom: 10px;
  width: 100%;
}
.matrix-symbol.align-symbol.selected {
  background-color: rgba(76, 175, 80, 0.05);
}
.matrix-symbol.align-symbol > matrix > setting > main-setting {
  margin-bottom: 0px;
}
.matrix-symbol.align-symbol > matrix > bulb {
  left: 50%;
}
.matrix-symbol.align-symbol > matrix > setting {
  margin-left: 20px;
}
.matrix-symbol.align-symbol > matrix.align {
  width: 100%;
  display: block;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td {
  padding: 0;
  vertical-align: baseline;
  border: 1px solid transparent;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell {
  /* should align start and area-container level (instead of line level)
                as for lazy rendering, we need to have exact line width */
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container {
  align-items: flex-start;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line {
  width: auto;
  text-align: left;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.align-right > .editor-cell {
  /* should align start and area-container level (instead of line level)
                as for lazy rendering, we need to have exact line width */
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.align-right > .editor-cell > area-container {
  align-items: flex-end;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.align-right > .editor-cell > area-container > line {
  width: auto;
  text-align: right;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.non-select {
  border: none;
  user-select: none;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.expand {
  width: 100%;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #e0e0e0;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > .editor-cell {
  min-width: 1.5em;
}
.matrix-symbol.align-symbol > matrix > table > tbody > tr > td > tupple {
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: baseline;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
.matrix-symbol.gather-symbol {
  /*display flex because to make sure it's spend whole line*/
  display: flex;
  justify-content: center;
  margin-top: 10px;
  margin-bottom: 10px;
  width: 100%;
}
.matrix-symbol.gather-symbol.selected {
  background-color: rgba(76, 175, 80, 0.05);
}
.matrix-symbol.gather-symbol > matrix.gather {
  width: 100%;
  display: block;
}
.matrix-symbol.gather-symbol > matrix > setting > main-setting {
  margin-bottom: 0px;
}
.matrix-symbol.gather-symbol > matrix > bulb {
  left: -1em;
}
.matrix-symbol.gather-symbol > matrix > setting {
  margin-left: 20px;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td {
  padding: 0;
  vertical-align: baseline;
  border: 1px solid transparent;
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.non-select {
  user-select: none;
  width: 1.5em;
  border: none;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.expand {
  width: 100%;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #e0e0e0;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td line {
  text-align: center;
  text-align-last: auto;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > .editor-cell {
  min-width: 1.5em;
  /* should align start and area-container level (instead of line level)
                as for lazy rendering, we need to have exact line width */
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container {
  align-items: center;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > .editor-cell > area-container > line {
  width: auto;
}
.matrix-symbol.gather-symbol > matrix > table > tbody > tr > td > tupple {
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: baseline;
}

math-type compositeblock.table-symbol {
  width: 100%;
  display: flex;
}
math-type compositeblock.table-symbol.cap-above {
  flex-direction: column;
}
math-type .matrix-symbol > matrix.table {
  width: 100%;
  flex-direction: column;
  align-items: stretch;
}
math-type .matrix-symbol > matrix.table > table {
  table-layout: fixed;
  border: unset;
  width: 100%;
}
math-type .matrix-symbol > matrix.table > table > tbody > tr > td {
  vertical-align: top;
  padding: 0;
  position: relative;
}
math-type .cell-border-box {
  position: absolute;
  left: -1px;
  top: -1px;
  width: 100%;
  height: 100%;
}
.table-caption > line.text-mode:first-child {
  display: inline;
}
.table-caption > line.text-mode:first-child > blocks {
  display: inline;
}

editarea.lttb.text-mode > line.text-mode > blocks {
  text-align: inherit;
}



math-type compositeblock.table-of-content {
  display: block;
  width: 100%;
}
math-type compositeblock.table-of-content > toc-wrapper {
  position: relative;
  width: 100%;
  display: block;
  cursor: default;
}
math-type compositeblock.table-of-content > toc-wrapper .toc-setting-icons {
  display: none;
  position: absolute;
  left: -65px;
  width: 70px;
  top: -20px;
  bottom: 0;
  font-size: 1em;
  z-index: 999;
  padding-top: 20px;
}
math-type compositeblock.table-of-content > toc-wrapper .toc-setting-icons > .icon-refresh,
math-type compositeblock.table-of-content > toc-wrapper .toc-setting-icons > .icon-settings {
  border: 1px solid #c3c2c2;
  padding: 0.3em;
  padding-top: 0.1em;
  line-height: 1.2;
  padding-bottom: 0;
  cursor: pointer;
  background-color: #f7f7f7;
  color: gray;
  width: 12px;
  display: inline-block;
  margin-left: 5px;
}
math-type compositeblock.table-of-content > toc-wrapper:hover .toc-setting-icons {
  display: block;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode {
  width: 100%;
  cursor: default;
  display: block;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode {
  display: block;
  width: auto;
  cursor: default;
  padding-left: 1em;
  padding-right: 15px;
  font-style: unset;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > blocks,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > blocks {
  display: block;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > prefix,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > prefix {
  display: none;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl {
  padding-left: 15px;
  padding-right: 1em;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl > a > blocks,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl > blocks {
  text-align: right;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl a > blocks > compositeblock.toc-page-number-symbol,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode.has-rtl > blocks > compositeblock.toc-page-number-symbol {
  float: left;
  padding-left: 0;
  margin-right: 0;
  margin-left: 0;
  padding-right: 0.5em;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > block,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > block,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > blocks > block,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode a > blocks > block {
  white-space: pre-wrap;
  white-space: break-spaces;
  cursor: pointer;
  font-style: unset;
}
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > a > blocks > compositeblock.toc-page-number-symbol,
math-type compositeblock.table-of-content > toc-wrapper > editarea.toc-ea.text-mode > line.text-mode > blocks > compositeblock.toc-page-number-symbol {
  float: right;
  padding-left: 0.5em;
  margin-right: 0;
}

.icon-integral-symbol {
  margin: auto 4px auto auto;
  display: flex;
  flex-direction: row-reverse;
  font-size: 12px;
}
.icon-integral-symbol .square-up {
  border-width: 1px;
  margin-top: 0px;
}
.icon-integral-symbol .square-down {
  border-width: 1px;
  margin-top: 21px;
  margin-left: -10px;
}
.icon-integral-symbol .align-end {
  margin-top: 6px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .limit-type {
  position: relative;
}
math-type .limit-type > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  top: -1.4em;
  left: 0.6em;
  align-items: flex-start;
}
math-type .limit-type > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .limit-type > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .limit-type > .to,
math-type .limit-type > .from {
  float: left;
  clear: both;
}
math-type .limit-type > .to > line,
math-type .limit-type > .from > line,
math-type .limit-type > .to > editarea > line,
math-type .limit-type > .from > editarea > line {
  font-size: 0.7em;
}
math-type .limit-type > editarea-line,
math-type .limit-type > editarea-block {
  font-size: 0.7em;
}
math-type .limit-type > symbol {
  display: block;
  clear: both;
  pointer-events: none;
}
math-type .limit-type > symbol > span {
  white-space: nowrap;
  pointer-events: none;
}
math-type .limit-type > setting {
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  opacity: 0.5;
  opacity: 1;
  position: absolute;
  left: 50%;
  top: -2em;
  font-size: 0.6em;
  margin-left: -0.6em;
  padding: 0 0.2em;
  cursor: pointer;
}
math-type .limit-type > setting:hover {
  border-color: gray;
  opacity: 1;
}
math-type .limit-type > setting:hover {
  border: 1px solid gray;
}
math-type .limit-type > setting > i {
  transform: rotate(-60deg);
}
math-type .limit-type.limit-kind > setting > i {
  transform: rotate(45deg);
}
math-type .limit-type.limit-kind > symbol {
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > .from,
math-type .limit-type.limit-kind > .to {
  width: 100%;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > .from > line,
math-type .limit-type.limit-kind > .to > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > empty.from {
  height: 0;
  margin-top: -0.75em;
}
math-type .limit-type.limit-kind > empty.from > editarea.selected > line,
math-type .limit-type.limit-kind > empty.from > editarea-block.selected,
math-type .limit-type.limit-kind > empty.from > editarea-line.selected {
  background-color: white;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > empty.to {
  height: 0;
  text-align: center;
  text-align-last: auto;
}
math-type .limit-type.limit-kind > empty.to > editarea.selected > line,
math-type .limit-type.limit-kind > empty.to > editarea-block.selected,
math-type .limit-type.limit-kind > empty.to > editarea-line.selected {
  background-color: white;
  text-align: center;
  text-align-last: auto;
}
math-type .integral-like-symbol.inline > symbol {
  font-size: 1em;
}
math-type .integral-like-symbol.int-ml {
  margin-left: -0.5em;
}
math-type .integral-like-symbol.oint-ml {
  margin-left: -0.3em;
}
math-type .integral-like-symbol > symbol {
  font-size: 1.5em;
}
math-type .integral-like-symbol > symbol > span {
  line-height: 1.4em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .limit-type.lim-like-symbol {
  margin-left: 0.2em;
  margin-right: 0.2em;
}
math-type .limit-type.lim-like-symbol.close-left {
  margin-left: 0;
}
math-type .limit-type.lim-like-symbol.close-right {
  margin-right: 0;
}
math-type .limit-type.lim-like-symbol.limit-kind > empty.from > editarea {
  margin-top: -0.4em;
}
math-type .lim-like-symbol > add {
  left: 50%;
  top: -1em;
}
math-type .lim-like-symbol > symbol.inf {
  text-decoration: underline;
}
math-type .lim-like-symbol > symbol.sup {
  text-decoration: overline;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from,
math-type .lim-like-symbol.non-limit-kind > editarea.to {
  margin-left: 1.47em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-lim,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-lim {
  margin-left: 1.5435em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-liminf,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-liminf {
  margin-left: 3.15em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-limsup,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-limsup {
  margin-left: 3.528em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-sup,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-sup {
  margin-left: 1.6905em;
}
math-type .lim-like-symbol.non-limit-kind > editarea.from.from-varlimsup,
math-type .lim-like-symbol.non-limit-kind > editarea.to.to-varlimsup {
  margin-left: 1.5435em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to {
  margin-left: 2.072em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-lim,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-lim {
  margin-left: 2.1756em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-liminf,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-liminf {
  margin-left: 4.44em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-limsup,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-limsup {
  margin-left: 4.9728em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-sup,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-sup {
  margin-left: 2.3828em;
}
math-type .lim-like-symbol.non-limit-kind > editarea-block.from.from-varlimsup,
math-type .lim-like-symbol.non-limit-kind > editarea-block.to.to-varlimsup {
  margin-left: 2.1756em;
}



/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .limit-type.summation-like-symbol.limit-kind > empty.from {
  margin-top: -0.3em;
}
math-type .limit-type.summation-like-symbol.limit-kind > empty.from > editarea,
math-type .limit-type.summation-like-symbol.limit-kind > empty.from > editarea-block {
  margin-top: -0.2em;
}
math-type .summation-like-symbol.inline > add {
  top: -1.1em;
}
math-type .summation-like-symbol.inline > symbol {
  font-size: 1em;
}
math-type .summation-like-symbol.inline > symbol > span {
  vertical-align: 0.15em;
}
math-type .summation-like-symbol {
  padding-right: 0.15em;
}
math-type .summation-like-symbol > symbol {
  font-size: 1.5em;
}
math-type .summation-like-symbol > symbol > span {
  vertical-align: 0.1em;
  line-height: 1.4em;
}
math-type .summation-like-symbol > add {
  top: -1.5em;
}
math-type .summation-like-symbol > .custom-symbol {
  font-weight: bold;
}

hcomposed-symbol {
  display: flex;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
hcomposed-symbol > start {
  display: block;
  float: left;
  overflow: hidden;
}
hcomposed-symbol > middle {
  display: block;
  flex-grow: 1;
  white-space: nowrap;
  position: relative;
  overflow: hidden;
}
hcomposed-symbol > middle > fixed {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
}
hcomposed-symbol > middle > fixed > inside {
  display: inline-block;
  overflow: hidden;
}
hcomposed-symbol > end {
  display: block;
  overflow: hidden;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .arrow-like-symbol {
  padding: 0 0.2em;
}
math-type .arrow-like-symbol > arrow-like-simple > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  left: 0.8em;
  top: -0.7em;
}
math-type .arrow-like-symbol > arrow-like-simple > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .arrow-like-symbol > arrow-like-simple > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .arrow-like-symbol > middle {
  display: block;
  text-align: center;
  text-align-last: auto;
  clear: both;
  width: 100%;
  position: relative;
}
math-type .arrow-like-symbol > middle > inside {
  display: inline-block;
  height: 0.55em;
  width: 100%;
}
math-type .arrow-like-symbol > middle > inside > hcomposed-symbol {
  position: absolute;
  top: 0.4em;
  left: 0;
}
math-type .arrow-like-symbol > editarea.sright-1 {
  padding-left: 0.55em;
  padding-right: 0.25em;
}
math-type .arrow-like-symbol > editarea.sleft-1 {
  padding-left: 0.25em;
  padding-right: 0.55em;
}
math-type .arrow-like-symbol > editarea.small-margin {
  padding-left: 0.4em;
  padding-right: 0.4em;
}
math-type .arrow-like-symbol > editarea.large-padding {
  margin: 0 1.3em;
}
math-type .arrow-like-symbol > editarea > line {
  font-size: 0.7em;
}
math-type .arrow-like-symbol > .top {
  float: left;
  width: 100%;
  clear: both;
  margin-bottom: -0.5em;
  z-index: 1;
  position: relative;
}
math-type .arrow-like-symbol > .top.space-1,
math-type .arrow-like-symbol > .top.up-space-1-lower-space-2 {
  margin-bottom: -0.4em;
}
math-type .arrow-like-symbol > .bottom {
  margin-top: -0.45em;
  float: left;
  width: 100%;
}
math-type .arrow-like-symbol > .bottom.space-1,
math-type .arrow-like-symbol > .bottom.lower-space-1 {
  margin-top: -0.35em;
}
math-type .arrow-like-symbol > .bottom.space-2,
math-type .arrow-like-symbol > .bottom.up-space-1-lower-space-2 {
  margin-top: -0.25em;
}

.over-icon {
  margin: auto;
  width: 12px;
  font-size: 13px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-arrow-symbol > arrow-symbol {
  display: block;
  margin-right: -0.05em;
  position: relative;
}
math-type .over-arrow-symbol > arrow-symbol > hcomposed-symbol {
  position: absolute;
}
math-type .over-arrow-symbol > arrow-symbol > arrow-wrapper {
  margin-right: -0.2em;
}
math-type .over-arrow-symbol > editarea {
  display: inline-flex;
  text-align: center;
  text-align-last: auto;
}
math-type .over-arrow-symbol > editarea > area-container > line,
math-type .over-arrow-symbol > editarea > line {
  justify-content: center;
  text-align: center;
  text-align-last: auto;
}
math-type .over-arrow-symbol > editarea-block {
  min-width: 0.5em;
  text-align: center;
  text-align-last: auto;
  display: inline-block;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-line-symbol {
  margin-left: 0.05em;
  margin-right: 0.05em;
}
math-type .over-line-symbol > editarea {
  display: inline-flex;
  min-width: 0.5em;
}
math-type .over-line-symbol > editarea-line {
  min-width: 0.5em;
  display: inline-block;
  text-align: center;
  text-align-last: auto;
}
math-type .over-line-symbol > line-border {
  display: block;
  position: relative;
}
math-type .over-line-symbol > line-border > hcomposed-symbol {
  position: absolute;
}
math-type .over-line-symbol > line-border > svg {
  position: absolute;
  width: 100%;
  height: 100%;
}

brace-top-wrapper {
  display: flex;
  flex-direction: row;
  height: 100%;
  font-family: Asana-Math, Asana;
}
brace-top-wrapper > middle-wrapper {
  flex-grow: 1;
  position: relative;
  overflow: hidden;
}
brace-top-wrapper > middle-wrapper > fixed {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
}
brace-top-wrapper > middle-wrapper > fixed > middle-inside {
  overflow: hidden;
}
brace-top-wrapper first,
brace-top-wrapper middle,
brace-top-wrapper last {
  overflow: hidden;
  position: relative;
}
brace-top-wrapper first {
  min-width: 0.7em;
  width: 0.7em;
}
brace-top-wrapper > middle {
  min-width: 0.6em;
  width: 0.6em;
}
brace-top-wrapper > last {
  min-width: 0.7em;
  width: 0.7em;
}
bracket-top-wrapper {
  display: flex;
  flex-direction: column;
  width: 100%;
  font-family: Asana-Math, Asana;
}
bracket-top-wrapper > first,
bracket-top-wrapper middle,
bracket-top-wrapper last {
  overflow: hidden;
  position: relative;
}
bracket-top-wrapper > first {
  height: 0.5em;
  min-height: 0.5em;
}
bracket-top-wrapper middle-wrapper {
  flex-grow: 1;
  position: relative;
  overflow: hidden;
}
bracket-top-wrapper middle-wrapper > fixed {
  overflow: hidden;
  position: absolute;
  left: 0;
  top: 0;
}
bracket-top-wrapper middle-wrapper > fixed > middle {
  display: block;
  overflow: hidden;
}
bracket-top-wrapper > last {
  height: 0.65em;
  min-height: 0.65em;
}
parenthesis-top-wrapper {
  display: flex;
  flex-direction: column;
  width: 100%;
  font-family: Asana-Math, Asana;
}
parenthesis-top-wrapper > first,
parenthesis-top-wrapper middle,
parenthesis-top-wrapper last {
  overflow: hidden;
  position: relative;
  height: 1em;
  min-height: 1em;
}
parenthesis-top-wrapper > first {
  min-height: 0.9em;
  height: 0.9em;
}
parenthesis-top-wrapper middle-wrapper {
  flex-grow: 1;
  position: relative;
  overflow: hidden;
}
parenthesis-top-wrapper middle-wrapper > fixed {
  position: absolute;
  top: 0;
  left: 0;
}
parenthesis-top-wrapper middle-wrapper > fixed > middle {
  display: block;
  overflow: hidden;
}
parenthesis-top-wrapper > last {
  min-height: 1em;
  height: 1em;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .over-brace-symbol {
  position: relative;
}
math-type .over-brace-symbol > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  top: -1.5em;
  margin-left: -0.6em;
}
math-type .over-brace-symbol > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type .over-brace-symbol > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type .over-brace-symbol > top-brace {
  pointer-events: none;
  display: block;
  min-width: 1.1em;
  position: relative;
  clear: both;
  margin-bottom: -0.1em;
  font-style: normal;
  font-weight: normal;
}
math-type .over-brace-symbol > top-brace > brace-top-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  left: 50%;
  transform: translate(-50%, 0);
}
math-type .over-brace-symbol > editarea {
  display: inline-flex;
  width: 100%;
  align-self: center;
  clear: both;
}
math-type .over-brace-symbol > editarea.overValue {
  font-size: 0.7em;
  float: left;
  width: 100%;
  margin-bottom: 0.1em;
}

.icon-hat {
  margin: auto;
  width: 12px;
  font-size: 12px;
}
.icon-hat .square {
  margin-top: -3px;
}

.under-arc-symbol {
  display: inline-block;
}
.under-arc-symbol > editarea {
  display: inline-flex;
}
.under-arc-symbol > symbol {
  display: block;
  width: 100%;
  position: relative;
}
.under-arc-symbol > symbol > svg {
  position: absolute;
  left: 0;
  top: 0;
  display: block;
  width: 100%;
  height: 100%;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .under-line-symbol > editarea {
  display: inline-flex;
}
math-type .under-line-symbol > line-border {
  display: block;
  position: relative;
  float: left;
  width: 100%;
}
math-type .under-line-symbol > line-border > svg {
  position: absolute;
  width: 100%;
  height: 100%;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.under-brace-symbol {
  display: inline-flex;
  flex-flow: column;
  position: relative;
}
math-type compositeblock.under-brace-symbol > add {
  opacity: 0.5;
  background-color: #f7f7f7;
  border: 1px solid #c3c2c2;
  color: gray;
  display: block;
  position: absolute;
  font-size: 0.6em;
  cursor: pointer;
  margin-left: -0.4em;
  z-index: 999;
  opacity: 0.7;
  top: -0.5em;
  left: 50%;
  top: 3em;
}
math-type compositeblock.under-brace-symbol > add:hover {
  border-color: gray;
  opacity: 1;
}
math-type compositeblock.under-brace-symbol > add > i {
  display: block;
  height: 1em;
  padding: 0.1em 0.15em;
  padding-bottom: 0;
  width: 0.8em;
}
math-type compositeblock.under-brace-symbol > bottom-brace {
  pointer-events: none;
  display: block;
  position: relative;
  min-width: 1.3em;
  font-style: normal;
  font-weight: normal;
}
math-type compositeblock.under-brace-symbol > bottom-brace > brace-top-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  left: 50%;
  transform: translate(-50%, 0);
}
math-type compositeblock.under-brace-symbol > editarea {
  margin-left: 0.15em;
  margin-right: 0.15em;
  align-self: center;
}
math-type compositeblock.under-brace-symbol > editarea.underValue {
  font-size: 0.7em;
}
.under-brace-icon {
  width: 12px;
  margin: auto;
  font-size: 12px;
}
.under-brace-icon .brace-wrapper {
  margin-top: -14px;
}


math-type .operator-name > editarea {
  margin-left: 0.2em;
  margin-right: 0.2em;
  display: inline-flex;
}
math-type .operator-name > editarea.close-left {
  margin-left: 0;
}
math-type .operator-name > editarea.close-right {
  margin-right: 0;
}

.math-group > editarea {
  float: left;
}
.group-icon .rectangle {
  width: 23px;
  height: 12px;
  border-style: solid;
  border-width: 1px;
  text-align: center;
  border-color: gray;
  font-family: fantasy;
  color: black;
  padding-top: 1px;
  font-size: 9px;
  line-height: 14px;
  vertical-align: middle;
  margin: auto;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.over-symbol {
  position: relative;
}
math-type compositeblock.over-symbol > symbol {
  font-family: Asana-Math, Asana, Arial;
  height: 8em;
  display: block;
  text-align: center;
  text-align-last: auto;
  position: relative;
}
math-type compositeblock.over-symbol > symbol > inner {
  display: block;
  position: absolute;
  text-align: center;
  text-align-last: auto;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}
math-type compositeblock.over-symbol > symbol.dot > inner.left-sign,
math-type compositeblock.over-symbol > symbol.ring > inner.left-sign {
  transform: translate(-0.07em, 0);
}
math-type compositeblock.over-symbol > symbol.dot > inner.right-sign,
math-type compositeblock.over-symbol > symbol.ring > inner.right-sign {
  transform: translate(0.2em, 0);
}
math-type compositeblock.over-symbol > symbol.dot > inner,
math-type compositeblock.over-symbol > symbol.ring > inner {
  transform: translate(0.05em, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner.left-sign,
math-type compositeblock.over-symbol > symbol.small-tilde > inner.left-sign {
  transform: translate(-0.04em, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner.right-sign,
math-type compositeblock.over-symbol > symbol.small-tilde > inner.right-sign {
  transform: translate(0.15em, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner.ignore-shift,
math-type compositeblock.over-symbol > symbol.small-tilde > inner.ignore-shift {
  transform: translate(0, 0);
}
math-type compositeblock.over-symbol > symbol.small-hat > inner,
math-type compositeblock.over-symbol > symbol.small-tilde > inner {
  transform: translate(0.05em, 0);
}
math-type compositeblock.over-symbol > symbol.acute > inner.left-sign {
  transform: translate(-0.04em, 0);
}
math-type compositeblock.over-symbol > symbol.acute > inner.right-sign {
  transform: translate(0.25em, 0);
}
math-type compositeblock.over-symbol > symbol.acute > inner {
  transform: translate(0.1em, 0);
}
math-type compositeblock.over-symbol > symbol.grave,
math-type compositeblock.over-symbol > symbol.breve,
math-type compositeblock.over-symbol > symbol.acute {
  font-family: 'Times New Roman', Times, serif;
}
math-type compositeblock.over-symbol > symbol.grave > inner.left-sign,
math-type compositeblock.over-symbol > symbol.breve > inner.left-sign,
math-type compositeblock.over-symbol > symbol.check > inner.left-sign {
  transform: translate(-0.07em, 0);
}
math-type compositeblock.over-symbol > symbol.grave > inner.right-sign,
math-type compositeblock.over-symbol > symbol.breve > inner.right-sign,
math-type compositeblock.over-symbol > symbol.check > inner.right-sign {
  transform: translate(0.17em, 0);
}
math-type compositeblock.over-symbol > symbol.ddddot {
  min-width: 0.9em;
}
math-type compositeblock.over-symbol > symbol.dddot {
  min-width: 0.7em;
}

.math-xx > editarea {
  float: left;
}

math-type .big-delimiter-symbol {
  display: inline-flex;
  align-items: center;
  position: relative;
  margin: 0.1em 0;
}
math-type .big-delimiter-symbol big-delimiter.big-open {
  margin-left: 0.09em;
}
math-type .big-delimiter-symbol big-delimiter.big-close {
  margin-right: 0.07em;
}
math-type .big-delimiter-symbol > base-line-indicator {
  height: inherit;
}
math-type .big-delimiter-symbol > big-delimiter > svg {
  height: 100%;
  width: 100%;
}
math-type .big-delimiter-symbol > big-delimiter > bulb {
  left: -10px;
}
math-type .big-delimiter-symbol > big-delimiter > setting {
  width: 158px;
  display: flex;
  position: absolute;
  left: 0;
  top: -40px;
}
math-type .big-delimiter-symbol > big-delimiter > setting > .select-box-container {
  margin-right: 4px;
}
math-type .big-delimiter-symbol > big-delimiter > setting > .select-box-container:last-child {
  margin-right: 0px;
}

select-buttons {
  font-size: 13px;
  color: gray;
  display: block;
}
select-buttons > sb-item {
  display: inline-block;
  padding: 2px 2px;
  cursor: pointer;
  border: 1px solid transparent;
  /*box-sizing: border-box;*/
}
select-buttons > sb-item.selected {
  background-color: white;
  border: 1px solid lightgray;
}
select-buttons > sb-item:hover {
  border: 1px solid lightgray;
}
select-buttons > sb-item.disabled {
  opacity: 0.3;
  cursor: default;
  border: 1px solid transparent;
}
select-buttons > sb-item.disabled:hover {
  background-color: inherit;
  border: 1px solid transparent;
}

tabs-container tab-item {
  color: gray;
}
tabs-container tab-item:hover {
  color: black;
}

expandable-component.button-action {
  cursor: pointer;
  color: gray;
  fill: gray;
}
expandable-component.button-action:hover,
expandable-component.button-action.selected {
  color: black;
  fill: black;
}
expandable-component.button-action:hover label-display,
expandable-component.button-action.selected label-display {
  border: 1px solid #e2e0e0;
}
expandable-component.button-action label-display {
  font-size: 12px;
  padding-top: 5px;
  display: flex;
  border: 1px solid transparent;
  padding-left: 2px;
  padding-right: 2px;
  margin-top: 0px;
  padding-bottom: 4px;
  cursor: pointer;
}
expandable-component.button-action label-display > i {
  padding-left: 5px;
  padding-top: 1px;
}
expandable-component.button-action label-item-container > label-item:hover {
  background-color: #bfe4bd;
}
expandable-component.button-action label-item-container > label-item.ignore-select {
  background-color: inherit;
  cursor: default;
}
expandable-component.button-action.button-style label-display {
  background: white;
  border: 1px solid lightgray;
}
expandable-component.button-action.button-style:hover,
expandable-component.button-action.button-style.selected {
  color: gray;
}
expandable-component.button-action.button-style:hover label-display,
expandable-component.button-action.button-style.selected label-display {
  background: #f7f6f6;
}

g.group-box-move {
  opacity: 0.2;
}
g.group-box-move:hover {
  opacity: 0.8;
}




.math-diagram .intersections-group {
  stroke-width: 2px;
  stroke: black;
  fill: transparent;
  cursor: move;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.math-diagram > math-diagram {
  background: white;
}
math-type compositeblock.math-diagram {
  cursor: default;
  width: 100%;
  /** display block as if inline block, it will be disapear in some cases*/
  display: block;
}
math-type compositeblock.math-diagram .connection-point {
  cursor: crosshair;
}
math-type compositeblock.math-diagram .connection-point g {
  fill-opacity: 0.6;
}
math-type compositeblock.math-diagram .connection-point:hover g {
  fill-opacity: 1;
}
math-type compositeblock.math-diagram .text-diagram-editor editarea.text-mode.non-wrap > line.text-mode {
  font-size: unset;
}
math-type compositeblock.math-diagram .text-diagram-editor editarea.text-mode.non-wrap > line.text-mode > block {
  white-space: pre;
}
math-type compositeblock.math-diagram .text-diagram-editor editarea.text-mode.non-wrap > line.text-mode > blocks > block {
  white-space: pre;
}
math-type compositeblock.math-diagram > math-diagram {
  border: 1px solid transparent;
}
math-type compositeblock.math-diagram > math-diagram > clip-region > zoom-region {
  display: block;
  width: 100%;
  height: 100%;
}
math-type compositeblock.math-diagram > math-diagram > clip-region > zoom-region > svg {
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}
math-type compositeblock.math-diagram .add-label {
  fill: gray;
}
math-type compositeblock.math-diagram .add-label:hover {
  fill: black;
}
math-type compositeblock.math-diagram .diagram-editor {
  margin: 0 2px;
}
math-type compositeblock.math-diagram .control-point-guide {
  stroke: lightgray;
  stroke-width: 0.5px;
  pointer-events: none;
}
math-type compositeblock.math-diagram .connection-group {
  stroke: black;
  fill: none;
}
math-type compositeblock.math-diagram .arrow-line {
  cursor: move;
}
math-type compositeblock.math-diagram .mobile-tablet .shape .transparent,
math-type compositeblock.math-diagram .mobile-tablet .composite-shape .transparent {
  stroke-width: 10px;
}
math-type compositeblock.math-diagram .shape,
math-type compositeblock.math-diagram .composite-shape {
  stroke-width: 1px;
  fill: none;
  cursor: move;
}
math-type compositeblock.math-diagram .shape .transparent,
math-type compositeblock.math-diagram .composite-shape .transparent {
  pointer-events: visiblePainted;
  stroke-width: 6px;
  stroke: transparent;
  stroke-dasharray: none;
  fill: none;
}
math-type compositeblock.math-diagram .mobile-tablet .connection.transparent,
math-type compositeblock.math-diagram .mobile-tablet .connection.transparent > line,
math-type compositeblock.math-diagram .mobile-tablet .connection.transparent > path {
  stroke-width: 10px;
}
math-type compositeblock.math-diagram .connection {
  stroke-width: 1px;
  fill: none;
  cursor: move;
}
math-type compositeblock.math-diagram .connection.transparent,
math-type compositeblock.math-diagram .connection.transparent > line,
math-type compositeblock.math-diagram .connection.transparent > path {
  pointer-events: visiblePainted;
  stroke-width: 6px;
  stroke: transparent;
  stroke-dasharray: none;
  fill: none;
}
math-type compositeblock.math-diagram .frame {
  stroke-width: 1px;
  fill: transparent;
}
math-type math-diagram {
  display: block;
  position: relative;
  width: 100%;
  height: 300px;
}
math-type math-diagram position-container {
  position: absolute;
  width: 1px;
  height: 1px;
  display: block;
}
math-type math-diagram dg-editor-container {
  position: absolute;
  min-width: 0.85em;
  border-collapse: border-box;
}
math-type math-diagram coverlayer {
  position: absolute;
  background: transparent;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  z-index: 2;
  cursor: move;
}
math-type math-diagram connection-point {
  position: absolute;
  display: block;
  height: 6px;
  width: 6px;
  background: lightgray;
  border: 1px solid gray;
  bottom: -10px;
  left: 50%;
  margin-left: -3px;
  cursor: e-resize;
}
math-type .diagram-caption > line.text-mode:first-child {
  display: inline;
}
math-type .diagram-caption > line.text-mode:first-child > blocks {
  display: inline;
}


.plot-input-style-settings {
  opacity: 0.5;
}
.plot-input-style-settings:hover {
  opacity: 1;
}

.psa-cn .ps-hint {
  opacity: 0;
  transition: opacity 0.3s linear;
}
.psa-cn:hover .ps-hint {
  opacity: 0.6;
}

.role-toolbar-wrapper.dg-full-view tool-bar too-bar-container {
  justify-content: start;
  width: auto;
  min-width: 0;
}
.role-toolbar-wrapper.dg-full-view diagram-settings {
  width: auto;
}

.dg-items-bar-container item {
  display: inline-block;
  padding: 3px;
  fill: gray;
  stroke: gray;
}
.dg-items-bar-container item,
.dg-items-bar-container item-option {
  border: 1px transparent solid;
}
.dg-items-bar-container item:hover,
.dg-items-bar-container item-option:hover {
  border: 1px #c4c1c1 solid;
  background: white;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type compositeblock.theorem {
  display: block;
}
math-type compositeblock.theorem.selected {
  outline: 1px solid rgba(93, 92, 92, 0.3);
}
math-type theorem-name {
  min-width: 20px;
  display: inline;
}
math-type theorem-name > line.text-mode:first-child {
  display: inline;
}
math-type editarea.text-mode.edit-theorem-content {
  min-width: 100px;
  display: inline;
  font-style: italic;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode:first-child {
  display: inline;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode:first-child > blocks {
  display: inline;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode > block {
  font-style: italic;
}
math-type editarea.text-mode.edit-theorem-content > line.text-mode > blocks > block {
  font-style: italic;
}
math-type editarea.text-mode.edit-theorem-content.normal > line.text-mode > block {
  font-style: normal;
}
math-type editarea.text-mode.edit-theorem-content.normal > line.text-mode > blocks > block {
  font-style: normal;
}
math-type editarea.text-mode.edit-theorem-content .qed-symbol {
  line-height: 1em;
}
.deletable {
  cursor: pointer;
}
.deletable:hover {
  color: red;
}

.regular-checkbox:hover {
  background-color: #f3f2f2;
}

@media print {
  code[class*="language-"],
  pre[class*="language-"] {
    text-shadow: none !important;
  }
}
math-type .code-section prefix.code-line-number {
  color: #a9a7a7;
  width: 2.5em;
  display: inline-block;
  flex-shrink: 0;
}
math-type .code-section prefix.code-line-number.prefix-l10 {
  width: 1.5em;
}
math-type .code-section prefix.code-line-number.prefix-l100 {
  width: 2em;
}
math-type .code-section .code-line-blocks-container {
  white-space: pre-wrap;
  white-space: break-spaces;
}
math-type .code-section .code-line-blocks-container block.token {
  white-space: pre-wrap;
  white-space: break-spaces;
}
math-type .code-section line.text-mode.code-section-line {
  display: flex;
  flex-direction: row;
  line-height: 1.5;
}

/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */
.code-section.theme-default editarea {
  color: black;
}
.code-section.theme-default .token.comment,
.code-section.theme-default .token.prolog,
.code-section.theme-default .token.doctype,
.code-section.theme-default .token.cdata {
  color: slategray;
}
.code-section.theme-default .token.punctuation {
  color: #999;
}
.code-section.theme-default .namespace {
  opacity: 0.7;
}
.code-section.theme-default .token.property,
.code-section.theme-default .token.tag,
.code-section.theme-default .token.boolean,
.code-section.theme-default .token.number,
.code-section.theme-default .token.constant,
.code-section.theme-default .token.symbol,
.code-section.theme-default .token.deleted {
  color: #905;
}
.code-section.theme-default .token.selector,
.code-section.theme-default .token.attr-name,
.code-section.theme-default .token.string,
.code-section.theme-default .token.char,
.code-section.theme-default .token.builtin,
.code-section.theme-default .token.inserted {
  color: #690;
}
.code-section.theme-default .token.operator,
.code-section.theme-default .token.entity,
.code-section.theme-default .token.url,
.code-section.theme-default .language-css .token.string,
.code-section.theme-default .style .token.string {
  color: #9a6e3a;
}
.code-section.theme-default .token.atrule,
.code-section.theme-default .token.attr-value,
.code-section.theme-default .token.keyword {
  color: #07a;
}
.code-section.theme-default .token.function,
.code-section.theme-default .token.class-name {
  color: #DD4A68;
}
.code-section.theme-default .token.regex,
.code-section.theme-default .token.important,
.code-section.theme-default .token.important1,
.code-section.theme-default .token.variable {
  color: #e90;
}
.code-section.theme-default .token.important,
.code-section.theme-default .token.bold,
.code-section.theme-default .token.bold1 {
  font-weight: bold;
}
.code-section.theme-default .token.italic,
.code-section.theme-default .token.italic1 {
  font-style: italic;
}
.code-section.theme-default .token.entity {
  cursor: help;
}

/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */
.code-section.theme-tomorrow-night {
  /**
 * prism.js tomorrow night eighties for JavaScript, CoffeeScript, CSS and HTML
 * Based on https://github.com/chriskempson/tomorrow-theme
 * @author Rose Pritchard
 */
}
.code-section.theme-tomorrow-night editarea {
  caret-color: #ccc;
}
.code-section.theme-tomorrow-night editarea {
  color: #ccc;
}
.code-section.theme-tomorrow-night .token.comment,
.code-section.theme-tomorrow-night .token.block-comment,
.code-section.theme-tomorrow-night .token.prolog,
.code-section.theme-tomorrow-night .token.doctype,
.code-section.theme-tomorrow-night .token.cdata {
  color: #999;
}
.code-section.theme-tomorrow-night .token.punctuation {
  color: #ccc;
}
.code-section.theme-tomorrow-night .token.tag,
.code-section.theme-tomorrow-night .token.attr-name,
.code-section.theme-tomorrow-night .token.namespace,
.code-section.theme-tomorrow-night .token.deleted {
  color: #e2777a;
}
.code-section.theme-tomorrow-night .token.function-name {
  color: #6196cc;
}
.code-section.theme-tomorrow-night .token.boolean,
.code-section.theme-tomorrow-night .token.number,
.code-section.theme-tomorrow-night .token.function {
  color: #f08d49;
}
.code-section.theme-tomorrow-night .token.property,
.code-section.theme-tomorrow-night .token.class-name,
.code-section.theme-tomorrow-night .token.constant,
.code-section.theme-tomorrow-night .token.symbol {
  color: #f8c555;
}
.code-section.theme-tomorrow-night .token.selector,
.code-section.theme-tomorrow-night .token.important,
.code-section.theme-tomorrow-night .token.important1,
.code-section.theme-tomorrow-night .token.atrule,
.code-section.theme-tomorrow-night .token.keyword,
.code-section.theme-tomorrow-night .token.builtin {
  color: #cc99cd;
}
.code-section.theme-tomorrow-night .token.string,
.code-section.theme-tomorrow-night .token.char,
.code-section.theme-tomorrow-night .token.attr-value,
.code-section.theme-tomorrow-night .token.regex,
.code-section.theme-tomorrow-night .token.variable {
  color: #7ec699;
}
.code-section.theme-tomorrow-night .token.operator,
.code-section.theme-tomorrow-night .token.entity,
.code-section.theme-tomorrow-night .token.url {
  color: #67cdcc;
}
.code-section.theme-tomorrow-night .token.important,
.code-section.theme-tomorrow-night .token.bold,
.code-section.theme-tomorrow-night .token.bold1 {
  font-weight: bold;
}
.code-section.theme-tomorrow-night .token.italic,
.code-section.theme-tomorrow-night .token.italic1 {
  font-style: italic;
}
.code-section.theme-tomorrow-night .token.entity {
  cursor: help;
}
.code-section.theme-tomorrow-night .token.inserted {
  color: green;
}

editor-container > math-type.dark-mode {
  background: #1e1e1e;
}
math-type.dark-mode {
  background: #1e1e1e;
}
math-type.dark-mode.math-type-for-print {
  -webkit-print-color-adjust: exact;
}
math-type.dark-mode editarea.root-editor {
  color: #e0e0e0;
  fill: #e0e0e0;
  stroke: #e0e0e0;
  border-color: #e0e0e0;
}
math-type.dark-mode editarea.root-editor {
  background: #1e1e1e;
}
math-type.dark-mode .math-container-symbol.selected,
math-type.dark-mode .math-container-symbol.display.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.gather-symbol.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.gather-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.align-symbol.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.align-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.matrix-like.selected {
  background-color: #2a352a;
}
math-type.dark-mode .matrix-symbol.matrix-like > matrix > table > tbody > tr.selected:not(.hline) {
  border-top: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.matrix-like > matrix > table > tbody > tr:last-child.selected {
  border-bottom: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol > matrix > table > tbody > tr > td.selected:not(.vline) {
  border-left: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol > matrix > table > tbody > tr > td:last-child.selected {
  border-right: 1px solid #525252;
}
math-type.dark-mode .matrix-symbol.case-symbol > matrix > table > tbody > tr > td.selected {
  border: 1px solid #525252;
}
math-type.dark-mode selection-wrapper > selection {
  background-color: rgba(33, 150, 243, 0.25);
}
math-type.dark-mode selection-wrapper.inactive > selection {
  background-color: rgba(255, 255, 255, 0.27);
}
math-type.dark-mode editarea.selected {
  outline: 1px solid rgba(177, 174, 174, 0.3);
}
math-type.dark-mode compositeblock.math-diagram > math-diagram {
  background: #1e1e1e;
}
container-layer.dark-mode editor-container {
  background: #1e1e1e;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
editor-container > math-type {
  background: white;
  outline: 1px solid lightgray;
}
math-type {
  display: block;
  position: relative;
  padding: 20px;
  color: black;
  padding-top: 15px;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  outline: none;
  cursor: text;
  text-align: initial;
}
math-type .rcnt {
  color: white;
  font-size: 12px;
  position: -webkit-sticky;
  position: sticky;
  top: 0;
  bottom: 0;
  display: flex;
  flex-direction: row;
}
math-type > .mt-sa {
  position: absolute;
  top: 0;
  left: -100px;
  right: -100px;
  bottom: -400px;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  pointer-events: none;
}
math-type.math-only compositeblock.math-container-symbol {
  width: 100%;
}
math-type.math-only compositeblock.math-container-symbol.selected {
  outline: none;
  background: none;
}
math-type.math-only compositeblock.math-container-symbol > editarea {
  width: 100%;
}
math-type.math-only compositeblock.math-container-symbol > editarea > line {
  justify-content: flex-start;
}
math-type > input:not([type]),
math-type input[type="text"] {
  width: 50px;
}
math-type composition-indicator {
  display: block;
  position: absolute;
  height: 2px;
  min-width: 2px;
  border-bottom: 2px solid gray;
  left: 0;
  top: 0;
}
math-type .focus-element {
  outline: none;
  overflow: hidden;
  width: 0px;
  height: 0px;
  top: 0px;
  left: 0px;
  display: block;
  position: absolute;
  font-size: 40px;
}
.scroll-without-scrollbar {
  scrollbar-width: none;
  /* Firefox */
  -ms-overflow-style: none;
  /* IE 10+ */
}
.scroll-without-scrollbar::-webkit-scrollbar {
  width: 0;
  height: 0;
  display: none;
}
#root,
.main-container {
  width: 100%;
  color: #212121;
}
.sub-text-cursor,
.text-cursor {
  position: absolute;
  color: green;
  /*font-size: 1.2em;*/
  pointer-events: none;
  border-left: 2px solid green;
  display: block;
  top: 0px;
  left: 0px;
  z-index: 10;
}
.sub-text-cursor {
  opacity: 0.4;
}
math-edit-container {
  display: block;
  outline: none;
  position: relative;
  font-family: 'Asana';
}
.root-editor {
  min-height: 500px;
  box-sizing: border-box;
}
.root-editor.restricted-view {
  min-height: unset;
}
.root-editor.test-view {
  min-height: 100px;
}
.menu {
  color: #ffffff;
  text-transform: uppercase;
  text-decoration: none;
  font-family: "HelveticaNeue-Medium", sans-serif;
  font-size: 14px;
  display: inline-block;
  transform: scale(1, 1.5);
  -webkit-transform: scale(1, 1.5);
  /* Safari and Chrome */
  -moz-transform: scale(1, 1.5);
  /* Firefox */
  -ms-transform: scale(1, 1.5);
  /* IE 9+ */
  -o-transform: scale(1, 1.5);
  /* Opera */
}
.setting-group-options {
  font-size: 13px;
  color: gray;
  fill: gray;
}
.setting-group-options > i,
.setting-group-options > svg.icon {
  padding: 3px;
  cursor: pointer;
  border: 1px solid transparent;
  /*box-sizing: border-box;*/
}
.setting-group-options > i.selected,
.setting-group-options > svg.icon.selected {
  background-color: white;
  border: 1px solid lightgray;
}
.setting-group-options > i:hover,
.setting-group-options > svg.icon:hover {
  border: 1px solid lightgray;
}
.setting-group-options > i.disabled,
.setting-group-options > svg.icon.disabled {
  opacity: 0.3;
}
.setting-group-options > i.disabled:hover,
.setting-group-options > svg.icon.disabled:hover {
  background-color: inherit;
  border: 1px solid transparent;
}
math-type .math-text,
math-type .normal-text,
math-type .raw-latex {
  font-family: arial, verdana, geneva, lucida, 'lucida grande', arial, helvetica, sans-serif;
}
math-type .math-text editarea.text-mode > line.text-mode > blocks > block,
math-type .normal-text editarea.text-mode > line.text-mode > blocks > block,
math-type .raw-latex editarea.text-mode > line.text-mode > blocks > block {
  white-space: nowrap;
}
.mt-common-dialog {
  box-shadow: 1px 1px 1px 0px #e0dddd;
  background-color: #f7f7f7;
  border: 1px lightgray solid;
  z-index: 14;
  padding: 6px;
  cursor: default;
  font-family: "Segoe UI", Arial, Verdana, sans-serif;
}
disabled-layer {
  display: block;
  position: absolute;
  left: 0;
  top: 1px;
  right: 0;
  bottom: 2px;
  background: rgba(247, 247, 247, 0.66);
  /** consider export button z-index when change this one*/
  z-index: 500;
}
math-type tag-container tag-select-wrapper {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
}
math-type tag-container tag-box-select {
  position: absolute;
  display: block;
  background-color: green;
  opacity: 0;
  cursor: pointer;
  z-index: 15;
}
math-type tag-container tag-box-select:hover {
  opacity: 0.2;
}
math-type tag-container tag-box-gap {
  position: absolute;
  display: block;
  background-color: white;
  opacity: 0.9;
  z-index: 15;
}
.setting-popup-zindex {
  z-index: 11;
}
svg.selectable {
  cursor: pointer;
  border: 1px solid transparent;
}
svg.selectable.selected {
  background: white;
  border: solid 1px lightgray;
}
svg.selectable:hover {
  border: solid 1px lightgray;
}


@media print {
  @page {
    margin: 0;
  }
  /**
    Convert Preview into main print area
    */
  .math-type-doc,
  .docs-container,
  .modal-dialog-root-container,
  instructions-container {
    display: none !important;
  }
  .print-preview-container {
    position: static !important;
    display: block !important;
    visibility: visible !important;
    width: auto !important;
    height: auto !important;
    z-index: 99999 !important;
  }
  .print-container {
    position: static !important;
    overflow: hidden;
  }
  .print-preview-controls-container {
    display: none !important;
  }
  .math-type-no-print {
    display: none !important;
  }
  area-container.print-page-level {
    margin-left: 0 !important;
    margin-top: 0 !important;
    margin-right: 0 !important;
    margin-bottom: 0 !important;
    border: none !important;
    border-left: none !important;
    border-top: none !important;
    border-right: none !important;
    border-bottom: none !important;
    break-inside: avoid !important;
  }
  .area-container-border {
    border: none !important;
    border-left: none !important;
    border-top: none !important;
    border-right: none !important;
    border-bottom: none !important;
    display: none !important;
  }
  #print-container {
    background-color: transparent !important;
  }
  #print-container > math-type {
    background-color: transparent !important;
  }
  #print-container > math-type > math-edit-container > editarea {
    background-color: transparent !important;
  }
  /*-----------------------------*/
  header,
  .export-bar-container {
    display: none !important;
  }
  math-type {
    padding: 0 !important;
  }
  .print-remove-background {
    background-color: transparent !important;
  }
  document-info-bar {
    display: none !important;
  }
  document-sidebar-container {
    display: none !important;
  }
  body {
    position: relative !important;
  }
  page,
  #root,
  body,
  html {
    height: 100% !important;
    width: 100% !important;
    position: relative !important;
    background: white !important;
    overflow: visible !important;
  }
}
.print-background.math-type-for-print {
  -webkit-print-color-adjust: exact;
}
@media print {
  outline: none !important;
  .npm__react-simple-code-editor__textarea {
    display: none !important;
  }
  math-diagram {
    border: none !important;
  }
  .no-border-on-print {
    border: none !important;
  }
  .setting-select {
    display: none !important;
  }
  .no-print,
  ref-tag.empty-line-tag,
  .text-cursor,
  .sub-text-cursor,
  selection-wrapper,
  message-box-container,
  connection-controls,
  .control-point-guide,
  tool-bar,
  items-bar,
  document-sidebar,
  resize-bar,
  diagram-expander,
  warning-error-region,
  loading-layer,
  resizing-info,
  toc-refresh {
    display: none !important;
  }
  .no-print-outline {
    outline: none !important;
  }
  .selected {
    background: unset !important;
  }
  .math-container-symbol.selected {
    background: unset !important;
  }
  .matrix-symbol.align-symbol {
    background: unset !important;
  }
  .matrix-symbol.gather-symbol {
    background: unset !important;
  }
  tr.selected,
  td.selected {
    border: unset !important;
  }
  tr.selected.hline {
    border-top: 1px solid black !important;
  }
  tr.selected.last-hline {
    border-bottom: 1px solid black !important;
  }
  td.selected.vline {
    border-left: 1px solid black !important;
  }
  td.selected.last-vline {
    border-right: 1px solid black !important;
  }
  .selected {
    outline: unset !important;
  }
  container-layer {
    margin: 0 !important;
    padding: 0 !important;
    background: transparent !important;
    height: initial !important;
    overflow: visible !important;
  }
  editor-container {
    border: none !important;
    margin: 0 !important;
    padding: 0 !important;
    background: transparent !important;
    width: 100% !important;
  }
  content-area {
    padding: 0px !important;
    margin: 0;
    background: transparent !important;
  }
  vcomposed-symbol.non-safari > start {
    margin-bottom: -0.05em !important;
  }
  vcomposed-symbol.non-safari > middle-center {
    margin-top: -0.05em;
    margin-bottom: -0.05em !important;
  }
  vcomposed-symbol.non-safari > middle {
    margin-top: -0.05em;
    margin-bottom: -0.05em !important;
  }
  vcomposed-symbol.non-safari > end {
    margin-top: -0.05em !important;
  }
}
.math-type-for-print {
  outline: none !important;
}
.math-type-for-print .npm__react-simple-code-editor__textarea {
  display: none !important;
}
.math-type-for-print math-diagram {
  border: none !important;
}
.math-type-for-print .no-border-on-print {
  border: none !important;
}
.math-type-for-print .setting-select {
  display: none !important;
}
.math-type-for-print .no-print,
.math-type-for-print ref-tag.empty-line-tag,
.math-type-for-print .text-cursor,
.math-type-for-print .sub-text-cursor,
.math-type-for-print selection-wrapper,
.math-type-for-print message-box-container,
.math-type-for-print connection-controls,
.math-type-for-print .control-point-guide,
.math-type-for-print tool-bar,
.math-type-for-print items-bar,
.math-type-for-print document-sidebar,
.math-type-for-print resize-bar,
.math-type-for-print diagram-expander,
.math-type-for-print warning-error-region,
.math-type-for-print loading-layer,
.math-type-for-print resizing-info,
.math-type-for-print toc-refresh {
  display: none !important;
}
.math-type-for-print .no-print-outline {
  outline: none !important;
}
.math-type-for-print .selected {
  background: unset !important;
}
.math-type-for-print .math-container-symbol.selected {
  background: unset !important;
}
.math-type-for-print .matrix-symbol.align-symbol {
  background: unset !important;
}
.math-type-for-print .matrix-symbol.gather-symbol {
  background: unset !important;
}
.math-type-for-print tr.selected,
.math-type-for-print td.selected {
  border: unset !important;
}
.math-type-for-print tr.selected.hline {
  border-top: 1px solid black !important;
}
.math-type-for-print tr.selected.last-hline {
  border-bottom: 1px solid black !important;
}
.math-type-for-print td.selected.vline {
  border-left: 1px solid black !important;
}
.math-type-for-print td.selected.last-vline {
  border-right: 1px solid black !important;
}
.math-type-for-print .selected {
  outline: unset !important;
}
.math-type-for-print container-layer {
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  height: initial !important;
  overflow: visible !important;
}
.math-type-for-print editor-container {
  border: none !important;
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  width: 100% !important;
}
.math-type-for-print content-area {
  padding: 0px !important;
  margin: 0;
  background: transparent !important;
}
.math-type-for-print vcomposed-symbol.non-safari > start {
  margin-bottom: -0.05em !important;
}
.math-type-for-print vcomposed-symbol.non-safari > middle-center {
  margin-top: -0.05em;
  margin-bottom: -0.05em !important;
}
.math-type-for-print vcomposed-symbol.non-safari > middle {
  margin-top: -0.05em;
  margin-bottom: -0.05em !important;
}
.math-type-for-print vcomposed-symbol.non-safari > end {
  margin-top: -0.05em !important;
}
.justify-single-line {
  display: inline-block;
  text-align-last: justify;
  width: 100%;
}
.rtl-on-line-level {
  direction: rtl;
}

math-type modal-dialog.import-latex math-type editarea.root-editor {
  min-height: 100px;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
math-type .mobile-keys-support-region {
  position: fixed;
  top: 84px;
  left: 45px;
  color: gray;
  z-index: 11609;
  opacity: 0.9;
  display: flex;
  width: auto;
  z-index: 600;
  cursor: pointer;
}
math-type .mobile-keys-support-region.is-android {
  top: unset;
  bottom: 4px;
  left: 17px;
}
math-type .mobile-keys-support-region.select-only {
  top: 40px;
  left: 25px;
}
math-type .mobile-keys-support-region.select-only .btn-suggestion-box-mobile {
  display: none;
}



.special-symbol-dialog__special-char {
  display: inline-block;
  width: 24px;
  height: 24px;
  line-height: 24px;
  border-bottom: 1px solid #ddd;
  border-right: 1px solid #ddd;
  text-align: center;
  cursor: pointer;
  outline: none;
}
.special-symbol-dialog__special-char:hover {
  background: #bfe4bd;
}

/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**different context*/
/**different context*/
context-menu-container {
  position: fixed;
  left: 100px;
  top: 300px;
  z-index: 13;
  box-shadow: 2px 2px 3px 0px #c3c3c3;
  border: 1px solid lightgray;
  width: 200px;
  background: white;
  cursor: default;
  outline: none;
  font-family: "Segoe UI", Arial, Verdana, sans-serif;
}
context-menu-container ct-item {
  display: block;
  padding: 6px 9px;
  font-size: 13px;
  color: gray;
}
context-menu-container ct-item.disabled {
  color: lightgray;
}
context-menu-container ct-item:hover {
  background: #eae9e9;
}
context-menu-container ct-item.hidden {
  display: none;
}
context-menu-container ct-icon {
  width: 20px;
  display: inline-block;
}
context-menu-container ct-separator {
  width: 100%;
  display: block;
  height: 1px;
  margin-top: 2px;
  margin-bottom: 2px;
  border-top: 1px solid lightgray;
}

/* Collection default theme */
/* Grid default theme */
/* Table default theme */









/* List default theme */



math-type .symbol-container,
.auto-complete-external-area .symbol-container {
  display: flex;
  flex-direction: row;
  min-height: 25px;
  padding-left: 4px;
  padding-right: 12px;
  align-items: center;
  cursor: pointer;
}
math-type .symbol-container.selected,
.auto-complete-external-area .symbol-container.selected {
  background-color: #bfe4bd;
}
math-type .symbol-friendly-name,
.auto-complete-external-area .symbol-friendly-name {
  flex-grow: 1;
  font-family: Asana;
  /*padding-top: 6px;*/
}
math-type .symbol-icon,
.auto-complete-external-area .symbol-icon {
  /*padding-top: 6px;*/
  margin-right: 15px;
  min-width: 20px;
  text-align: center;
}
math-type .short-cut,
.auto-complete-external-area .short-cut {
  text-align: center;
  color: gray;
  /*vertical-align: middle;*/
  /*line-height: 20px;*/
  margin: 0 2px 0 2px;
  font-size: 12px;
  display: flex;
  align-items: center;
}
math-type .short-cut span,
.auto-complete-external-area .short-cut span {
  font-size: 10px;
}
math-type .hidden,
.auto-complete-external-area .hidden {
  display: none;
}







/**different context*/
/**different context*/
selection-wrapper {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
  user-select: none;
  pointer-events: none;
  z-index: 9;
}
selection-wrapper > selection {
  display: block;
  position: absolute;
  background-color: rgba(0, 126, 255, 0.15);
  user-select: none;
  width: 100px;
  height: 100px;
  transform-origin: 0 0;
}
selection-wrapper.inactive > selection {
  background-color: rgba(58, 57, 57, 0.13);
}

region-highlight-container {
  user-select: none;
  pointer-events: none;
  display: block;
  position: absolute;
  width: 0px;
  height: 0px;
  top: 0;
  left: 0;
  border: 1px solid lightgoldenrodyellow;
  opacity: 0.2;
}
region-highlight-container > rhc-all > rh-rect {
  display: block;
  position: absolute;
  background: orange;
}
region-highlight-container > rh-selected-rect {
  display: block;
  position: absolute;
  background: red;
}

.math-template-btb.btn-normal {
  background: transparent;
  margin-left: 0;
  font-size: 12px;
  border: none;
}
.math-template-btb.btn-normal:hover {
  background: white;
}
.math-template-name-item:hover {
  background: #f7f7f7;
}

.math-template-tree .tree-node-name {
  white-space: nowrap;
}
.math-template-tree .tree-node-name:hover {
  background: #f7f7f7;
}

math-type compositeblock.bib-bibliography {
  width: 100%;
  display: block;
}
math-type compositeblock.bib-cite {
  display: inline;
  white-space: break-spaces;
}
math-type compositeblock.bib-cite > editarea.text-mode {
  display: inline;
}
math-type compositeblock.bib-cite > editarea.text-mode > line.text-mode {
  display: inline;
}
math-type compositeblock.bib-cite > editarea.text-mode > line.text-mode > blocks {
  display: inline;
}
.csl-context {
  white-space: pre-wrap;
}
.csl-context.csl-cite div {
  display: inline;
}
.csl-context div.csl-left-margin {
  float: left;
}
.csl-context div.csl-block {
  font-weight: bold;
}
.csl-context div.csl-right-inline {
  margin-left: 2.5em;
}
.csl-context div.csl-indent {
  margin-top: 0.5em;
  margin-left: 2em;
  padding-bottom: 0.2em;
  padding-left: 0.5em;
  border-left: 5px solid #ccc;
}

.caption-ref-select .role-item:hover {
  background: #edf9ec;
}

.footnote-mt-container {
  position: relative;
}
.footnote-mt-container .more-option-box {
  position: absolute;
  left: -25px;
  top: 0;
  width: 30px;
  bottom: 0;
  display: none;
}
.footnote-mt-container .more-option-box > div {
  background: #f7f7f7;
  border: 1px solid #d6d3d3;
  padding: 0 0.2em;
  cursor: pointer;
  color: gray;
  display: inline-block;
}
.footnote-mt-container.hover-select:hover .more-option-box {
  display: block;
}
.mt-doc-fn > math-edit-container > editarea > area-container > line > first-line-prefix {
  padding-right: 0.3em;
}
.mt-doc-fn > math-edit-container > editarea > area-container > line.has-rtl {
  direction: rtl;
}
.mt-doc-fn > math-edit-container > editarea > area-container > line.has-rtl > first-line-prefix {
  padding-left: 0.3em;
}
.blocks-inline > math-edit-container > editarea > area-container > line > blocks {
  display: inline;
}

.lang-name:hover {
  background: #f7f7f7;
}
.lang-name.selected {
  background: #e1e8f5;
}
.custom-lange-area input::placeholder,
.custom-lange-area textarea::placeholder {
  color: lightgray;
}

.page-print-item {
  position: relative;
}
.page-print-item:hover .page-print-item-hover {
  display: block;
}
.page-print-item-hover {
  display: none;
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  margin-top: 10px;
  background: #f7f6f6;
  z-index: 10;
  padding: 5px;
  font-size: 0.8em;
  white-space: nowrap;
  color: gray;
  border: 1px solid lightgray;
}

.settings-show-hide {
  background: rgba(255, 255, 255, 0.61);
}
.settings-show-hide:hover {
  background: white;
}
.group-symbol-collapsed {
  display: block;
  border: 1px dotted lightgray;
  padding-top: 0.1em;
  padding-bottom: 0.1em;
}
.role-math-mode-group.math-mode-group-expanded .settings-show-hide,
.role-text-mode-group-inline.text-mode-group-inline-expanded .settings-show-hide {
  display: none;
}
.role-math-mode-group.math-mode-group-expanded:hover,
.role-text-mode-group-inline.text-mode-group-inline-expanded:hover {
  outline: 1px solid lightgray;
}
.role-math-mode-group.math-mode-group-expanded:hover .settings-show-hide,
.role-text-mode-group-inline.text-mode-group-inline-expanded:hover .settings-show-hide {
  display: flex;
}

math-type compositeblock.text-super-script-symbol,
math-type compositeblock.text-sub-script-symbol {
  display: inline;
}
math-type compositeblock.text-super-script-symbol > editarea.text-mode,
math-type compositeblock.text-sub-script-symbol > editarea.text-mode {
  display: inline;
}
math-type compositeblock.text-super-script-symbol > editarea.text-mode > line.text-mode,
math-type compositeblock.text-sub-script-symbol > editarea.text-mode > line.text-mode {
  display: inline;
}
math-type compositeblock.text-super-script-symbol > editarea.text-mode > line.text-mode > blocks,
math-type compositeblock.text-sub-script-symbol > editarea.text-mode > line.text-mode > blocks {
  display: inline;
}
math-type .text-super-script-symbol {
  vertical-align: super;
}
math-type .text-sub-script-symbol {
  vertical-align: sub;
}

compositeblock.section-ref {
  display: inline;
}
compositeblock.section-ref > .section-ref-border {
  display: inline;
  white-space: pre-wrap;
}
compositeblock.section-ref > div {
  display: inline;
}



icon-dropdown-items icon-dropdown-item:hover {
  background: #eae9e9;
}
icon-dropdown ii-icon {
  fill: gray;
}
icon-dropdown:hover {
  color: #4e4d4d;
}
icon-dropdown:hover ii-icon {
  fill: #4e4d4d;
}

resizable-container {
  display: block;
  position: relative;
  min-height: 0;
  flex-shrink: 0;
}





a.fce {
  cursor: pointer;
}
a.fce:hover svg {
  fill: #2d4373;
}
a.fce svg {
  fill: #3b5998;
}
a.fce i {
  text-align: center;
  color: white;
}
a.gg {
  cursor: pointer;
}
a.gg:hover svg {
  fill: #c23321;
}
a.gg svg {
  fill: #dd4b39;
}
a.gg i {
  text-align: center;
  color: white;
}
a.twr {
  cursor: pointer;
}
a.twr:hover svg {
  fill: #2795e9;
}
a.twr svg {
  fill: #55acee;
}
a.twr i {
  text-align: center;
  color: white;
}
a.gh {
  cursor: pointer;
}
a.gh:hover svg {
  fill: #2b2b2b;
}
a.gh svg {
  fill: #444;
}
a.gh i {
  text-align: center;
  color: white;
}





modal-dialog.swift.document-name modal-container.mt-common-dialog {
  width: 500px;
  max-width: 95vw;
}
modal-dialog.swift.document-name document-name {
  width: 100%;
  display: flex;
  flex-direction: column;
}
modal-dialog.swift.document-name document-name label {
  display: block;
  font-size: 13px;
}
modal-dialog.swift.document-name document-name textarea {
  width: auto;
  display: block;
  margin: 5px 0px;
  height: 39px;
  outline: none;
  border: 1px solid lightgray;
  resize: vertical;
}

.dock-tab-content {
  flex: 1;
  min-height: 0;
  min-width: 0;
  display: none;
}
.dock-tab-content.active {
  display: flex;
}

quick-start editarea.root-editor {
  min-height: 100px;
}
quick-start > qs-math-type-container > math-type:hover {
  border: 1px solid gray;
}
quick-start > qs-math-type-container > math-type tool-bar {
  display: none;
}
quick-start > qs-math-type-container > math-type items-bar {
  display: none;
  left: -60px;
  top: 0px;
  box-shadow: 0px 1px 2px 0px #4c4949;
}





/**we use alpha as we have problem with background (without alpha) in Electron version (older Chrome) **/
/* z-index region*/
/**Context Level 1*/
/**both Level 1 and 2 Context */
/**Context Level 2 inside docsContainerZIndex*/
document-info-container document-info-bar {
  display: block;
  position: absolute;
  right: 15px;
  bottom: 5px;
  background: #f7f7f7;
  box-shadow: 1px 1px 1px 0px #e0dddd;
  border: 1px lightgray solid;
  font-size: 12px;
  padding: 0px;
  color: gray;
  opacity: 0.8;
  z-index: 4;
}
document-info-container document-info-bar:hover {
  opacity: 1;
}
document-info-container modal-container button.ok.btn-primary {
  display: none;
}
.Popover-body {
  font-size: 12px;
  padding: 10px;
  background: #4CAF50;
  box-shadow: #888686 1px 1px 1px 1px;
  color: white;
  max-width: 250px;
}
.Popover-tip {
  fill: #4CAF50;
}

/**Context Level 1*/
/**both Level 1 and 2 Context */
/**Context Level 2 inside docsContainerZIndex*/
.doc-toolbar-container {
  position: relative;
  background: #f7f7f7;
  top: 0;
  left: 0;
  width: 100%;
  border: 1px lightgray solid;
  margin-left: -2px;
  z-index: 6;
}
.doc-toolbar-container > tool-bar {
  position: relative;
  top: 0;
  left: 0;
  display: block;
  padding-left: 0px;
  min-width: 770px;
  width: 770px;
  margin: auto;
  background: transparent;
  box-shadow: none;
  border: none;
  height: 35px;
}











/**Context Level 1*/
/**both Level 1 and 2 Context */
/**Context Level 2 inside docsContainerZIndex*/


</style><style>/* @font-face {
  font-family: 'FontAwesome';
  src: format('woff'), url('fonts/icomoon.svg?erlpdm#icomoon') format('svg');
  font-weight: normal;
  font-style: normal;
} */

[class^="fa-"], [class*=" fa-"] {
  /* use !important to prevent issues with browser extensions that change fonts */
  /* font-family: 'FontAwesome' !important;
  speak: none;
  font-style: normal;
  font-weight: normal;
  font-variant: normal;
  text-transform: none; */
  /* line-height: 1; */
  /* Better Font Rendering =========== */
  /* -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale; */
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.fa-plus:before {
  content: "\f067";
}
.fa-user:before {
  content: "\f007";
}
.fa-check:before {
  content: "\f00c";
}
.fa-close:before {
  content: "\f00d";
}
.fa-remove:before {
  content: "\f00d";
}
.fa-times:before {
  content: "\f00d";
}
.fa-search-plus:before {
  content: "\f00e";
}
.fa-search-minus:before {
  content: "\f010";
}
.fa-cog:before {
  content: "\f013";
}
.fa-gear:before {
  content: "\f013";
}
.fa-trash-o:before {
  content: "\f014";
}
.fa-file-o:before {
  content: "\f016";
}
.fa-refresh:before {
  content: "\f021";
}
.fa-font:before {
  content: "\f031";
}
.fa-bold:before {
  content: "\f032";
}
.fa-italic:before {
  content: "\f033";
}
.fa-align-left:before {
  content: "\f036";
}
.fa-align-center:before {
  content: "\f037";
}
.fa-align-right:before {
  content: "\f038";
}
.fa-dedent:before {
  content: "\f03b";
}
.fa-outdent:before {
  content: "\f03b";
}
.fa-indent:before {
  content: "\f03c";
}
.fa-image:before {
  content: "\f03e";
}
.fa-photo:before {
  content: "\f03e";
}
.fa-picture-o:before {
  content: "\f03e";
}
.fa-pencil:before {
  content: "\f040";
}
.fa-edit:before {
  content: "\f044";
}
.fa-pencil-square-o:before {
  content: "\f044";
}
.fa-share-square-o:before {
  content: "\f045";
}
.fa-arrows:before {
  content: "\f047";
}
.fa-chevron-left:before {
  content: "\f053";
}
.fa-chevron-right:before {
  content: "\f054";
}
.fa-times-circle:before {
  content: "\f057";
}
.fa-info-circle:before {
  content: "\f05a";
}
.fa-arrow-left:before {
  content: "\f060";
}
.fa-arrow-right:before {
  content: "\f061";
}
.fa-arrow-up:before {
  content: "\f062";
}
.fa-arrow-down:before {
  content: "\f063";
}
.fa-mail-forward:before {
  content: "\f064";
}
.fa-share:before {
  content: "\f064";
}
.fa-exclamation-circle:before {
  content: "\f06a";
}
.fa-exclamation-triangle:before {
  content: "\f071";
}
.fa-warning:before {
  content: "\f071";
}
.fa-chevron-up:before {
  content: "\f077";
}
.fa-chevron-down:before {
  content: "\f078";
}
.fa-folder:before {
  content: "\f07b";
}
.fa-folder-open:before {
  content: "\f07c";
}
.fa-twitter:before {
  content: "\f099";
}
.fa-twr:before {
  content: "\f099";
}
.fa-facebook:before {
  content: "\f09a";
}
.fa-fce:before {
  content: "\f09a";
}
.fa-facebook-f:before {
  content: "\f09a";
}
.fa-github:before {
  content: "\f09b";
}
.fa-gh:before {
  content: "\f09b";
}
.fa-cut:before {
  content: "\f0c4";
}
.fa-scissors:before {
  content: "\f0c4";
}
.fa-copy:before {
  content: "\f0c5";
}
.fa-files-o:before {
  content: "\f0c5";
}
.fa-bars:before {
  content: "\f0c9";
}
.fa-navicon:before {
  content: "\f0c9";
}
.fa-reorder:before {
  content: "\f0c9";
}
.fa-list-ul:before {
  content: "\f0ca";
}
.fa-list-ol:before {
  content: "\f0cb";
}
.fa-strikethrough:before {
  content: "\f0cc";
}
.fa-underline:before {
  content: "\f0cd";
}
.fa-table:before {
  content: "\f0ce";
}
.fa-magic:before {
  content: "\f0d0";
}
.fa-caret-down:before {
  content: "\f0d7";
}
.fa-caret-right:before {
  content: "\f0da";
}
.fa-sort-desc:before {
  content: "\f0dd";
}
.fa-sort-down:before {
  content: "\f0dd";
}
.fa-clipboard:before {
  content: "\f0ea";
}
.fa-paste:before {
  content: "\f0ea";
}
.fa-angle-double-left:before {
  content: "\f100";
}
.fa-angle-double-right:before {
  content: "\f101";
}
.fa-angle-double-up:before {
  content: "\f102";
}
.fa-angle-double-down:before {
  content: "\f103";
}
.fa-circle:before {
  content: "\f111";
}
.fa-mail-reply:before {
  content: "\f112";
}
.fa-reply:before {
  content: "\f112";
}
.fa-exclamation:before {
  content: "\f12a";
}
.fa-eraser:before {
  content: "\f12d";
}
.fa-ellipsis-h:before {
  content: "\f141";
}
.fa-ellipsis-v:before {
  content: "\f142";
}
.fa-file:before {
  content: "\f15b";
}
.fa-file-text:before {
  content: "\f15c";
}
.fa-google:before {
  content: "\f1a0";
}
.fa-gg:before {
  content: "\f1a0";
}
.fa-trash:before {
  content: "\f1f8";
}
.fa-i-cursor:before {
  content: "\f246";
}
.fa-hand-paper-o:before {
  content: "\f256";
}
.fa-hand-stop-o:before {
  content: "\f256";
}
</style><style>.cb--iframe--D9uyG5KJkpFrhXQGvuUZ {
  all: unset;
  position: fixed;
  right: 0;
  top: 0;
  height: 100%;
  width: 352px;
  z-index: 1000000;
  background: white;
  border: none;
  box-shadow: -3px 2px 5px 2px rgba(0, 0, 0, 0.25);

  transition: right 0.3s ease-out;
}

.cb--closed--yR5Hz5LlC8GYYnikZEG3 {
  right: -352px;
}

.cb--hidden--eb2QcR3oerg0RqbXVXQA {
  display: none;
}
</style><style>.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV,
.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV *:not(path) {
  all: unset;
}

.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV {
  position: fixed;
  right: 0px;
  z-index: 1000001;

  /* override default button styles */
  margin: 0;
  padding: 0;
  border: none;
  cursor: pointer;

  transition: right 0.3s ease-out;
  border-radius: 2px 0 0 2px;
  text-align: center;
}

.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV,
.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV button {
  /* override default button styles */
  margin: 0;
  padding: 0;
  border: none;
  cursor: pointer;
}

.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV.cb--closed--nrw5TP6zJINZIXFZdXx5,
.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV.cb--closed--nrw5TP6zJINZIXFZdXx5 .cb--openToggleButton--rMjdYC82LOME172qu64b {
  height: 48px;
  width: 48px;
  border-radius: 4px 0 0 4px;
  background: #0160ff;
}
.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV.cb--closed--nrw5TP6zJINZIXFZdXx5 .cb--whiteBackgroundWrapper--duMZtlQWI2ORKV2R8jKE {
  height: 48px;
  width: 48px;
}

.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV.cb--open--GtrssE1a2QGrnMivMoKp {
  right: 352px;
  width: 32px;
}

.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV.cb--closed--nrw5TP6zJINZIXFZdXx5 {
  box-shadow: -2px 2px 5px 0px rgba(0, 0, 0, 0.25);
}

.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV.cb--open--GtrssE1a2QGrnMivMoKp .cb--whiteBackgroundWrapper--duMZtlQWI2ORKV2R8jKE {
  background: white;
  border-radius: 2px 0 0 2px;
  box-shadow: -2px 2px 5px 0px rgba(0, 0, 0, 0.25);
  display: block;
}

.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV.cb--open--GtrssE1a2QGrnMivMoKp .cb--openToggleButton--rMjdYC82LOME172qu64b,
.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV.cb--open--GtrssE1a2QGrnMivMoKp .cb--dismissButton--Erb4Il5vr1CZp2IrKfaY {
  height: 32px;
  width: 32px;
  background: none;
}

.cb--logoContainer--Z1CneBzB_UG5LJ5y9Gen svg {
  fill: white;
  padding: 8px;
}

.cb--closeIconContainer--Of0GHevV1dxXAOKkdnBq svg,
.cb--dismissButton--Erb4Il5vr1CZp2IrKfaY svg,
.cb--gripperIcon--n8h56L9XSf892C5RTZKH svg {
  fill: #666666;
}

.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV.cb--open--GtrssE1a2QGrnMivMoKp .cb--logoContainer--Z1CneBzB_UG5LJ5y9Gen,
.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV.cb--closed--nrw5TP6zJINZIXFZdXx5 .cb--closeIconContainer--Of0GHevV1dxXAOKkdnBq,
.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV.cb--closed--nrw5TP6zJINZIXFZdXx5 .cb--dismissButton--Erb4Il5vr1CZp2IrKfaY {
  display: none;
}

.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV .cb--dismissButton--Erb4Il5vr1CZp2IrKfaY svg {
  /* Shrink X icon size, it is too large compared to other icons at same width */
  width: 24px;
}

.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV .cb--gripperIcon--n8h56L9XSf892C5RTZKH {
  height: 24px;
  width: 32px;
  padding: 0;
  margin-top: 4px;
  margin-left: auto;
  margin-right: auto;
  display: none;
}

.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV:hover .cb--gripperIcon--n8h56L9XSf892C5RTZKH,
.cb--openCloseButton--ZetIKUJKuXAyp7PvINNV.cb--dragging--Oya0wwegkiVHmiooh20T .cb--gripperIcon--n8h56L9XSf892C5RTZKH {
  display: block;
}
</style><style>.cb--how-to-open-ftux--xSPP1x7faD_mYZvbrmug {
  all: unset;
  position: fixed;
  right: 0;
  top: 0;
  z-index: 1000000;
  width: 352px;
  background: white;
  border: none;
  box-shadow: -3px 2px 5px 2px rgba(0, 0, 0, 0.25);
  border-radius: 4px;
  display: flex;
  flex-direction: column;
  color: black;

  font-family: "Roboto", Arial, sans-serif !important;
  font-size: 16px !important;
  font-weight: 400 !important;
  line-height: 24px !important;
}

.cb--close-icon--yZkyyYh7THwuH8USAmUi {
  all: unset;
  cursor: pointer;
  height: 24px;
  width: 24px;
  padding: 4px;
  border-radius: 4px;
  margin-left: auto;
  background: white;
}

.cb--ftux-message--R39U88ovkIA9hdk1fWSA {
  margin: 0 20px 20px 20px;
}

.cb--cb-icon--TPte35gUbs2aIVMsWjFT {
  display: inline-block;
  height: 24px;
  width: 24px;
  border-radius: 4px;
  background: #0160ff;
  color: white;
  vertical-align: bottom;
}

.cb--cb-icon--TPte35gUbs2aIVMsWjFT svg {
  fill: white;
  margin: 4px;
}
</style><style>/*!***********************************************************************************************************************************************!*\
  !*** css ./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/sass-loader/dist/cjs.js!./src/content/content.scss ***!
  \***********************************************************************************************************************************************/
@font-face {
  font-family: 'BlufFont-Crimson';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: url("chrome-extension://edcebjbpihembjfeogmjamkphfhldnln/428025ba40b1c354f687.ttf") format("truetype"); }

@font-face {
  font-family: 'BlufFont-Crimson';
  font-style: italic;
  font-weight: 600;
  font-display: swap;
  src: url("chrome-extension://edcebjbpihembjfeogmjamkphfhldnln/f6d119a9c637c1dce674.ttf") format("truetype"); }

@font-face {
  font-family: 'BlufFont-Crimson';
  font-style: italic;
  font-weight: 700;
  font-display: swap;
  src: url("chrome-extension://edcebjbpihembjfeogmjamkphfhldnln/17d0e509df0846a8dd9e.ttf") format("truetype"); }

@font-face {
  font-family: 'BlufFont-Crimson';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url("chrome-extension://edcebjbpihembjfeogmjamkphfhldnln/b7af1dccae742a310539.ttf") format("truetype"); }

@font-face {
  font-family: 'BlufFont-Crimson';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: url("chrome-extension://edcebjbpihembjfeogmjamkphfhldnln/3518edb0e88939f1d275.ttf") format("truetype"); }

@font-face {
  font-family: 'BlufFont-Crimson';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: url("chrome-extension://edcebjbpihembjfeogmjamkphfhldnln/22c807fdbe784a0ec91a.ttf") format("truetype"); }

@font-face {
  font-family: 'BlufFont-Ubuntu';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url("chrome-extension://edcebjbpihembjfeogmjamkphfhldnln/1cbb1b79a23478cc89ad.ttf") format("truetype"); }

@font-face {
  font-family: 'BlufFont-UbuntuMono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: url("chrome-extension://edcebjbpihembjfeogmjamkphfhldnln/9fa7d55c51063608f793.ttf") format("truetype"); }

.bluf_class__NC9fa {
  z-index: 999999999;
  position: fixed;
  font-family: 'BlufFont-Crimson', serif, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale; }

icon {
  display: inline-block;
  line-height: 1em;
  height: 1em;
  width: 1em; }

.bluf_class__Cz8nc {
  border-radius: 4px;
  outline: var(--color-blue-200) dashed 3px;
  outline-offset: 2px;
  z-index: 999999999; }

/*!*************************************************************************************************************************************************************!*\
  !*** css ./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/sass-loader/dist/cjs.js!./src/content/components/ChatWindow.scss ***!
  \*************************************************************************************************************************************************************/
.bluf_class__emjps {
  height: fit-content;
  min-width: 500px;
  max-width: 500px; }
  .bluf_class__emjps .bluf_class__hcdDp {
    display: none !important; }
  .bluf_class__emjps .bluf_class__vlIfk {
    position: absolute;
    top: 0;
    right: 0; }
  .bluf_class__emjps .bluf_class__oEiXe {
    display: block;
    max-height: 600px;
    overflow-x: hidden;
    overflow-y: auto;
    overscroll-behavior: contain; }
  .bluf_class__emjps .bluf_class__UbYoD {
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    row-gap: 8px;
    padding: 8px;
    box-sizing: border-box;
    width: 100%;
    min-height: 200px;
    /* Hide scrollbar for IE, Edge and Firefox */
    -ms-overflow-style: none;
    /* IE and Edge */
    scrollbar-width: none;
    /* Firefox */
    /* Hide scrollbar for Chrome, Safari and Opera */ }
    .bluf_class__emjps .bluf_class__UbYoD::-webkit-scrollbar {
      display: none; }
  .bluf_class__emjps .bluf_class__OC8pQ {
    margin: 16px 24px; }
  .bluf_class__emjps .bluf_class__AUvDx, .bluf_class__emjps .bluf_class__VYIfk, .bluf_class__emjps .bluf_class___Na7T {
    line-height: 1.2em;
    max-width: 80%;
    padding: 4px 12px; }
  .bluf_class__emjps .bluf_class___Na7T {
    align-self: end;
    color: #604f4f;
    cursor: pointer;
    transition: background 200ms ease;
    border-radius: 4px 4px 0;
    max-width: 70%; }
    .bluf_class__emjps .bluf_class___Na7T:hover {
      background: #8e804f20; }
    .bluf_class__emjps .bluf_class___Na7T .bluf_class__LkbUX {
      font-family: 'BlufFont-Ubuntu', sans-serif;
      color: #808080;
      width: fit-content;
      margin-left: auto;
      display: flex;
      align-items: center; }
      .bluf_class__emjps .bluf_class___Na7T .bluf_class__LkbUX icon {
        color: #D63E67; }
        .bluf_class__emjps .bluf_class___Na7T .bluf_class__LkbUX icon:before {
          transition: transform 200ms ease; }
      .bluf_class__emjps .bluf_class___Na7T .bluf_class__LkbUX.bluf_class__AZ0GN icon {
        transform: rotate(180deg); }
    .bluf_class__emjps .bluf_class___Na7T .bluf_class__jJgEC {
      margin-top: 4px; }
  .bluf_class__emjps .bluf_class__AUvDx {
    font-family: 'BlufFont-Ubuntu', sans-serif;
    font-weight: 400;
    color: white;
    align-self: end;
    background: #D63E67;
    border-radius: 4px 4px 0; }
  .bluf_class__emjps .bluf_class__VYIfk {
    align-self: start;
    padding-top: 8px;
    border-left: solid 4px #D63E67;
    font-size: 18px;
    color: #363232;
    border-radius: 0 4px 4px 0;
    transition: background 200ms ease; }
    .bluf_class__emjps .bluf_class__VYIfk *::selection {
      background: #D63E67;
      color: white; }
    .bluf_class__emjps .bluf_class__VYIfk *::-moz-selection {
      background: #D63E67;
      /* Gecko Browsers */
      color: white; }
  .bluf_class__emjps .bluf_class__BGj01 {
    border: 1px solid #D63E67;
    border-radius: 4px;
    background: #D63E6710;
    padding: 6px 8px 4px; }
    .bluf_class__emjps .bluf_class__BGj01 icon {
      color: #D63E67;
      font-size: 20px;
      margin: 0 4px 0 0;
      vertical-align: top; }
  .bluf_class__emjps .bluf_class__hd968 {
    position: relative;
    font-family: 'BlufFont-Ubuntu', sans-serif;
    border-top: #80808040 solid 1px;
    padding: 4px 8px;
    display: block;
    line-height: 0; }
    .bluf_class__emjps .bluf_class__hd968 textarea.bluf_class__hrcZF {
      all: unset;
      overflow-y: hidden;
      outline: none;
      resize: none;
      height: calc(1.4em + 8px);
      min-height: calc(1.4em + 8px);
      width: 100%;
      padding: 4px 8px;
      box-sizing: border-box;
      line-height: 1.2em;
      font-size: 16px;
      font-weight: 400;
      color: black; }
      .bluf_class__emjps .bluf_class__hd968 textarea.bluf_class__hrcZF:hover, .bluf_class__emjps .bluf_class__hd968 textarea.bluf_class__hrcZF:focus {
        outline: none;
        resize: none; }
      .bluf_class__emjps .bluf_class__hd968 textarea.bluf_class__hrcZF::placeholder {
        color: #808080;
        font-style: italic; }
    .bluf_class__emjps .bluf_class__hd968 .bluf_class__mw0va {
      position: absolute;
      bottom: 0;
      right: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 6px; }
      .bluf_class__emjps .bluf_class__hd968 .bluf_class__mw0va span {
        color: #808080;
        font-style: italic;
        margin-right: 8px;
        margin-bottom: 4px; }
      .bluf_class__emjps .bluf_class__hd968 .bluf_class__mw0va button {
        padding: 4px 10px; }
  .bluf_class__emjps h1 {
    font-size: 1.1em; }
  .bluf_class__emjps h2 {
    font-size: 1em; }
  .bluf_class__emjps h3, .bluf_class__emjps h4, .bluf_class__emjps h5, .bluf_class__emjps h6 {
    font-size: 1em; }
  .bluf_class__emjps h1, .bluf_class__emjps h2, .bluf_class__emjps h3, .bluf_class__emjps h4, .bluf_class__emjps h5, .bluf_class__emjps h6 {
    margin: .2em 0;
    color: black; }
  .bluf_class__emjps :is(h1, h2, h3, h4, h5, h5):not(:first-child) {
    margin-top: .4em; }
  .bluf_class__emjps p {
    margin: 0.2em 0 0; }
  .bluf_class__emjps ul, .bluf_class__emjps ol {
    margin: 0;
    padding-inline-start: 1em; }
  .bluf_class__emjps pre {
    background: #DBD4BF;
    border-radius: 4px;
    overflow-y: auto;
    padding: 12px 8px;
    margin: 8px 0;
    font-size: 0.9em;
    line-height: 1.1em; }
  .bluf_class__emjps code {
    font-family: 'BlufFont-UbuntuMono', monospace;
    background: #DBD4BF;
    padding: 0 0.2em;
    border-radius: 4px; }
  .bluf_class__emjps blockquote {
    margin: 8px;
    padding: 8px 16px;
    background: #8e804f20;
    border-left: solid 4px #8e804f60;
    font-style: italic;
    border-radius: 0 4px 4px 0; }
  .bluf_class__emjps .bluf_class__I1kDb {
    position: absolute;
    top: 32px;
    left: 0;
    width: 100%;
    height: calc(100% - 32px);
    background: #f5f0e4;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    row-gap: 10px; }
    .bluf_class__emjps .bluf_class__I1kDb button {
      min-width: 200px; }
      .bluf_class__emjps .bluf_class__I1kDb button:last-child {
        margin-bottom: 10px; }
    .bluf_class__emjps .bluf_class__I1kDb span {
      font-size: 20px;
      color: #604f4f; }
    .bluf_class__emjps .bluf_class__I1kDb .bluf_class__q6vtM {
      margin-bottom: 18px; }
  .bluf_class__emjps a {
    color: #D63E67; }
    .bluf_class__emjps a:visited {
      color: #AE3848; }
  .bluf_class__emjps button {
    background: #D63E67;
    color: white;
    border: none;
    font-size: 16px;
    padding: .4em 1.5em;
    border-radius: 4px;
    font-family: 'BlufFont-Ubuntu', sans-serif;
    cursor: pointer;
    transition: background-color 200ms ease;
    font-weight: 500;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-wrap: nowrap;
    gap: 8px; }
    .bluf_class__emjps button:hover:not(:disabled) {
      background: #AE3848; }
    .bluf_class__emjps button:disabled {
      cursor: not-allowed;
      background: #bf6980; }

/*!**********************************************************************************************************************************************************!*\
  !*** css ./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/sass-loader/dist/cjs.js!./src/content/components/loaders.scss ***!
  \**********************************************************************************************************************************************************/
/**
 * ==============================================
 * Spinner
 * ==============================================
 */
.bluf_class__JJUGW {
  width: 48px;
  height: 48px;
  border: 5px solid #504e4e;
  border-bottom-color: transparent;
  border-radius: 50%;
  display: inline-block;
  box-sizing: border-box;
  animation: bluf_class__mX_67 1s linear infinite; }

@keyframes bluf_class__mX_67 {
  0% {
    transform: rotate(0deg); }
  100% {
    transform: rotate(360deg); } }

/**
 * ==============================================
 * Dot Flashing
 * ==============================================
 */
.bluf_class__T_gXX {
  position: relative;
  margin: 0 15px;
  display: inline-block; }
  .bluf_class__T_gXX, .bluf_class__T_gXX::before, .bluf_class__T_gXX::after {
    width: 10px;
    height: 10px;
    border-radius: 5px;
    background-color: #504e4e80;
    opacity: 1;
    animation: bluf_class__T_gXX 1s infinite linear alternate; }
  .bluf_class__T_gXX {
    animation-delay: 0.5s; }
  .bluf_class__T_gXX::before, .bluf_class__T_gXX::after {
    content: "";
    display: inline-block;
    position: absolute;
    top: 0; }
  .bluf_class__T_gXX:before {
    left: -15px;
    animation-delay: 0s; }
  .bluf_class__T_gXX:after {
    left: 15px;
    animation-delay: 1s; }

@keyframes bluf_class__T_gXX {
  0% {
    opacity: 1; }
  50%, 100% {
    opacity: .2; } }

/*!*********************************************************************************************************************************************************!*\
  !*** css ./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/sass-loader/dist/cjs.js!./src/content/components/window.scss ***!
  \*********************************************************************************************************************************************************/
.bluf_class__J7Gi9 {
  position: fixed;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh; }

.bluf_class__sXKJh {
  position: fixed;
  box-shadow: #00000032 0 5px 17px, #00000020 0 2px 7px;
  background: #f5f0e4;
  border-radius: 8px;
  z-index: 99999;
  font-size: 16px;
  right: 100px;
  top: 100px;
  text-align: left; }
  .bluf_class__sXKJh.bluf_class__jgnFL .bluf_class__bEx51 {
    cursor: grabbing; }
  .bluf_class__sXKJh .bluf_class__ccIg6 {
    height: 28px; }
  .bluf_class__sXKJh .bluf_class__bEx51 {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    font-weight: 800;
    font-size: 21px;
    column-gap: 4px;
    color: black;
    padding-bottom: 8px;
    padding-top: 4px;
    cursor: grab; }
  .bluf_class__sXKJh .bluf_class__d3Xds {
    position: absolute;
    top: 0;
    left: 0; }
  .bluf_class__sXKJh .bluf_class__ZQGYi {
    position: absolute;
    background: lightcoral;
    width: 20px;
    height: 20px; }

/*!**************************************************************************************************************************************************************!*\
  !*** css ./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/sass-loader/dist/cjs.js!./src/content/components/icon-botton.scss ***!
  \**************************************************************************************************************************************************************/
.bluf_class__wuhc0 {
  padding: 2px;
  margin: 2px;
  font-size: 18px;
  color: black;
  border-radius: 12px;
  background: #D63E6700;
  transition: background 200ms ease;
  cursor: pointer; }
  .bluf_class__wuhc0:hover {
    background: #D63E6740; }

/*!*******************************************************************************************************************************************************!*\
  !*** css ./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[2].use[1]!./node_modules/sass-loader/dist/cjs.js!./src/content/components/Menu.scss ***!
  \*******************************************************************************************************************************************************/
.bluf_class__K7vPD {
  position: absolute;
  top: 4px;
  right: 4px;
  box-shadow: #00000032 0 5px 17px, #00000020 0 2px 7px;
  background: #f5f0e4;
  border-radius: 4px; }
  .bluf_class__K7vPD .bluf_class__vzIih {
    margin: 0 0 0 auto;
    display: block; }
  .bluf_class__K7vPD .bluf_class__vFvkT {
    display: flex;
    align-items: center;
    column-gap: 8px;
    padding: 8px 16px;
    cursor: pointer;
    transition: background 200ms ease;
    color: #604f4f;
    font-family: 'BlufFont-Ubuntu', sans-serif;
    font-size: 16px;
    font-weight: 500; }
    .bluf_class__K7vPD .bluf_class__vFvkT:hover {
      background: #DBD4BF;
      color: #4f4545; }


/*# sourceMappingURL=content.css.map*/</style></head><body style="overflow:auto;background:rgb(255, 255, 255);width:auto;height:auto;"><editor-container style="display:block;margin:auto;width:816px;"><math-type style="user-select:text;" class=" math-type-for-print "><math-edit-container><editarea class="root-editor" style="font-family: &quot;Computer Modern Sans&quot;, serif; font-size: 17px;"><area-baseline aria-hidden="true">a</area-baseline><area-container><line class="root text-mode selected align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 1.73em; font-weight: bold;">Visual Search System</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="anchor-tag inline" style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 1.2em; font-weight: bold;"><div data-id="n0.6062854006318239" class="anchor-tag-border no-border-on-print" id="n0.6062854006318239"><span>Table of Content</span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="table-of-content inline"><toc-wrapper><editarea class="edit-area toc-ea no-area-container text-mode"><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.1968619065645698" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.1968619065645698" style="display: inline-block; white-space: pre;">1. </span></compositeblock><block>Introduction</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 619.547px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L619.546875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.4092703529534971" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.4092703529534971" style="display: inline-block; white-space: pre;">1.1. </span></compositeblock><block>Clarifying Requirements</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 490.844px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L490.84375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.15233419762817335" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.15233419762817335" style="display: inline-block; white-space: pre;">2. </span></compositeblock><block>Frame the Problem as an ML Task</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 458.031px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L458.03125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.6668417498798465" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.6668417498798465" style="display: inline-block; white-space: pre;">2.1. </span></compositeblock><block>Defining the ML objective</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 474.25px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L474.25,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.5445747198627666" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.5445747198627666" style="display: inline-block; white-space: pre;">2.2. </span></compositeblock><block>Specifying the system’s input and output</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 367.641px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L367.640625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.45188405462772563" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.45188405462772563" style="display: inline-block; white-space: pre;">2.3. </span></compositeblock><block>Choosing the right ML category</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 432.312px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L432.3125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.0625798731118421" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.0625798731118421" style="display: inline-block; white-space: pre;">2.3.1. </span></compositeblock><block>How to rank images using representation learning?</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 235.922px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L235.921875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.36997494746006976" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.36997494746006976" style="display: inline-block; white-space: pre;">3. </span></compositeblock><block>Data Preparation</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 584.055px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L584.0546875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.8606708869634265" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.8606708869634265" style="display: inline-block; white-space: pre;">3.1. </span></compositeblock><block>Data Engineering</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 536.438px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L536.4375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.60575381996371" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.60575381996371" style="display: inline-block; white-space: pre;">3.1.1. </span></compositeblock><block>Images</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 546.211px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L546.2109375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.5167221702587774" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.5167221702587774" style="display: inline-block; white-space: pre;">3.1.2. </span></compositeblock><block>Users</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 557.086px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L557.0859375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.7702964158168089" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.7702964158168089" style="display: inline-block; white-space: pre;">3.1.3. </span></compositeblock><block>User-image interactions</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 428.453px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L428.453125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.2372348109075204" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.2372348109075204" style="display: inline-block; white-space: pre;">3.2. </span></compositeblock><block>Feature Engineering</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 517.977px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L517.9765625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.999112248737493" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.999112248737493" style="display: inline-block; white-space: pre;">4. </span></compositeblock><block>Model Development</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 564.164px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L564.1640625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.2701461107267571" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.2701461107267571" style="display: inline-block; white-space: pre;">4.1. </span></compositeblock><block>Model Selection</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 545.836px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L545.8359375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.27231869949887644" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.27231869949887644" style="display: inline-block; white-space: pre;">4.2. </span></compositeblock><block>Model Training</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 551.141px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L551.140625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.8283952425830514" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.8283952425830514" style="display: inline-block; white-space: pre;">4.3. </span></compositeblock><block>Constructing the dataset</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 483.703px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L483.703125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.823941995267188" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.823941995267188" style="display: inline-block; white-space: pre;">4.3.1. </span></compositeblock><block>Use human judgments</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 436.969px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L436.96875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.5066465608303319" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.5066465608303319" style="display: inline-block; white-space: pre;">4.3.2. </span></compositeblock><block>Use interactions such as user click as a proxy for similarity</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 181.305px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L181.3046875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.6060406532473948" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.6060406532473948" style="display: inline-block; white-space: pre;">4.3.3. </span></compositeblock><block>Artificially create a similar image from the query image</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 203.266px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L203.265625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.7232391636003104" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.7232391636003104" style="display: inline-block; white-space: pre;">4.3.4. </span></compositeblock><block>Which approach works best in our case?</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 308.875px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L308.875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.1283469327017528" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.1283469327017528" style="display: inline-block; white-space: pre;">4.4. </span></compositeblock><block>Choosing the loss function</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 471.547px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L471.546875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.8299906316558476" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.8299906316558476" style="display: inline-block; white-space: pre;">5. </span></compositeblock><block>Evaluation</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 631.961px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L631.9609375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.14919488143075665" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.14919488143075665" style="display: inline-block; white-space: pre;">5.1. </span></compositeblock><block>Offline Metrics</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 554.469px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L554.46875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.44193849210843483" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.44193849210843483" style="display: inline-block; white-space: pre;">5.2. </span></compositeblock><block>Online Metrics</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 555.461px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L555.4609375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.7793533116500244" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.7793533116500244" style="display: inline-block; white-space: pre;">5.2.1. </span></compositeblock><block>Click-Through Rate (CTR)</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 403.117px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L403.1171875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.5869609451460054" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.5869609451460054" style="display: inline-block; white-space: pre;">6. </span></compositeblock><block>Serving</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 654.617px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L654.6171875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.47325277262881316" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.47325277262881316" style="display: inline-block; white-space: pre;">6.1. </span></compositeblock><block>Prediction Pipeline</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 525.398px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L525.3984375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.0027946867290176147" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.0027946867290176147" style="display: inline-block; white-space: pre;">6.1.1. </span></compositeblock><block>Embedding Generation Service</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 377.961px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L377.9609375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.8967360631870427" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.8967360631870427" style="display: inline-block; white-space: pre;">6.1.2. </span></compositeblock><block>Nearest Neighbor Service</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 416.719px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L416.71875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.4266641867893801" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.4266641867893801" style="display: inline-block; white-space: pre;">6.1.3. </span></compositeblock><block>Re-ranking Service</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 463.078px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L463.078125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.3699953519594881" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.3699953519594881" style="display: inline-block; white-space: pre;">6.2. </span></compositeblock><block>Indexing Pipeline</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 538.477px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L538.4765625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.682100431480549" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.682100431480549" style="display: inline-block; white-space: pre;">6.2.1. </span></compositeblock><block>Indexing Service</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 480.656px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L480.65625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s2" style="line-height: 1.4; padding-left: 3em; cursor: pointer;"><a href="#n0.15381220637283954" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.15381220637283954" style="display: inline-block; white-space: pre;">6.3. </span></compositeblock><block>Performance of nearest neighbor (NN) algorithms</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 307.391px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L307.390625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.696635299365522" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.696635299365522" style="display: inline-block; white-space: pre;">6.3.1. </span></compositeblock><block>Exact nearest neighbor</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 433.18px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L433.1796875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.09152887273328258" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.09152887273328258" style="display: inline-block; white-space: pre;">6.3.2. </span></compositeblock><block>Approximate nearest neighbor (ANN)</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 329.188px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L329.1875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.168097326440799" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.168097326440799" style="display: inline-block; white-space: pre;">6.3.3. </span></compositeblock><block>Tree-based ANN</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 477.562px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L477.5625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.46361619432766554" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.46361619432766554" style="display: inline-block; white-space: pre;">6.3.4. </span></compositeblock><block>Locality sensitive hashing (LSH)</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 366.125px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L366.125,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.18930969365111627" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.18930969365111627" style="display: inline-block; white-space: pre;">6.3.5. </span></compositeblock><block>Clustering-based ANN</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 437.547px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L437.546875,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s3" style="line-height: 1.4; padding-left: 6em; cursor: pointer;"><a href="#n0.03977412737382813" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.03977412737382813" style="display: inline-block; white-space: pre;">6.3.6. </span></compositeblock><block>Which algorithm should we use?</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 365.227px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L365.2265625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.7213628662738067" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.7213628662738067" style="display: inline-block; white-space: pre;">7. </span></compositeblock><block>Other Talking Points</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 558.062px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L558.0625,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line><line class="text-mode toc-s1" style="line-height: 1.4; cursor: pointer;"><a href="#n0.773991377613257" style="color: inherit; text-decoration: inherit;"><prefix style="cursor: pointer;"></prefix><blocks style="cursor: pointer;"><baselineblock class="inline"></baselineblock><compositeblock class="prefix-block inline"><span data-line-id="n0.773991377613257" style="display: inline-block; white-space: pre;">8. </span></compositeblock><block>References</block><compositeblock dir="ltr" class="toc-underline-placeholder-symbol inline" style="width: 20px; overflow: visible;"><svg data-reactroot="" style="width: 631.586px; height: 5px; overflow: visible; display: inline-block;"><path d="M 5,5 L631.5859375,5" stroke-dasharray="1 2" fill="none"></path></svg></compositeblock><compositeblock dir="ltr" class="toc-page-number-symbol inline"><span> </span></compositeblock></blocks></a></line></editarea></toc-wrapper></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="inline" style="display: block;"><div style="vertical-align: baseline;"><div style="display: inline-block; height: 0px; border-bottom: 1px solid; width: 100%;"></div></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.1968619065645698" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.1968619065645698" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Introduction</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block style="background-color: rgb(252, 239, 178);">A system helps users discover images that are visually similar to a selected image</block><block>. </block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>In this chapter, we design a visual search system similar to </block><block style="font-weight: bold; color: rgb(144, 19, 254);">Pinterest’s</block><block> [1] [2].</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 707.125px; height: 345.58px; position: relative;"><img src="image-resources/0951e4b9-4c70-4ede-8837-fe897fe83fe1.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.9219115496251118" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.9219115496251118"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 108363 --> <!-- /react-text --><!-- react-text: 108364 -->1<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Retrieved images that are visually similar to the selected crop</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.4092703529534971" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.4092703529534971" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">1.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Clarifying Requirements</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Here’s a typical interaction between a candidate and an interviewer:</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">• </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item full-line-block-inside" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">• </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="boxed-container inline" style="display: block;"><div style="border-style: solid; border-width: 1px; padding: 2em; margin-top: 0.1em; margin-bottom: 0.1em; border-color: rgb(0, 0, 0); border-radius: 20px;"><editarea class="text-mode"><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Candidate:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> Should we rank the results from most similar to least similar?</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Interviewer:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> Images that appear first in the list should be more similar to the query image.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Candidate:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> Should the system support videos, too?</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Interviewer:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> Let’s focus only on images.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Candidate:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> A platform like Pinterest allows users to select an image crop and retrieve similar images. Should we support that functionality?</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Interviewer:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> Yes.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Candidate:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> Are the displayed images personalized to the user?</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Interviewer:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> For simplicity, let’s not focus on personalization. A query image yields the same results, regardless of who searches for it.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Candidate:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> Can the model use the metadata of the query image, such as image tags?</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Interviewer:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> In practice, the model uses image metadata. But for simplicity, let’s assume we don’t rely on the metadata, but only on the image pixels.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Candidate:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> Can users perform other actions such as save, share, or like? These actions can help label training data.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Interviewer:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> Great point. For simplicity, let’s assume the only supported action is image clicks.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Candidate:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> Should we moderate the images?</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Interviewer:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> It’s important to keep the platform safe, but content moderation is out of scope.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Candidate:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> We can construct training data online and label them based on user interactions. Is this the expected way to construct training data?</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Interviewer:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> Yes, that sounds reasonable.</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Candidate:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> How fast should the search be? Assuming we have 100-200 billion images on the platform, the system should be able to retrieve similar images quickly. Is that a reasonable assumption?</block></blocks></line><line class="text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em; font-weight: bold;">Interviewer:</block><block style="font-family: &quot;Computer Modern Serif&quot;, serif; font-size: 0.9em;"> Yes, that is a reasonable assumption.</block></blocks></line></editarea></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Let’s summarize the problem statement: </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>We are asked to design a visual search system. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>The system retrieves images similar to the query image provided by the user, ranks them based on their similarities to the query image, and then displays them to the user. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>The platform only supports images, with no video or text queries allowed. </block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>For simplicity, no personalization is required.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.15233419762817335" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.15233419762817335" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Frame the Problem as an ML Task</block></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.6668417498798465" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.6668417498798465" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">2.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Defining the ML objective</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>In order to solve this problem using an ML model, we need to create a well-defined ML objective. A potential ML objective is to accurately retrieve images that are visually similar to the image the user is searching for.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.5445747198627666" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.5445747198627666" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">2.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Specifying the system’s input and output</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>The input of a visual search system is a query image provided by the user. The system outputs images that are visually similar to the query image, and the output images are ranked by similarities. Figure 2.2 shows the input and output of a visual search system.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 501.75px; height: 362.43px; position: relative;"><img src="image-resources/0ae758ad-43cd-4886-b770-9f060d89f5b0.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.5501571561923633" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.5501571561923633"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 108638 --> <!-- /react-text --><!-- react-text: 108639 -->2<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">A visual search system’s input-output</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.45188405462772563" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.45188405462772563" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">2.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Choosing the right ML category</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>The output of the model is a set of ranked images that are similar to the query image. As a result, visual search systems can be framed as a ranking problem. In general, the goal of ranking problems is to rank a collection of items, such as images, websites, products, etc., based on their relevance to a query, so that more relevant items appear higher in the search results. Many ML applications, such as recommendation systems, search engines, document retrieval, and online advertising, can be framed as ranking problems. In this chapter, we will use a widely-used approach called representation learning. Let’s examine this in more detail.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Representation learning. In representation learning [3], a model is trained to transform input data, such as images, into representations called embeddings. Another way of describing this is that the model maps input images to points in an N-dimensional space called embedding space. These embeddings are learned so that similar images have embeddings that are in close proximity to each other, in the space. Figure 2.3 illustrates how two similar images are mapped onto two points in close proximity within the embedding space. To demonstrate, we visualize image embeddings (denoted by </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>&amp;#x27;</mi><mi>x</mi><mi>&amp;#x27;</mi></mrow></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">'x'</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>'</mi><mi>x</mi><mi>'</mi></mrow></mstyle></math></span></compositeblock><block>) in a 2-dimensional space. In reality, this space is </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>N</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">N</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>N</mi></mstyle></math></span></compositeblock><block>-dimensional, where </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>N</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">N</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>N</mi></mstyle></math></span></compositeblock><block> is the size of the embedding vector.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 684.875px; height: 329.65px; position: relative;"><img src="image-resources/f9d237ca-0d55-4d38-a108-7eb9c43f66c7.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.6144596444366828" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.6144596444366828"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 108711 --> <!-- /react-text --><!-- react-text: 108712 -->3<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Similar images in the embedding space</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.0625798731118421" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.0625798731118421" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">2.3.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>How to rank images using representation learning?</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>First, the input images are transformed into embedding vectors. Next, we calculate the similarity scores between the query image and other images on the platform by measuring their distances in the embedding space. The images are ranked by similarity scores, as shown in Figure 2.4.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 592.25px; height: 370.94px; position: relative;"><img src="image-resources/d0f5aaea-0e36-492b-8174-946462d93f04.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.24697944007205108" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.24697944007205108"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 108761 --> <!-- /react-text --><!-- react-text: 108762 -->4<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Top 3 images similar to the query image</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>At this point, you may have many questions, including how to ensure similar images are placed close to each other in the embedding space, how to define the similarity, and how to train such a model. We will talk more about these in the model development section.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.36997494746006976" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.36997494746006976" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Data Preparation</block></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.8606708869634265" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.8606708869634265" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">3.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Data Engineering</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Aside from generic data engineering fundamentals, it’s important to understand what data is available. As a visual search system mainly focuses on users and images, we have the following data available:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Images</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Users</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>User-image interactions</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.60575381996371" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.60575381996371" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">3.1.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Images</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Creators upload images, and the system stores the images and their metadata, such as owner id, contextual information (e.g., upload time), tags, etc. Table 2.1 shows a simplified example of image metadata.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">• </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 496.375px; height: 184.83px; position: relative;"><img src="image-resources/f6691136-8fb8-48e1-af22-ab8634bd186a.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.5167221702587774" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.5167221702587774" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">3.1.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Users</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>User data contains demographic attributes associated with users, such as age, gender, etc. Table 2.2 shows an example of user data.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 503.844px; height: 169.75px; position: relative;"><img src="image-resources/7c32ff76-9dee-4324-9b5b-e48c7a5fceb3.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.7702964158168089" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.7702964158168089" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">3.1.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>User-image interactions</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Interaction data contains different types of user interactions. Based on the requirements gathered, the primary types of interactions are impressions and clicks. Table 2.3 shows an overview of interaction data.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 522.25px; height: 187.47px; position: relative;"><img src="image-resources/da791715-b2b1-4d64-a33d-246409c24305.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div style="display: none;"></div></compositeblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.2372348109075204" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.2372348109075204" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">3.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Feature Engineering</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>In this section, you are expected to talk about engineering great features and preparing them as model inputs. This usually depends on how we framed the task and what the model’s inputs are. In the earlier “Framing the problem as an ML task” section, we framed the visual search system as a ranking problem and used representation learning to solve it. In particular, we employed a model which expects an image as input. The image needs to be preprocessed before being passed to the model. Let’s take a look at common image preprocessing operations:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Resizing:</block><block> Models usually require fixed image sizes (e.g., </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mn>224</mn><mo form=&quot;infix&quot;>×</mo><mn>224</mn></mrow></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">224</block><block class="Binary">×</block><block class="Normal">224</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mn>224</mn><mo form="infix">×</mo><mn>224</mn></mrow></mstyle></math></span></compositeblock><block>)</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Scaling:</block><block> Scale pixel values of the image to the range of 0 and 1</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Z-score normalization:</block><block> Scale pixel values to have a mean of 0 and variance of 1</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Consistent:</block><block> Ensuring images have a consistent color mode (e.g., RGB or CMYK)</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.999112248737493" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.999112248737493" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Model Development</block></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.2701461107267571" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.2701461107267571" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">4.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Model Selection</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>We choose neural networks because:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Neural networks are good at handling unstructured data, such as images and text</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Unlike many traditional machine learning models, neural networks are able to produce the embeddings we need for representation learning.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>What types of neural network architectures should we use? It is essential that the architecture works with images. CNN-based architectures such as ResNet [4] or more recent Transformer-based architectures [5] such as ViT [6] perform well with image inputs. Figure 2.5 shows a simplified model architecture that transforms the input image into an embedding vector. The number of convolution layers, the number of neurons in fullyconnected layers, and the size of the embedding vector are hyperparameters typically chosen via experimentation.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 695.625px; height: 225.63px; position: relative;"><img src="image-resources/ff4361f8-3d5c-47dc-9965-b62a98f2ae81.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.4874338709226025" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.4874338709226025"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 109036 --> <!-- /react-text --><!-- react-text: 109037 -->5<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">A simplified model architecture</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.27231869949887644" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.27231869949887644" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">4.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Model Training</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>In order to retrieve visually similar images, a model must learn representations (embeddings) during training. In this section, we discuss how to train a model to learn image representations.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>A common technique for learning image representations is contrastive training [7]. With this technique, we train the model to distinguish similar and dissimilar images. As Figure 2.6 shows, we provide the model with a query image (left), one similar image to the query image (highlighted dog image on the right), and a few dissimilar images (also right.) During training, the model learns to produce representations in which the similar image more closely resembles the query image, than do other images on the right side of Figure 2.6.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 448.25px; height: 290.46px; position: relative;"><img src="image-resources/6e2c1196-492a-4310-aedf-b8fd296f0fb2.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.08865376403723801" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.08865376403723801"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 109096 --> <!-- /react-text --><!-- react-text: 109097 -->6<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Contrastive training</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.8283952425830514" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.8283952425830514" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">4.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Constructing the dataset</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>As described earlier, each data point used for training contains a query image, a positive image that’s similar to the query image, and </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>n</mi><mo form=&quot;infix&quot;>-</mo><mn>1</mn></mrow></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">n</block><block class="Binary">-</block><block class="Normal">1</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>n</mi><mo form="infix">-</mo><mn>1</mn></mrow></mstyle></math></span></compositeblock><block> negative images that are dissimilar to the query image. The ground truth label of the data point is the index of the positive image. Asf Figure 2.7 shows, along with the query image (q), we have </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>n</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">n</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>n</mi></mstyle></math></span></compositeblock><block> other images, of which one is similar to the q (image of the dog), and the other </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>n</mi><mo form=&quot;infix&quot;>-</mo><mn>1</mn></mrow></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">n</block><block class="Binary">-</block><block class="Normal">1</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>n</mi><mo form="infix">-</mo><mn>1</mn></mrow></mstyle></math></span></compositeblock><block> images are dissimilar. The ground truth label for this data point is the index of the positive image, which is 2 (the second image among the </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>n</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">n</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>n</mi></mstyle></math></span></compositeblock><block> images in Figure 2.7).</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 537.25px; height: 150.05px; position: relative;"><img src="image-resources/313e76df-2615-4b33-97ed-eaecd8e2eb57.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.9211489415491065" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.9211489415491065"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 109179 --> <!-- /react-text --><!-- react-text: 109180 -->7<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Training data point</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>To construct a training data point, we randomly choose a query image and </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>n</mi><mo form=&quot;infix&quot;>-</mo><mn>1</mn></mrow></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">n</block><block class="Binary">-</block><block class="Normal">1</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>n</mi><mo form="infix">-</mo><mn>1</mn></mrow></mstyle></math></span></compositeblock><block> images as negative images. To select a positive image, we have the following three options:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Use human judgment</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Use interactions such as user clicks as a proxy for similarity</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Artificially create a similar image from the query image, known as self-supervision</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.823941995267188" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.823941995267188" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">4.3.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Use human judgments</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>This approach relies on human contractors manually finding similar images. Human involvement produces accurate training data, but using human annotators is expensive and time-consuming.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.5066465608303319" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.5066465608303319" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">4.3.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Use interactions such as user click as a proxy for similarity</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>In this approach, we measure similarity based on interaction data. As an example, when a user clicks on an image, the clicked image is considered to be similar to the query image q.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>This approach does not require manual work and can generate training data automatically. However, the click signal is usually very noisy. Users sometimes click on images even when the image is not similar to the query image. Additionally, this data is very sparse, and we may not have click data available for lots of the images. The use of noisy and sparse training data leads to poor performance.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.6060406532473948" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.6060406532473948" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">4.3.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Artificially create a similar image from the query image</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>In this approach, we artificially create a similar image from the query image. For example, we can augment the query image by rotating it and using the newly generated image as a similar image. Recently developed frameworks such as SimCLR [7] and MoCo [8] use the same approach.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 487.75px; height: 172.08px; position: relative;"><img src="image-resources/71ccfb07-e82c-499d-995e-376048bdb569.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.9213058703569206" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.9213058703569206"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 109302 --> <!-- /react-text --><!-- react-text: 109303 -->8<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Use data augmentation to create a similar image</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>An advantage of this method is that no manual work is required. We can implement simple data augmentation logic to create similar images. In addition, the constructed training data is not noisy, since augmenting an image always results in a similar image. The major drawback of this approach is that the constructed training data differs from the real data. In practice, similar images are not augmented versions of the query image; they are visually and semantically similar, but are distinct.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.7232391636003104" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.7232391636003104" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">4.3.4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Which approach works best in our case?</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>In an interview setting, it’s critical you propose various options and discuss their tradeoffs. There is usually not a single best solution that always works. Here, we use the self-supervision option for two reasons. Firstly, there is no upfront cost associated with it, since the process can be automated. Secondly, various frameworks such as SimCLR [7] have shown promising results when trained on a large dataset. Since we have access to billions of images on the platform, this approach might be a good fit.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>We can always switch to other labeling methods if the experiment results are unsatisfactory. For example, we can start with the self-supervision option and later use click data for labeling. We can also combine the options. For example, we may use clicks to build our initial training data and rely on human annotators to identify and remove noisy data points. Discussing different options and trade-offs with the interviewer is critical to make good design decisions.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">• </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Once we construct the dataset, it’s time to train the model using a proper loss function.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.1283469327017528" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.1283469327017528" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">4.4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Choosing the loss function</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>As Figure 2.9 shows, the model takes images as input and produces an embedding for each input image.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><msub><mi>E</mi><mi>x</mi></msub></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">E</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">x</editarea-block></compositeblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><msub><mi>E</mi><mi>x</mi></msub></mstyle></math></span></compositeblock><block> denotes the embedding of the image </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>x</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">x</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>x</mi></mstyle></math></span></compositeblock><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 491.75px; height: 273.66px; position: relative;"><img src="image-resources/aaa18701-1cfa-44ba-bbc1-975b8c4ac8f6.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.6847839558563142" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.6847839558563142"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 109412 --> <!-- /react-text --><!-- react-text: 109413 -->9<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Model input-output</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>The goal of the training is to optimize the model parameters so that similar images have embeddings close to each other in the embedding space. As Figure 2.10 shows, the positive image and the query image should become closer during training.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 395.75px; height: 360.76px; position: relative;"><img src="image-resources/d4704461-1d20-465d-9a46-baf79f3b0a2d.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.506109012189029" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.506109012189029"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 109457 --> <!-- /react-text --><!-- react-text: 109458 -->10<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Input images mapped into the embedding space</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>To achieve this goal, we need to use a loss function to measure the quality of the produced embeddings. Different loss functions are designed for contrastive training, and interviewers don’t usually expect you to hold an in-depth discussion. However, it is crucial to have a high-level understanding of how contrastive loss functions work.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>We are going to briefly discuss how a simplified contrastive loss operates. If you are interested in learning more about contrastive losses, refer to [9].</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 548.75px; height: 299.03px; position: relative;"><img src="image-resources/35a6282d-018d-440a-9975-47f790aa93eb.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.631978006656239" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.631978006656239"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 109512 --> <!-- /react-text --><!-- react-text: 109513 -->11<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">A simplified contrastive loss</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>As Figure 2.11 shows, we compute the contrastive loss in three steps.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Compute similarities.</block><block> First, we compute the similarities between the query image and the embeddings of other images. Dot product [10] and cosine similarity [11] are widely used to measure the similarity between points in the embedding space. Euclidean distance [12] can also measure the similarity. However, Euclidean distance usually performs poorly in high dimensions because of the curse of dimensionality [13]. To learn more about the curse of dimensionality issues, read [14].</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Softmax.</block><block> A softmax function is applied over the computed distances. This ensures the values sum up to one, which allows the values to be interpreted as probabilities.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Cross-entropy.</block><block> Cross-entropy [15] measures how close the predicted probabilities are to the ground truth labels. When the predicted probabilities are close to the ground truth, it shows that the embeddings are good enough to distinguish the positive image from the negative ones.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>In the interview, you can also discuss the possibility of using a pre-trained model. For example, we could leverage a pre-trained contrastive model and fine-tune it using the training data. These pre-trained models have already been trained on large datasets, and therefore they have learned good image representations. This significantly reduces the training time compared to training a model from scratch.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.8299906316558476" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.8299906316558476" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">5. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Evaluation</block></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.14919488143075665" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.14919488143075665" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">5.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Offline Metrics</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Based on the given requirements, an evaluation dataset is available for offline evaluation. Let’s assume each data point has a query image, a few candidate images, and a similarity score for each candidate image and the query image pair. A similarity score is an integer number between 0 and 5, where 0 indicates no similarity and 5 indicates two images are visually and semantically very similar. For each data point in the evaluation dataset, we compare the ranking produced by the model with the ideal ranking, based on the ground truth scores.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 524.75px; height: 143.9px; position: relative;"><img src="image-resources/01a4799c-851f-4f58-9b83-552cafabaaac.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.3440484656306373" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.3440484656306373"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 109610 --> <!-- /react-text --><!-- react-text: 109611 -->12<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">A data point from the evaluation dataset</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">• </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Now, let’s examine offline metrics that are commonly used in search systems. Note that search, information retrieval, and recommendation systems usually share the same offline metrics.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(63, 131, 219);">Mean reciprocal rank (MRR)</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(63, 131, 219);">Recall@k</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(63, 131, 219);">Precision@k</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(63, 131, 219);">Mean average precision (mAP)</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(63, 131, 219);">Normalized discounted cumulative gain (nDCG)</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">MRR.</block><block> This metric measures the quality of the model by considering the rank of the first relevant item in each output list produced by the model, and then averaging them. The formula is:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area display" style="font-size: 17px;" data-mathml="<math display=&quot;block&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mi>R</mi><mi>R</mi><mo form=&quot;infix&quot;>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo largeop=&quot;true&quot; movablelimit=&quot;true&quot;>∑</mo><mrow><mi>i</mi><mo form=&quot;infix&quot;>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mfrac><mn>1</mn><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub></mrow></mfrac></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="taggable" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">MRR</block><block class="Relation">=</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">1</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><block class="Normal">m</block></editarea-line></compositeblock><compositeblock dir="ltr" class="summation-like-symbol limit-type limit-kind"><editarea class="from no-area-container" style="margin-bottom: -0.411765em;"><line class="" style="margin-bottom: -0.168067em; line-height: 1.2;"><baselineblock></baselineblock><block>m</block></line></editarea><symbol class="" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana; font-style: normal; font-weight: normal;"><span>∑</span></symbol><editarea class="to to-summation no-area-container" style="margin-top: 0.176471em;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block>i=1</block></line></editarea></compositeblock><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">1</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><block class="Normal">rank</block><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">i</editarea-block></compositeblock></editarea-line></compositeblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>R</mi><mi>R</mi><mo form="infix">=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo largeop="true" movablelimit="true">∑</mo><mrow><mi>i</mi><mo form="infix">=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mfrac><mn>1</mn><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub></mrow></mfrac></math></span></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">• </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>m</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">m</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>m</mi></mstyle></math></span></compositeblock><block> → total number of output lists</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub></mrow></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">rank</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">i</editarea-block></compositeblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>i</mi></msub></mrow></mstyle></math></span></compositeblock><block> → rank of the first relevant item in the </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>i</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">i</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>i</mi></mstyle></math></span></compositeblock><block>th output list.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Figure 2.13 illustrates how this works. For each of the 4 ranked lists, we compute the reciprocal rank (RR) and then calculate the average value of the RRs to get the MRR.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 363.375px; height: 355.92px; position: relative;"><img src="image-resources/04d5948f-a3ab-4484-a021-4367be72759f.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.7813701641735604" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.7813701641735604"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 109749 --> <!-- /react-text --><!-- react-text: 109750 -->13<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">MRR calculation example</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Let’s examine the shortcoming of this metric. Since MRR considers only the first relevant item and ignores other relevant items in the list, it does not measure the precision and ranking quality of a ranked list. For example, Figure 2.14 shows the outputs of two different models. The output of model 1 has 3 relevant items, while the output of model 2 has 1 relevant item. However, the reciprocal rank of both models is 0 5. Given this shortcoming, we will not use this metric.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 394.5px; height: 119.8px; position: relative;"><img src="image-resources/4a7bedcd-6f16-4791-aff6-b116f16677b5.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.31590786594470033" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.31590786594470033"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 109794 --> <!-- /react-text --><!-- react-text: 109795 -->14<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">MRR of two different models</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Recall@k.</block><block> This metric measures the ratio between the number of relevant items in the output list and the total number of relevant items available in the entire dataset. The formula is:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area display" style="font-size: 17px;" data-mathml="<math display=&quot;block&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi>@</mi><mi>k</mi><mo form=&quot;infix&quot;>=</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>n</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>b</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>r</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>f</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>v</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>n</mi><mi mathvariant=&quot;normal&quot;>t</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>s</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>n</mi><mi mathvariant=&quot;normal&quot;>g</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>h</mi><mi mathvariant=&quot;normal&quot;>e</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>p</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi>k</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;bold&quot;>i</mi><mi mathvariant=&quot;bold&quot;>t</mi><mi mathvariant=&quot;bold&quot;>e</mi><mi mathvariant=&quot;bold&quot;>m</mi><mi mathvariant=&quot;bold&quot;>s</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;bold&quot;>i</mi><mi mathvariant=&quot;bold&quot;>n</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;bold&quot;>t</mi><mi mathvariant=&quot;bold&quot;>h</mi><mi mathvariant=&quot;bold&quot;>e</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;bold&quot;>o</mi><mi mathvariant=&quot;bold&quot;>u</mi><mi mathvariant=&quot;bold&quot;>t</mi><mi mathvariant=&quot;bold&quot;>p</mi><mi mathvariant=&quot;bold&quot;>u</mi><mi mathvariant=&quot;bold&quot;>t</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;bold&quot;>l</mi><mi mathvariant=&quot;bold&quot;>i</mi><mi mathvariant=&quot;bold&quot;>s</mi><mi mathvariant=&quot;bold&quot;>t</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>l</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>v</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>n</mi><mi mathvariant=&quot;normal&quot;>t</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>s</mi></mrow></mfrac></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="taggable" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana;">recall</block><block class="Normal">@k</block><block class="Relation">=</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana;">number of relevant items among the top</block><block class="Normal"> k </block><block class="Normal" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana; font-weight: bold;">items in the output list</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><block class="Normal" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana;">total relevant items</block></editarea-line></compositeblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">l</mi><mi>@</mi><mi>k</mi><mo form="infix">=</mo><mfrac><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">s</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">g</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">t</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">p</mi><mspace is="true" width="0.22em"></mspace><mi>k</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="bold">i</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">m</mi><mi mathvariant="bold">s</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="bold">i</mi><mi mathvariant="bold">n</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="bold">t</mi><mi mathvariant="bold">h</mi><mi mathvariant="bold">e</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="bold">o</mi><mi mathvariant="bold">u</mi><mi mathvariant="bold">t</mi><mi mathvariant="bold">p</mi><mi mathvariant="bold">u</mi><mi mathvariant="bold">t</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="bold">l</mi><mi mathvariant="bold">i</mi><mi mathvariant="bold">s</mi><mi mathvariant="bold">t</mi></mrow><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">s</mi></mrow></mfrac></math></span></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Even though recall@k measures how many relevant items the model failed to include in the output list, this isn’t always a good metric. Let’s understand why not. In some systems, such as search engines, the total number of relevant items can be very high. This negatively affects the recall as the denominator is very large. For example, when the query image is an image of a dog, the database may contain millions of dog images. The goal is not to return every dog image but to retrieve a handful of the most similar dog images.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Given recall@k doesn’t measure the ranking quality of the model, we will not use it.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">Precision@k.</block><block> This metric measures the proportion of relevant items among the top k items in the output list. The formula is:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area display" style="font-size: 17px;" data-mathml="<math display=&quot;block&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>n</mi><mi>@</mi><mi>k</mi><mo form=&quot;infix&quot;>=</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>n</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>b</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>r</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>f</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>v</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>n</mi><mi mathvariant=&quot;normal&quot;>t</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>s</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>n</mi><mi mathvariant=&quot;normal&quot;>g</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>h</mi><mi mathvariant=&quot;normal&quot;>e</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>p</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi>k</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>s</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>n</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>h</mi><mi mathvariant=&quot;normal&quot;>e</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>t</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>t</mi></mrow><mi>k</mi></mfrac></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="taggable" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana;">precision</block><block class="Normal">@k</block><block class="Relation">=</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana;">number of relevant items among the top</block><block class="Normal"> k </block><block class="Normal" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana;">items in the output list</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><block class="Normal">k</block></editarea-line></compositeblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi><mi>@</mi><mi>k</mi><mo form="infix">=</mo><mfrac><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">s</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">g</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">t</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">p</mi><mspace is="true" width="0.22em"></mspace><mi>k</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">s</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">o</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">t</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi></mrow><mi>k</mi></mfrac></math></span></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>This metric measures how precise the output lists are, but it doesn’t consider the ranking quality. For example, in Figure 2.15, if we rank more relevant items higher in the list, the precision won’t change. This metric is not ideal for our use case, since we need to measure both the precision and ranking quality of the results.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 374.125px; height: 118.7px; position: relative;"><img src="image-resources/3b25042a-3353-4272-a3a2-edeac9d7672d.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.5092339157571222" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.5092339157571222"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 109917 --> <!-- /react-text --><!-- react-text: 109918 -->15<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Precision@5 of two different models</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">mAP</block><block>. This metric first computes the average precision (AP) for each output list, and then averages AP values.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Let’s first understand what AP is. It takes a list of </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>k</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">k</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>k</mi></mstyle></math></span></compositeblock><block> items, such as images, and averages the precision@k at different values of </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>k</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">k</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>k</mi></mstyle></math></span></compositeblock><block>. AP is high if more relevant items are located at the top of the list. For a list of size </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>k</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">k</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>k</mi></mstyle></math></span></compositeblock><block>, the AP formula is:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area display" style="font-size: 17px;" data-mathml="<math display=&quot;block&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;normal&quot;>A</mi><mi mathvariant=&quot;normal&quot;>P</mi><mo form=&quot;infix&quot;>=</mo><mfrac><mrow><munderover><mo largeop=&quot;true&quot; movablelimit=&quot;true&quot;>∑</mo><mrow><mi>i</mi><mo form=&quot;infix&quot;>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mi mathvariant=&quot;normal&quot;>P</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>n</mi><mi mathvariant=&quot;normal&quot;>@</mi><mi mathvariant=&quot;normal&quot;>k</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>f</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi>i</mi><mi>&amp;#x27;</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>h</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>m</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>s</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>v</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>n</mi><mi mathvariant=&quot;normal&quot;>t</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>o</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>h</mi><mi mathvariant=&quot;normal&quot;>e</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>r</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>l</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>v</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>n</mi><mi mathvariant=&quot;normal&quot;>t</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>s</mi></mrow></mfrac></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="taggable" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana;">AP</block><block class="Relation">=</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="summation-like-symbol limit-type non-limit-kind inline"><editarea class="from no-area-container" style="margin-bottom: -0.588235em; margin-left: 1.1em;"><line class="" style="margin-bottom: -0.168067em; line-height: 1.2;"><baselineblock></baselineblock><block>k</block></line></editarea><symbol class="" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana; font-style: normal; font-weight: normal;"><span>∑</span></symbol><editarea class="to to-summation no-area-container" style="margin-top: -0.411765em; margin-left: 1.1em;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block>i=1</block></line></editarea></compositeblock><block class="Normal" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana;">Precision@k if</block><block class="Normal"> i'</block><block class="Normal" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana;">th item is relevant to the user</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><block class="Normal" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana;">total relevant items</block></editarea-line></compositeblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">A</mi><mi mathvariant="normal">P</mi><mo form="infix">=</mo><mfrac><mrow><munderover><mo largeop="true" movablelimit="true">∑</mo><mrow><mi>i</mi><mo form="infix">=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mi mathvariant="normal">P</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">@</mi><mi mathvariant="normal">k</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi><mspace is="true" width="0.22em"></mspace><mi>i</mi><mi>'</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">t</mi><mi mathvariant="normal">o</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">u</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">t</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">s</mi></mrow></mfrac></math></span></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Let’s look at an example to better understand the metric. Figure 2.16 shows AP calculations for each of the 4 output lists produced by the model.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 576.75px; height: 434.97px; position: relative;"><img src="image-resources/250f383f-ebc1-42ea-a069-08bf97697238.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.01719259062763734" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.01719259062763734"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 110014 --> <!-- /react-text --><!-- react-text: 110015 -->16<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">mAP calculations</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Since we average precisions, the overall ranking quality of the list is considered. However, mAP is designed for binary relevances; in other words, it works well when each item is either relevant or irrelevant. For continuous relevance scores, nDCG is a better choice.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">nDCG.</block><block> This metric measures the ranking quality of an output list and shows how good the ranking is, compared to the ideal ranking. First, let’s explain DCG and then discuss nDCG.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(0, 0, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">What is DCG?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="color: rgb(0, 0, 0); flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>DCG calculates the cumulative gain of items in a list by summing up the relevance score of each item. Then the score is accumulated from the top of the output list to the bottom, with the score of each result discounted at lower ranks. The formula is:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area display" style="font-size: 17px;" data-mathml="<math display=&quot;block&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub><mo form=&quot;infix&quot;>=</mo><munderover><mo largeop=&quot;true&quot; movablelimit=&quot;true&quot;>∑</mo><mrow><mi>i</mi><mo form=&quot;infix&quot;>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mfrac><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo form=&quot;infix&quot;>+</mo><mn>1</mn><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="taggable" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">DCG</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">p</editarea-block></compositeblock><block class="Relation">=</block><compositeblock dir="ltr" class="summation-like-symbol limit-type limit-kind"><editarea class="from no-area-container" style="margin-bottom: -0.411765em;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block>p</block></line></editarea><symbol class="" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana; font-style: normal; font-weight: normal;"><span>∑</span></symbol><editarea class="to to-summation no-area-container" style="margin-top: 0.176471em;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block>i=1</block></line></editarea></compositeblock><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">rel</block><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">i</editarea-block></compositeblock></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="constant-text inline"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">2</editarea-block></compositeblock><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">i</block><block class="Binary">+</block><block class="Normal">1</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line></compositeblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub><mo form="infix">=</mo><munderover><mo largeop="true" movablelimit="true">∑</mo><mrow><mi>i</mi><mo form="infix">=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mfrac><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence="true" stretchy="false">(</mo><mi>i</mi><mo form="infix">+</mo><mn>1</mn><mo fence="true" stretchy="false">)</mo></mrow></mfrac></math></span></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">• </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">rel</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">i</editarea-block></compositeblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></mstyle></math></span></compositeblock><block> → ground truth relevance score of the image ranked at location </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>i</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">i</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>i</mi></mstyle></math></span></compositeblock><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="color: rgb(255, 64, 0); font-weight: bold; flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(255, 64, 0);">What is nDCG?</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Because DCG sums up the relevance scores of items and discounts their positions, the result of DCG could be any value. In order to get a more meaningful score, we need to normalize DCG. For this, nDCG divides the DCG by the DCG of an ideal ranking. The formula is:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area display" style="font-size: 17px;" data-mathml="<math display=&quot;block&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mi>D</mi><mi>C</mi><msub><mi>P</mi><mi>p</mi></msub><mo form=&quot;infix&quot;>=</mo><mfrac><mrow><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub></mrow><mrow><mi>I</mi><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub></mrow></mfrac></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="taggable" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">nDCP</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">p</editarea-block></compositeblock><block class="Relation">=</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">DCG</block><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">p</editarea-block></compositeblock></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><block class="Normal">IDCG</block><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">p</editarea-block></compositeblock></editarea-line></compositeblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mi>D</mi><mi>C</mi><msub><mi>P</mi><mi>p</mi></msub><mo form="infix">=</mo><mfrac><mrow><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub></mrow><mrow><mi>I</mi><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub></mrow></mfrac></math></span></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">• </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>I</mi><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub></mrow></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">IDCG</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">p</editarea-block></compositeblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>I</mi><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub></mrow></mstyle></math></span></compositeblock><block> → the </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>D</mi><mi>C</mi><mi>G</mi></mrow></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">DCG</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>D</mi><mi>C</mi><mi>G</mi></mrow></mstyle></math></span></compositeblock><block> of the ideal ranking (a ranking ordered by the relevance scores of items). Note that in a perfect ranking system, the DCG is equal to IDCG.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Let’s use an example to better understand nDCG. In Figure 2.17, we can see a list of output images and their associated ground truth relevance scores produced by a search system.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 577.5px; height: 148px; position: relative;"><img src="image-resources/d230f97e-7442-4c55-9cb4-2a01ad9c204b.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.621480678917453" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.621480678917453"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 110191 --> <!-- /react-text --><!-- react-text: 110192 -->17<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">A ranked list produced by a search system</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>We can compute nDCG in 3 steps:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Compute DCG</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Compute IDCG</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Divide DCG by IDCG</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(78, 166, 78);">Compute DCG:</block><block> The DCG for the current ranking produced by the model is:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area display" style="font-size: 17px;" data-mathml="<math display=&quot;block&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub><mo form=&quot;infix&quot;>=</mo><munderover><mo largeop=&quot;true&quot; movablelimit=&quot;true&quot;>∑</mo><mrow><mi>i</mi><mo form=&quot;infix&quot;>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mfrac><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo form=&quot;infix&quot;>+</mo><mn>1</mn><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo form=&quot;infix&quot;>=</mo><mfrac><mn>0</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo form=&quot;infix&quot;>+</mo><mfrac><mn>5</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo form=&quot;infix&quot;>+</mo><mfrac><mn>1</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mn>4</mn><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo form=&quot;infix&quot;>+</mo><mfrac><mn>4</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mn>5</mn><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo form=&quot;infix&quot;>+</mo><mfrac><mn>2</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mn>6</mn><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo form=&quot;infix&quot;>=</mo><mn>6.151</mn></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="taggable" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">DCG</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">p</editarea-block></compositeblock><block class="Relation">=</block><compositeblock dir="ltr" class="summation-like-symbol limit-type limit-kind"><editarea class="from no-area-container" style="margin-bottom: -0.411765em;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block>p</block></line></editarea><symbol class="" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana; font-style: normal; font-weight: normal;"><span>∑</span></symbol><editarea class="to to-summation no-area-container" style="margin-top: 0.176471em;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block>i=1</block></line></editarea></compositeblock><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">rel</block><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">i</editarea-block></compositeblock></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="constant-text inline"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">2</editarea-block></compositeblock><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">i</block><block class="Binary">+</block><block class="Normal">1</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line></compositeblock><block class="Relation">=</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">0</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="constant-text inline"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">2</editarea-block></compositeblock><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">2</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line></compositeblock><block class="Binary">+</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">5</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="constant-text inline"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">2</editarea-block></compositeblock><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">3</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line></compositeblock><block class="Binary">+</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">1</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="constant-text inline"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">2</editarea-block></compositeblock><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">4</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line></compositeblock><block class="Binary">+</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">4</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="constant-text inline"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">2</editarea-block></compositeblock><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">5</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line></compositeblock><block class="Binary">+</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">2</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="constant-text inline"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">2</editarea-block></compositeblock><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">6</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line></compositeblock><block class="Relation">=</block><block class="Normal">6.151</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub><mo form="infix">=</mo><munderover><mo largeop="true" movablelimit="true">∑</mo><mrow><mi>i</mi><mo form="infix">=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mfrac><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence="true" stretchy="false">(</mo><mi>i</mi><mo form="infix">+</mo><mn>1</mn><mo fence="true" stretchy="false">)</mo></mrow></mfrac><mo form="infix">=</mo><mfrac><mn>0</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence="true" stretchy="false">(</mo><mn>2</mn><mo fence="true" stretchy="false">)</mo></mrow></mfrac><mo form="infix">+</mo><mfrac><mn>5</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence="true" stretchy="false">(</mo><mn>3</mn><mo fence="true" stretchy="false">)</mo></mrow></mfrac><mo form="infix">+</mo><mfrac><mn>1</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence="true" stretchy="false">(</mo><mn>4</mn><mo fence="true" stretchy="false">)</mo></mrow></mfrac><mo form="infix">+</mo><mfrac><mn>4</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence="true" stretchy="false">(</mo><mn>5</mn><mo fence="true" stretchy="false">)</mo></mrow></mfrac><mo form="infix">+</mo><mfrac><mn>2</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence="true" stretchy="false">(</mo><mn>6</mn><mo fence="true" stretchy="false">)</mo></mrow></mfrac><mo form="infix">=</mo><mn>6.151</mn></math></span></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold; color: rgb(78, 166, 78);">Compute IDCG:</block><block> The ideal ranking calculation is the same as the DCG calculation, except that it recommends the most relevant items first (Figure 2.18).</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 448.5px; height: 154.14px; position: relative;"><img src="image-resources/103a28af-57a0-4b36-8bad-e97187741bd9.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.4870833586515433" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.4870833586515433"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 110301 --> <!-- /react-text --><!-- react-text: 110302 -->18<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Ideal ranking list</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>The IDCG for the ideal ranking is:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area display" style="font-size: 17px;" data-mathml="<math display=&quot;block&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub><mo form=&quot;infix&quot;>=</mo><munderover><mo largeop=&quot;true&quot; movablelimit=&quot;true&quot;>∑</mo><mrow><mi>i</mi><mo form=&quot;infix&quot;>=</mo><mn>1</mn></mrow><mi>𝜈</mi></munderover><mfrac><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo form=&quot;infix&quot;>+</mo><mn>1</mn><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo form=&quot;infix&quot;>=</mo><mfrac><mn>5</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mn>2</mn><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo form=&quot;infix&quot;>+</mo><mfrac><mn>4</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo form=&quot;infix&quot;>+</mo><mfrac><mn>2</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mn>4</mn><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo form=&quot;infix&quot;>+</mo><mfrac><mn>1</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mn>5</mn><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo form=&quot;infix&quot;>+</mo><mfrac><mn>0</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mn>6</mn><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo form=&quot;infix&quot;>=</mo><mn>8.9543</mn></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="taggable" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">IDCG</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">p</editarea-block></compositeblock><block class="Relation">=</block><compositeblock dir="ltr" class="summation-like-symbol limit-type limit-kind"><editarea class="from no-area-container" style="margin-bottom: -0.411765em;"><line class="" style="margin-bottom: -0.168067em; line-height: 1.2;"><baselineblock></baselineblock><block>𝜈</block></line></editarea><symbol class="" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana; font-style: normal; font-weight: normal;"><span>∑</span></symbol><editarea class="to to-summation no-area-container" style="margin-top: 0.176471em;"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block>i=1</block></line></editarea></compositeblock><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">rel</block><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">i</editarea-block></compositeblock></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="constant-text inline"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">2</editarea-block></compositeblock><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">i</block><block class="Binary">+</block><block class="Normal">1</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line></compositeblock><block class="Relation">=</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">5</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="constant-text inline"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">2</editarea-block></compositeblock><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">2</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line></compositeblock><block class="Binary">+</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">4</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="constant-text inline"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">2</editarea-block></compositeblock><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">3</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line></compositeblock><block class="Binary">+</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">2</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="constant-text inline"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">2</editarea-block></compositeblock><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">4</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line></compositeblock><block class="Binary">+</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">1</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="constant-text inline"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">2</editarea-block></compositeblock><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">5</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line></compositeblock><block class="Binary">+</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">0</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><compositeblock dir="ltr" class="constant-text inline"><constant-text class="close-left close-right" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.5724em;">2</editarea-block></compositeblock><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">6</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></editarea-line></compositeblock><block class="Relation">=</block><block class="Normal">8.9543</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub><mo form="infix">=</mo><munderover><mo largeop="true" movablelimit="true">∑</mo><mrow><mi>i</mi><mo form="infix">=</mo><mn>1</mn></mrow><mi>𝜈</mi></munderover><mfrac><mrow><mi>r</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence="true" stretchy="false">(</mo><mi>i</mi><mo form="infix">+</mo><mn>1</mn><mo fence="true" stretchy="false">)</mo></mrow></mfrac><mo form="infix">=</mo><mfrac><mn>5</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence="true" stretchy="false">(</mo><mn>2</mn><mo fence="true" stretchy="false">)</mo></mrow></mfrac><mo form="infix">+</mo><mfrac><mn>4</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence="true" stretchy="false">(</mo><mn>3</mn><mo fence="true" stretchy="false">)</mo></mrow></mfrac><mo form="infix">+</mo><mfrac><mn>2</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence="true" stretchy="false">(</mo><mn>4</mn><mo fence="true" stretchy="false">)</mo></mrow></mfrac><mo form="infix">+</mo><mfrac><mn>1</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence="true" stretchy="false">(</mo><mn>5</mn><mo fence="true" stretchy="false">)</mo></mrow></mfrac><mo form="infix">+</mo><mfrac><mn>0</mn><mrow><msub><mi>log</mi><mn>2</mn></msub><mo fence="true" stretchy="false">(</mo><mn>6</mn><mo fence="true" stretchy="false">)</mo></mrow></mfrac><mo form="infix">=</mo><mn>8.9543</mn></math></span></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Divide DCG by IDCG:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area display" style="font-size: 17px;" data-mathml="<math display=&quot;block&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mi>D</mi><mi>C</mi><msub><mi>P</mi><mi>p</mi></msub><mo form=&quot;infix&quot;>=</mo><mfrac><mrow><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub></mrow><mrow><mi>I</mi><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub></mrow></mfrac><mo form=&quot;infix&quot;>=</mo><mfrac><mn>6.151</mn><mn>8.9543</mn></mfrac><mo form=&quot;infix&quot;>=</mo><mn>0.6869</mn></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="taggable" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">nDCP</block><compositeblock dir="ltr" class="power-index-symbol-container"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">p</editarea-block></compositeblock><block class="Relation">=</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">DCG</block><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">p</editarea-block></compositeblock></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><block class="Normal">IDCG</block><compositeblock dir="ltr" class="power-index-symbol-container inline"><middle-base><inline></inline></middle-base><editarea-block class="index-value" style="line-height: 1.2; margin-top: -0.747899em;">p</editarea-block></compositeblock></editarea-line></compositeblock><block class="Relation">=</block><compositeblock dir="ltr" class="fraction-symbol smaller"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">6.151</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="margin-bottom: -0.176471em; line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><block class="Normal">8.9543</block></editarea-line></compositeblock><block class="Relation">=</block><block class="Normal">0.6869</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mi>D</mi><mi>C</mi><msub><mi>P</mi><mi>p</mi></msub><mo form="infix">=</mo><mfrac><mrow><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub></mrow><mrow><mi>I</mi><mi>D</mi><mi>C</mi><msub><mi>G</mi><mi>p</mi></msub></mrow></mfrac><mo form="infix">=</mo><mfrac><mn>6.151</mn><mn>8.9543</mn></mfrac><mo form="infix">=</mo><mn>0.6869</mn></math></span></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>nDCG works well most times. Its primary shortcoming is that deriving ground truth relevance scores is not always possible. In our case, since the evaluation dataset contains similarity scores, we can use nDCG to measure the performance of the model during the offline evaluation.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.44193849210843483" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.44193849210843483" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">5.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Online Metrics</block></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.7793533116500244" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.7793533116500244" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">5.2.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Click-Through Rate (CTR)</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>This metric shows how often users click on the displayed items. CTR can be calculated using the following formula:</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area display" style="font-size: 17px;" data-mathml="<math display=&quot;block&quot; xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;normal&quot;>C</mi><mi mathvariant=&quot;normal&quot;>T</mi><mi mathvariant=&quot;normal&quot;>R</mi><mo form=&quot;infix&quot; mathvariant=&quot;normal&quot;>=</mo><mfrac><mrow><mi mathvariant=&quot;normal&quot;>N</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>b</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>r</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>f</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>k</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>d</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>g</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>s</mi></mrow><mrow><mi mathvariant=&quot;normal&quot;>T</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>l</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>n</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>b</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>r</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>f</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>u</mi><mi mathvariant=&quot;normal&quot;>g</mi><mi mathvariant=&quot;normal&quot;>g</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>s</mi><mi mathvariant=&quot;normal&quot;>t</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>d</mi><mspace is=&quot;true&quot; width=&quot;0.22em&quot;></mspace><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>a</mi><mi mathvariant=&quot;normal&quot;>g</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>s</mi></mrow></mfrac></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="taggable" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana;">CTR</block><block class="Relation" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana;">=</block><compositeblock dir="ltr" class="fraction-symbol smaller" style="font-family: LatinModern-Mathrm, LatinModern-Math, LatinModern, Asana;"><editarea-line class=" frac-edit-area enumerator" style="line-height: 1.2; margin-bottom: -0.470588em;"><baselineblock></baselineblock><block class="Normal">Number of clicked images</block></editarea-line><div class="frac-line"><inline style="border-bottom: 1px solid;"></inline></div><editarea-line class=" frac-edit-area denominator" style="line-height: 1.2; margin-top: -0.411765em;"><baselineblock></baselineblock><block class="Normal">Total number of suggested images</block></editarea-line></compositeblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">C</mi><mi mathvariant="normal">T</mi><mi mathvariant="normal">R</mi><mo form="infix" mathvariant="normal">=</mo><mfrac><mrow><mi mathvariant="normal">N</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">c</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">k</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow><mrow><mi mathvariant="normal">T</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">n</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">s</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">d</mi><mspace is="true" width="0.22em"></mspace><mi mathvariant="normal">i</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mrow></mfrac></math></span></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>A high CTR indicates that users click on the displayed items often. CTR is commonly used as an online metric in search and recommendation systems, as we will see in later chapters.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-weight: bold;">Average daily, weekly, and monthly time spent on the suggested images.</block><block> This metric shows how engaged users are with the suggested images. When the search system is accurate, we expect this metric to increase.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.5869609451460054" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.5869609451460054" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">6. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Serving</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>At serving time, the system returns a ranked list of similar images based on a query image. Figure 2.19 shows the prediction pipeline and an indexing pipeline. Let’s look closer at each pipeline.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 706.125px; height: 349.95px; position: relative;"><img src="image-resources/a9b5c7a9-23c6-4689-ba0d-b96ba12aa7bc.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.39533151547254386" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.39533151547254386"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 110476 --> <!-- /react-text --><!-- react-text: 110477 -->19<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Prediction and indexing pipeline</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.47325277262881316" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.47325277262881316" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">6.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Prediction Pipeline</block></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.0027946867290176147" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.0027946867290176147" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.1.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Embedding Generation Service</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>This service computes the embedding of the input query image. As Figure 2.20 shows, it preprocesses the image and uses the trained model to determine the embedding.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 509.25px; height: 251.23px; position: relative;"><img src="image-resources/85f05ae7-ec22-4fe6-be92-dc7169eaa313.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.14107048358361607" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.14107048358361607"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 110536 --> <!-- /react-text --><!-- react-text: 110537 -->20<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Embedding generation service</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.8967360631870427" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.8967360631870427" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.1.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Nearest Neighbor Service</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Once we get the embedding of the query image, we need to retrieve similar images from the embedding space. The nearest neighbor service does this.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Let’s define the nearest neighbor search more formally. Given a query point “q” and a set of other points S, it finds the closest points to “q” in set S. Note that an image embedding is a point in </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>N</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">N</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>N</mi></mstyle></math></span></compositeblock><block>-dimensional space, where </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>N</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">N</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>N</mi></mstyle></math></span></compositeblock><block> is the size of the embedding vector. Figure 2.21 shows the top 3 nearest neighbors of image q. We denote the query image as q, and other images as </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>x</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">x</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>x</mi></mstyle></math></span></compositeblock><block>.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 438.75px; height: 416.18px; position: relative;"><img src="image-resources/27373125-cc33-48e3-b3d0-a0a4abe115d4.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.8754222258472495" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.8754222258472495"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 110609 --> <!-- /react-text --><!-- react-text: 110610 -->21<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Top 3 nearest neighbors to image q in the embedding space</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.4266641867893801" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.4266641867893801" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.1.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Re-ranking Service</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>This service incorporates business-level logic and policies. For example, it filters inappropriate results, ensures we don’t include private images, removes duplicates or nearduplicate results, and enforces other similar logic before displaying the final results to the user.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.3699953519594881" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.3699953519594881" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">6.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Indexing Pipeline</block></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.682100431480549" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.682100431480549" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.2.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Indexing Service</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>All images on the platform are indexed by this service to improve search performance.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Another responsibility of the indexing service is to keep the index table updated. For example, when a creator adds a new image to the platform, the service indexes the embedding of the new image to make it discoverable by the nearest neighbor search.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">• </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Indexing increases memory usage because we store the embeddings of the entire images in an index table. Various optimizations are available to reduce memory usages, such as vector quantization [16] and product quantization [17].</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-1" data-line-id="n0.15381220637283954" style="font-size: 1.1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.15381220637283954" role="heading" aria-level="2"><prefix style="text-align: left; padding-right: 0.25em;">6.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Performance of nearest neighbor (NN) algorithms</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Nearest neighbor search is a core component of information retrieval, search, and recommendation systems. A slight improvement in its efficiency leads to significant overall performance improvement. Given how critical this component is, the interviewer may want you to deep diver into this topic.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>NN algorithms can be divided into two categories: exact and approximate. Let’s examine each in more detail.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.696635299365522" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.696635299365522" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.3.1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Exact nearest neighbor</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Exact nearest neighbor, also called linear search, is the simplest form of NN. It works by searching the entire index table, calculating the distance of each point with the query point q, and retrieving the </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>k</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">k</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>k</mi></mstyle></math></span></compositeblock><block> nearest points. The time complexity is </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>O</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo form=&quot;infix&quot;>×</mo><mi>D</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">O</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">N</block><block class="Binary">×</block><block class="Normal">D</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>O</mi><mo fence="true" stretchy="false">(</mo><mi>N</mi><mo form="infix">×</mo><mi>D</mi><mo fence="true" stretchy="false">)</mo></mrow></mstyle></math></span></compositeblock><block>, where </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>N</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">N</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>N</mi></mstyle></math></span></compositeblock><block> is the total number of points and </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>D</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">D</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>D</mi></mstyle></math></span></compositeblock><block> is the point dimension.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>In a large-scale system in which </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mi>N</mi></mstyle></math>"><editarea class="math-mode-font lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">N</block></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mi>N</mi></mstyle></math></span></compositeblock><block> may easily run into the billions, the linear time complexity is too slow.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.09152887273328258" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.09152887273328258" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.3.2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Approximate nearest neighbor (ANN)</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>In many applications, showing users similar enough items is sufficient, and there is no need to perform an exact nearest neighbor search.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>In ANN algorithms, a particular data structure is used to reduce the time complexity of NN search to sublinear, e.g., </block><compositeblock dir="ltr" class="math-container-symbol role-mathmode-area inline" style="font-size: 17px;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mrow><mi>O</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>(</mo><mi>D</mi><mo form=&quot;infix&quot;>×</mo><mi>log</mi><mi>N</mi><mo fence=&quot;true&quot; stretchy=&quot;false&quot;>)</mo></mrow></mstyle></math>"><editarea class="math-mode-font lazy lazyable no-area-container" style="font-family: LatinModern-Math, LatinModern, Asana-Math, Asana;" aria-hidden="true"><line class="" style="line-height: 1.2;"><baselineblock></baselineblock><block class="Normal">O</block><opensymbolblock class="normal" type="parenthesis"><bracket-span>(</bracket-span></opensymbolblock><block class="Normal">D</block><block class="Binary">×</block><compositeblock dir="ltr" class="constant-text"><constant-text class="close-left" style="font-family: LatinModern, Asana; font-style: normal;">log</constant-text></compositeblock><block class="Normal">N</block><closesymbolblock class="normal" type="parenthesis"><bracket-span>)</bracket-span></closesymbolblock></line></editarea><span role="presentation" style="width:100%;position:absolute;top:0;left:0;clip:rect(1px, 1px, 1px, 1px);height:1px;padding:1px 0 0 0!important;overflow:hidden;user-select:none;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mrow><mi>O</mi><mo fence="true" stretchy="false">(</mo><mi>D</mi><mo form="infix">×</mo><mi>log</mi><mi>N</mi><mo fence="true" stretchy="false">)</mo></mrow></mstyle></math></span></compositeblock><block>. They usually require up-front preprocessing or additional space.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>ANN algorithms can be divided into the following three categories:</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Tree-based ANN</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Locality-sensitive hashing (LSH)-based ANN</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Clustering-based ANN</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>There are various algorithms within each category, and interviewers typically do not expect you to know every detail. It’s adequate to have a high-level understanding of them. So, let’s briefly cover each category.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.168097326440799" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.168097326440799" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.3.3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Tree-based ANN</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Tree-based algorithms form a tree by splitting the space into multiple partitions. Then, they leverage the characteristics of the tree to perform a faster search.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>We form the tree by iteratively adding new criteria to each node. For instance, one criterion for the root node can be: gender=male. This means any point with a female attribute belongs to the left sub-tree.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 383.75px; height: 335.89px; position: relative;"><img src="image-resources/561457f9-4ba9-4c76-9879-290f871e3e71.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.28877418643800623" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.28877418643800623"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 110873 --> <!-- /react-text --><!-- react-text: 110874 -->22<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">A formed tree from the points</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>In the tree, non-leaf nodes split the space into two partitions given the criterion. Leaf nodes indicate a particular region in space. Figure 2.23 shows an example of the space divided into 7 regions. The algorithm only searches the partition that the query point belongs to.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 389.5px; height: 383.06px; position: relative;"><img src="image-resources/28c8d358-77ae-4f00-8088-5d866bac38b5.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.09948943316778136" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.09948943316778136"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 110918 --> <!-- /react-text --><!-- react-text: 110919 -->23<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Partitioned space by the tree</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Typical tree-based methods are R-trees [18], Kd-trees [19], and Annoy (Approximate Nearest Neighbor Oh Yeah) [20].</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.46361619432766554" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.46361619432766554" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.3.4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Locality sensitive hashing (LSH)</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>LSH uses particular hash functions to reduce the dimensions of points and group them into buckets. These hash functions map points in close proximity to each other into the same bucket. LSH searches only those points belonging to the same bucket as the query point q. You can learn more about LSH by reading [21].</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode full-line-block-inside" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><compositeblock dir="ltr" class="image-container no-cursor-selected no-editor"><image-viewer class=""><image-container class="center"><div class="image-content" style="width: 565.25px; height: 274.77px; position: relative;"><img src="image-resources/afb07388-8c00-4db5-aa8f-629206183b80.png" style="width: 100%; height: 100%; box-sizing: border-box; border-radius: 0px;"></div></image-container></image-viewer><div data-caption-block-id="n0.43645655171000386" class="role-image-caption-container role-caption-container" style="display: flex; align-items: center; justify-content: center; margin-top: 10px;" id="n0.43645655171000386"><span class="no-print-outline" style="outline: none; position: relative; text-align: center;"><span class="role-image-caption-prefix" style="padding-right: 0.3em; font-weight: bold;"><span class="role-image-caption-name">Figure</span><span class="role-image-caption-number"><!-- react-text: 110983 --> <!-- /react-text --><!-- react-text: 110984 -->24<!-- /react-text --></span><span>:</span></span><editarea class="image-caption text-mode" style="min-width: 50px; display: inline;"><line class="text-mode align-center" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><block style="font-size: 0.9em;">Use LSH to group the data points into buckets</block></blocks></line></editarea></span></div></compositeblock></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.18930969365111627" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.18930969365111627" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.3.5. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Clustering-based ANN</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>These algorithms form clusters by grouping the points based on similarities. Once the clusters are formed, the algorithms search only the subset of points in the cluster to which the query point belongs.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-2" data-line-id="n0.03977412737382813" style="font-size: 1em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.03977412737382813" role="heading" aria-level="3"><prefix style="text-align: left; padding-right: 0em;">6.3.6. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Which algorithm should we use?</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Results from the exact nearest neighbor method are guaranteed to be accurate. This makes it a good option when we have limited data points, or if it’s required to have the exact nearest neighbors. However, when there are a large number of points, it’s impractical to run the algorithm efficiently. In this case, ANN methods are commonly used. While they may not return the exact points, they are more efficient in finding the nearest points.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>Given the amount of data available in today’s systems, the ANN method is a more pragmatic solution. In our visual search system, we use ANN to find similar image embeddings.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left; visibility: hidden;">• </prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>For an applied ML role, the interviewer may ask you to implement ANN. Two widelyused libraries are Faiss [22] (developed by Meta) and ScaNN [23] (developed by Google). Each supports the majority of methods we have described in this chapter. You are encouraged to familiarize yourself with at least one of these libraries to better understand the concepts and to gain the confidence with which to implement the nearest neighbor search in an ML coding interview.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.7213628662738067" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.7213628662738067" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">7. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Other Talking Points</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">• </prefix><blocks><baselineblock class="inline"></baselineblock><block>If there is extra time at the end of the interview, you might be asked follow-up questions or challenged to discuss advanced topics, depending on various factors such as the interviewer’s preference, the candidate’s expertise, role requirements, etc. Some topics to prepare for, especially for senior roles, are listed below.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Moderate content in the system by identifying and blocking inappropriate images [24].</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Different biases present in the system, such as positional bias [25][26].</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>How to use image metadata such as tags to improve search results. This is covered in Chapter 3 Google Street View Blurring System.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Smart crop using object detection [27].</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>How to use graph neural networks to learn better representations [28].</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>Support the ability to search images by a textual query. We examine this in Chapter 4.</block></blocks></line><line class="root text-mode indent-1 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="2"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">– </prefix><blocks><baselineblock class="inline"></baselineblock><block>How to use active learning [29] or human-in-the-loop [30] ML to annotate data more efficiently.</block></blocks></line><line class="root text-mode" style="line-height: 1.4;"><prefix></prefix><blocks><baselineblock class="inline"></baselineblock><emptyblock aria-label="empty line"> </emptyblock></blocks></line><line class="root text-mode section sindent-0" data-line-id="n0.773991377613257" style="font-size: 1.2em; padding-top: 0.5em; padding-bottom: 0.5em; font-weight: bold; line-height: 1.4;" id="n0.773991377613257" role="heading" aria-level="1"><prefix style="text-align: left; padding-right: 0.5em;">8. </prefix><blocks><baselineblock class="inline"></baselineblock><block>References</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">1. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Visual search at pinterest. https://arxiv.org/pdf/1505.07647.pdf.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">2. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Visual embeddings for search at Pinterest. https://medium.com/pinterest-engineering/unifying-visual-embeddings-for-visual-search-at-pinterest-74ea7ea103f0.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">3. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Representation learning. https://en.wikipedia.org/wiki/Feature_learning.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">4. </prefix><blocks><baselineblock class="inline"></baselineblock><block>ResNet paper. https://arxiv.org/pdf/1512.03385.pdf.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">5. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Transformer paper. https://arxiv.org/pdf/1706.03762.pdf.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">6. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Vision Transformer paper. https://arxiv.org/pdf/2010.11929.pdf.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">7. </prefix><blocks><baselineblock class="inline"></baselineblock><block>SimCLR paper. https://arxiv.org/pdf/2002.05709.pdf.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">8. </prefix><blocks><baselineblock class="inline"></baselineblock><block>MoCo paper. https://openaccess.thecvf.com/content_CVPR_2020/papers/He_Momentum_Contrast_for_Unsupervised_Visual_Representation_Learning_CVPR_2020_paper.pdf.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">9. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Contrastive representation learning methods. https://lilianweng.github.io/posts/2019-11-10-self-supervised/.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">10. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Dot product. https://en.wikipedia.org/wiki/Dot_product.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">11. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Cosine similarity. https://en.wikipedia.org/wiki/Cosine_similarity.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">12. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Euclidean distance. https://en.wikipedia.org/wiki/Euclidean_distance.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">13. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Curse of dimensionality. https://en.wikipedia.org/wiki/Curse_of_dimensionality.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">14. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Curse of dimensionality issues in ML. https://www.mygreatlearning.com/blog/understanding-curse-of-dimensionality/.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">15. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Cross-entropy loss. https://en.wikipedia.org/wiki/Cross_entropy.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">16. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Vector quantization. http://ws.binghamton.edu/fowler/fowler%20personal%20page/EE523_files/Ch_10_1%20VQ%20Description%20(PPT).pdf.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">17. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Product quantization. https://towardsdatascience.com/product-quantization-for-similarity-search-2f1f67c5fddd.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">18. </prefix><blocks><baselineblock class="inline"></baselineblock><block>R-Trees. https://en.wikipedia.org/wiki/R-tree.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">19. </prefix><blocks><baselineblock class="inline"></baselineblock><block>KD-Tree. https://kanoki.org/2020/08/05/find-nearest-neighbor-using-kd-tree/.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">20. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Annoy. https://towardsdatascience.com/comprehensive-guide-to-approximate-nearest-neighbors-algorithms-8b94f057d6b6.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">21. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Locality-sensitive hashing. https://web.stanford.edu/class/cs246/slides/03-lsh.pdf.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">22. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Faiss library. https://github.com/facebookresearch/faiss/wiki.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">23. </prefix><blocks><baselineblock class="inline"></baselineblock><block>ScaNN library. https://github.com/google-research/google-research/tree/master/scann.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">24. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Content moderation with ML. https://appen.com/blog/content-moderation/.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">25. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Bias in AI and recommendation systems. https://www.searchenginejournal.com/biases-search-recommender-systems/339319/#close.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">26. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Positional bias. https://eugeneyan.com/writing/position-bias/.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">27. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Smart crop. https://blog.twitter.com/engineering/en_us/topics/infrastructure/2018/Smart-Auto-Cropping-of-Images.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">28. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Better search with gnns. https://arxiv.org/pdf/2010.01666.pdf.</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">29. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Active learning. https://en.wikipedia.org/wiki/Active_learning_(machine_learning).</block></blocks></line><line class="root text-mode indent-0 has-indent list-item" style="line-height: 1.4;" role="listitem" aria-level="1"><prefix style="flex-shrink: 0; min-width: 1em; text-align: left;">30. </prefix><blocks><baselineblock class="inline"></baselineblock><block>Human-in-the-loop ML. https://arxiv.org/pdf/2108.00941.pdf.</block></blocks></line></area-container></editarea><div></div></math-edit-container></math-type></editor-container></body></html>